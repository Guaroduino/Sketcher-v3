(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();function ST(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Wp={exports:{}},_c={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G0;function N1(){if(G0)return _c;G0=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,r,a){var c=null;if(a!==void 0&&(c=""+a),r.key!==void 0&&(c=""+r.key),"key"in r){a={};for(var d in r)d!=="key"&&(a[d]=r[d])}else a=r;return r=a.ref,{$$typeof:t,type:s,key:c,ref:r!==void 0?r:null,props:a}}return _c.Fragment=e,_c.jsx=n,_c.jsxs=n,_c}var $0;function M1(){return $0||($0=1,Wp.exports=N1()),Wp.exports}var g=M1(),Xp={exports:{}},gt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y0;function k1(){if(Y0)return gt;Y0=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),E=Symbol.iterator;function S(O){return O===null||typeof O!="object"?null:(O=E&&O[E]||O["@@iterator"],typeof O=="function"?O:null)}var L={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,F={};function z(O,Q,te){this.props=O,this.context=Q,this.refs=F,this.updater=te||L}z.prototype.isReactComponent={},z.prototype.setState=function(O,Q){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,Q,"setState")},z.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function q(){}q.prototype=z.prototype;function j(O,Q,te){this.props=O,this.context=Q,this.refs=F,this.updater=te||L}var H=j.prototype=new q;H.constructor=j,U(H,z.prototype),H.isPureReactComponent=!0;var Y=Array.isArray;function K(){}var R={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function N(O,Q,te){var ie=te.ref;return{$$typeof:t,type:O,key:Q,ref:ie!==void 0?ie:null,props:te}}function I(O,Q){return N(O.type,Q,O.props)}function D(O){return typeof O=="object"&&O!==null&&O.$$typeof===t}function k(O){var Q={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(te){return Q[te]})}var M=/\/+/g;function ce(O,Q){return typeof O=="object"&&O!==null&&O.key!=null?k(""+O.key):Q.toString(36)}function ge(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(K,K):(O.status="pending",O.then(function(Q){O.status==="pending"&&(O.status="fulfilled",O.value=Q)},function(Q){O.status==="pending"&&(O.status="rejected",O.reason=Q)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function $(O,Q,te,ie,Ce){var be=typeof O;(be==="undefined"||be==="boolean")&&(O=null);var Fe=!1;if(O===null)Fe=!0;else switch(be){case"bigint":case"string":case"number":Fe=!0;break;case"object":switch(O.$$typeof){case t:case e:Fe=!0;break;case _:return Fe=O._init,$(Fe(O._payload),Q,te,ie,Ce)}}if(Fe)return Ce=Ce(O),Fe=ie===""?"."+ce(O,0):ie,Y(Ce)?(te="",Fe!=null&&(te=Fe.replace(M,"$&/")+"/"),$(Ce,Q,te,"",function(tt){return tt})):Ce!=null&&(D(Ce)&&(Ce=I(Ce,te+(Ce.key==null||O&&O.key===Ce.key?"":(""+Ce.key).replace(M,"$&/")+"/")+Fe)),Q.push(Ce)),1;Fe=0;var Ue=ie===""?".":ie+":";if(Y(O))for(var Oe=0;Oe<O.length;Oe++)ie=O[Oe],be=Ue+ce(ie,Oe),Fe+=$(ie,Q,te,be,Ce);else if(Oe=S(O),typeof Oe=="function")for(O=Oe.call(O),Oe=0;!(ie=O.next()).done;)ie=ie.value,be=Ue+ce(ie,Oe++),Fe+=$(ie,Q,te,be,Ce);else if(be==="object"){if(typeof O.then=="function")return $(ge(O),Q,te,ie,Ce);throw Q=String(O),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return Fe}function G(O,Q,te){if(O==null)return O;var ie=[],Ce=0;return $(O,ie,"","",function(be){return Q.call(te,be,Ce++)}),ie}function ae(O){if(O._status===-1){var Q=O._result;Q=Q(),Q.then(function(te){(O._status===0||O._status===-1)&&(O._status=1,O._result=te)},function(te){(O._status===0||O._status===-1)&&(O._status=2,O._result=te)}),O._status===-1&&(O._status=0,O._result=Q)}if(O._status===1)return O._result.default;throw O._result}var ve=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(Q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},X={map:G,forEach:function(O,Q,te){G(O,function(){Q.apply(this,arguments)},te)},count:function(O){var Q=0;return G(O,function(){Q++}),Q},toArray:function(O){return G(O,function(Q){return Q})||[]},only:function(O){if(!D(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return gt.Activity=b,gt.Children=X,gt.Component=z,gt.Fragment=n,gt.Profiler=r,gt.PureComponent=j,gt.StrictMode=s,gt.Suspense=f,gt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,gt.__COMPILER_RUNTIME={__proto__:null,c:function(O){return R.H.useMemoCache(O)}},gt.cache=function(O){return function(){return O.apply(null,arguments)}},gt.cacheSignal=function(){return null},gt.cloneElement=function(O,Q,te){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var ie=U({},O.props),Ce=O.key;if(Q!=null)for(be in Q.key!==void 0&&(Ce=""+Q.key),Q)!T.call(Q,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&Q.ref===void 0||(ie[be]=Q[be]);var be=arguments.length-2;if(be===1)ie.children=te;else if(1<be){for(var Fe=Array(be),Ue=0;Ue<be;Ue++)Fe[Ue]=arguments[Ue+2];ie.children=Fe}return N(O.type,Ce,ie)},gt.createContext=function(O){return O={$$typeof:c,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:a,_context:O},O},gt.createElement=function(O,Q,te){var ie,Ce={},be=null;if(Q!=null)for(ie in Q.key!==void 0&&(be=""+Q.key),Q)T.call(Q,ie)&&ie!=="key"&&ie!=="__self"&&ie!=="__source"&&(Ce[ie]=Q[ie]);var Fe=arguments.length-2;if(Fe===1)Ce.children=te;else if(1<Fe){for(var Ue=Array(Fe),Oe=0;Oe<Fe;Oe++)Ue[Oe]=arguments[Oe+2];Ce.children=Ue}if(O&&O.defaultProps)for(ie in Fe=O.defaultProps,Fe)Ce[ie]===void 0&&(Ce[ie]=Fe[ie]);return N(O,be,Ce)},gt.createRef=function(){return{current:null}},gt.forwardRef=function(O){return{$$typeof:d,render:O}},gt.isValidElement=D,gt.lazy=function(O){return{$$typeof:_,_payload:{_status:-1,_result:O},_init:ae}},gt.memo=function(O,Q){return{$$typeof:h,type:O,compare:Q===void 0?null:Q}},gt.startTransition=function(O){var Q=R.T,te={};R.T=te;try{var ie=O(),Ce=R.S;Ce!==null&&Ce(te,ie),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"&&ie.then(K,ve)}catch(be){ve(be)}finally{Q!==null&&te.types!==null&&(Q.types=te.types),R.T=Q}},gt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},gt.use=function(O){return R.H.use(O)},gt.useActionState=function(O,Q,te){return R.H.useActionState(O,Q,te)},gt.useCallback=function(O,Q){return R.H.useCallback(O,Q)},gt.useContext=function(O){return R.H.useContext(O)},gt.useDebugValue=function(){},gt.useDeferredValue=function(O,Q){return R.H.useDeferredValue(O,Q)},gt.useEffect=function(O,Q){return R.H.useEffect(O,Q)},gt.useEffectEvent=function(O){return R.H.useEffectEvent(O)},gt.useId=function(){return R.H.useId()},gt.useImperativeHandle=function(O,Q,te){return R.H.useImperativeHandle(O,Q,te)},gt.useInsertionEffect=function(O,Q){return R.H.useInsertionEffect(O,Q)},gt.useLayoutEffect=function(O,Q){return R.H.useLayoutEffect(O,Q)},gt.useMemo=function(O,Q){return R.H.useMemo(O,Q)},gt.useOptimistic=function(O,Q){return R.H.useOptimistic(O,Q)},gt.useReducer=function(O,Q,te){return R.H.useReducer(O,Q,te)},gt.useRef=function(O){return R.H.useRef(O)},gt.useState=function(O){return R.H.useState(O)},gt.useSyncExternalStore=function(O,Q,te){return R.H.useSyncExternalStore(O,Q,te)},gt.useTransition=function(){return R.H.useTransition()},gt.version="19.2.0",gt}var J0;function ug(){return J0||(J0=1,Xp.exports=k1()),Xp.exports}var P=ug();const dg=ST(P);var Qp={exports:{}},xc={},Zp={exports:{}},em={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K0;function D1(){return K0||(K0=1,(function(t){function e($,G){var ae=$.length;$.push(G);e:for(;0<ae;){var ve=ae-1>>>1,X=$[ve];if(0<r(X,G))$[ve]=G,$[ae]=X,ae=ve;else break e}}function n($){return $.length===0?null:$[0]}function s($){if($.length===0)return null;var G=$[0],ae=$.pop();if(ae!==G){$[0]=ae;e:for(var ve=0,X=$.length,O=X>>>1;ve<O;){var Q=2*(ve+1)-1,te=$[Q],ie=Q+1,Ce=$[ie];if(0>r(te,ae))ie<X&&0>r(Ce,te)?($[ve]=Ce,$[ie]=ae,ve=ie):($[ve]=te,$[Q]=ae,ve=Q);else if(ie<X&&0>r(Ce,ae))$[ve]=Ce,$[ie]=ae,ve=ie;else break e}}return G}function r($,G){var ae=$.sortIndex-G.sortIndex;return ae!==0?ae:$.id-G.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var f=[],h=[],_=1,b=null,E=3,S=!1,L=!1,U=!1,F=!1,z=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;function H($){for(var G=n(h);G!==null;){if(G.callback===null)s(h);else if(G.startTime<=$)s(h),G.sortIndex=G.expirationTime,e(f,G);else break;G=n(h)}}function Y($){if(U=!1,H($),!L)if(n(f)!==null)L=!0,K||(K=!0,k());else{var G=n(h);G!==null&&ge(Y,G.startTime-$)}}var K=!1,R=-1,T=5,N=-1;function I(){return F?!0:!(t.unstable_now()-N<T)}function D(){if(F=!1,K){var $=t.unstable_now();N=$;var G=!0;try{e:{L=!1,U&&(U=!1,q(R),R=-1),S=!0;var ae=E;try{t:{for(H($),b=n(f);b!==null&&!(b.expirationTime>$&&I());){var ve=b.callback;if(typeof ve=="function"){b.callback=null,E=b.priorityLevel;var X=ve(b.expirationTime<=$);if($=t.unstable_now(),typeof X=="function"){b.callback=X,H($),G=!0;break t}b===n(f)&&s(f),H($)}else s(f);b=n(f)}if(b!==null)G=!0;else{var O=n(h);O!==null&&ge(Y,O.startTime-$),G=!1}}break e}finally{b=null,E=ae,S=!1}G=void 0}}finally{G?k():K=!1}}}var k;if(typeof j=="function")k=function(){j(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,ce=M.port2;M.port1.onmessage=D,k=function(){ce.postMessage(null)}}else k=function(){z(D,0)};function ge($,G){R=z(function(){$(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return E},t.unstable_next=function($){switch(E){case 1:case 2:case 3:var G=3;break;default:G=E}var ae=E;E=G;try{return $()}finally{E=ae}},t.unstable_requestPaint=function(){F=!0},t.unstable_runWithPriority=function($,G){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ae=E;E=$;try{return G()}finally{E=ae}},t.unstable_scheduleCallback=function($,G,ae){var ve=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?ve+ae:ve):ae=ve,$){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=ae+X,$={id:_++,callback:G,priorityLevel:$,startTime:ae,expirationTime:X,sortIndex:-1},ae>ve?($.sortIndex=ae,e(h,$),n(f)===null&&$===n(h)&&(U?(q(R),R=-1):U=!0,ge(Y,ae-ve))):($.sortIndex=X,e(f,$),L||S||(L=!0,K||(K=!0,k()))),$},t.unstable_shouldYield=I,t.unstable_wrapCallback=function($){var G=E;return function(){var ae=E;E=G;try{return $.apply(this,arguments)}finally{E=ae}}}})(em)),em}var W0;function P1(){return W0||(W0=1,Zp.exports=D1()),Zp.exports}var tm={exports:{}},as={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X0;function L1(){if(X0)return as;X0=1;var t=ug();function e(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)h+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(f,h,_){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:b==null?null:""+b,children:f,containerInfo:h,implementation:_}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return as.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,as.createPortal=function(f,h){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(f,h,null,_)},as.flushSync=function(f){var h=c.T,_=s.p;try{if(c.T=null,s.p=2,f)return f()}finally{c.T=h,s.p=_,s.d.f()}},as.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,s.d.C(f,h))},as.prefetchDNS=function(f){typeof f=="string"&&s.d.D(f)},as.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var _=h.as,b=d(_,h.crossOrigin),E=typeof h.integrity=="string"?h.integrity:void 0,S=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;_==="style"?s.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:b,integrity:E,fetchPriority:S}):_==="script"&&s.d.X(f,{crossOrigin:b,integrity:E,fetchPriority:S,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},as.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var _=d(h.as,h.crossOrigin);s.d.M(f,{crossOrigin:_,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&s.d.M(f)},as.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var _=h.as,b=d(_,h.crossOrigin);s.d.L(f,_,{crossOrigin:b,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},as.preloadModule=function(f,h){if(typeof f=="string")if(h){var _=d(h.as,h.crossOrigin);s.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:_,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else s.d.m(f)},as.requestFormReset=function(f){s.d.r(f)},as.unstable_batchedUpdates=function(f,h){return f(h)},as.useFormState=function(f,h,_){return c.H.useFormState(f,h,_)},as.useFormStatus=function(){return c.H.useHostTransitionStatus()},as.version="19.2.0",as}var Q0;function V1(){if(Q0)return tm.exports;Q0=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),tm.exports=L1(),tm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z0;function U1(){if(Z0)return xc;Z0=1;var t=P1(),e=ug(),n=V1();function s(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function a(i){var o=i,l=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(l=o.return),i=o.return;while(i)}return o.tag===3?l:null}function c(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function d(i){if(i.tag===31){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function f(i){if(a(i)!==i)throw Error(s(188))}function h(i){var o=i.alternate;if(!o){if(o=a(i),o===null)throw Error(s(188));return o!==i?null:i}for(var l=i,u=o;;){var y=l.return;if(y===null)break;var x=y.alternate;if(x===null){if(u=y.return,u!==null){l=u;continue}break}if(y.child===x.child){for(x=y.child;x;){if(x===l)return f(y),i;if(x===u)return f(y),o;x=x.sibling}throw Error(s(188))}if(l.return!==u.return)l=y,u=x;else{for(var C=!1,V=y.child;V;){if(V===l){C=!0,l=y,u=x;break}if(V===u){C=!0,u=y,l=x;break}V=V.sibling}if(!C){for(V=x.child;V;){if(V===l){C=!0,l=x,u=y;break}if(V===u){C=!0,u=x,l=y;break}V=V.sibling}if(!C)throw Error(s(189))}}if(l.alternate!==u)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?i:o}function _(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=_(i),o!==null)return o;i=i.sibling}return null}var b=Object.assign,E=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),L=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),j=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function k(i){return i===null||typeof i!="object"?null:(i=D&&i[D]||i["@@iterator"],typeof i=="function"?i:null)}var M=Symbol.for("react.client.reference");function ce(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===M?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case U:return"Fragment";case z:return"Profiler";case F:return"StrictMode";case Y:return"Suspense";case K:return"SuspenseList";case N:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case L:return"Portal";case j:return i.displayName||"Context";case q:return(i._context.displayName||"Context")+".Consumer";case H:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case R:return o=i.displayName||null,o!==null?o:ce(i.type)||"Memo";case T:o=i._payload,i=i._init;try{return ce(i(o))}catch{}}return null}var ge=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},ve=[],X=-1;function O(i){return{current:i}}function Q(i){0>X||(i.current=ve[X],ve[X]=null,X--)}function te(i,o){X++,ve[X]=i.current,i.current=o}var ie=O(null),Ce=O(null),be=O(null),Fe=O(null);function Ue(i,o){switch(te(be,o),te(Ce,i),te(ie,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?p0(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=p0(o),i=m0(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Q(ie),te(ie,i)}function Oe(){Q(ie),Q(Ce),Q(be)}function tt(i){i.memoizedState!==null&&te(Fe,i);var o=ie.current,l=m0(o,i.type);o!==l&&(te(Ce,i),te(ie,l))}function Ot(i){Ce.current===i&&(Q(ie),Q(Ce)),Fe.current===i&&(Q(Fe),mc._currentValue=ae)}var vt,Ae;function Ne(i){if(vt===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);vt=o&&o[1]||"",Ae=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+vt+i+Ae}var Se=!1;function De(i,o){if(!i||Se)return"";Se=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(o){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(he){var le=he}Reflect.construct(i,[],_e)}else{try{_e.call()}catch(he){le=he}i.call(_e.prototype)}}else{try{throw Error()}catch(he){le=he}(_e=i())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(he){if(he&&le&&typeof he.stack=="string")return[he.stack,le.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=u.DetermineComponentFrameRoot(),C=x[0],V=x[1];if(C&&V){var W=C.split(`
`),oe=V.split(`
`);for(y=u=0;u<W.length&&!W[u].includes("DetermineComponentFrameRoot");)u++;for(;y<oe.length&&!oe[y].includes("DetermineComponentFrameRoot");)y++;if(u===W.length||y===oe.length)for(u=W.length-1,y=oe.length-1;1<=u&&0<=y&&W[u]!==oe[y];)y--;for(;1<=u&&0<=y;u--,y--)if(W[u]!==oe[y]){if(u!==1||y!==1)do if(u--,y--,0>y||W[u]!==oe[y]){var me=`
`+W[u].replace(" at new "," at ");return i.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",i.displayName)),me}while(1<=u&&0<=y);break}}}finally{Se=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?Ne(l):""}function et(i,o){switch(i.tag){case 26:case 27:case 5:return Ne(i.type);case 16:return Ne("Lazy");case 13:return i.child!==o&&o!==null?Ne("Suspense Fallback"):Ne("Suspense");case 19:return Ne("SuspenseList");case 0:case 15:return De(i.type,!1);case 11:return De(i.type.render,!1);case 1:return De(i.type,!0);case 31:return Ne("Activity");default:return""}}function We(i){try{var o="",l=null;do o+=et(i,l),l=i,i=i.return;while(i);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var it=Object.prototype.hasOwnProperty,rt=t.unstable_scheduleCallback,St=t.unstable_cancelCallback,_t=t.unstable_shouldYield,Gt=t.unstable_requestPaint,ct=t.unstable_now,Bt=t.unstable_getCurrentPriorityLevel,qe=t.unstable_ImmediatePriority,ot=t.unstable_UserBlockingPriority,Vt=t.unstable_NormalPriority,Pn=t.unstable_LowPriority,rn=t.unstable_IdlePriority,$t=t.log,on=t.unstable_setDisableYieldValue,Ln=null,an=null;function In(i){if(typeof $t=="function"&&on(i),an&&typeof an.setStrictMode=="function")try{an.setStrictMode(Ln,i)}catch{}}var Ct=Math.clz32?Math.clz32:Ie,_s=Math.log,ln=Math.LN2;function Ie(i){return i>>>=0,i===0?32:31-(_s(i)/ln|0)|0}var Pe=256,ht=262144,$e=4194304;function At(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function wt(i,o,l){var u=i.pendingLanes;if(u===0)return 0;var y=0,x=i.suspendedLanes,C=i.pingedLanes;i=i.warmLanes;var V=u&134217727;return V!==0?(u=V&~x,u!==0?y=At(u):(C&=V,C!==0?y=At(C):l||(l=V&~i,l!==0&&(y=At(l))))):(V=u&~x,V!==0?y=At(V):C!==0?y=At(C):l||(l=u&~i,l!==0&&(y=At(l)))),y===0?0:o!==0&&o!==y&&(o&x)===0&&(x=y&-y,l=o&-o,x>=l||x===32&&(l&4194048)!==0)?o:y}function Qe(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function we(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xe(){var i=$e;return $e<<=1,($e&62914560)===0&&($e=4194304),i}function at(i){for(var o=[],l=0;31>l;l++)o.push(i);return o}function Me(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Re(i,o,l,u,y,x){var C=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var V=i.entanglements,W=i.expirationTimes,oe=i.hiddenUpdates;for(l=C&~l;0<l;){var me=31-Ct(l),_e=1<<me;V[me]=0,W[me]=-1;var le=oe[me];if(le!==null)for(oe[me]=null,me=0;me<le.length;me++){var he=le[me];he!==null&&(he.lane&=-536870913)}l&=~_e}u!==0&&Be(i,u,0),x!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=x&~(C&~o))}function Be(i,o,l){i.pendingLanes|=o,i.suspendedLanes&=~o;var u=31-Ct(o);i.entangledLanes|=o,i.entanglements[u]=i.entanglements[u]|1073741824|l&261930}function fe(i,o){var l=i.entangledLanes|=o;for(i=i.entanglements;l;){var u=31-Ct(l),y=1<<u;y&o|i[u]&o&&(i[u]|=o),l&=~y}}function ee(i,o){var l=o&-o;return l=(l&42)!==0?1:de(l),(l&(i.suspendedLanes|o))!==0?0:l}function de(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Te(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Le(){var i=G.p;return i!==0?i:(i=window.event,i===void 0?32:O0(i.type))}function ze(i,o){var l=G.p;try{return G.p=i,o()}finally{G.p=l}}var Ke=Math.random().toString(36).slice(2),Ye="__reactFiber$"+Ke,dt="__reactProps$"+Ke,It="__reactContainer$"+Ke,jt="__reactEvents$"+Ke,Kt="__reactListeners$"+Ke,Xt="__reactHandles$"+Ke,En="__reactResources$"+Ke,un="__reactMarker$"+Ke;function xs(i){delete i[Ye],delete i[dt],delete i[jt],delete i[Kt],delete i[Xt]}function Xn(i){var o=i[Ye];if(o)return o;for(var l=i.parentNode;l;){if(o=l[It]||l[Ye]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(i=E0(i);i!==null;){if(l=i[Ye])return l;i=E0(i)}return o}i=l,l=i.parentNode}return null}function Hn(i){if(i=i[Ye]||i[It]){var o=i.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return i}return null}function Jn(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(s(33))}function fs(i){var o=i[En];return o||(o=i[En]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function dn(i){i[un]=!0}var Ns=new Set,ni={};function bs(i,o){ps(i,o),ps(i+"Capture",o)}function ps(i,o){for(ni[i]=o,i=0;i<o.length;i++)Ns.add(o[i])}var _n=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),si={},Eo={};function da(i){return it.call(Eo,i)?!0:it.call(si,i)?!1:_n.test(i)?Eo[i]=!0:(si[i]=!0,!1)}function vr(i,o,l){if(da(o))if(l===null)i.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var u=o.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+l)}}function ms(i,o,l){if(l===null)i.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+l)}}function Tn(i,o,l,u){if(u===null)i.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(o,l,""+u)}}function Rn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ii(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function js(i,o,l){var u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o);if(!i.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,x=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return y.call(this)},set:function(C){l=""+C,x.call(this,C)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(C){l=""+C},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function J(i){if(!i._valueTracker){var o=ii(i)?"checked":"value";i._valueTracker=js(i,o,""+i[o])}}function pe(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var l=o.getValue(),u="";return i&&(u=ii(i)?i.checked?"true":"false":i.value),i=u,i!==l?(o.setValue(i),!0):!1}function He(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Et=/[\n"\\]/g;function mt(i){return i.replace(Et,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Gn(i,o,l,u,y,x,C,V){i.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?i.type=C:i.removeAttribute("type"),o!=null?C==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+Rn(o)):i.value!==""+Rn(o)&&(i.value=""+Rn(o)):C!=="submit"&&C!=="reset"||i.removeAttribute("value"),o!=null?Il(i,C,Rn(o)):l!=null?Il(i,C,Rn(l)):u!=null&&i.removeAttribute("value"),y==null&&x!=null&&(i.defaultChecked=!!x),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?i.name=""+Rn(V):i.removeAttribute("name")}function os(i,o,l,u,y,x,C,V){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.type=x),o!=null||l!=null){if(!(x!=="submit"&&x!=="reset"||o!=null)){J(i);return}l=l!=null?""+Rn(l):"",o=o!=null?""+Rn(o):l,V||o===i.value||(i.value=o),i.defaultValue=o}u=u??y,u=typeof u!="function"&&typeof u!="symbol"&&!!u,i.checked=V?i.checked:!!u,i.defaultChecked=!!u,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.name=C),J(i)}function Il(i,o,l){o==="number"&&He(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function _r(i,o,l,u){if(i=i.options,o){o={};for(var y=0;y<l.length;y++)o["$"+l[y]]=!0;for(l=0;l<i.length;l++)y=o.hasOwnProperty("$"+i[l].value),i[l].selected!==y&&(i[l].selected=y),y&&u&&(i[l].defaultSelected=!0)}else{for(l=""+Rn(l),o=null,y=0;y<i.length;y++){if(i[y].value===l){i[y].selected=!0,u&&(i[y].defaultSelected=!0);return}o!==null||i[y].disabled||(o=i[y])}o!==null&&(o.selected=!0)}}function au(i,o,l){if(o!=null&&(o=""+Rn(o),o!==i.value&&(i.value=o),l==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=l!=null?""+Rn(l):""}function xr(i,o,l,u){if(o==null){if(u!=null){if(l!=null)throw Error(s(92));if(ge(u)){if(1<u.length)throw Error(s(93));u=u[0]}l=u}l==null&&(l=""),o=l}l=Rn(o),i.defaultValue=l,u=i.textContent,u===l&&u!==""&&u!==null&&(i.value=u),J(i)}function Es(i,o){if(o){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=o;return}}i.textContent=o}var lu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rl(i,o,l){var u=o.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":u?i.setProperty(o,l):typeof l!="number"||l===0||lu.has(o)?o==="float"?i.cssFloat=l:i[o]=(""+l).trim():i[o]=l+"px"}function Nl(i,o,l){if(o!=null&&typeof o!="object")throw Error(s(62));if(i=i.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||o!=null&&o.hasOwnProperty(u)||(u.indexOf("--")===0?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="");for(var y in o)u=o[y],o.hasOwnProperty(y)&&l[y]!==u&&Rl(i,y,u)}else for(var x in o)o.hasOwnProperty(x)&&Rl(i,x,o[x])}function ha(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),br=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function fa(i){return br.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ri(){}var Ml=null;function Fs(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Er=null,_i=null;function To(i){var o=Hn(i);if(o&&(i=o.stateNode)){var l=i[dt]||null;e:switch(i=o.stateNode,o.type){case"input":if(Gn(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),o=l.name,l.type==="radio"&&o!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+mt(""+o)+'"][type="radio"]'),o=0;o<l.length;o++){var u=l[o];if(u!==i&&u.form===i.form){var y=u[dt]||null;if(!y)throw Error(s(90));Gn(u,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<l.length;o++)u=l[o],u.form===i.form&&pe(u)}break e;case"textarea":au(i,l.value,l.defaultValue);break e;case"select":o=l.value,o!=null&&_r(i,!!l.multiple,o,!1)}}}var pa=!1;function Tr(i,o,l){if(pa)return i(o,l);pa=!0;try{var u=i(o);return u}finally{if(pa=!1,(Er!==null||_i!==null)&&(nd(),Er&&(o=Er,i=_i,_i=Er=null,To(o),i)))for(o=0;o<i.length;o++)To(i[o])}}function oi(i,o){var l=i.stateNode;if(l===null)return null;var u=l[dt]||null;if(u===null)return null;l=u[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(i=i.type,u=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!u;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(s(231,o,typeof l));return l}var qs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wo=!1;if(qs)try{var en={};Object.defineProperty(en,"passive",{get:function(){wo=!0}}),window.addEventListener("test",en,en),window.removeEventListener("test",en,en)}catch{wo=!1}var xi=null,kl=null,Co=null;function Dl(){if(Co)return Co;var i,o=kl,l=o.length,u,y="value"in xi?xi.value:xi.textContent,x=y.length;for(i=0;i<l&&o[i]===y[i];i++);var C=l-i;for(u=1;u<=C&&o[l-u]===y[x-u];u++);return Co=y.slice(i,1<u?1-u:void 0)}function So(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Hi(){return!0}function ai(){return!1}function Qn(i){function o(l,u,y,x,C){this._reactName=l,this._targetInst=y,this.type=u,this.nativeEvent=x,this.target=C,this.currentTarget=null;for(var V in i)i.hasOwnProperty(V)&&(l=i[V],this[V]=l?l(x):x[V]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Hi:ai,this.isPropagationStopped=ai,this}return b(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Hi)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Hi)},persist:function(){},isPersistent:Hi}),o}var Gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bi=Qn(Gi),wr=b({},Gi,{view:0,detail:0}),Pl=Qn(wr),Cr,ma,Ei,ga=b({},wr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sr,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ei&&(Ei&&i.type==="mousemove"?(Cr=i.screenX-Ei.screenX,ma=i.screenY-Ei.screenY):ma=Cr=0,Ei=i),Cr)},movementY:function(i){return"movementY"in i?i.movementY:ma}}),Ll=Qn(ga),Ao=b({},ga,{dataTransfer:0}),uu=Qn(Ao),du=b({},wr,{relatedTarget:0}),Io=Qn(du),Vl=b({},Gi,{animationName:0,elapsedTime:0,pseudoElement:0}),hu=Qn(Vl),ya=b({},Gi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),fu=Qn(ya),pu=b({},Gi,{data:0}),Ti=Qn(pu),mu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vu(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=yu[i])?!!o[i]:!1}function Sr(){return vu}var gs=b({},wr,{key:function(i){if(i.key){var o=mu[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=So(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?gu[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sr,charCode:function(i){return i.type==="keypress"?So(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?So(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),_u=Qn(gs),xu=b({},ga,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$i=Qn(xu),m=b({},wr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sr}),w=Qn(m),A=b({},Gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),B=Qn(A),se=b({},ga,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=Qn(se),ke=b({},Gi,{newState:0,oldState:0}),xt=Qn(ke),Nn=[9,13,27,32],Yt=qs&&"CompositionEvent"in window,yn=null;qs&&"documentMode"in document&&(yn=document.documentMode);var Hs=qs&&"TextEvent"in window&&!yn,wi=qs&&(!Yt||yn&&8<yn&&11>=yn),li=" ",ci=!1;function Ro(i,o){switch(i){case"keyup":return Nn.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function va(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var _a=!1;function eA(i,o){switch(i){case"compositionend":return va(o);case"keypress":return o.which!==32?null:(ci=!0,li);case"textInput":return i=o.data,i===li&&ci?null:i;default:return null}}function tA(i,o){if(_a)return i==="compositionend"||!Yt&&Ro(i,o)?(i=Dl(),Co=kl=xi=null,_a=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return wi&&o.locale!=="ko"?null:o.data;default:return null}}var nA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cy(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!nA[i.type]:o==="textarea"}function Sy(i,o,l,u){Er?_i?_i.push(u):_i=[u]:Er=u,o=cd(o,"onChange"),0<o.length&&(l=new bi("onChange","change",null,l,u),i.push({event:l,listeners:o}))}var Ul=null,Ol=null;function sA(i){l0(i,0)}function bu(i){var o=Jn(i);if(pe(o))return i}function Ay(i,o){if(i==="change")return o}var Iy=!1;if(qs){var nf;if(qs){var sf="oninput"in document;if(!sf){var Ry=document.createElement("div");Ry.setAttribute("oninput","return;"),sf=typeof Ry.oninput=="function"}nf=sf}else nf=!1;Iy=nf&&(!document.documentMode||9<document.documentMode)}function Ny(){Ul&&(Ul.detachEvent("onpropertychange",My),Ol=Ul=null)}function My(i){if(i.propertyName==="value"&&bu(Ol)){var o=[];Sy(o,Ol,i,Fs(i)),Tr(sA,o)}}function iA(i,o,l){i==="focusin"?(Ny(),Ul=o,Ol=l,Ul.attachEvent("onpropertychange",My)):i==="focusout"&&Ny()}function rA(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return bu(Ol)}function oA(i,o){if(i==="click")return bu(o)}function aA(i,o){if(i==="input"||i==="change")return bu(o)}function lA(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Ms=typeof Object.is=="function"?Object.is:lA;function Bl(i,o){if(Ms(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var l=Object.keys(i),u=Object.keys(o);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var y=l[u];if(!it.call(o,y)||!Ms(i[y],o[y]))return!1}return!0}function ky(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Dy(i,o){var l=ky(i);i=0;for(var u;l;){if(l.nodeType===3){if(u=i+l.textContent.length,i<=o&&u>=o)return{node:l,offset:o-i};i=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=ky(l)}}function Py(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Py(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Ly(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=He(i.document);o instanceof i.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)i=o.contentWindow;else break;o=He(i.document)}return o}function rf(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var cA=qs&&"documentMode"in document&&11>=document.documentMode,xa=null,of=null,zl=null,af=!1;function Vy(i,o,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;af||xa==null||xa!==He(u)||(u=xa,"selectionStart"in u&&rf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),zl&&Bl(zl,u)||(zl=u,u=cd(of,"onSelect"),0<u.length&&(o=new bi("onSelect","select",null,o,l),i.push({event:o,listeners:u}),o.target=xa)))}function No(i,o){var l={};return l[i.toLowerCase()]=o.toLowerCase(),l["Webkit"+i]="webkit"+o,l["Moz"+i]="moz"+o,l}var ba={animationend:No("Animation","AnimationEnd"),animationiteration:No("Animation","AnimationIteration"),animationstart:No("Animation","AnimationStart"),transitionrun:No("Transition","TransitionRun"),transitionstart:No("Transition","TransitionStart"),transitioncancel:No("Transition","TransitionCancel"),transitionend:No("Transition","TransitionEnd")},lf={},Uy={};qs&&(Uy=document.createElement("div").style,"AnimationEvent"in window||(delete ba.animationend.animation,delete ba.animationiteration.animation,delete ba.animationstart.animation),"TransitionEvent"in window||delete ba.transitionend.transition);function Mo(i){if(lf[i])return lf[i];if(!ba[i])return i;var o=ba[i],l;for(l in o)if(o.hasOwnProperty(l)&&l in Uy)return lf[i]=o[l];return i}var Oy=Mo("animationend"),By=Mo("animationiteration"),zy=Mo("animationstart"),uA=Mo("transitionrun"),dA=Mo("transitionstart"),hA=Mo("transitioncancel"),jy=Mo("transitionend"),Fy=new Map,cf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cf.push("scrollEnd");function ui(i,o){Fy.set(i,o),bs(o,[i])}var Eu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Gs=[],Ea=0,uf=0;function Tu(){for(var i=Ea,o=uf=Ea=0;o<i;){var l=Gs[o];Gs[o++]=null;var u=Gs[o];Gs[o++]=null;var y=Gs[o];Gs[o++]=null;var x=Gs[o];if(Gs[o++]=null,u!==null&&y!==null){var C=u.pending;C===null?y.next=y:(y.next=C.next,C.next=y),u.pending=y}x!==0&&qy(l,y,x)}}function wu(i,o,l,u){Gs[Ea++]=i,Gs[Ea++]=o,Gs[Ea++]=l,Gs[Ea++]=u,uf|=u,i.lanes|=u,i=i.alternate,i!==null&&(i.lanes|=u)}function df(i,o,l,u){return wu(i,o,l,u),Cu(i)}function ko(i,o){return wu(i,null,null,o),Cu(i)}function qy(i,o,l){i.lanes|=l;var u=i.alternate;u!==null&&(u.lanes|=l);for(var y=!1,x=i.return;x!==null;)x.childLanes|=l,u=x.alternate,u!==null&&(u.childLanes|=l),x.tag===22&&(i=x.stateNode,i===null||i._visibility&1||(y=!0)),i=x,x=x.return;return i.tag===3?(x=i.stateNode,y&&o!==null&&(y=31-Ct(l),i=x.hiddenUpdates,u=i[y],u===null?i[y]=[o]:u.push(o),o.lane=l|536870912),x):null}function Cu(i){if(50<lc)throw lc=0,xp=null,Error(s(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var Ta={};function fA(i,o,l,u){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ks(i,o,l,u){return new fA(i,o,l,u)}function hf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Yi(i,o){var l=i.alternate;return l===null?(l=ks(i.tag,o,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=o,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,o=i.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function Hy(i,o){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,o=l.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Su(i,o,l,u,y,x){var C=0;if(u=i,typeof i=="function")hf(i)&&(C=1);else if(typeof i=="string")C=v1(i,l,ie.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case N:return i=ks(31,l,o,y),i.elementType=N,i.lanes=x,i;case U:return Do(l.children,y,x,o);case F:C=8,y|=24;break;case z:return i=ks(12,l,o,y|2),i.elementType=z,i.lanes=x,i;case Y:return i=ks(13,l,o,y),i.elementType=Y,i.lanes=x,i;case K:return i=ks(19,l,o,y),i.elementType=K,i.lanes=x,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case j:C=10;break e;case q:C=9;break e;case H:C=11;break e;case R:C=14;break e;case T:C=16,u=null;break e}C=29,l=Error(s(130,i===null?"null":typeof i,"")),u=null}return o=ks(C,l,o,y),o.elementType=i,o.type=u,o.lanes=x,o}function Do(i,o,l,u){return i=ks(7,i,u,o),i.lanes=l,i}function ff(i,o,l){return i=ks(6,i,null,o),i.lanes=l,i}function Gy(i){var o=ks(18,null,null,0);return o.stateNode=i,o}function pf(i,o,l){return o=ks(4,i.children!==null?i.children:[],i.key,o),o.lanes=l,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var $y=new WeakMap;function $s(i,o){if(typeof i=="object"&&i!==null){var l=$y.get(i);return l!==void 0?l:(o={value:i,source:o,stack:We(o)},$y.set(i,o),o)}return{value:i,source:o,stack:We(o)}}var wa=[],Ca=0,Au=null,jl=0,Ys=[],Js=0,Ar=null,Ci=1,Si="";function Ji(i,o){wa[Ca++]=jl,wa[Ca++]=Au,Au=i,jl=o}function Yy(i,o,l){Ys[Js++]=Ci,Ys[Js++]=Si,Ys[Js++]=Ar,Ar=i;var u=Ci;i=Si;var y=32-Ct(u)-1;u&=~(1<<y),l+=1;var x=32-Ct(o)+y;if(30<x){var C=y-y%5;x=(u&(1<<C)-1).toString(32),u>>=C,y-=C,Ci=1<<32-Ct(o)+y|l<<y|u,Si=x+i}else Ci=1<<x|l<<y|u,Si=i}function mf(i){i.return!==null&&(Ji(i,1),Yy(i,1,0))}function gf(i){for(;i===Au;)Au=wa[--Ca],wa[Ca]=null,jl=wa[--Ca],wa[Ca]=null;for(;i===Ar;)Ar=Ys[--Js],Ys[Js]=null,Si=Ys[--Js],Ys[Js]=null,Ci=Ys[--Js],Ys[Js]=null}function Jy(i,o){Ys[Js++]=Ci,Ys[Js++]=Si,Ys[Js++]=Ar,Ci=o.id,Si=o.overflow,Ar=i}var Zn=null,fn=null,Ut=!1,Ir=null,Ks=!1,yf=Error(s(519));function Rr(i){var o=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fl($s(o,i)),yf}function Ky(i){var o=i.stateNode,l=i.type,u=i.memoizedProps;switch(o[Ye]=i,o[dt]=u,l){case"dialog":Nt("cancel",o),Nt("close",o);break;case"iframe":case"object":case"embed":Nt("load",o);break;case"video":case"audio":for(l=0;l<uc.length;l++)Nt(uc[l],o);break;case"source":Nt("error",o);break;case"img":case"image":case"link":Nt("error",o),Nt("load",o);break;case"details":Nt("toggle",o);break;case"input":Nt("invalid",o),os(o,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Nt("invalid",o);break;case"textarea":Nt("invalid",o),xr(o,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||o.textContent===""+l||u.suppressHydrationWarning===!0||h0(o.textContent,l)?(u.popover!=null&&(Nt("beforetoggle",o),Nt("toggle",o)),u.onScroll!=null&&Nt("scroll",o),u.onScrollEnd!=null&&Nt("scrollend",o),u.onClick!=null&&(o.onclick=ri),o=!0):o=!1,o||Rr(i,!0)}function Wy(i){for(Zn=i.return;Zn;)switch(Zn.tag){case 5:case 31:case 13:Ks=!1;return;case 27:case 3:Ks=!0;return;default:Zn=Zn.return}}function Sa(i){if(i!==Zn)return!1;if(!Ut)return Wy(i),Ut=!0,!1;var o=i.tag,l;if((l=o!==3&&o!==27)&&((l=o===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||Lp(i.type,i.memoizedProps)),l=!l),l&&fn&&Rr(i),Wy(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));fn=b0(i)}else if(o===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));fn=b0(i)}else o===27?(o=fn,qr(i.type)?(i=zp,zp=null,fn=i):fn=o):fn=Zn?Xs(i.stateNode.nextSibling):null;return!0}function Po(){fn=Zn=null,Ut=!1}function vf(){var i=Ir;return i!==null&&(Ss===null?Ss=i:Ss.push.apply(Ss,i),Ir=null),i}function Fl(i){Ir===null?Ir=[i]:Ir.push(i)}var _f=O(null),Lo=null,Ki=null;function Nr(i,o,l){te(_f,o._currentValue),o._currentValue=l}function Wi(i){i._currentValue=_f.current,Q(_f)}function xf(i,o,l){for(;i!==null;){var u=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,u!==null&&(u.childLanes|=o)):u!==null&&(u.childLanes&o)!==o&&(u.childLanes|=o),i===l)break;i=i.return}}function bf(i,o,l,u){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var x=y.dependencies;if(x!==null){var C=y.child;x=x.firstContext;e:for(;x!==null;){var V=x;x=y;for(var W=0;W<o.length;W++)if(V.context===o[W]){x.lanes|=l,V=x.alternate,V!==null&&(V.lanes|=l),xf(x.return,l,i),u||(C=null);break e}x=V.next}}else if(y.tag===18){if(C=y.return,C===null)throw Error(s(341));C.lanes|=l,x=C.alternate,x!==null&&(x.lanes|=l),xf(C,l,i),C=null}else C=y.child;if(C!==null)C.return=y;else for(C=y;C!==null;){if(C===i){C=null;break}if(y=C.sibling,y!==null){y.return=C.return,C=y;break}C=C.return}y=C}}function Aa(i,o,l,u){i=null;for(var y=o,x=!1;y!==null;){if(!x){if((y.flags&524288)!==0)x=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var C=y.alternate;if(C===null)throw Error(s(387));if(C=C.memoizedProps,C!==null){var V=y.type;Ms(y.pendingProps.value,C.value)||(i!==null?i.push(V):i=[V])}}else if(y===Fe.current){if(C=y.alternate,C===null)throw Error(s(387));C.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(mc):i=[mc])}y=y.return}i!==null&&bf(o,i,l,u),o.flags|=262144}function Iu(i){for(i=i.firstContext;i!==null;){if(!Ms(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Vo(i){Lo=i,Ki=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function es(i){return Xy(Lo,i)}function Ru(i,o){return Lo===null&&Vo(i),Xy(i,o)}function Xy(i,o){var l=o._currentValue;if(o={context:o,memoizedValue:l,next:null},Ki===null){if(i===null)throw Error(s(308));Ki=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else Ki=Ki.next=o;return l}var pA=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(l,u){i.push(u)}};this.abort=function(){o.aborted=!0,i.forEach(function(l){return l()})}},mA=t.unstable_scheduleCallback,gA=t.unstable_NormalPriority,Vn={$$typeof:j,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ef(){return{controller:new pA,data:new Map,refCount:0}}function ql(i){i.refCount--,i.refCount===0&&mA(gA,function(){i.controller.abort()})}var Hl=null,Tf=0,Ia=0,Ra=null;function yA(i,o){if(Hl===null){var l=Hl=[];Tf=0,Ia=Sp(),Ra={status:"pending",value:void 0,then:function(u){l.push(u)}}}return Tf++,o.then(Qy,Qy),o}function Qy(){if(--Tf===0&&Hl!==null){Ra!==null&&(Ra.status="fulfilled");var i=Hl;Hl=null,Ia=0,Ra=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function vA(i,o){var l=[],u={status:"pending",value:null,reason:null,then:function(y){l.push(y)}};return i.then(function(){u.status="fulfilled",u.value=o;for(var y=0;y<l.length;y++)(0,l[y])(o)},function(y){for(u.status="rejected",u.reason=y,y=0;y<l.length;y++)(0,l[y])(void 0)}),u}var Zy=$.S;$.S=function(i,o){V_=ct(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&yA(i,o),Zy!==null&&Zy(i,o)};var Uo=O(null);function wf(){var i=Uo.current;return i!==null?i:cn.pooledCache}function Nu(i,o){o===null?te(Uo,Uo.current):te(Uo,o.pool)}function ev(){var i=wf();return i===null?null:{parent:Vn._currentValue,pool:i}}var Na=Error(s(460)),Cf=Error(s(474)),Mu=Error(s(542)),ku={then:function(){}};function tv(i){return i=i.status,i==="fulfilled"||i==="rejected"}function nv(i,o,l){switch(l=i[l],l===void 0?i.push(o):l!==o&&(o.then(ri,ri),o=l),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,iv(i),i;default:if(typeof o.status=="string")o.then(ri,ri);else{if(i=cn,i!==null&&100<i.shellSuspendCounter)throw Error(s(482));i=o,i.status="pending",i.then(function(u){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=u}},function(u){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=u}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,iv(i),i}throw Bo=o,Na}}function Oo(i){try{var o=i._init;return o(i._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Bo=l,Na):l}}var Bo=null;function sv(){if(Bo===null)throw Error(s(459));var i=Bo;return Bo=null,i}function iv(i){if(i===Na||i===Mu)throw Error(s(483))}var Ma=null,Gl=0;function Du(i){var o=Gl;return Gl+=1,Ma===null&&(Ma=[]),nv(Ma,i,o)}function $l(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Pu(i,o){throw o.$$typeof===E?Error(s(525)):(i=Object.prototype.toString.call(o),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function rv(i){function o(ne,Z){if(i){var re=ne.deletions;re===null?(ne.deletions=[Z],ne.flags|=16):re.push(Z)}}function l(ne,Z){if(!i)return null;for(;Z!==null;)o(ne,Z),Z=Z.sibling;return null}function u(ne){for(var Z=new Map;ne!==null;)ne.key!==null?Z.set(ne.key,ne):Z.set(ne.index,ne),ne=ne.sibling;return Z}function y(ne,Z){return ne=Yi(ne,Z),ne.index=0,ne.sibling=null,ne}function x(ne,Z,re){return ne.index=re,i?(re=ne.alternate,re!==null?(re=re.index,re<Z?(ne.flags|=67108866,Z):re):(ne.flags|=67108866,Z)):(ne.flags|=1048576,Z)}function C(ne){return i&&ne.alternate===null&&(ne.flags|=67108866),ne}function V(ne,Z,re,ye){return Z===null||Z.tag!==6?(Z=ff(re,ne.mode,ye),Z.return=ne,Z):(Z=y(Z,re),Z.return=ne,Z)}function W(ne,Z,re,ye){var nt=re.type;return nt===U?me(ne,Z,re.props.children,ye,re.key):Z!==null&&(Z.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===T&&Oo(nt)===Z.type)?(Z=y(Z,re.props),$l(Z,re),Z.return=ne,Z):(Z=Su(re.type,re.key,re.props,null,ne.mode,ye),$l(Z,re),Z.return=ne,Z)}function oe(ne,Z,re,ye){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==re.containerInfo||Z.stateNode.implementation!==re.implementation?(Z=pf(re,ne.mode,ye),Z.return=ne,Z):(Z=y(Z,re.children||[]),Z.return=ne,Z)}function me(ne,Z,re,ye,nt){return Z===null||Z.tag!==7?(Z=Do(re,ne.mode,ye,nt),Z.return=ne,Z):(Z=y(Z,re),Z.return=ne,Z)}function _e(ne,Z,re){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Z=ff(""+Z,ne.mode,re),Z.return=ne,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case S:return re=Su(Z.type,Z.key,Z.props,null,ne.mode,re),$l(re,Z),re.return=ne,re;case L:return Z=pf(Z,ne.mode,re),Z.return=ne,Z;case T:return Z=Oo(Z),_e(ne,Z,re)}if(ge(Z)||k(Z))return Z=Do(Z,ne.mode,re,null),Z.return=ne,Z;if(typeof Z.then=="function")return _e(ne,Du(Z),re);if(Z.$$typeof===j)return _e(ne,Ru(ne,Z),re);Pu(ne,Z)}return null}function le(ne,Z,re,ye){var nt=Z!==null?Z.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return nt!==null?null:V(ne,Z,""+re,ye);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case S:return re.key===nt?W(ne,Z,re,ye):null;case L:return re.key===nt?oe(ne,Z,re,ye):null;case T:return re=Oo(re),le(ne,Z,re,ye)}if(ge(re)||k(re))return nt!==null?null:me(ne,Z,re,ye,null);if(typeof re.then=="function")return le(ne,Z,Du(re),ye);if(re.$$typeof===j)return le(ne,Z,Ru(ne,re),ye);Pu(ne,re)}return null}function he(ne,Z,re,ye,nt){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ne=ne.get(re)||null,V(Z,ne,""+ye,nt);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case S:return ne=ne.get(ye.key===null?re:ye.key)||null,W(Z,ne,ye,nt);case L:return ne=ne.get(ye.key===null?re:ye.key)||null,oe(Z,ne,ye,nt);case T:return ye=Oo(ye),he(ne,Z,re,ye,nt)}if(ge(ye)||k(ye))return ne=ne.get(re)||null,me(Z,ne,ye,nt,null);if(typeof ye.then=="function")return he(ne,Z,re,Du(ye),nt);if(ye.$$typeof===j)return he(ne,Z,re,Ru(Z,ye),nt);Pu(Z,ye)}return null}function Ge(ne,Z,re,ye){for(var nt=null,Ft=null,Ze=Z,Tt=Z=0,kt=null;Ze!==null&&Tt<re.length;Tt++){Ze.index>Tt?(kt=Ze,Ze=null):kt=Ze.sibling;var qt=le(ne,Ze,re[Tt],ye);if(qt===null){Ze===null&&(Ze=kt);break}i&&Ze&&qt.alternate===null&&o(ne,Ze),Z=x(qt,Z,Tt),Ft===null?nt=qt:Ft.sibling=qt,Ft=qt,Ze=kt}if(Tt===re.length)return l(ne,Ze),Ut&&Ji(ne,Tt),nt;if(Ze===null){for(;Tt<re.length;Tt++)Ze=_e(ne,re[Tt],ye),Ze!==null&&(Z=x(Ze,Z,Tt),Ft===null?nt=Ze:Ft.sibling=Ze,Ft=Ze);return Ut&&Ji(ne,Tt),nt}for(Ze=u(Ze);Tt<re.length;Tt++)kt=he(Ze,ne,Tt,re[Tt],ye),kt!==null&&(i&&kt.alternate!==null&&Ze.delete(kt.key===null?Tt:kt.key),Z=x(kt,Z,Tt),Ft===null?nt=kt:Ft.sibling=kt,Ft=kt);return i&&Ze.forEach(function(Jr){return o(ne,Jr)}),Ut&&Ji(ne,Tt),nt}function lt(ne,Z,re,ye){if(re==null)throw Error(s(151));for(var nt=null,Ft=null,Ze=Z,Tt=Z=0,kt=null,qt=re.next();Ze!==null&&!qt.done;Tt++,qt=re.next()){Ze.index>Tt?(kt=Ze,Ze=null):kt=Ze.sibling;var Jr=le(ne,Ze,qt.value,ye);if(Jr===null){Ze===null&&(Ze=kt);break}i&&Ze&&Jr.alternate===null&&o(ne,Ze),Z=x(Jr,Z,Tt),Ft===null?nt=Jr:Ft.sibling=Jr,Ft=Jr,Ze=kt}if(qt.done)return l(ne,Ze),Ut&&Ji(ne,Tt),nt;if(Ze===null){for(;!qt.done;Tt++,qt=re.next())qt=_e(ne,qt.value,ye),qt!==null&&(Z=x(qt,Z,Tt),Ft===null?nt=qt:Ft.sibling=qt,Ft=qt);return Ut&&Ji(ne,Tt),nt}for(Ze=u(Ze);!qt.done;Tt++,qt=re.next())qt=he(Ze,ne,Tt,qt.value,ye),qt!==null&&(i&&qt.alternate!==null&&Ze.delete(qt.key===null?Tt:qt.key),Z=x(qt,Z,Tt),Ft===null?nt=qt:Ft.sibling=qt,Ft=qt);return i&&Ze.forEach(function(R1){return o(ne,R1)}),Ut&&Ji(ne,Tt),nt}function sn(ne,Z,re,ye){if(typeof re=="object"&&re!==null&&re.type===U&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case S:e:{for(var nt=re.key;Z!==null;){if(Z.key===nt){if(nt=re.type,nt===U){if(Z.tag===7){l(ne,Z.sibling),ye=y(Z,re.props.children),ye.return=ne,ne=ye;break e}}else if(Z.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===T&&Oo(nt)===Z.type){l(ne,Z.sibling),ye=y(Z,re.props),$l(ye,re),ye.return=ne,ne=ye;break e}l(ne,Z);break}else o(ne,Z);Z=Z.sibling}re.type===U?(ye=Do(re.props.children,ne.mode,ye,re.key),ye.return=ne,ne=ye):(ye=Su(re.type,re.key,re.props,null,ne.mode,ye),$l(ye,re),ye.return=ne,ne=ye)}return C(ne);case L:e:{for(nt=re.key;Z!==null;){if(Z.key===nt)if(Z.tag===4&&Z.stateNode.containerInfo===re.containerInfo&&Z.stateNode.implementation===re.implementation){l(ne,Z.sibling),ye=y(Z,re.children||[]),ye.return=ne,ne=ye;break e}else{l(ne,Z);break}else o(ne,Z);Z=Z.sibling}ye=pf(re,ne.mode,ye),ye.return=ne,ne=ye}return C(ne);case T:return re=Oo(re),sn(ne,Z,re,ye)}if(ge(re))return Ge(ne,Z,re,ye);if(k(re)){if(nt=k(re),typeof nt!="function")throw Error(s(150));return re=nt.call(re),lt(ne,Z,re,ye)}if(typeof re.then=="function")return sn(ne,Z,Du(re),ye);if(re.$$typeof===j)return sn(ne,Z,Ru(ne,re),ye);Pu(ne,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,Z!==null&&Z.tag===6?(l(ne,Z.sibling),ye=y(Z,re),ye.return=ne,ne=ye):(l(ne,Z),ye=ff(re,ne.mode,ye),ye.return=ne,ne=ye),C(ne)):l(ne,Z)}return function(ne,Z,re,ye){try{Gl=0;var nt=sn(ne,Z,re,ye);return Ma=null,nt}catch(Ze){if(Ze===Na||Ze===Mu)throw Ze;var Ft=ks(29,Ze,null,ne.mode);return Ft.lanes=ye,Ft.return=ne,Ft}finally{}}}var zo=rv(!0),ov=rv(!1),Mr=!1;function Sf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Af(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function kr(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Dr(i,o,l){var u=i.updateQueue;if(u===null)return null;if(u=u.shared,(Jt&2)!==0){var y=u.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),u.pending=o,o=Cu(i),qy(i,null,l),o}return wu(i,u,o,l),Cu(i)}function Yl(i,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194048)!==0)){var u=o.lanes;u&=i.pendingLanes,l|=u,o.lanes=l,fe(i,l)}}function If(i,o){var l=i.updateQueue,u=i.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var y=null,x=null;if(l=l.firstBaseUpdate,l!==null){do{var C={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};x===null?y=x=C:x=x.next=C,l=l.next}while(l!==null);x===null?y=x=o:x=x.next=o}else y=x=o;l={baseState:u.baseState,firstBaseUpdate:y,lastBaseUpdate:x,shared:u.shared,callbacks:u.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=o:i.next=o,l.lastBaseUpdate=o}var Rf=!1;function Jl(){if(Rf){var i=Ra;if(i!==null)throw i}}function Kl(i,o,l,u){Rf=!1;var y=i.updateQueue;Mr=!1;var x=y.firstBaseUpdate,C=y.lastBaseUpdate,V=y.shared.pending;if(V!==null){y.shared.pending=null;var W=V,oe=W.next;W.next=null,C===null?x=oe:C.next=oe,C=W;var me=i.alternate;me!==null&&(me=me.updateQueue,V=me.lastBaseUpdate,V!==C&&(V===null?me.firstBaseUpdate=oe:V.next=oe,me.lastBaseUpdate=W))}if(x!==null){var _e=y.baseState;C=0,me=oe=W=null,V=x;do{var le=V.lane&-536870913,he=le!==V.lane;if(he?(Mt&le)===le:(u&le)===le){le!==0&&le===Ia&&(Rf=!0),me!==null&&(me=me.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var Ge=i,lt=V;le=o;var sn=l;switch(lt.tag){case 1:if(Ge=lt.payload,typeof Ge=="function"){_e=Ge.call(sn,_e,le);break e}_e=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=lt.payload,le=typeof Ge=="function"?Ge.call(sn,_e,le):Ge,le==null)break e;_e=b({},_e,le);break e;case 2:Mr=!0}}le=V.callback,le!==null&&(i.flags|=64,he&&(i.flags|=8192),he=y.callbacks,he===null?y.callbacks=[le]:he.push(le))}else he={lane:le,tag:V.tag,payload:V.payload,callback:V.callback,next:null},me===null?(oe=me=he,W=_e):me=me.next=he,C|=le;if(V=V.next,V===null){if(V=y.shared.pending,V===null)break;he=V,V=he.next,he.next=null,y.lastBaseUpdate=he,y.shared.pending=null}}while(!0);me===null&&(W=_e),y.baseState=W,y.firstBaseUpdate=oe,y.lastBaseUpdate=me,x===null&&(y.shared.lanes=0),Or|=C,i.lanes=C,i.memoizedState=_e}}function av(i,o){if(typeof i!="function")throw Error(s(191,i));i.call(o)}function lv(i,o){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)av(l[i],o)}var ka=O(null),Lu=O(0);function cv(i,o){i=rr,te(Lu,i),te(ka,o),rr=i|o.baseLanes}function Nf(){te(Lu,rr),te(ka,ka.current)}function Mf(){rr=Lu.current,Q(ka),Q(Lu)}var Ds=O(null),Ws=null;function Pr(i){var o=i.alternate;te(Mn,Mn.current&1),te(Ds,i),Ws===null&&(o===null||ka.current!==null||o.memoizedState!==null)&&(Ws=i)}function kf(i){te(Mn,Mn.current),te(Ds,i),Ws===null&&(Ws=i)}function uv(i){i.tag===22?(te(Mn,Mn.current),te(Ds,i),Ws===null&&(Ws=i)):Lr()}function Lr(){te(Mn,Mn.current),te(Ds,Ds.current)}function Ps(i){Q(Ds),Ws===i&&(Ws=null),Q(Mn)}var Mn=O(0);function Vu(i){for(var o=i;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Op(l)||Bp(l)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Xi=0,bt=null,tn=null,Un=null,Uu=!1,Da=!1,jo=!1,Ou=0,Wl=0,Pa=null,_A=0;function wn(){throw Error(s(321))}function Df(i,o){if(o===null)return!1;for(var l=0;l<o.length&&l<i.length;l++)if(!Ms(i[l],o[l]))return!1;return!0}function Pf(i,o,l,u,y,x){return Xi=x,bt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,$.H=i===null||i.memoizedState===null?Yv:Kf,jo=!1,x=l(u,y),jo=!1,Da&&(x=hv(o,l,u,y)),dv(i),x}function dv(i){$.H=Zl;var o=tn!==null&&tn.next!==null;if(Xi=0,Un=tn=bt=null,Uu=!1,Wl=0,Pa=null,o)throw Error(s(300));i===null||On||(i=i.dependencies,i!==null&&Iu(i)&&(On=!0))}function hv(i,o,l,u){bt=i;var y=0;do{if(Da&&(Pa=null),Wl=0,Da=!1,25<=y)throw Error(s(301));if(y+=1,Un=tn=null,i.updateQueue!=null){var x=i.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}$.H=Jv,x=o(l,u)}while(Da);return x}function xA(){var i=$.H,o=i.useState()[0];return o=typeof o.then=="function"?Xl(o):o,i=i.useState()[0],(tn!==null?tn.memoizedState:null)!==i&&(bt.flags|=1024),o}function Lf(){var i=Ou!==0;return Ou=0,i}function Vf(i,o,l){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~l}function Uf(i){if(Uu){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Uu=!1}Xi=0,Un=tn=bt=null,Da=!1,Wl=Ou=0,Pa=null}function ys(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?bt.memoizedState=Un=i:Un=Un.next=i,Un}function kn(){if(tn===null){var i=bt.alternate;i=i!==null?i.memoizedState:null}else i=tn.next;var o=Un===null?bt.memoizedState:Un.next;if(o!==null)Un=o,tn=i;else{if(i===null)throw bt.alternate===null?Error(s(467)):Error(s(310));tn=i,i={memoizedState:tn.memoizedState,baseState:tn.baseState,baseQueue:tn.baseQueue,queue:tn.queue,next:null},Un===null?bt.memoizedState=Un=i:Un=Un.next=i}return Un}function Bu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xl(i){var o=Wl;return Wl+=1,Pa===null&&(Pa=[]),i=nv(Pa,i,o),o=bt,(Un===null?o.memoizedState:Un.next)===null&&(o=o.alternate,$.H=o===null||o.memoizedState===null?Yv:Kf),i}function zu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Xl(i);if(i.$$typeof===j)return es(i)}throw Error(s(438,String(i)))}function Of(i){var o=null,l=bt.updateQueue;if(l!==null&&(o=l.memoCache),o==null){var u=bt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(o={data:u.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),l===null&&(l=Bu(),bt.updateQueue=l),l.memoCache=o,l=o.data[o.index],l===void 0)for(l=o.data[o.index]=Array(i),u=0;u<i;u++)l[u]=I;return o.index++,l}function Qi(i,o){return typeof o=="function"?o(i):o}function ju(i){var o=kn();return Bf(o,tn,i)}function Bf(i,o,l){var u=i.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=l;var y=i.baseQueue,x=u.pending;if(x!==null){if(y!==null){var C=y.next;y.next=x.next,x.next=C}o.baseQueue=y=x,u.pending=null}if(x=i.baseState,y===null)i.memoizedState=x;else{o=y.next;var V=C=null,W=null,oe=o,me=!1;do{var _e=oe.lane&-536870913;if(_e!==oe.lane?(Mt&_e)===_e:(Xi&_e)===_e){var le=oe.revertLane;if(le===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),_e===Ia&&(me=!0);else if((Xi&le)===le){oe=oe.next,le===Ia&&(me=!0);continue}else _e={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},W===null?(V=W=_e,C=x):W=W.next=_e,bt.lanes|=le,Or|=le;_e=oe.action,jo&&l(x,_e),x=oe.hasEagerState?oe.eagerState:l(x,_e)}else le={lane:_e,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},W===null?(V=W=le,C=x):W=W.next=le,bt.lanes|=_e,Or|=_e;oe=oe.next}while(oe!==null&&oe!==o);if(W===null?C=x:W.next=V,!Ms(x,i.memoizedState)&&(On=!0,me&&(l=Ra,l!==null)))throw l;i.memoizedState=x,i.baseState=C,i.baseQueue=W,u.lastRenderedState=x}return y===null&&(u.lanes=0),[i.memoizedState,u.dispatch]}function zf(i){var o=kn(),l=o.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=i;var u=l.dispatch,y=l.pending,x=o.memoizedState;if(y!==null){l.pending=null;var C=y=y.next;do x=i(x,C.action),C=C.next;while(C!==y);Ms(x,o.memoizedState)||(On=!0),o.memoizedState=x,o.baseQueue===null&&(o.baseState=x),l.lastRenderedState=x}return[x,u]}function fv(i,o,l){var u=bt,y=kn(),x=Ut;if(x){if(l===void 0)throw Error(s(407));l=l()}else l=o();var C=!Ms((tn||y).memoizedState,l);if(C&&(y.memoizedState=l,On=!0),y=y.queue,qf(gv.bind(null,u,y,i),[i]),y.getSnapshot!==o||C||Un!==null&&Un.memoizedState.tag&1){if(u.flags|=2048,La(9,{destroy:void 0},mv.bind(null,u,y,l,o),null),cn===null)throw Error(s(349));x||(Xi&127)!==0||pv(u,o,l)}return l}function pv(i,o,l){i.flags|=16384,i={getSnapshot:o,value:l},o=bt.updateQueue,o===null?(o=Bu(),bt.updateQueue=o,o.stores=[i]):(l=o.stores,l===null?o.stores=[i]:l.push(i))}function mv(i,o,l,u){o.value=l,o.getSnapshot=u,yv(o)&&vv(i)}function gv(i,o,l){return l(function(){yv(o)&&vv(i)})}function yv(i){var o=i.getSnapshot;i=i.value;try{var l=o();return!Ms(i,l)}catch{return!0}}function vv(i){var o=ko(i,2);o!==null&&As(o,i,2)}function jf(i){var o=ys();if(typeof i=="function"){var l=i;if(i=l(),jo){In(!0);try{l()}finally{In(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:i},o}function _v(i,o,l,u){return i.baseState=l,Bf(i,tn,typeof u=="function"?u:Qi)}function bA(i,o,l,u,y){if(Hu(i))throw Error(s(485));if(i=o.action,i!==null){var x={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){x.listeners.push(C)}};$.T!==null?l(!0):x.isTransition=!1,u(x),l=o.pending,l===null?(x.next=o.pending=x,xv(o,x)):(x.next=l.next,o.pending=l.next=x)}}function xv(i,o){var l=o.action,u=o.payload,y=i.state;if(o.isTransition){var x=$.T,C={};$.T=C;try{var V=l(y,u),W=$.S;W!==null&&W(C,V),bv(i,o,V)}catch(oe){Ff(i,o,oe)}finally{x!==null&&C.types!==null&&(x.types=C.types),$.T=x}}else try{x=l(y,u),bv(i,o,x)}catch(oe){Ff(i,o,oe)}}function bv(i,o,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Ev(i,o,u)},function(u){return Ff(i,o,u)}):Ev(i,o,l)}function Ev(i,o,l){o.status="fulfilled",o.value=l,Tv(o),i.state=l,o=i.pending,o!==null&&(l=o.next,l===o?i.pending=null:(l=l.next,o.next=l,xv(i,l)))}function Ff(i,o,l){var u=i.pending;if(i.pending=null,u!==null){u=u.next;do o.status="rejected",o.reason=l,Tv(o),o=o.next;while(o!==u)}i.action=null}function Tv(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function wv(i,o){return o}function Cv(i,o){if(Ut){var l=cn.formState;if(l!==null){e:{var u=bt;if(Ut){if(fn){t:{for(var y=fn,x=Ks;y.nodeType!==8;){if(!x){y=null;break t}if(y=Xs(y.nextSibling),y===null){y=null;break t}}x=y.data,y=x==="F!"||x==="F"?y:null}if(y){fn=Xs(y.nextSibling),u=y.data==="F!";break e}}Rr(u)}u=!1}u&&(o=l[0])}}return l=ys(),l.memoizedState=l.baseState=o,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wv,lastRenderedState:o},l.queue=u,l=Hv.bind(null,bt,u),u.dispatch=l,u=jf(!1),x=Jf.bind(null,bt,!1,u.queue),u=ys(),y={state:o,dispatch:null,action:i,pending:null},u.queue=y,l=bA.bind(null,bt,y,x,l),y.dispatch=l,u.memoizedState=i,[o,l,!1]}function Sv(i){var o=kn();return Av(o,tn,i)}function Av(i,o,l){if(o=Bf(i,o,wv)[0],i=ju(Qi)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var u=Xl(o)}catch(C){throw C===Na?Mu:C}else u=o;o=kn();var y=o.queue,x=y.dispatch;return l!==o.memoizedState&&(bt.flags|=2048,La(9,{destroy:void 0},EA.bind(null,y,l),null)),[u,x,i]}function EA(i,o){i.action=o}function Iv(i){var o=kn(),l=tn;if(l!==null)return Av(o,l,i);kn(),o=o.memoizedState,l=kn();var u=l.queue.dispatch;return l.memoizedState=i,[o,u,!1]}function La(i,o,l,u){return i={tag:i,create:l,deps:u,inst:o,next:null},o=bt.updateQueue,o===null&&(o=Bu(),bt.updateQueue=o),l=o.lastEffect,l===null?o.lastEffect=i.next=i:(u=l.next,l.next=i,i.next=u,o.lastEffect=i),i}function Rv(){return kn().memoizedState}function Fu(i,o,l,u){var y=ys();bt.flags|=i,y.memoizedState=La(1|o,{destroy:void 0},l,u===void 0?null:u)}function qu(i,o,l,u){var y=kn();u=u===void 0?null:u;var x=y.memoizedState.inst;tn!==null&&u!==null&&Df(u,tn.memoizedState.deps)?y.memoizedState=La(o,x,l,u):(bt.flags|=i,y.memoizedState=La(1|o,x,l,u))}function Nv(i,o){Fu(8390656,8,i,o)}function qf(i,o){qu(2048,8,i,o)}function TA(i){bt.flags|=4;var o=bt.updateQueue;if(o===null)o=Bu(),bt.updateQueue=o,o.events=[i];else{var l=o.events;l===null?o.events=[i]:l.push(i)}}function Mv(i){var o=kn().memoizedState;return TA({ref:o,nextImpl:i}),function(){if((Jt&2)!==0)throw Error(s(440));return o.impl.apply(void 0,arguments)}}function kv(i,o){return qu(4,2,i,o)}function Dv(i,o){return qu(4,4,i,o)}function Pv(i,o){if(typeof o=="function"){i=i();var l=o(i);return function(){typeof l=="function"?l():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Lv(i,o,l){l=l!=null?l.concat([i]):null,qu(4,4,Pv.bind(null,o,i),l)}function Hf(){}function Vv(i,o){var l=kn();o=o===void 0?null:o;var u=l.memoizedState;return o!==null&&Df(o,u[1])?u[0]:(l.memoizedState=[i,o],i)}function Uv(i,o){var l=kn();o=o===void 0?null:o;var u=l.memoizedState;if(o!==null&&Df(o,u[1]))return u[0];if(u=i(),jo){In(!0);try{i()}finally{In(!1)}}return l.memoizedState=[u,o],u}function Gf(i,o,l){return l===void 0||(Xi&1073741824)!==0&&(Mt&261930)===0?i.memoizedState=o:(i.memoizedState=l,i=O_(),bt.lanes|=i,Or|=i,l)}function Ov(i,o,l,u){return Ms(l,o)?l:ka.current!==null?(i=Gf(i,l,u),Ms(i,o)||(On=!0),i):(Xi&42)===0||(Xi&1073741824)!==0&&(Mt&261930)===0?(On=!0,i.memoizedState=l):(i=O_(),bt.lanes|=i,Or|=i,o)}function Bv(i,o,l,u,y){var x=G.p;G.p=x!==0&&8>x?x:8;var C=$.T,V={};$.T=V,Jf(i,!1,o,l);try{var W=y(),oe=$.S;if(oe!==null&&oe(V,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var me=vA(W,u);Ql(i,o,me,Us(i))}else Ql(i,o,u,Us(i))}catch(_e){Ql(i,o,{then:function(){},status:"rejected",reason:_e},Us())}finally{G.p=x,C!==null&&V.types!==null&&(C.types=V.types),$.T=C}}function wA(){}function $f(i,o,l,u){if(i.tag!==5)throw Error(s(476));var y=zv(i).queue;Bv(i,y,o,ae,l===null?wA:function(){return jv(i),l(u)})}function zv(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:ae},next:null};var l={};return o.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qi,lastRenderedState:l},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function jv(i){var o=zv(i);o.next===null&&(o=i.alternate.memoizedState),Ql(i,o.next.queue,{},Us())}function Yf(){return es(mc)}function Fv(){return kn().memoizedState}function qv(){return kn().memoizedState}function CA(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var l=Us();i=kr(l);var u=Dr(o,i,l);u!==null&&(As(u,o,l),Yl(u,o,l)),o={cache:Ef()},i.payload=o;return}o=o.return}}function SA(i,o,l){var u=Us();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Hu(i)?Gv(o,l):(l=df(i,o,l,u),l!==null&&(As(l,i,u),$v(l,o,u)))}function Hv(i,o,l){var u=Us();Ql(i,o,l,u)}function Ql(i,o,l,u){var y={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Hu(i))Gv(o,y);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=o.lastRenderedReducer,x!==null))try{var C=o.lastRenderedState,V=x(C,l);if(y.hasEagerState=!0,y.eagerState=V,Ms(V,C))return wu(i,o,y,0),cn===null&&Tu(),!1}catch{}finally{}if(l=df(i,o,y,u),l!==null)return As(l,i,u),$v(l,o,u),!0}return!1}function Jf(i,o,l,u){if(u={lane:2,revertLane:Sp(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Hu(i)){if(o)throw Error(s(479))}else o=df(i,l,u,2),o!==null&&As(o,i,2)}function Hu(i){var o=i.alternate;return i===bt||o!==null&&o===bt}function Gv(i,o){Da=Uu=!0;var l=i.pending;l===null?o.next=o:(o.next=l.next,l.next=o),i.pending=o}function $v(i,o,l){if((l&4194048)!==0){var u=o.lanes;u&=i.pendingLanes,l|=u,o.lanes=l,fe(i,l)}}var Zl={readContext:es,use:zu,useCallback:wn,useContext:wn,useEffect:wn,useImperativeHandle:wn,useLayoutEffect:wn,useInsertionEffect:wn,useMemo:wn,useReducer:wn,useRef:wn,useState:wn,useDebugValue:wn,useDeferredValue:wn,useTransition:wn,useSyncExternalStore:wn,useId:wn,useHostTransitionStatus:wn,useFormState:wn,useActionState:wn,useOptimistic:wn,useMemoCache:wn,useCacheRefresh:wn};Zl.useEffectEvent=wn;var Yv={readContext:es,use:zu,useCallback:function(i,o){return ys().memoizedState=[i,o===void 0?null:o],i},useContext:es,useEffect:Nv,useImperativeHandle:function(i,o,l){l=l!=null?l.concat([i]):null,Fu(4194308,4,Pv.bind(null,o,i),l)},useLayoutEffect:function(i,o){return Fu(4194308,4,i,o)},useInsertionEffect:function(i,o){Fu(4,2,i,o)},useMemo:function(i,o){var l=ys();o=o===void 0?null:o;var u=i();if(jo){In(!0);try{i()}finally{In(!1)}}return l.memoizedState=[u,o],u},useReducer:function(i,o,l){var u=ys();if(l!==void 0){var y=l(o);if(jo){In(!0);try{l(o)}finally{In(!1)}}}else y=o;return u.memoizedState=u.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},u.queue=i,i=i.dispatch=SA.bind(null,bt,i),[u.memoizedState,i]},useRef:function(i){var o=ys();return i={current:i},o.memoizedState=i},useState:function(i){i=jf(i);var o=i.queue,l=Hv.bind(null,bt,o);return o.dispatch=l,[i.memoizedState,l]},useDebugValue:Hf,useDeferredValue:function(i,o){var l=ys();return Gf(l,i,o)},useTransition:function(){var i=jf(!1);return i=Bv.bind(null,bt,i.queue,!0,!1),ys().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,l){var u=bt,y=ys();if(Ut){if(l===void 0)throw Error(s(407));l=l()}else{if(l=o(),cn===null)throw Error(s(349));(Mt&127)!==0||pv(u,o,l)}y.memoizedState=l;var x={value:l,getSnapshot:o};return y.queue=x,Nv(gv.bind(null,u,x,i),[i]),u.flags|=2048,La(9,{destroy:void 0},mv.bind(null,u,x,l,o),null),l},useId:function(){var i=ys(),o=cn.identifierPrefix;if(Ut){var l=Si,u=Ci;l=(u&~(1<<32-Ct(u)-1)).toString(32)+l,o="_"+o+"R_"+l,l=Ou++,0<l&&(o+="H"+l.toString(32)),o+="_"}else l=_A++,o="_"+o+"r_"+l.toString(32)+"_";return i.memoizedState=o},useHostTransitionStatus:Yf,useFormState:Cv,useActionState:Cv,useOptimistic:function(i){var o=ys();o.memoizedState=o.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=l,o=Jf.bind(null,bt,!0,l),l.dispatch=o,[i,o]},useMemoCache:Of,useCacheRefresh:function(){return ys().memoizedState=CA.bind(null,bt)},useEffectEvent:function(i){var o=ys(),l={impl:i};return o.memoizedState=l,function(){if((Jt&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},Kf={readContext:es,use:zu,useCallback:Vv,useContext:es,useEffect:qf,useImperativeHandle:Lv,useInsertionEffect:kv,useLayoutEffect:Dv,useMemo:Uv,useReducer:ju,useRef:Rv,useState:function(){return ju(Qi)},useDebugValue:Hf,useDeferredValue:function(i,o){var l=kn();return Ov(l,tn.memoizedState,i,o)},useTransition:function(){var i=ju(Qi)[0],o=kn().memoizedState;return[typeof i=="boolean"?i:Xl(i),o]},useSyncExternalStore:fv,useId:Fv,useHostTransitionStatus:Yf,useFormState:Sv,useActionState:Sv,useOptimistic:function(i,o){var l=kn();return _v(l,tn,i,o)},useMemoCache:Of,useCacheRefresh:qv};Kf.useEffectEvent=Mv;var Jv={readContext:es,use:zu,useCallback:Vv,useContext:es,useEffect:qf,useImperativeHandle:Lv,useInsertionEffect:kv,useLayoutEffect:Dv,useMemo:Uv,useReducer:zf,useRef:Rv,useState:function(){return zf(Qi)},useDebugValue:Hf,useDeferredValue:function(i,o){var l=kn();return tn===null?Gf(l,i,o):Ov(l,tn.memoizedState,i,o)},useTransition:function(){var i=zf(Qi)[0],o=kn().memoizedState;return[typeof i=="boolean"?i:Xl(i),o]},useSyncExternalStore:fv,useId:Fv,useHostTransitionStatus:Yf,useFormState:Iv,useActionState:Iv,useOptimistic:function(i,o){var l=kn();return tn!==null?_v(l,tn,i,o):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:Of,useCacheRefresh:qv};Jv.useEffectEvent=Mv;function Wf(i,o,l,u){o=i.memoizedState,l=l(u,o),l=l==null?o:b({},o,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Xf={enqueueSetState:function(i,o,l){i=i._reactInternals;var u=Us(),y=kr(u);y.payload=o,l!=null&&(y.callback=l),o=Dr(i,y,u),o!==null&&(As(o,i,u),Yl(o,i,u))},enqueueReplaceState:function(i,o,l){i=i._reactInternals;var u=Us(),y=kr(u);y.tag=1,y.payload=o,l!=null&&(y.callback=l),o=Dr(i,y,u),o!==null&&(As(o,i,u),Yl(o,i,u))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var l=Us(),u=kr(l);u.tag=2,o!=null&&(u.callback=o),o=Dr(i,u,l),o!==null&&(As(o,i,l),Yl(o,i,l))}};function Kv(i,o,l,u,y,x,C){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(u,x,C):o.prototype&&o.prototype.isPureReactComponent?!Bl(l,u)||!Bl(y,x):!0}function Wv(i,o,l,u){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,u),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,u),o.state!==i&&Xf.enqueueReplaceState(o,o.state,null)}function Fo(i,o){var l=o;if("ref"in o){l={};for(var u in o)u!=="ref"&&(l[u]=o[u])}if(i=i.defaultProps){l===o&&(l=b({},l));for(var y in i)l[y]===void 0&&(l[y]=i[y])}return l}function Xv(i){Eu(i)}function Qv(i){console.error(i)}function Zv(i){Eu(i)}function Gu(i,o){try{var l=i.onUncaughtError;l(o.value,{componentStack:o.stack})}catch(u){setTimeout(function(){throw u})}}function e_(i,o,l){try{var u=i.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Qf(i,o,l){return l=kr(l),l.tag=3,l.payload={element:null},l.callback=function(){Gu(i,o)},l}function t_(i){return i=kr(i),i.tag=3,i}function n_(i,o,l,u){var y=l.type.getDerivedStateFromError;if(typeof y=="function"){var x=u.value;i.payload=function(){return y(x)},i.callback=function(){e_(o,l,u)}}var C=l.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(i.callback=function(){e_(o,l,u),typeof y!="function"&&(Br===null?Br=new Set([this]):Br.add(this));var V=u.stack;this.componentDidCatch(u.value,{componentStack:V!==null?V:""})})}function AA(i,o,l,u,y){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(o=l.alternate,o!==null&&Aa(o,l,y,!0),l=Ds.current,l!==null){switch(l.tag){case 31:case 13:return Ws===null?sd():l.alternate===null&&Cn===0&&(Cn=3),l.flags&=-257,l.flags|=65536,l.lanes=y,u===ku?l.flags|=16384:(o=l.updateQueue,o===null?l.updateQueue=new Set([u]):o.add(u),Tp(i,u,y)),!1;case 22:return l.flags|=65536,u===ku?l.flags|=16384:(o=l.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=o):(l=o.retryQueue,l===null?o.retryQueue=new Set([u]):l.add(u)),Tp(i,u,y)),!1}throw Error(s(435,l.tag))}return Tp(i,u,y),sd(),!1}if(Ut)return o=Ds.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,u!==yf&&(i=Error(s(422),{cause:u}),Fl($s(i,l)))):(u!==yf&&(o=Error(s(423),{cause:u}),Fl($s(o,l))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,u=$s(u,l),y=Qf(i.stateNode,u,y),If(i,y),Cn!==4&&(Cn=2)),!1;var x=Error(s(520),{cause:u});if(x=$s(x,l),ac===null?ac=[x]:ac.push(x),Cn!==4&&(Cn=2),o===null)return!0;u=$s(u,l),l=o;do{switch(l.tag){case 3:return l.flags|=65536,i=y&-y,l.lanes|=i,i=Qf(l.stateNode,u,i),If(l,i),!1;case 1:if(o=l.type,x=l.stateNode,(l.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Br===null||!Br.has(x))))return l.flags|=65536,y&=-y,l.lanes|=y,y=t_(y),n_(y,i,l,u),If(l,y),!1}l=l.return}while(l!==null);return!1}var Zf=Error(s(461)),On=!1;function ts(i,o,l,u){o.child=i===null?ov(o,null,l,u):zo(o,i.child,l,u)}function s_(i,o,l,u,y){l=l.render;var x=o.ref;if("ref"in u){var C={};for(var V in u)V!=="ref"&&(C[V]=u[V])}else C=u;return Vo(o),u=Pf(i,o,l,C,x,y),V=Lf(),i!==null&&!On?(Vf(i,o,y),Zi(i,o,y)):(Ut&&V&&mf(o),o.flags|=1,ts(i,o,u,y),o.child)}function i_(i,o,l,u,y){if(i===null){var x=l.type;return typeof x=="function"&&!hf(x)&&x.defaultProps===void 0&&l.compare===null?(o.tag=15,o.type=x,r_(i,o,x,u,y)):(i=Su(l.type,null,u,o,o.mode,y),i.ref=o.ref,i.return=o,o.child=i)}if(x=i.child,!ap(i,y)){var C=x.memoizedProps;if(l=l.compare,l=l!==null?l:Bl,l(C,u)&&i.ref===o.ref)return Zi(i,o,y)}return o.flags|=1,i=Yi(x,u),i.ref=o.ref,i.return=o,o.child=i}function r_(i,o,l,u,y){if(i!==null){var x=i.memoizedProps;if(Bl(x,u)&&i.ref===o.ref)if(On=!1,o.pendingProps=u=x,ap(i,y))(i.flags&131072)!==0&&(On=!0);else return o.lanes=i.lanes,Zi(i,o,y)}return ep(i,o,l,u,y)}function o_(i,o,l,u){var y=u.children,x=i!==null?i.memoizedState:null;if(i===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((o.flags&128)!==0){if(x=x!==null?x.baseLanes|l:l,i!==null){for(u=o.child=i.child,y=0;u!==null;)y=y|u.lanes|u.childLanes,u=u.sibling;u=y&~x}else u=0,o.child=null;return a_(i,o,x,l,u)}if((l&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&Nu(o,x!==null?x.cachePool:null),x!==null?cv(o,x):Nf(),uv(o);else return u=o.lanes=536870912,a_(i,o,x!==null?x.baseLanes|l:l,l,u)}else x!==null?(Nu(o,x.cachePool),cv(o,x),Lr(),o.memoizedState=null):(i!==null&&Nu(o,null),Nf(),Lr());return ts(i,o,y,l),o.child}function ec(i,o){return i!==null&&i.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function a_(i,o,l,u,y){var x=wf();return x=x===null?null:{parent:Vn._currentValue,pool:x},o.memoizedState={baseLanes:l,cachePool:x},i!==null&&Nu(o,null),Nf(),uv(o),i!==null&&Aa(i,o,u,!0),o.childLanes=y,null}function $u(i,o){return o=Ju({mode:o.mode,children:o.children},i.mode),o.ref=i.ref,i.child=o,o.return=i,o}function l_(i,o,l){return zo(o,i.child,null,l),i=$u(o,o.pendingProps),i.flags|=2,Ps(o),o.memoizedState=null,i}function IA(i,o,l){var u=o.pendingProps,y=(o.flags&128)!==0;if(o.flags&=-129,i===null){if(Ut){if(u.mode==="hidden")return i=$u(o,u),o.lanes=536870912,ec(null,i);if(kf(o),(i=fn)?(i=x0(i,Ks),i=i!==null&&i.data==="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:Ar!==null?{id:Ci,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},l=Gy(i),l.return=o,o.child=l,Zn=o,fn=null)):i=null,i===null)throw Rr(o);return o.lanes=536870912,null}return $u(o,u)}var x=i.memoizedState;if(x!==null){var C=x.dehydrated;if(kf(o),y)if(o.flags&256)o.flags&=-257,o=l_(i,o,l);else if(o.memoizedState!==null)o.child=i.child,o.flags|=128,o=null;else throw Error(s(558));else if(On||Aa(i,o,l,!1),y=(l&i.childLanes)!==0,On||y){if(u=cn,u!==null&&(C=ee(u,l),C!==0&&C!==x.retryLane))throw x.retryLane=C,ko(i,C),As(u,i,C),Zf;sd(),o=l_(i,o,l)}else i=x.treeContext,fn=Xs(C.nextSibling),Zn=o,Ut=!0,Ir=null,Ks=!1,i!==null&&Jy(o,i),o=$u(o,u),o.flags|=4096;return o}return i=Yi(i.child,{mode:u.mode,children:u.children}),i.ref=o.ref,o.child=i,i.return=o,i}function Yu(i,o){var l=o.ref;if(l===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(i===null||i.ref!==l)&&(o.flags|=4194816)}}function ep(i,o,l,u,y){return Vo(o),l=Pf(i,o,l,u,void 0,y),u=Lf(),i!==null&&!On?(Vf(i,o,y),Zi(i,o,y)):(Ut&&u&&mf(o),o.flags|=1,ts(i,o,l,y),o.child)}function c_(i,o,l,u,y,x){return Vo(o),o.updateQueue=null,l=hv(o,u,l,y),dv(i),u=Lf(),i!==null&&!On?(Vf(i,o,x),Zi(i,o,x)):(Ut&&u&&mf(o),o.flags|=1,ts(i,o,l,x),o.child)}function u_(i,o,l,u,y){if(Vo(o),o.stateNode===null){var x=Ta,C=l.contextType;typeof C=="object"&&C!==null&&(x=es(C)),x=new l(u,x),o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Xf,o.stateNode=x,x._reactInternals=o,x=o.stateNode,x.props=u,x.state=o.memoizedState,x.refs={},Sf(o),C=l.contextType,x.context=typeof C=="object"&&C!==null?es(C):Ta,x.state=o.memoizedState,C=l.getDerivedStateFromProps,typeof C=="function"&&(Wf(o,l,C,u),x.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(C=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),C!==x.state&&Xf.enqueueReplaceState(x,x.state,null),Kl(o,u,x,y),Jl(),x.state=o.memoizedState),typeof x.componentDidMount=="function"&&(o.flags|=4194308),u=!0}else if(i===null){x=o.stateNode;var V=o.memoizedProps,W=Fo(l,V);x.props=W;var oe=x.context,me=l.contextType;C=Ta,typeof me=="object"&&me!==null&&(C=es(me));var _e=l.getDerivedStateFromProps;me=typeof _e=="function"||typeof x.getSnapshotBeforeUpdate=="function",V=o.pendingProps!==V,me||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(V||oe!==C)&&Wv(o,x,u,C),Mr=!1;var le=o.memoizedState;x.state=le,Kl(o,u,x,y),Jl(),oe=o.memoizedState,V||le!==oe||Mr?(typeof _e=="function"&&(Wf(o,l,_e,u),oe=o.memoizedState),(W=Mr||Kv(o,l,W,u,le,oe,C))?(me||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(o.flags|=4194308)):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=u,o.memoizedState=oe),x.props=u,x.state=oe,x.context=C,u=W):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),u=!1)}else{x=o.stateNode,Af(i,o),C=o.memoizedProps,me=Fo(l,C),x.props=me,_e=o.pendingProps,le=x.context,oe=l.contextType,W=Ta,typeof oe=="object"&&oe!==null&&(W=es(oe)),V=l.getDerivedStateFromProps,(oe=typeof V=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(C!==_e||le!==W)&&Wv(o,x,u,W),Mr=!1,le=o.memoizedState,x.state=le,Kl(o,u,x,y),Jl();var he=o.memoizedState;C!==_e||le!==he||Mr||i!==null&&i.dependencies!==null&&Iu(i.dependencies)?(typeof V=="function"&&(Wf(o,l,V,u),he=o.memoizedState),(me=Mr||Kv(o,l,me,u,le,he,W)||i!==null&&i.dependencies!==null&&Iu(i.dependencies))?(oe||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(u,he,W),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(u,he,W)),typeof x.componentDidUpdate=="function"&&(o.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof x.componentDidUpdate!="function"||C===i.memoizedProps&&le===i.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||C===i.memoizedProps&&le===i.memoizedState||(o.flags|=1024),o.memoizedProps=u,o.memoizedState=he),x.props=u,x.state=he,x.context=W,u=me):(typeof x.componentDidUpdate!="function"||C===i.memoizedProps&&le===i.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||C===i.memoizedProps&&le===i.memoizedState||(o.flags|=1024),u=!1)}return x=u,Yu(i,o),u=(o.flags&128)!==0,x||u?(x=o.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:x.render(),o.flags|=1,i!==null&&u?(o.child=zo(o,i.child,null,y),o.child=zo(o,null,l,y)):ts(i,o,l,y),o.memoizedState=x.state,i=o.child):i=Zi(i,o,y),i}function d_(i,o,l,u){return Po(),o.flags|=256,ts(i,o,l,u),o.child}var tp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function np(i){return{baseLanes:i,cachePool:ev()}}function sp(i,o,l){return i=i!==null?i.childLanes&~l:0,o&&(i|=Vs),i}function h_(i,o,l){var u=o.pendingProps,y=!1,x=(o.flags&128)!==0,C;if((C=x)||(C=i!==null&&i.memoizedState===null?!1:(Mn.current&2)!==0),C&&(y=!0,o.flags&=-129),C=(o.flags&32)!==0,o.flags&=-33,i===null){if(Ut){if(y?Pr(o):Lr(),(i=fn)?(i=x0(i,Ks),i=i!==null&&i.data!=="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:Ar!==null?{id:Ci,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},l=Gy(i),l.return=o,o.child=l,Zn=o,fn=null)):i=null,i===null)throw Rr(o);return Bp(i)?o.lanes=32:o.lanes=536870912,null}var V=u.children;return u=u.fallback,y?(Lr(),y=o.mode,V=Ju({mode:"hidden",children:V},y),u=Do(u,y,l,null),V.return=o,u.return=o,V.sibling=u,o.child=V,u=o.child,u.memoizedState=np(l),u.childLanes=sp(i,C,l),o.memoizedState=tp,ec(null,u)):(Pr(o),ip(o,V))}var W=i.memoizedState;if(W!==null&&(V=W.dehydrated,V!==null)){if(x)o.flags&256?(Pr(o),o.flags&=-257,o=rp(i,o,l)):o.memoizedState!==null?(Lr(),o.child=i.child,o.flags|=128,o=null):(Lr(),V=u.fallback,y=o.mode,u=Ju({mode:"visible",children:u.children},y),V=Do(V,y,l,null),V.flags|=2,u.return=o,V.return=o,u.sibling=V,o.child=u,zo(o,i.child,null,l),u=o.child,u.memoizedState=np(l),u.childLanes=sp(i,C,l),o.memoizedState=tp,o=ec(null,u));else if(Pr(o),Bp(V)){if(C=V.nextSibling&&V.nextSibling.dataset,C)var oe=C.dgst;C=oe,u=Error(s(419)),u.stack="",u.digest=C,Fl({value:u,source:null,stack:null}),o=rp(i,o,l)}else if(On||Aa(i,o,l,!1),C=(l&i.childLanes)!==0,On||C){if(C=cn,C!==null&&(u=ee(C,l),u!==0&&u!==W.retryLane))throw W.retryLane=u,ko(i,u),As(C,i,u),Zf;Op(V)||sd(),o=rp(i,o,l)}else Op(V)?(o.flags|=192,o.child=i.child,o=null):(i=W.treeContext,fn=Xs(V.nextSibling),Zn=o,Ut=!0,Ir=null,Ks=!1,i!==null&&Jy(o,i),o=ip(o,u.children),o.flags|=4096);return o}return y?(Lr(),V=u.fallback,y=o.mode,W=i.child,oe=W.sibling,u=Yi(W,{mode:"hidden",children:u.children}),u.subtreeFlags=W.subtreeFlags&65011712,oe!==null?V=Yi(oe,V):(V=Do(V,y,l,null),V.flags|=2),V.return=o,u.return=o,u.sibling=V,o.child=u,ec(null,u),u=o.child,V=i.child.memoizedState,V===null?V=np(l):(y=V.cachePool,y!==null?(W=Vn._currentValue,y=y.parent!==W?{parent:W,pool:W}:y):y=ev(),V={baseLanes:V.baseLanes|l,cachePool:y}),u.memoizedState=V,u.childLanes=sp(i,C,l),o.memoizedState=tp,ec(i.child,u)):(Pr(o),l=i.child,i=l.sibling,l=Yi(l,{mode:"visible",children:u.children}),l.return=o,l.sibling=null,i!==null&&(C=o.deletions,C===null?(o.deletions=[i],o.flags|=16):C.push(i)),o.child=l,o.memoizedState=null,l)}function ip(i,o){return o=Ju({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function Ju(i,o){return i=ks(22,i,null,o),i.lanes=0,i}function rp(i,o,l){return zo(o,i.child,null,l),i=ip(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function f_(i,o,l){i.lanes|=o;var u=i.alternate;u!==null&&(u.lanes|=o),xf(i.return,o,l)}function op(i,o,l,u,y,x){var C=i.memoizedState;C===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:y,treeForkCount:x}:(C.isBackwards=o,C.rendering=null,C.renderingStartTime=0,C.last=u,C.tail=l,C.tailMode=y,C.treeForkCount=x)}function p_(i,o,l){var u=o.pendingProps,y=u.revealOrder,x=u.tail;u=u.children;var C=Mn.current,V=(C&2)!==0;if(V?(C=C&1|2,o.flags|=128):C&=1,te(Mn,C),ts(i,o,u,l),u=Ut?jl:0,!V&&i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&f_(i,l,o);else if(i.tag===19)f_(i,l,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(l=o.child,y=null;l!==null;)i=l.alternate,i!==null&&Vu(i)===null&&(y=l),l=l.sibling;l=y,l===null?(y=o.child,o.child=null):(y=l.sibling,l.sibling=null),op(o,!1,y,l,x,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,y=o.child,o.child=null;y!==null;){if(i=y.alternate,i!==null&&Vu(i)===null){o.child=y;break}i=y.sibling,y.sibling=l,l=y,y=i}op(o,!0,l,null,x,u);break;case"together":op(o,!1,null,null,void 0,u);break;default:o.memoizedState=null}return o.child}function Zi(i,o,l){if(i!==null&&(o.dependencies=i.dependencies),Or|=o.lanes,(l&o.childLanes)===0)if(i!==null){if(Aa(i,o,l,!1),(l&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(s(153));if(o.child!==null){for(i=o.child,l=Yi(i,i.pendingProps),o.child=l,l.return=o;i.sibling!==null;)i=i.sibling,l=l.sibling=Yi(i,i.pendingProps),l.return=o;l.sibling=null}return o.child}function ap(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&Iu(i)))}function RA(i,o,l){switch(o.tag){case 3:Ue(o,o.stateNode.containerInfo),Nr(o,Vn,i.memoizedState.cache),Po();break;case 27:case 5:tt(o);break;case 4:Ue(o,o.stateNode.containerInfo);break;case 10:Nr(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,kf(o),null;break;case 13:var u=o.memoizedState;if(u!==null)return u.dehydrated!==null?(Pr(o),o.flags|=128,null):(l&o.child.childLanes)!==0?h_(i,o,l):(Pr(o),i=Zi(i,o,l),i!==null?i.sibling:null);Pr(o);break;case 19:var y=(i.flags&128)!==0;if(u=(l&o.childLanes)!==0,u||(Aa(i,o,l,!1),u=(l&o.childLanes)!==0),y){if(u)return p_(i,o,l);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),te(Mn,Mn.current),u)break;return null;case 22:return o.lanes=0,o_(i,o,l,o.pendingProps);case 24:Nr(o,Vn,i.memoizedState.cache)}return Zi(i,o,l)}function m_(i,o,l){if(i!==null)if(i.memoizedProps!==o.pendingProps)On=!0;else{if(!ap(i,l)&&(o.flags&128)===0)return On=!1,RA(i,o,l);On=(i.flags&131072)!==0}else On=!1,Ut&&(o.flags&1048576)!==0&&Yy(o,jl,o.index);switch(o.lanes=0,o.tag){case 16:e:{var u=o.pendingProps;if(i=Oo(o.elementType),o.type=i,typeof i=="function")hf(i)?(u=Fo(i,u),o.tag=1,o=u_(null,o,i,u,l)):(o.tag=0,o=ep(null,o,i,u,l));else{if(i!=null){var y=i.$$typeof;if(y===H){o.tag=11,o=s_(null,o,i,u,l);break e}else if(y===R){o.tag=14,o=i_(null,o,i,u,l);break e}}throw o=ce(i)||i,Error(s(306,o,""))}}return o;case 0:return ep(i,o,o.type,o.pendingProps,l);case 1:return u=o.type,y=Fo(u,o.pendingProps),u_(i,o,u,y,l);case 3:e:{if(Ue(o,o.stateNode.containerInfo),i===null)throw Error(s(387));u=o.pendingProps;var x=o.memoizedState;y=x.element,Af(i,o),Kl(o,u,null,l);var C=o.memoizedState;if(u=C.cache,Nr(o,Vn,u),u!==x.cache&&bf(o,[Vn],l,!0),Jl(),u=C.element,x.isDehydrated)if(x={element:u,isDehydrated:!1,cache:C.cache},o.updateQueue.baseState=x,o.memoizedState=x,o.flags&256){o=d_(i,o,u,l);break e}else if(u!==y){y=$s(Error(s(424)),o),Fl(y),o=d_(i,o,u,l);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(fn=Xs(i.firstChild),Zn=o,Ut=!0,Ir=null,Ks=!0,l=ov(o,null,u,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Po(),u===y){o=Zi(i,o,l);break e}ts(i,o,u,l)}o=o.child}return o;case 26:return Yu(i,o),i===null?(l=S0(o.type,null,o.pendingProps,null))?o.memoizedState=l:Ut||(l=o.type,i=o.pendingProps,u=ud(be.current).createElement(l),u[Ye]=o,u[dt]=i,ns(u,l,i),dn(u),o.stateNode=u):o.memoizedState=S0(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return tt(o),i===null&&Ut&&(u=o.stateNode=T0(o.type,o.pendingProps,be.current),Zn=o,Ks=!0,y=fn,qr(o.type)?(zp=y,fn=Xs(u.firstChild)):fn=y),ts(i,o,o.pendingProps.children,l),Yu(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&Ut&&((y=u=fn)&&(u=r1(u,o.type,o.pendingProps,Ks),u!==null?(o.stateNode=u,Zn=o,fn=Xs(u.firstChild),Ks=!1,y=!0):y=!1),y||Rr(o)),tt(o),y=o.type,x=o.pendingProps,C=i!==null?i.memoizedProps:null,u=x.children,Lp(y,x)?u=null:C!==null&&Lp(y,C)&&(o.flags|=32),o.memoizedState!==null&&(y=Pf(i,o,xA,null,null,l),mc._currentValue=y),Yu(i,o),ts(i,o,u,l),o.child;case 6:return i===null&&Ut&&((i=l=fn)&&(l=o1(l,o.pendingProps,Ks),l!==null?(o.stateNode=l,Zn=o,fn=null,i=!0):i=!1),i||Rr(o)),null;case 13:return h_(i,o,l);case 4:return Ue(o,o.stateNode.containerInfo),u=o.pendingProps,i===null?o.child=zo(o,null,u,l):ts(i,o,u,l),o.child;case 11:return s_(i,o,o.type,o.pendingProps,l);case 7:return ts(i,o,o.pendingProps,l),o.child;case 8:return ts(i,o,o.pendingProps.children,l),o.child;case 12:return ts(i,o,o.pendingProps.children,l),o.child;case 10:return u=o.pendingProps,Nr(o,o.type,u.value),ts(i,o,u.children,l),o.child;case 9:return y=o.type._context,u=o.pendingProps.children,Vo(o),y=es(y),u=u(y),o.flags|=1,ts(i,o,u,l),o.child;case 14:return i_(i,o,o.type,o.pendingProps,l);case 15:return r_(i,o,o.type,o.pendingProps,l);case 19:return p_(i,o,l);case 31:return IA(i,o,l);case 22:return o_(i,o,l,o.pendingProps);case 24:return Vo(o),u=es(Vn),i===null?(y=wf(),y===null&&(y=cn,x=Ef(),y.pooledCache=x,x.refCount++,x!==null&&(y.pooledCacheLanes|=l),y=x),o.memoizedState={parent:u,cache:y},Sf(o),Nr(o,Vn,y)):((i.lanes&l)!==0&&(Af(i,o),Kl(o,null,null,l),Jl()),y=i.memoizedState,x=o.memoizedState,y.parent!==u?(y={parent:u,cache:u},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),Nr(o,Vn,u)):(u=x.cache,Nr(o,Vn,u),u!==y.cache&&bf(o,[Vn],l,!0))),ts(i,o,o.pendingProps.children,l),o.child;case 29:throw o.pendingProps}throw Error(s(156,o.tag))}function er(i){i.flags|=4}function lp(i,o,l,u,y){if((o=(i.mode&32)!==0)&&(o=!1),o){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(F_())i.flags|=8192;else throw Bo=ku,Cf}else i.flags&=-16777217}function g_(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!M0(o))if(F_())i.flags|=8192;else throw Bo=ku,Cf}function Ku(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Xe():536870912,i.lanes|=o,Ba|=o)}function tc(i,o){if(!Ut)switch(i.tailMode){case"hidden":o=i.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:u.sibling=null}}function pn(i){var o=i.alternate!==null&&i.alternate.child===i.child,l=0,u=0;if(o)for(var y=i.child;y!==null;)l|=y.lanes|y.childLanes,u|=y.subtreeFlags&65011712,u|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)l|=y.lanes|y.childLanes,u|=y.subtreeFlags,u|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=u,i.childLanes=l,o}function NA(i,o,l){var u=o.pendingProps;switch(gf(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pn(o),null;case 1:return pn(o),null;case 3:return l=o.stateNode,u=null,i!==null&&(u=i.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Wi(Vn),Oe(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(Sa(o)?er(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,vf())),pn(o),null;case 26:var y=o.type,x=o.memoizedState;return i===null?(er(o),x!==null?(pn(o),g_(o,x)):(pn(o),lp(o,y,null,u,l))):x?x!==i.memoizedState?(er(o),pn(o),g_(o,x)):(pn(o),o.flags&=-16777217):(i=i.memoizedProps,i!==u&&er(o),pn(o),lp(o,y,i,u,l)),null;case 27:if(Ot(o),l=be.current,y=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==u&&er(o);else{if(!u){if(o.stateNode===null)throw Error(s(166));return pn(o),null}i=ie.current,Sa(o)?Ky(o):(i=T0(y,u,l),o.stateNode=i,er(o))}return pn(o),null;case 5:if(Ot(o),y=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==u&&er(o);else{if(!u){if(o.stateNode===null)throw Error(s(166));return pn(o),null}if(x=ie.current,Sa(o))Ky(o);else{var C=ud(be.current);switch(x){case 1:x=C.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:x=C.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":x=C.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":x=C.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":x=C.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof u.is=="string"?C.createElement("select",{is:u.is}):C.createElement("select"),u.multiple?x.multiple=!0:u.size&&(x.size=u.size);break;default:x=typeof u.is=="string"?C.createElement(y,{is:u.is}):C.createElement(y)}}x[Ye]=o,x[dt]=u;e:for(C=o.child;C!==null;){if(C.tag===5||C.tag===6)x.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===o)break e;for(;C.sibling===null;){if(C.return===null||C.return===o)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}o.stateNode=x;e:switch(ns(x,y,u),y){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&er(o)}}return pn(o),lp(o,o.type,i===null?null:i.memoizedProps,o.pendingProps,l),null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==u&&er(o);else{if(typeof u!="string"&&o.stateNode===null)throw Error(s(166));if(i=be.current,Sa(o)){if(i=o.stateNode,l=o.memoizedProps,u=null,y=Zn,y!==null)switch(y.tag){case 27:case 5:u=y.memoizedProps}i[Ye]=o,i=!!(i.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||h0(i.nodeValue,l)),i||Rr(o,!0)}else i=ud(i).createTextNode(u),i[Ye]=o,o.stateNode=i}return pn(o),null;case 31:if(l=o.memoizedState,i===null||i.memoizedState!==null){if(u=Sa(o),l!==null){if(i===null){if(!u)throw Error(s(318));if(i=o.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(557));i[Ye]=o}else Po(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;pn(o),i=!1}else l=vf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=l),i=!0;if(!i)return o.flags&256?(Ps(o),o):(Ps(o),null);if((o.flags&128)!==0)throw Error(s(558))}return pn(o),null;case 13:if(u=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=Sa(o),u!==null&&u.dehydrated!==null){if(i===null){if(!y)throw Error(s(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(s(317));y[Ye]=o}else Po(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;pn(o),y=!1}else y=vf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(Ps(o),o):(Ps(o),null)}return Ps(o),(o.flags&128)!==0?(o.lanes=l,o):(l=u!==null,i=i!==null&&i.memoizedState!==null,l&&(u=o.child,y=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(y=u.alternate.memoizedState.cachePool.pool),x=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(x=u.memoizedState.cachePool.pool),x!==y&&(u.flags|=2048)),l!==i&&l&&(o.child.flags|=8192),Ku(o,o.updateQueue),pn(o),null);case 4:return Oe(),i===null&&Np(o.stateNode.containerInfo),pn(o),null;case 10:return Wi(o.type),pn(o),null;case 19:if(Q(Mn),u=o.memoizedState,u===null)return pn(o),null;if(y=(o.flags&128)!==0,x=u.rendering,x===null)if(y)tc(u,!1);else{if(Cn!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(x=Vu(i),x!==null){for(o.flags|=128,tc(u,!1),i=x.updateQueue,o.updateQueue=i,Ku(o,i),o.subtreeFlags=0,i=l,l=o.child;l!==null;)Hy(l,i),l=l.sibling;return te(Mn,Mn.current&1|2),Ut&&Ji(o,u.treeForkCount),o.child}i=i.sibling}u.tail!==null&&ct()>ed&&(o.flags|=128,y=!0,tc(u,!1),o.lanes=4194304)}else{if(!y)if(i=Vu(x),i!==null){if(o.flags|=128,y=!0,i=i.updateQueue,o.updateQueue=i,Ku(o,i),tc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!x.alternate&&!Ut)return pn(o),null}else 2*ct()-u.renderingStartTime>ed&&l!==536870912&&(o.flags|=128,y=!0,tc(u,!1),o.lanes=4194304);u.isBackwards?(x.sibling=o.child,o.child=x):(i=u.last,i!==null?i.sibling=x:o.child=x,u.last=x)}return u.tail!==null?(i=u.tail,u.rendering=i,u.tail=i.sibling,u.renderingStartTime=ct(),i.sibling=null,l=Mn.current,te(Mn,y?l&1|2:l&1),Ut&&Ji(o,u.treeForkCount),i):(pn(o),null);case 22:case 23:return Ps(o),Mf(),u=o.memoizedState!==null,i!==null?i.memoizedState!==null!==u&&(o.flags|=8192):u&&(o.flags|=8192),u?(l&536870912)!==0&&(o.flags&128)===0&&(pn(o),o.subtreeFlags&6&&(o.flags|=8192)):pn(o),l=o.updateQueue,l!==null&&Ku(o,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),u=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(u=o.memoizedState.cachePool.pool),u!==l&&(o.flags|=2048),i!==null&&Q(Uo),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),o.memoizedState.cache!==l&&(o.flags|=2048),Wi(Vn),pn(o),null;case 25:return null;case 30:return null}throw Error(s(156,o.tag))}function MA(i,o){switch(gf(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Wi(Vn),Oe(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Ot(o),null;case 31:if(o.memoizedState!==null){if(Ps(o),o.alternate===null)throw Error(s(340));Po()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 13:if(Ps(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(s(340));Po()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Q(Mn),null;case 4:return Oe(),null;case 10:return Wi(o.type),null;case 22:case 23:return Ps(o),Mf(),i!==null&&Q(Uo),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return Wi(Vn),null;case 25:return null;default:return null}}function y_(i,o){switch(gf(o),o.tag){case 3:Wi(Vn),Oe();break;case 26:case 27:case 5:Ot(o);break;case 4:Oe();break;case 31:o.memoizedState!==null&&Ps(o);break;case 13:Ps(o);break;case 19:Q(Mn);break;case 10:Wi(o.type);break;case 22:case 23:Ps(o),Mf(),i!==null&&Q(Uo);break;case 24:Wi(Vn)}}function nc(i,o){try{var l=o.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var y=u.next;l=y;do{if((l.tag&i)===i){u=void 0;var x=l.create,C=l.inst;u=x(),C.destroy=u}l=l.next}while(l!==y)}}catch(V){Zt(o,o.return,V)}}function Vr(i,o,l){try{var u=o.updateQueue,y=u!==null?u.lastEffect:null;if(y!==null){var x=y.next;u=x;do{if((u.tag&i)===i){var C=u.inst,V=C.destroy;if(V!==void 0){C.destroy=void 0,y=o;var W=l,oe=V;try{oe()}catch(me){Zt(y,W,me)}}}u=u.next}while(u!==x)}}catch(me){Zt(o,o.return,me)}}function v_(i){var o=i.updateQueue;if(o!==null){var l=i.stateNode;try{lv(o,l)}catch(u){Zt(i,i.return,u)}}}function __(i,o,l){l.props=Fo(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(u){Zt(i,o,u)}}function sc(i,o){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var u=i.stateNode;break;case 30:u=i.stateNode;break;default:u=i.stateNode}typeof l=="function"?i.refCleanup=l(u):l.current=u}}catch(y){Zt(i,o,y)}}function Ai(i,o){var l=i.ref,u=i.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(y){Zt(i,o,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(y){Zt(i,o,y)}else l.current=null}function x_(i){var o=i.type,l=i.memoizedProps,u=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(y){Zt(i,i.return,y)}}function cp(i,o,l){try{var u=i.stateNode;ZA(u,i.type,l,o),u[dt]=o}catch(y){Zt(i,i.return,y)}}function b_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&qr(i.type)||i.tag===4}function up(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||b_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&qr(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function dp(i,o,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,o?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,o):(o=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,o.appendChild(i),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=ri));else if(u!==4&&(u===27&&qr(i.type)&&(l=i.stateNode,o=null),i=i.child,i!==null))for(dp(i,o,l),i=i.sibling;i!==null;)dp(i,o,l),i=i.sibling}function Wu(i,o,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,o?l.insertBefore(i,o):l.appendChild(i);else if(u!==4&&(u===27&&qr(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(Wu(i,o,l),i=i.sibling;i!==null;)Wu(i,o,l),i=i.sibling}function E_(i){var o=i.stateNode,l=i.memoizedProps;try{for(var u=i.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);ns(o,u,l),o[Ye]=i,o[dt]=l}catch(x){Zt(i,i.return,x)}}var tr=!1,Bn=!1,hp=!1,T_=typeof WeakSet=="function"?WeakSet:Set,Kn=null;function kA(i,o){if(i=i.containerInfo,Dp=yd,i=Ly(i),rf(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var y=u.anchorOffset,x=u.focusNode;u=u.focusOffset;try{l.nodeType,x.nodeType}catch{l=null;break e}var C=0,V=-1,W=-1,oe=0,me=0,_e=i,le=null;t:for(;;){for(var he;_e!==l||y!==0&&_e.nodeType!==3||(V=C+y),_e!==x||u!==0&&_e.nodeType!==3||(W=C+u),_e.nodeType===3&&(C+=_e.nodeValue.length),(he=_e.firstChild)!==null;)le=_e,_e=he;for(;;){if(_e===i)break t;if(le===l&&++oe===y&&(V=C),le===x&&++me===u&&(W=C),(he=_e.nextSibling)!==null)break;_e=le,le=_e.parentNode}_e=he}l=V===-1||W===-1?null:{start:V,end:W}}else l=null}l=l||{start:0,end:0}}else l=null;for(Pp={focusedElem:i,selectionRange:l},yd=!1,Kn=o;Kn!==null;)if(o=Kn,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,Kn=i;else for(;Kn!==null;){switch(o=Kn,x=o.alternate,i=o.flags,o.tag){case 0:if((i&4)!==0&&(i=o.updateQueue,i=i!==null?i.events:null,i!==null))for(l=0;l<i.length;l++)y=i[l],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&x!==null){i=void 0,l=o,y=x.memoizedProps,x=x.memoizedState,u=l.stateNode;try{var Ge=Fo(l.type,y);i=u.getSnapshotBeforeUpdate(Ge,x),u.__reactInternalSnapshotBeforeUpdate=i}catch(lt){Zt(l,l.return,lt)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,l=i.nodeType,l===9)Up(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Up(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(s(163))}if(i=o.sibling,i!==null){i.return=o.return,Kn=i;break}Kn=o.return}}function w_(i,o,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:sr(i,l),u&4&&nc(5,l);break;case 1:if(sr(i,l),u&4)if(i=l.stateNode,o===null)try{i.componentDidMount()}catch(C){Zt(l,l.return,C)}else{var y=Fo(l.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(y,o,i.__reactInternalSnapshotBeforeUpdate)}catch(C){Zt(l,l.return,C)}}u&64&&v_(l),u&512&&sc(l,l.return);break;case 3:if(sr(i,l),u&64&&(i=l.updateQueue,i!==null)){if(o=null,l.child!==null)switch(l.child.tag){case 27:case 5:o=l.child.stateNode;break;case 1:o=l.child.stateNode}try{lv(i,o)}catch(C){Zt(l,l.return,C)}}break;case 27:o===null&&u&4&&E_(l);case 26:case 5:sr(i,l),o===null&&u&4&&x_(l),u&512&&sc(l,l.return);break;case 12:sr(i,l);break;case 31:sr(i,l),u&4&&A_(i,l);break;case 13:sr(i,l),u&4&&I_(i,l),u&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=jA.bind(null,l),a1(i,l))));break;case 22:if(u=l.memoizedState!==null||tr,!u){o=o!==null&&o.memoizedState!==null||Bn,y=tr;var x=Bn;tr=u,(Bn=o)&&!x?ir(i,l,(l.subtreeFlags&8772)!==0):sr(i,l),tr=y,Bn=x}break;case 30:break;default:sr(i,l)}}function C_(i){var o=i.alternate;o!==null&&(i.alternate=null,C_(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&xs(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var vn=null,Ts=!1;function nr(i,o,l){for(l=l.child;l!==null;)S_(i,o,l),l=l.sibling}function S_(i,o,l){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Ln,l)}catch{}switch(l.tag){case 26:Bn||Ai(l,o),nr(i,o,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Bn||Ai(l,o);var u=vn,y=Ts;qr(l.type)&&(vn=l.stateNode,Ts=!1),nr(i,o,l),hc(l.stateNode),vn=u,Ts=y;break;case 5:Bn||Ai(l,o);case 6:if(u=vn,y=Ts,vn=null,nr(i,o,l),vn=u,Ts=y,vn!==null)if(Ts)try{(vn.nodeType===9?vn.body:vn.nodeName==="HTML"?vn.ownerDocument.body:vn).removeChild(l.stateNode)}catch(x){Zt(l,o,x)}else try{vn.removeChild(l.stateNode)}catch(x){Zt(l,o,x)}break;case 18:vn!==null&&(Ts?(i=vn,v0(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),Ya(i)):v0(vn,l.stateNode));break;case 4:u=vn,y=Ts,vn=l.stateNode.containerInfo,Ts=!0,nr(i,o,l),vn=u,Ts=y;break;case 0:case 11:case 14:case 15:Vr(2,l,o),Bn||Vr(4,l,o),nr(i,o,l);break;case 1:Bn||(Ai(l,o),u=l.stateNode,typeof u.componentWillUnmount=="function"&&__(l,o,u)),nr(i,o,l);break;case 21:nr(i,o,l);break;case 22:Bn=(u=Bn)||l.memoizedState!==null,nr(i,o,l),Bn=u;break;default:nr(i,o,l)}}function A_(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Ya(i)}catch(l){Zt(o,o.return,l)}}}function I_(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Ya(i)}catch(l){Zt(o,o.return,l)}}function DA(i){switch(i.tag){case 31:case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new T_),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new T_),o;default:throw Error(s(435,i.tag))}}function Xu(i,o){var l=DA(i);o.forEach(function(u){if(!l.has(u)){l.add(u);var y=FA.bind(null,i,u);u.then(y,y)}})}function ws(i,o){var l=o.deletions;if(l!==null)for(var u=0;u<l.length;u++){var y=l[u],x=i,C=o,V=C;e:for(;V!==null;){switch(V.tag){case 27:if(qr(V.type)){vn=V.stateNode,Ts=!1;break e}break;case 5:vn=V.stateNode,Ts=!1;break e;case 3:case 4:vn=V.stateNode.containerInfo,Ts=!0;break e}V=V.return}if(vn===null)throw Error(s(160));S_(x,C,y),vn=null,Ts=!1,x=y.alternate,x!==null&&(x.return=null),y.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)R_(o,i),o=o.sibling}var di=null;function R_(i,o){var l=i.alternate,u=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ws(o,i),Cs(i),u&4&&(Vr(3,i,i.return),nc(3,i),Vr(5,i,i.return));break;case 1:ws(o,i),Cs(i),u&512&&(Bn||l===null||Ai(l,l.return)),u&64&&tr&&(i=i.updateQueue,i!==null&&(u=i.callbacks,u!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var y=di;if(ws(o,i),Cs(i),u&512&&(Bn||l===null||Ai(l,l.return)),u&4){var x=l!==null?l.memoizedState:null;if(u=i.memoizedState,l===null)if(u===null)if(i.stateNode===null){e:{u=i.type,l=i.memoizedProps,y=y.ownerDocument||y;t:switch(u){case"title":x=y.getElementsByTagName("title")[0],(!x||x[un]||x[Ye]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=y.createElement(u),y.head.insertBefore(x,y.querySelector("head > title"))),ns(x,u,l),x[Ye]=i,dn(x),u=x;break e;case"link":var C=R0("link","href",y).get(u+(l.href||""));if(C){for(var V=0;V<C.length;V++)if(x=C[V],x.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&x.getAttribute("rel")===(l.rel==null?null:l.rel)&&x.getAttribute("title")===(l.title==null?null:l.title)&&x.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){C.splice(V,1);break t}}x=y.createElement(u),ns(x,u,l),y.head.appendChild(x);break;case"meta":if(C=R0("meta","content",y).get(u+(l.content||""))){for(V=0;V<C.length;V++)if(x=C[V],x.getAttribute("content")===(l.content==null?null:""+l.content)&&x.getAttribute("name")===(l.name==null?null:l.name)&&x.getAttribute("property")===(l.property==null?null:l.property)&&x.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&x.getAttribute("charset")===(l.charSet==null?null:l.charSet)){C.splice(V,1);break t}}x=y.createElement(u),ns(x,u,l),y.head.appendChild(x);break;default:throw Error(s(468,u))}x[Ye]=i,dn(x),u=x}i.stateNode=u}else N0(y,i.type,i.stateNode);else i.stateNode=I0(y,u,i.memoizedProps);else x!==u?(x===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):x.count--,u===null?N0(y,i.type,i.stateNode):I0(y,u,i.memoizedProps)):u===null&&i.stateNode!==null&&cp(i,i.memoizedProps,l.memoizedProps)}break;case 27:ws(o,i),Cs(i),u&512&&(Bn||l===null||Ai(l,l.return)),l!==null&&u&4&&cp(i,i.memoizedProps,l.memoizedProps);break;case 5:if(ws(o,i),Cs(i),u&512&&(Bn||l===null||Ai(l,l.return)),i.flags&32){y=i.stateNode;try{Es(y,"")}catch(Ge){Zt(i,i.return,Ge)}}u&4&&i.stateNode!=null&&(y=i.memoizedProps,cp(i,y,l!==null?l.memoizedProps:y)),u&1024&&(hp=!0);break;case 6:if(ws(o,i),Cs(i),u&4){if(i.stateNode===null)throw Error(s(162));u=i.memoizedProps,l=i.stateNode;try{l.nodeValue=u}catch(Ge){Zt(i,i.return,Ge)}}break;case 3:if(fd=null,y=di,di=dd(o.containerInfo),ws(o,i),di=y,Cs(i),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Ya(o.containerInfo)}catch(Ge){Zt(i,i.return,Ge)}hp&&(hp=!1,N_(i));break;case 4:u=di,di=dd(i.stateNode.containerInfo),ws(o,i),Cs(i),di=u;break;case 12:ws(o,i),Cs(i);break;case 31:ws(o,i),Cs(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Xu(i,u)));break;case 13:ws(o,i),Cs(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Zu=ct()),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Xu(i,u)));break;case 22:y=i.memoizedState!==null;var W=l!==null&&l.memoizedState!==null,oe=tr,me=Bn;if(tr=oe||y,Bn=me||W,ws(o,i),Bn=me,tr=oe,Cs(i),u&8192)e:for(o=i.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(l===null||W||tr||Bn||qo(i)),l=null,o=i;;){if(o.tag===5||o.tag===26){if(l===null){W=l=o;try{if(x=W.stateNode,y)C=x.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{V=W.stateNode;var _e=W.memoizedProps.style,le=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;V.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(Ge){Zt(W,W.return,Ge)}}}else if(o.tag===6){if(l===null){W=o;try{W.stateNode.nodeValue=y?"":W.memoizedProps}catch(Ge){Zt(W,W.return,Ge)}}}else if(o.tag===18){if(l===null){W=o;try{var he=W.stateNode;y?_0(he,!0):_0(W.stateNode,!1)}catch(Ge){Zt(W,W.return,Ge)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;l===o&&(l=null),o=o.return}l===o&&(l=null),o.sibling.return=o.return,o=o.sibling}u&4&&(u=i.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Xu(i,l))));break;case 19:ws(o,i),Cs(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Xu(i,u)));break;case 30:break;case 21:break;default:ws(o,i),Cs(i)}}function Cs(i){var o=i.flags;if(o&2){try{for(var l,u=i.return;u!==null;){if(b_(u)){l=u;break}u=u.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var y=l.stateNode,x=up(i);Wu(i,x,y);break;case 5:var C=l.stateNode;l.flags&32&&(Es(C,""),l.flags&=-33);var V=up(i);Wu(i,V,C);break;case 3:case 4:var W=l.stateNode.containerInfo,oe=up(i);dp(i,oe,W);break;default:throw Error(s(161))}}catch(me){Zt(i,i.return,me)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function N_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;N_(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function sr(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)w_(i,o.alternate,o),o=o.sibling}function qo(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:Vr(4,o,o.return),qo(o);break;case 1:Ai(o,o.return);var l=o.stateNode;typeof l.componentWillUnmount=="function"&&__(o,o.return,l),qo(o);break;case 27:hc(o.stateNode);case 26:case 5:Ai(o,o.return),qo(o);break;case 22:o.memoizedState===null&&qo(o);break;case 30:qo(o);break;default:qo(o)}i=i.sibling}}function ir(i,o,l){for(l=l&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var u=o.alternate,y=i,x=o,C=x.flags;switch(x.tag){case 0:case 11:case 15:ir(y,x,l),nc(4,x);break;case 1:if(ir(y,x,l),u=x,y=u.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(oe){Zt(u,u.return,oe)}if(u=x,y=u.updateQueue,y!==null){var V=u.stateNode;try{var W=y.shared.hiddenCallbacks;if(W!==null)for(y.shared.hiddenCallbacks=null,y=0;y<W.length;y++)av(W[y],V)}catch(oe){Zt(u,u.return,oe)}}l&&C&64&&v_(x),sc(x,x.return);break;case 27:E_(x);case 26:case 5:ir(y,x,l),l&&u===null&&C&4&&x_(x),sc(x,x.return);break;case 12:ir(y,x,l);break;case 31:ir(y,x,l),l&&C&4&&A_(y,x);break;case 13:ir(y,x,l),l&&C&4&&I_(y,x);break;case 22:x.memoizedState===null&&ir(y,x,l),sc(x,x.return);break;case 30:break;default:ir(y,x,l)}o=o.sibling}}function fp(i,o){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&ql(l))}function pp(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&ql(i))}function hi(i,o,l,u){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)M_(i,o,l,u),o=o.sibling}function M_(i,o,l,u){var y=o.flags;switch(o.tag){case 0:case 11:case 15:hi(i,o,l,u),y&2048&&nc(9,o);break;case 1:hi(i,o,l,u);break;case 3:hi(i,o,l,u),y&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&ql(i)));break;case 12:if(y&2048){hi(i,o,l,u),i=o.stateNode;try{var x=o.memoizedProps,C=x.id,V=x.onPostCommit;typeof V=="function"&&V(C,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(W){Zt(o,o.return,W)}}else hi(i,o,l,u);break;case 31:hi(i,o,l,u);break;case 13:hi(i,o,l,u);break;case 23:break;case 22:x=o.stateNode,C=o.alternate,o.memoizedState!==null?x._visibility&2?hi(i,o,l,u):ic(i,o):x._visibility&2?hi(i,o,l,u):(x._visibility|=2,Va(i,o,l,u,(o.subtreeFlags&10256)!==0||!1)),y&2048&&fp(C,o);break;case 24:hi(i,o,l,u),y&2048&&pp(o.alternate,o);break;default:hi(i,o,l,u)}}function Va(i,o,l,u,y){for(y=y&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var x=i,C=o,V=l,W=u,oe=C.flags;switch(C.tag){case 0:case 11:case 15:Va(x,C,V,W,y),nc(8,C);break;case 23:break;case 22:var me=C.stateNode;C.memoizedState!==null?me._visibility&2?Va(x,C,V,W,y):ic(x,C):(me._visibility|=2,Va(x,C,V,W,y)),y&&oe&2048&&fp(C.alternate,C);break;case 24:Va(x,C,V,W,y),y&&oe&2048&&pp(C.alternate,C);break;default:Va(x,C,V,W,y)}o=o.sibling}}function ic(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var l=i,u=o,y=u.flags;switch(u.tag){case 22:ic(l,u),y&2048&&fp(u.alternate,u);break;case 24:ic(l,u),y&2048&&pp(u.alternate,u);break;default:ic(l,u)}o=o.sibling}}var rc=8192;function Ua(i,o,l){if(i.subtreeFlags&rc)for(i=i.child;i!==null;)k_(i,o,l),i=i.sibling}function k_(i,o,l){switch(i.tag){case 26:Ua(i,o,l),i.flags&rc&&i.memoizedState!==null&&_1(l,di,i.memoizedState,i.memoizedProps);break;case 5:Ua(i,o,l);break;case 3:case 4:var u=di;di=dd(i.stateNode.containerInfo),Ua(i,o,l),di=u;break;case 22:i.memoizedState===null&&(u=i.alternate,u!==null&&u.memoizedState!==null?(u=rc,rc=16777216,Ua(i,o,l),rc=u):Ua(i,o,l));break;default:Ua(i,o,l)}}function D_(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function oc(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var u=o[l];Kn=u,L_(u,i)}D_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)P_(i),i=i.sibling}function P_(i){switch(i.tag){case 0:case 11:case 15:oc(i),i.flags&2048&&Vr(9,i,i.return);break;case 3:oc(i);break;case 12:oc(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,Qu(i)):oc(i);break;default:oc(i)}}function Qu(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var u=o[l];Kn=u,L_(u,i)}D_(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:Vr(8,o,o.return),Qu(o);break;case 22:l=o.stateNode,l._visibility&2&&(l._visibility&=-3,Qu(o));break;default:Qu(o)}i=i.sibling}}function L_(i,o){for(;Kn!==null;){var l=Kn;switch(l.tag){case 0:case 11:case 15:Vr(8,l,o);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:ql(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Kn=u;else e:for(l=i;Kn!==null;){u=Kn;var y=u.sibling,x=u.return;if(C_(u),u===l){Kn=null;break e}if(y!==null){y.return=x,Kn=y;break e}Kn=x}}}var PA={getCacheForType:function(i){var o=es(Vn),l=o.data.get(i);return l===void 0&&(l=i(),o.data.set(i,l)),l},cacheSignal:function(){return es(Vn).controller.signal}},LA=typeof WeakMap=="function"?WeakMap:Map,Jt=0,cn=null,Rt=null,Mt=0,Qt=0,Ls=null,Ur=!1,Oa=!1,mp=!1,rr=0,Cn=0,Or=0,Ho=0,gp=0,Vs=0,Ba=0,ac=null,Ss=null,yp=!1,Zu=0,V_=0,ed=1/0,td=null,Br=null,$n=0,zr=null,za=null,or=0,vp=0,_p=null,U_=null,lc=0,xp=null;function Us(){return(Jt&2)!==0&&Mt!==0?Mt&-Mt:$.T!==null?Sp():Le()}function O_(){if(Vs===0)if((Mt&536870912)===0||Ut){var i=ht;ht<<=1,(ht&3932160)===0&&(ht=262144),Vs=i}else Vs=536870912;return i=Ds.current,i!==null&&(i.flags|=32),Vs}function As(i,o,l){(i===cn&&(Qt===2||Qt===9)||i.cancelPendingCommit!==null)&&(ja(i,0),jr(i,Mt,Vs,!1)),Me(i,l),((Jt&2)===0||i!==cn)&&(i===cn&&((Jt&2)===0&&(Ho|=l),Cn===4&&jr(i,Mt,Vs,!1)),Ii(i))}function B_(i,o,l){if((Jt&6)!==0)throw Error(s(327));var u=!l&&(o&127)===0&&(o&i.expiredLanes)===0||Qe(i,o),y=u?OA(i,o):Ep(i,o,!0),x=u;do{if(y===0){Oa&&!u&&jr(i,o,0,!1);break}else{if(l=i.current.alternate,x&&!VA(l)){y=Ep(i,o,!1),x=!1;continue}if(y===2){if(x=o,i.errorRecoveryDisabledLanes&x)var C=0;else C=i.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){o=C;e:{var V=i;y=ac;var W=V.current.memoizedState.isDehydrated;if(W&&(ja(V,C).flags|=256),C=Ep(V,C,!1),C!==2){if(mp&&!W){V.errorRecoveryDisabledLanes|=x,Ho|=x,y=4;break e}x=Ss,Ss=y,x!==null&&(Ss===null?Ss=x:Ss.push.apply(Ss,x))}y=C}if(x=!1,y!==2)continue}}if(y===1){ja(i,0),jr(i,o,0,!0);break}e:{switch(u=i,x=y,x){case 0:case 1:throw Error(s(345));case 4:if((o&4194048)!==o)break;case 6:jr(u,o,Vs,!Ur);break e;case 2:Ss=null;break;case 3:case 5:break;default:throw Error(s(329))}if((o&62914560)===o&&(y=Zu+300-ct(),10<y)){if(jr(u,o,Vs,!Ur),wt(u,0,!0)!==0)break e;or=o,u.timeoutHandle=g0(z_.bind(null,u,l,Ss,td,yp,o,Vs,Ho,Ba,Ur,x,"Throttled",-0,0),y);break e}z_(u,l,Ss,td,yp,o,Vs,Ho,Ba,Ur,x,null,-0,0)}}break}while(!0);Ii(i)}function z_(i,o,l,u,y,x,C,V,W,oe,me,_e,le,he){if(i.timeoutHandle=-1,_e=o.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ri},k_(o,x,_e);var Ge=(x&62914560)===x?Zu-ct():(x&4194048)===x?V_-ct():0;if(Ge=x1(_e,Ge),Ge!==null){or=x,i.cancelPendingCommit=Ge(J_.bind(null,i,o,x,l,u,y,C,V,W,me,_e,null,le,he)),jr(i,x,C,!oe);return}}J_(i,o,x,l,u,y,C,V,W)}function VA(i){for(var o=i;;){var l=o.tag;if((l===0||l===11||l===15)&&o.flags&16384&&(l=o.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var y=l[u],x=y.getSnapshot;y=y.value;try{if(!Ms(x(),y))return!1}catch{return!1}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function jr(i,o,l,u){o&=~gp,o&=~Ho,i.suspendedLanes|=o,i.pingedLanes&=~o,u&&(i.warmLanes|=o),u=i.expirationTimes;for(var y=o;0<y;){var x=31-Ct(y),C=1<<x;u[x]=-1,y&=~C}l!==0&&Be(i,l,o)}function nd(){return(Jt&6)===0?(cc(0),!1):!0}function bp(){if(Rt!==null){if(Qt===0)var i=Rt.return;else i=Rt,Ki=Lo=null,Uf(i),Ma=null,Gl=0,i=Rt;for(;i!==null;)y_(i.alternate,i),i=i.return;Rt=null}}function ja(i,o){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,n1(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),or=0,bp(),cn=i,Rt=l=Yi(i.current,null),Mt=o,Qt=0,Ls=null,Ur=!1,Oa=Qe(i,o),mp=!1,Ba=Vs=gp=Ho=Or=Cn=0,Ss=ac=null,yp=!1,(o&8)!==0&&(o|=o&32);var u=i.entangledLanes;if(u!==0)for(i=i.entanglements,u&=o;0<u;){var y=31-Ct(u),x=1<<y;o|=i[y],u&=~x}return rr=o,Tu(),l}function j_(i,o){bt=null,$.H=Zl,o===Na||o===Mu?(o=sv(),Qt=3):o===Cf?(o=sv(),Qt=4):Qt=o===Zf?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ls=o,Rt===null&&(Cn=1,Gu(i,$s(o,i.current)))}function F_(){var i=Ds.current;return i===null?!0:(Mt&4194048)===Mt?Ws===null:(Mt&62914560)===Mt||(Mt&536870912)!==0?i===Ws:!1}function q_(){var i=$.H;return $.H=Zl,i===null?Zl:i}function H_(){var i=$.A;return $.A=PA,i}function sd(){Cn=4,Ur||(Mt&4194048)!==Mt&&Ds.current!==null||(Oa=!0),(Or&134217727)===0&&(Ho&134217727)===0||cn===null||jr(cn,Mt,Vs,!1)}function Ep(i,o,l){var u=Jt;Jt|=2;var y=q_(),x=H_();(cn!==i||Mt!==o)&&(td=null,ja(i,o)),o=!1;var C=Cn;e:do try{if(Qt!==0&&Rt!==null){var V=Rt,W=Ls;switch(Qt){case 8:bp(),C=6;break e;case 3:case 2:case 9:case 6:Ds.current===null&&(o=!0);var oe=Qt;if(Qt=0,Ls=null,Fa(i,V,W,oe),l&&Oa){C=0;break e}break;default:oe=Qt,Qt=0,Ls=null,Fa(i,V,W,oe)}}UA(),C=Cn;break}catch(me){j_(i,me)}while(!0);return o&&i.shellSuspendCounter++,Ki=Lo=null,Jt=u,$.H=y,$.A=x,Rt===null&&(cn=null,Mt=0,Tu()),C}function UA(){for(;Rt!==null;)G_(Rt)}function OA(i,o){var l=Jt;Jt|=2;var u=q_(),y=H_();cn!==i||Mt!==o?(td=null,ed=ct()+500,ja(i,o)):Oa=Qe(i,o);e:do try{if(Qt!==0&&Rt!==null){o=Rt;var x=Ls;t:switch(Qt){case 1:Qt=0,Ls=null,Fa(i,o,x,1);break;case 2:case 9:if(tv(x)){Qt=0,Ls=null,$_(o);break}o=function(){Qt!==2&&Qt!==9||cn!==i||(Qt=7),Ii(i)},x.then(o,o);break e;case 3:Qt=7;break e;case 4:Qt=5;break e;case 7:tv(x)?(Qt=0,Ls=null,$_(o)):(Qt=0,Ls=null,Fa(i,o,x,7));break;case 5:var C=null;switch(Rt.tag){case 26:C=Rt.memoizedState;case 5:case 27:var V=Rt;if(C?M0(C):V.stateNode.complete){Qt=0,Ls=null;var W=V.sibling;if(W!==null)Rt=W;else{var oe=V.return;oe!==null?(Rt=oe,id(oe)):Rt=null}break t}}Qt=0,Ls=null,Fa(i,o,x,5);break;case 6:Qt=0,Ls=null,Fa(i,o,x,6);break;case 8:bp(),Cn=6;break e;default:throw Error(s(462))}}BA();break}catch(me){j_(i,me)}while(!0);return Ki=Lo=null,$.H=u,$.A=y,Jt=l,Rt!==null?0:(cn=null,Mt=0,Tu(),Cn)}function BA(){for(;Rt!==null&&!_t();)G_(Rt)}function G_(i){var o=m_(i.alternate,i,rr);i.memoizedProps=i.pendingProps,o===null?id(i):Rt=o}function $_(i){var o=i,l=o.alternate;switch(o.tag){case 15:case 0:o=c_(l,o,o.pendingProps,o.type,void 0,Mt);break;case 11:o=c_(l,o,o.pendingProps,o.type.render,o.ref,Mt);break;case 5:Uf(o);default:y_(l,o),o=Rt=Hy(o,rr),o=m_(l,o,rr)}i.memoizedProps=i.pendingProps,o===null?id(i):Rt=o}function Fa(i,o,l,u){Ki=Lo=null,Uf(o),Ma=null,Gl=0;var y=o.return;try{if(AA(i,y,o,l,Mt)){Cn=1,Gu(i,$s(l,i.current)),Rt=null;return}}catch(x){if(y!==null)throw Rt=y,x;Cn=1,Gu(i,$s(l,i.current)),Rt=null;return}o.flags&32768?(Ut||u===1?i=!0:Oa||(Mt&536870912)!==0?i=!1:(Ur=i=!0,(u===2||u===9||u===3||u===6)&&(u=Ds.current,u!==null&&u.tag===13&&(u.flags|=16384))),Y_(o,i)):id(o)}function id(i){var o=i;do{if((o.flags&32768)!==0){Y_(o,Ur);return}i=o.return;var l=NA(o.alternate,o,rr);if(l!==null){Rt=l;return}if(o=o.sibling,o!==null){Rt=o;return}Rt=o=i}while(o!==null);Cn===0&&(Cn=5)}function Y_(i,o){do{var l=MA(i.alternate,i);if(l!==null){l.flags&=32767,Rt=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!o&&(i=i.sibling,i!==null)){Rt=i;return}Rt=i=l}while(i!==null);Cn=6,Rt=null}function J_(i,o,l,u,y,x,C,V,W){i.cancelPendingCommit=null;do rd();while($n!==0);if((Jt&6)!==0)throw Error(s(327));if(o!==null){if(o===i.current)throw Error(s(177));if(x=o.lanes|o.childLanes,x|=uf,Re(i,l,x,C,V,W),i===cn&&(Rt=cn=null,Mt=0),za=o,zr=i,or=l,vp=x,_p=y,U_=u,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,qA(Vt,function(){return Z_(),null})):(i.callbackNode=null,i.callbackPriority=0),u=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||u){u=$.T,$.T=null,y=G.p,G.p=2,C=Jt,Jt|=4;try{kA(i,o,l)}finally{Jt=C,G.p=y,$.T=u}}$n=1,K_(),W_(),X_()}}function K_(){if($n===1){$n=0;var i=zr,o=za,l=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||l){l=$.T,$.T=null;var u=G.p;G.p=2;var y=Jt;Jt|=4;try{R_(o,i);var x=Pp,C=Ly(i.containerInfo),V=x.focusedElem,W=x.selectionRange;if(C!==V&&V&&V.ownerDocument&&Py(V.ownerDocument.documentElement,V)){if(W!==null&&rf(V)){var oe=W.start,me=W.end;if(me===void 0&&(me=oe),"selectionStart"in V)V.selectionStart=oe,V.selectionEnd=Math.min(me,V.value.length);else{var _e=V.ownerDocument||document,le=_e&&_e.defaultView||window;if(le.getSelection){var he=le.getSelection(),Ge=V.textContent.length,lt=Math.min(W.start,Ge),sn=W.end===void 0?lt:Math.min(W.end,Ge);!he.extend&&lt>sn&&(C=sn,sn=lt,lt=C);var ne=Dy(V,lt),Z=Dy(V,sn);if(ne&&Z&&(he.rangeCount!==1||he.anchorNode!==ne.node||he.anchorOffset!==ne.offset||he.focusNode!==Z.node||he.focusOffset!==Z.offset)){var re=_e.createRange();re.setStart(ne.node,ne.offset),he.removeAllRanges(),lt>sn?(he.addRange(re),he.extend(Z.node,Z.offset)):(re.setEnd(Z.node,Z.offset),he.addRange(re))}}}}for(_e=[],he=V;he=he.parentNode;)he.nodeType===1&&_e.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<_e.length;V++){var ye=_e[V];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}yd=!!Dp,Pp=Dp=null}finally{Jt=y,G.p=u,$.T=l}}i.current=o,$n=2}}function W_(){if($n===2){$n=0;var i=zr,o=za,l=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||l){l=$.T,$.T=null;var u=G.p;G.p=2;var y=Jt;Jt|=4;try{w_(i,o.alternate,o)}finally{Jt=y,G.p=u,$.T=l}}$n=3}}function X_(){if($n===4||$n===3){$n=0,Gt();var i=zr,o=za,l=or,u=U_;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?$n=5:($n=0,za=zr=null,Q_(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(Br=null),Te(l),o=o.stateNode,an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Ln,o,void 0,(o.current.flags&128)===128)}catch{}if(u!==null){o=$.T,y=G.p,G.p=2,$.T=null;try{for(var x=i.onRecoverableError,C=0;C<u.length;C++){var V=u[C];x(V.value,{componentStack:V.stack})}}finally{$.T=o,G.p=y}}(or&3)!==0&&rd(),Ii(i),y=i.pendingLanes,(l&261930)!==0&&(y&42)!==0?i===xp?lc++:(lc=0,xp=i):lc=0,cc(0)}}function Q_(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,ql(o)))}function rd(){return K_(),W_(),X_(),Z_()}function Z_(){if($n!==5)return!1;var i=zr,o=vp;vp=0;var l=Te(or),u=$.T,y=G.p;try{G.p=32>l?32:l,$.T=null,l=_p,_p=null;var x=zr,C=or;if($n=0,za=zr=null,or=0,(Jt&6)!==0)throw Error(s(331));var V=Jt;if(Jt|=4,P_(x.current),M_(x,x.current,C,l),Jt=V,cc(0,!1),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Ln,x)}catch{}return!0}finally{G.p=y,$.T=u,Q_(i,o)}}function e0(i,o,l){o=$s(l,o),o=Qf(i.stateNode,o,2),i=Dr(i,o,2),i!==null&&(Me(i,2),Ii(i))}function Zt(i,o,l){if(i.tag===3)e0(i,i,l);else for(;o!==null;){if(o.tag===3){e0(o,i,l);break}else if(o.tag===1){var u=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Br===null||!Br.has(u))){i=$s(l,i),l=t_(2),u=Dr(o,l,2),u!==null&&(n_(l,u,o,i),Me(u,2),Ii(u));break}}o=o.return}}function Tp(i,o,l){var u=i.pingCache;if(u===null){u=i.pingCache=new LA;var y=new Set;u.set(o,y)}else y=u.get(o),y===void 0&&(y=new Set,u.set(o,y));y.has(l)||(mp=!0,y.add(l),i=zA.bind(null,i,o,l),o.then(i,i))}function zA(i,o,l){var u=i.pingCache;u!==null&&u.delete(o),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,cn===i&&(Mt&l)===l&&(Cn===4||Cn===3&&(Mt&62914560)===Mt&&300>ct()-Zu?(Jt&2)===0&&ja(i,0):gp|=l,Ba===Mt&&(Ba=0)),Ii(i)}function t0(i,o){o===0&&(o=Xe()),i=ko(i,o),i!==null&&(Me(i,o),Ii(i))}function jA(i){var o=i.memoizedState,l=0;o!==null&&(l=o.retryLane),t0(i,l)}function FA(i,o){var l=0;switch(i.tag){case 31:case 13:var u=i.stateNode,y=i.memoizedState;y!==null&&(l=y.retryLane);break;case 19:u=i.stateNode;break;case 22:u=i.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(o),t0(i,l)}function qA(i,o){return rt(i,o)}var od=null,qa=null,wp=!1,ad=!1,Cp=!1,Fr=0;function Ii(i){i!==qa&&i.next===null&&(qa===null?od=qa=i:qa=qa.next=i),ad=!0,wp||(wp=!0,GA())}function cc(i,o){if(!Cp&&ad){Cp=!0;do for(var l=!1,u=od;u!==null;){if(i!==0){var y=u.pendingLanes;if(y===0)var x=0;else{var C=u.suspendedLanes,V=u.pingedLanes;x=(1<<31-Ct(42|i)+1)-1,x&=y&~(C&~V),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(l=!0,r0(u,x))}else x=Mt,x=wt(u,u===cn?x:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(x&3)===0||Qe(u,x)||(l=!0,r0(u,x));u=u.next}while(l);Cp=!1}}function HA(){n0()}function n0(){ad=wp=!1;var i=0;Fr!==0&&t1()&&(i=Fr);for(var o=ct(),l=null,u=od;u!==null;){var y=u.next,x=s0(u,o);x===0?(u.next=null,l===null?od=y:l.next=y,y===null&&(qa=l)):(l=u,(i!==0||(x&3)!==0)&&(ad=!0)),u=y}$n!==0&&$n!==5||cc(i),Fr!==0&&(Fr=0)}function s0(i,o){for(var l=i.suspendedLanes,u=i.pingedLanes,y=i.expirationTimes,x=i.pendingLanes&-62914561;0<x;){var C=31-Ct(x),V=1<<C,W=y[C];W===-1?((V&l)===0||(V&u)!==0)&&(y[C]=we(V,o)):W<=o&&(i.expiredLanes|=V),x&=~V}if(o=cn,l=Mt,l=wt(i,i===o?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u=i.callbackNode,l===0||i===o&&(Qt===2||Qt===9)||i.cancelPendingCommit!==null)return u!==null&&u!==null&&St(u),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||Qe(i,l)){if(o=l&-l,o===i.callbackPriority)return o;switch(u!==null&&St(u),Te(l)){case 2:case 8:l=ot;break;case 32:l=Vt;break;case 268435456:l=rn;break;default:l=Vt}return u=i0.bind(null,i),l=rt(l,u),i.callbackPriority=o,i.callbackNode=l,o}return u!==null&&u!==null&&St(u),i.callbackPriority=2,i.callbackNode=null,2}function i0(i,o){if($n!==0&&$n!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(rd()&&i.callbackNode!==l)return null;var u=Mt;return u=wt(i,i===cn?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u===0?null:(B_(i,u,o),s0(i,ct()),i.callbackNode!=null&&i.callbackNode===l?i0.bind(null,i):null)}function r0(i,o){if(rd())return null;B_(i,o,!0)}function GA(){s1(function(){(Jt&6)!==0?rt(qe,HA):n0()})}function Sp(){if(Fr===0){var i=Ia;i===0&&(i=Pe,Pe<<=1,(Pe&261888)===0&&(Pe=256)),Fr=i}return Fr}function o0(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:fa(""+i)}function a0(i,o){var l=o.ownerDocument.createElement("input");return l.name=o.name,l.value=o.value,i.id&&l.setAttribute("form",i.id),o.parentNode.insertBefore(l,o),i=new FormData(i),l.parentNode.removeChild(l),i}function $A(i,o,l,u,y){if(o==="submit"&&l&&l.stateNode===y){var x=o0((y[dt]||null).action),C=u.submitter;C&&(o=(o=C[dt]||null)?o0(o.formAction):C.getAttribute("formAction"),o!==null&&(x=o,C=null));var V=new bi("action","action",null,u,y);i.push({event:V,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Fr!==0){var W=C?a0(y,C):new FormData(y);$f(l,{pending:!0,data:W,method:y.method,action:x},null,W)}}else typeof x=="function"&&(V.preventDefault(),W=C?a0(y,C):new FormData(y),$f(l,{pending:!0,data:W,method:y.method,action:x},x,W))},currentTarget:y}]})}}for(var Ap=0;Ap<cf.length;Ap++){var Ip=cf[Ap],YA=Ip.toLowerCase(),JA=Ip[0].toUpperCase()+Ip.slice(1);ui(YA,"on"+JA)}ui(Oy,"onAnimationEnd"),ui(By,"onAnimationIteration"),ui(zy,"onAnimationStart"),ui("dblclick","onDoubleClick"),ui("focusin","onFocus"),ui("focusout","onBlur"),ui(uA,"onTransitionRun"),ui(dA,"onTransitionStart"),ui(hA,"onTransitionCancel"),ui(jy,"onTransitionEnd"),ps("onMouseEnter",["mouseout","mouseover"]),ps("onMouseLeave",["mouseout","mouseover"]),ps("onPointerEnter",["pointerout","pointerover"]),ps("onPointerLeave",["pointerout","pointerover"]),bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bs("onBeforeInput",["compositionend","keypress","textInput","paste"]),bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(uc));function l0(i,o){o=(o&4)!==0;for(var l=0;l<i.length;l++){var u=i[l],y=u.event;u=u.listeners;e:{var x=void 0;if(o)for(var C=u.length-1;0<=C;C--){var V=u[C],W=V.instance,oe=V.currentTarget;if(V=V.listener,W!==x&&y.isPropagationStopped())break e;x=V,y.currentTarget=oe;try{x(y)}catch(me){Eu(me)}y.currentTarget=null,x=W}else for(C=0;C<u.length;C++){if(V=u[C],W=V.instance,oe=V.currentTarget,V=V.listener,W!==x&&y.isPropagationStopped())break e;x=V,y.currentTarget=oe;try{x(y)}catch(me){Eu(me)}y.currentTarget=null,x=W}}}}function Nt(i,o){var l=o[jt];l===void 0&&(l=o[jt]=new Set);var u=i+"__bubble";l.has(u)||(c0(o,i,2,!1),l.add(u))}function Rp(i,o,l){var u=0;o&&(u|=4),c0(l,i,u,o)}var ld="_reactListening"+Math.random().toString(36).slice(2);function Np(i){if(!i[ld]){i[ld]=!0,Ns.forEach(function(l){l!=="selectionchange"&&(KA.has(l)||Rp(l,!1,i),Rp(l,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[ld]||(o[ld]=!0,Rp("selectionchange",!1,o))}}function c0(i,o,l,u){switch(O0(o)){case 2:var y=T1;break;case 8:y=w1;break;default:y=Gp}l=y.bind(null,o,l,i),y=void 0,!wo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),u?y!==void 0?i.addEventListener(o,l,{capture:!0,passive:y}):i.addEventListener(o,l,!0):y!==void 0?i.addEventListener(o,l,{passive:y}):i.addEventListener(o,l,!1)}function Mp(i,o,l,u,y){var x=u;if((o&1)===0&&(o&2)===0&&u!==null)e:for(;;){if(u===null)return;var C=u.tag;if(C===3||C===4){var V=u.stateNode.containerInfo;if(V===y)break;if(C===4)for(C=u.return;C!==null;){var W=C.tag;if((W===3||W===4)&&C.stateNode.containerInfo===y)return;C=C.return}for(;V!==null;){if(C=Xn(V),C===null)return;if(W=C.tag,W===5||W===6||W===26||W===27){u=x=C;continue e}V=V.parentNode}}u=u.return}Tr(function(){var oe=x,me=Fs(l),_e=[];e:{var le=Fy.get(i);if(le!==void 0){var he=bi,Ge=i;switch(i){case"keypress":if(So(l)===0)break e;case"keydown":case"keyup":he=_u;break;case"focusin":Ge="focus",he=Io;break;case"focusout":Ge="blur",he=Io;break;case"beforeblur":case"afterblur":he=Io;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Ll;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=uu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=w;break;case Oy:case By:case zy:he=hu;break;case jy:he=B;break;case"scroll":case"scrollend":he=Pl;break;case"wheel":he=ue;break;case"copy":case"cut":case"paste":he=fu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=$i;break;case"toggle":case"beforetoggle":he=xt}var lt=(o&4)!==0,sn=!lt&&(i==="scroll"||i==="scrollend"),ne=lt?le!==null?le+"Capture":null:le;lt=[];for(var Z=oe,re;Z!==null;){var ye=Z;if(re=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||re===null||ne===null||(ye=oi(Z,ne),ye!=null&&lt.push(dc(Z,ye,re))),sn)break;Z=Z.return}0<lt.length&&(le=new he(le,Ge,null,l,me),_e.push({event:le,listeners:lt}))}}if((o&7)===0){e:{if(le=i==="mouseover"||i==="pointerover",he=i==="mouseout"||i==="pointerout",le&&l!==Ml&&(Ge=l.relatedTarget||l.fromElement)&&(Xn(Ge)||Ge[It]))break e;if((he||le)&&(le=me.window===me?me:(le=me.ownerDocument)?le.defaultView||le.parentWindow:window,he?(Ge=l.relatedTarget||l.toElement,he=oe,Ge=Ge?Xn(Ge):null,Ge!==null&&(sn=a(Ge),lt=Ge.tag,Ge!==sn||lt!==5&&lt!==27&&lt!==6)&&(Ge=null)):(he=null,Ge=oe),he!==Ge)){if(lt=Ll,ye="onMouseLeave",ne="onMouseEnter",Z="mouse",(i==="pointerout"||i==="pointerover")&&(lt=$i,ye="onPointerLeave",ne="onPointerEnter",Z="pointer"),sn=he==null?le:Jn(he),re=Ge==null?le:Jn(Ge),le=new lt(ye,Z+"leave",he,l,me),le.target=sn,le.relatedTarget=re,ye=null,Xn(me)===oe&&(lt=new lt(ne,Z+"enter",Ge,l,me),lt.target=re,lt.relatedTarget=sn,ye=lt),sn=ye,he&&Ge)t:{for(lt=WA,ne=he,Z=Ge,re=0,ye=ne;ye;ye=lt(ye))re++;ye=0;for(var nt=Z;nt;nt=lt(nt))ye++;for(;0<re-ye;)ne=lt(ne),re--;for(;0<ye-re;)Z=lt(Z),ye--;for(;re--;){if(ne===Z||Z!==null&&ne===Z.alternate){lt=ne;break t}ne=lt(ne),Z=lt(Z)}lt=null}else lt=null;he!==null&&u0(_e,le,he,lt,!1),Ge!==null&&sn!==null&&u0(_e,sn,Ge,lt,!0)}}e:{if(le=oe?Jn(oe):window,he=le.nodeName&&le.nodeName.toLowerCase(),he==="select"||he==="input"&&le.type==="file")var Ft=Ay;else if(Cy(le))if(Iy)Ft=aA;else{Ft=rA;var Ze=iA}else he=le.nodeName,!he||he.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?oe&&ha(oe.elementType)&&(Ft=Ay):Ft=oA;if(Ft&&(Ft=Ft(i,oe))){Sy(_e,Ft,l,me);break e}Ze&&Ze(i,le,oe),i==="focusout"&&oe&&le.type==="number"&&oe.memoizedProps.value!=null&&Il(le,"number",le.value)}switch(Ze=oe?Jn(oe):window,i){case"focusin":(Cy(Ze)||Ze.contentEditable==="true")&&(xa=Ze,of=oe,zl=null);break;case"focusout":zl=of=xa=null;break;case"mousedown":af=!0;break;case"contextmenu":case"mouseup":case"dragend":af=!1,Vy(_e,l,me);break;case"selectionchange":if(cA)break;case"keydown":case"keyup":Vy(_e,l,me)}var Tt;if(Yt)e:{switch(i){case"compositionstart":var kt="onCompositionStart";break e;case"compositionend":kt="onCompositionEnd";break e;case"compositionupdate":kt="onCompositionUpdate";break e}kt=void 0}else _a?Ro(i,l)&&(kt="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(kt="onCompositionStart");kt&&(wi&&l.locale!=="ko"&&(_a||kt!=="onCompositionStart"?kt==="onCompositionEnd"&&_a&&(Tt=Dl()):(xi=me,kl="value"in xi?xi.value:xi.textContent,_a=!0)),Ze=cd(oe,kt),0<Ze.length&&(kt=new Ti(kt,i,null,l,me),_e.push({event:kt,listeners:Ze}),Tt?kt.data=Tt:(Tt=va(l),Tt!==null&&(kt.data=Tt)))),(Tt=Hs?eA(i,l):tA(i,l))&&(kt=cd(oe,"onBeforeInput"),0<kt.length&&(Ze=new Ti("onBeforeInput","beforeinput",null,l,me),_e.push({event:Ze,listeners:kt}),Ze.data=Tt)),$A(_e,i,oe,l,me)}l0(_e,o)})}function dc(i,o,l){return{instance:i,listener:o,currentTarget:l}}function cd(i,o){for(var l=o+"Capture",u=[];i!==null;){var y=i,x=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||x===null||(y=oi(i,l),y!=null&&u.unshift(dc(i,y,x)),y=oi(i,o),y!=null&&u.push(dc(i,y,x))),i.tag===3)return u;i=i.return}return[]}function WA(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function u0(i,o,l,u,y){for(var x=o._reactName,C=[];l!==null&&l!==u;){var V=l,W=V.alternate,oe=V.stateNode;if(V=V.tag,W!==null&&W===u)break;V!==5&&V!==26&&V!==27||oe===null||(W=oe,y?(oe=oi(l,x),oe!=null&&C.unshift(dc(l,oe,W))):y||(oe=oi(l,x),oe!=null&&C.push(dc(l,oe,W)))),l=l.return}C.length!==0&&i.push({event:o,listeners:C})}var XA=/\r\n?/g,QA=/\u0000|\uFFFD/g;function d0(i){return(typeof i=="string"?i:""+i).replace(XA,`
`).replace(QA,"")}function h0(i,o){return o=d0(o),d0(i)===o}function nn(i,o,l,u,y,x){switch(l){case"children":typeof u=="string"?o==="body"||o==="textarea"&&u===""||Es(i,u):(typeof u=="number"||typeof u=="bigint")&&o!=="body"&&Es(i,""+u);break;case"className":ms(i,"class",u);break;case"tabIndex":ms(i,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":ms(i,l,u);break;case"style":Nl(i,u,x);break;case"data":if(o!=="object"){ms(i,"data",u);break}case"src":case"href":if(u===""&&(o!=="a"||l!=="href")){i.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=fa(""+u),i.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(l==="formAction"?(o!=="input"&&nn(i,o,"name",y.name,y,null),nn(i,o,"formEncType",y.formEncType,y,null),nn(i,o,"formMethod",y.formMethod,y,null),nn(i,o,"formTarget",y.formTarget,y,null)):(nn(i,o,"encType",y.encType,y,null),nn(i,o,"method",y.method,y,null),nn(i,o,"target",y.target,y,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=fa(""+u),i.setAttribute(l,u);break;case"onClick":u!=null&&(i.onclick=ri);break;case"onScroll":u!=null&&Nt("scroll",i);break;case"onScrollEnd":u!=null&&Nt("scrollend",i);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(l=u.__html,l!=null){if(y.children!=null)throw Error(s(60));i.innerHTML=l}}break;case"multiple":i.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":i.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){i.removeAttribute("xlink:href");break}l=fa(""+u),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""+u):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":u===!0?i.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,u):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?i.setAttribute(l,u):i.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?i.removeAttribute(l):i.setAttribute(l,u);break;case"popover":Nt("beforetoggle",i),Nt("toggle",i),vr(i,"popover",u);break;case"xlinkActuate":Tn(i,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Tn(i,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Tn(i,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Tn(i,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Tn(i,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Tn(i,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Tn(i,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Tn(i,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Tn(i,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":vr(i,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=cu.get(l)||l,vr(i,l,u))}}function kp(i,o,l,u,y,x){switch(l){case"style":Nl(i,u,x);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(l=u.__html,l!=null){if(y.children!=null)throw Error(s(60));i.innerHTML=l}}break;case"children":typeof u=="string"?Es(i,u):(typeof u=="number"||typeof u=="bigint")&&Es(i,""+u);break;case"onScroll":u!=null&&Nt("scroll",i);break;case"onScrollEnd":u!=null&&Nt("scrollend",i);break;case"onClick":u!=null&&(i.onclick=ri);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ni.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(y=l.endsWith("Capture"),o=l.slice(2,y?l.length-7:void 0),x=i[dt]||null,x=x!=null?x[l]:null,typeof x=="function"&&i.removeEventListener(o,x,y),typeof u=="function")){typeof x!="function"&&x!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(o,u,y);break e}l in i?i[l]=u:u===!0?i.setAttribute(l,""):vr(i,l,u)}}}function ns(i,o,l){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Nt("error",i),Nt("load",i);var u=!1,y=!1,x;for(x in l)if(l.hasOwnProperty(x)){var C=l[x];if(C!=null)switch(x){case"src":u=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:nn(i,o,x,C,l,null)}}y&&nn(i,o,"srcSet",l.srcSet,l,null),u&&nn(i,o,"src",l.src,l,null);return;case"input":Nt("invalid",i);var V=x=C=y=null,W=null,oe=null;for(u in l)if(l.hasOwnProperty(u)){var me=l[u];if(me!=null)switch(u){case"name":y=me;break;case"type":C=me;break;case"checked":W=me;break;case"defaultChecked":oe=me;break;case"value":x=me;break;case"defaultValue":V=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(s(137,o));break;default:nn(i,o,u,me,l,null)}}os(i,x,V,W,oe,C,y,!1);return;case"select":Nt("invalid",i),u=C=x=null;for(y in l)if(l.hasOwnProperty(y)&&(V=l[y],V!=null))switch(y){case"value":x=V;break;case"defaultValue":C=V;break;case"multiple":u=V;default:nn(i,o,y,V,l,null)}o=x,l=C,i.multiple=!!u,o!=null?_r(i,!!u,o,!1):l!=null&&_r(i,!!u,l,!0);return;case"textarea":Nt("invalid",i),x=y=u=null;for(C in l)if(l.hasOwnProperty(C)&&(V=l[C],V!=null))switch(C){case"value":u=V;break;case"defaultValue":y=V;break;case"children":x=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(91));break;default:nn(i,o,C,V,l,null)}xr(i,u,y,x);return;case"option":for(W in l)if(l.hasOwnProperty(W)&&(u=l[W],u!=null))switch(W){case"selected":i.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:nn(i,o,W,u,l,null)}return;case"dialog":Nt("beforetoggle",i),Nt("toggle",i),Nt("cancel",i),Nt("close",i);break;case"iframe":case"object":Nt("load",i);break;case"video":case"audio":for(u=0;u<uc.length;u++)Nt(uc[u],i);break;case"image":Nt("error",i),Nt("load",i);break;case"details":Nt("toggle",i);break;case"embed":case"source":case"link":Nt("error",i),Nt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in l)if(l.hasOwnProperty(oe)&&(u=l[oe],u!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:nn(i,o,oe,u,l,null)}return;default:if(ha(o)){for(me in l)l.hasOwnProperty(me)&&(u=l[me],u!==void 0&&kp(i,o,me,u,l,void 0));return}}for(V in l)l.hasOwnProperty(V)&&(u=l[V],u!=null&&nn(i,o,V,u,l,null))}function ZA(i,o,l,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,x=null,C=null,V=null,W=null,oe=null,me=null;for(he in l){var _e=l[he];if(l.hasOwnProperty(he)&&_e!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":W=_e;default:u.hasOwnProperty(he)||nn(i,o,he,null,u,_e)}}for(var le in u){var he=u[le];if(_e=l[le],u.hasOwnProperty(le)&&(he!=null||_e!=null))switch(le){case"type":x=he;break;case"name":y=he;break;case"checked":oe=he;break;case"defaultChecked":me=he;break;case"value":C=he;break;case"defaultValue":V=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(s(137,o));break;default:he!==_e&&nn(i,o,le,he,u,_e)}}Gn(i,C,V,W,oe,me,x,y);return;case"select":he=C=V=le=null;for(x in l)if(W=l[x],l.hasOwnProperty(x)&&W!=null)switch(x){case"value":break;case"multiple":he=W;default:u.hasOwnProperty(x)||nn(i,o,x,null,u,W)}for(y in u)if(x=u[y],W=l[y],u.hasOwnProperty(y)&&(x!=null||W!=null))switch(y){case"value":le=x;break;case"defaultValue":V=x;break;case"multiple":C=x;default:x!==W&&nn(i,o,y,x,u,W)}o=V,l=C,u=he,le!=null?_r(i,!!l,le,!1):!!u!=!!l&&(o!=null?_r(i,!!l,o,!0):_r(i,!!l,l?[]:"",!1));return;case"textarea":he=le=null;for(V in l)if(y=l[V],l.hasOwnProperty(V)&&y!=null&&!u.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:nn(i,o,V,null,u,y)}for(C in u)if(y=u[C],x=l[C],u.hasOwnProperty(C)&&(y!=null||x!=null))switch(C){case"value":le=y;break;case"defaultValue":he=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(s(91));break;default:y!==x&&nn(i,o,C,y,u,x)}au(i,le,he);return;case"option":for(var Ge in l)if(le=l[Ge],l.hasOwnProperty(Ge)&&le!=null&&!u.hasOwnProperty(Ge))switch(Ge){case"selected":i.selected=!1;break;default:nn(i,o,Ge,null,u,le)}for(W in u)if(le=u[W],he=l[W],u.hasOwnProperty(W)&&le!==he&&(le!=null||he!=null))switch(W){case"selected":i.selected=le&&typeof le!="function"&&typeof le!="symbol";break;default:nn(i,o,W,le,u,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var lt in l)le=l[lt],l.hasOwnProperty(lt)&&le!=null&&!u.hasOwnProperty(lt)&&nn(i,o,lt,null,u,le);for(oe in u)if(le=u[oe],he=l[oe],u.hasOwnProperty(oe)&&le!==he&&(le!=null||he!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(s(137,o));break;default:nn(i,o,oe,le,u,he)}return;default:if(ha(o)){for(var sn in l)le=l[sn],l.hasOwnProperty(sn)&&le!==void 0&&!u.hasOwnProperty(sn)&&kp(i,o,sn,void 0,u,le);for(me in u)le=u[me],he=l[me],!u.hasOwnProperty(me)||le===he||le===void 0&&he===void 0||kp(i,o,me,le,u,he);return}}for(var ne in l)le=l[ne],l.hasOwnProperty(ne)&&le!=null&&!u.hasOwnProperty(ne)&&nn(i,o,ne,null,u,le);for(_e in u)le=u[_e],he=l[_e],!u.hasOwnProperty(_e)||le===he||le==null&&he==null||nn(i,o,_e,le,u,he)}function f0(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function e1(){if(typeof performance.getEntriesByType=="function"){for(var i=0,o=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var y=l[u],x=y.transferSize,C=y.initiatorType,V=y.duration;if(x&&V&&f0(C)){for(C=0,V=y.responseEnd,u+=1;u<l.length;u++){var W=l[u],oe=W.startTime;if(oe>V)break;var me=W.transferSize,_e=W.initiatorType;me&&f0(_e)&&(W=W.responseEnd,C+=me*(W<V?1:(V-oe)/(W-oe)))}if(--u,o+=8*(x+C)/(y.duration/1e3),i++,10<i)break}}if(0<i)return o/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Dp=null,Pp=null;function ud(i){return i.nodeType===9?i:i.ownerDocument}function p0(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function m0(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function Lp(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Vp=null;function t1(){var i=window.event;return i&&i.type==="popstate"?i===Vp?!1:(Vp=i,!0):(Vp=null,!1)}var g0=typeof setTimeout=="function"?setTimeout:void 0,n1=typeof clearTimeout=="function"?clearTimeout:void 0,y0=typeof Promise=="function"?Promise:void 0,s1=typeof queueMicrotask=="function"?queueMicrotask:typeof y0<"u"?function(i){return y0.resolve(null).then(i).catch(i1)}:g0;function i1(i){setTimeout(function(){throw i})}function qr(i){return i==="head"}function v0(i,o){var l=o,u=0;do{var y=l.nextSibling;if(i.removeChild(l),y&&y.nodeType===8)if(l=y.data,l==="/$"||l==="/&"){if(u===0){i.removeChild(y),Ya(o);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")hc(i.ownerDocument.documentElement);else if(l==="head"){l=i.ownerDocument.head,hc(l);for(var x=l.firstChild;x;){var C=x.nextSibling,V=x.nodeName;x[un]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&x.rel.toLowerCase()==="stylesheet"||l.removeChild(x),x=C}}else l==="body"&&hc(i.ownerDocument.body);l=y}while(l);Ya(o)}function _0(i,o){var l=i;i=0;do{var u=l.nextSibling;if(l.nodeType===1?o?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(o?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(i===0)break;i--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||i++;l=u}while(l)}function Up(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var l=o;switch(o=o.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Up(l),xs(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function r1(i,o,l,u){for(;i.nodeType===1;){var y=l;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!u&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(u){if(!i[un])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(x=i.getAttribute("rel"),x==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(x!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(x=i.getAttribute("src"),(x!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&x&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var x=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===x)return i}else return i;if(i=Xs(i.nextSibling),i===null)break}return null}function o1(i,o,l){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=Xs(i.nextSibling),i===null))return null;return i}function x0(i,o){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Xs(i.nextSibling),i===null))return null;return i}function Op(i){return i.data==="$?"||i.data==="$~"}function Bp(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function a1(i,o){var l=i.ownerDocument;if(i.data==="$~")i._reactRetry=o;else if(i.data!=="$?"||l.readyState!=="loading")o();else{var u=function(){o(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),i._reactRetry=u}}function Xs(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return i}var zp=null;function b0(i){i=i.nextSibling;for(var o=0;i;){if(i.nodeType===8){var l=i.data;if(l==="/$"||l==="/&"){if(o===0)return Xs(i.nextSibling);o--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||o++}i=i.nextSibling}return null}function E0(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(o===0)return i;o--}else l!=="/$"&&l!=="/&"||o++}i=i.previousSibling}return null}function T0(i,o,l){switch(o=ud(l),i){case"html":if(i=o.documentElement,!i)throw Error(s(452));return i;case"head":if(i=o.head,!i)throw Error(s(453));return i;case"body":if(i=o.body,!i)throw Error(s(454));return i;default:throw Error(s(451))}}function hc(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);xs(i)}var Qs=new Map,w0=new Set;function dd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var ar=G.d;G.d={f:l1,r:c1,D:u1,C:d1,L:h1,m:f1,X:m1,S:p1,M:g1};function l1(){var i=ar.f(),o=nd();return i||o}function c1(i){var o=Hn(i);o!==null&&o.tag===5&&o.type==="form"?jv(o):ar.r(i)}var Ha=typeof document>"u"?null:document;function C0(i,o,l){var u=Ha;if(u&&typeof o=="string"&&o){var y=mt(o);y='link[rel="'+i+'"][href="'+y+'"]',typeof l=="string"&&(y+='[crossorigin="'+l+'"]'),w0.has(y)||(w0.add(y),i={rel:i,crossOrigin:l,href:o},u.querySelector(y)===null&&(o=u.createElement("link"),ns(o,"link",i),dn(o),u.head.appendChild(o)))}}function u1(i){ar.D(i),C0("dns-prefetch",i,null)}function d1(i,o){ar.C(i,o),C0("preconnect",i,o)}function h1(i,o,l){ar.L(i,o,l);var u=Ha;if(u&&i&&o){var y='link[rel="preload"][as="'+mt(o)+'"]';o==="image"&&l&&l.imageSrcSet?(y+='[imagesrcset="'+mt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(y+='[imagesizes="'+mt(l.imageSizes)+'"]')):y+='[href="'+mt(i)+'"]';var x=y;switch(o){case"style":x=Ga(i);break;case"script":x=$a(i)}Qs.has(x)||(i=b({rel:"preload",href:o==="image"&&l&&l.imageSrcSet?void 0:i,as:o},l),Qs.set(x,i),u.querySelector(y)!==null||o==="style"&&u.querySelector(fc(x))||o==="script"&&u.querySelector(pc(x))||(o=u.createElement("link"),ns(o,"link",i),dn(o),u.head.appendChild(o)))}}function f1(i,o){ar.m(i,o);var l=Ha;if(l&&i){var u=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+mt(u)+'"][href="'+mt(i)+'"]',x=y;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=$a(i)}if(!Qs.has(x)&&(i=b({rel:"modulepreload",href:i},o),Qs.set(x,i),l.querySelector(y)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(pc(x)))return}u=l.createElement("link"),ns(u,"link",i),dn(u),l.head.appendChild(u)}}}function p1(i,o,l){ar.S(i,o,l);var u=Ha;if(u&&i){var y=fs(u).hoistableStyles,x=Ga(i);o=o||"default";var C=y.get(x);if(!C){var V={loading:0,preload:null};if(C=u.querySelector(fc(x)))V.loading=5;else{i=b({rel:"stylesheet",href:i,"data-precedence":o},l),(l=Qs.get(x))&&jp(i,l);var W=C=u.createElement("link");dn(W),ns(W,"link",i),W._p=new Promise(function(oe,me){W.onload=oe,W.onerror=me}),W.addEventListener("load",function(){V.loading|=1}),W.addEventListener("error",function(){V.loading|=2}),V.loading|=4,hd(C,o,u)}C={type:"stylesheet",instance:C,count:1,state:V},y.set(x,C)}}}function m1(i,o){ar.X(i,o);var l=Ha;if(l&&i){var u=fs(l).hoistableScripts,y=$a(i),x=u.get(y);x||(x=l.querySelector(pc(y)),x||(i=b({src:i,async:!0},o),(o=Qs.get(y))&&Fp(i,o),x=l.createElement("script"),dn(x),ns(x,"link",i),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},u.set(y,x))}}function g1(i,o){ar.M(i,o);var l=Ha;if(l&&i){var u=fs(l).hoistableScripts,y=$a(i),x=u.get(y);x||(x=l.querySelector(pc(y)),x||(i=b({src:i,async:!0,type:"module"},o),(o=Qs.get(y))&&Fp(i,o),x=l.createElement("script"),dn(x),ns(x,"link",i),l.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},u.set(y,x))}}function S0(i,o,l,u){var y=(y=be.current)?dd(y):null;if(!y)throw Error(s(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(o=Ga(l.href),l=fs(y).hoistableStyles,u=l.get(o),u||(u={type:"style",instance:null,count:0,state:null},l.set(o,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=Ga(l.href);var x=fs(y).hoistableStyles,C=x.get(i);if(C||(y=y.ownerDocument||y,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(i,C),(x=y.querySelector(fc(i)))&&!x._p&&(C.instance=x,C.state.loading=5),Qs.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Qs.set(i,l),x||y1(y,i,l,C.state))),o&&u===null)throw Error(s(528,""));return C}if(o&&u!==null)throw Error(s(529,""));return null;case"script":return o=l.async,l=l.src,typeof l=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=$a(l),l=fs(y).hoistableScripts,u=l.get(o),u||(u={type:"script",instance:null,count:0,state:null},l.set(o,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,i))}}function Ga(i){return'href="'+mt(i)+'"'}function fc(i){return'link[rel="stylesheet"]['+i+"]"}function A0(i){return b({},i,{"data-precedence":i.precedence,precedence:null})}function y1(i,o,l,u){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?u.loading=1:(o=i.createElement("link"),u.preload=o,o.addEventListener("load",function(){return u.loading|=1}),o.addEventListener("error",function(){return u.loading|=2}),ns(o,"link",l),dn(o),i.head.appendChild(o))}function $a(i){return'[src="'+mt(i)+'"]'}function pc(i){return"script[async]"+i}function I0(i,o,l){if(o.count++,o.instance===null)switch(o.type){case"style":var u=i.querySelector('style[data-href~="'+mt(l.href)+'"]');if(u)return o.instance=u,dn(u),u;var y=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(i.ownerDocument||i).createElement("style"),dn(u),ns(u,"style",y),hd(u,l.precedence,i),o.instance=u;case"stylesheet":y=Ga(l.href);var x=i.querySelector(fc(y));if(x)return o.state.loading|=4,o.instance=x,dn(x),x;u=A0(l),(y=Qs.get(y))&&jp(u,y),x=(i.ownerDocument||i).createElement("link"),dn(x);var C=x;return C._p=new Promise(function(V,W){C.onload=V,C.onerror=W}),ns(x,"link",u),o.state.loading|=4,hd(x,l.precedence,i),o.instance=x;case"script":return x=$a(l.src),(y=i.querySelector(pc(x)))?(o.instance=y,dn(y),y):(u=l,(y=Qs.get(x))&&(u=b({},l),Fp(u,y)),i=i.ownerDocument||i,y=i.createElement("script"),dn(y),ns(y,"link",u),i.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(s(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(u=o.instance,o.state.loading|=4,hd(u,l.precedence,i));return o.instance}function hd(i,o,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=u.length?u[u.length-1]:null,x=y,C=0;C<u.length;C++){var V=u[C];if(V.dataset.precedence===o)x=V;else if(x!==y)break}x?x.parentNode.insertBefore(i,x.nextSibling):(o=l.nodeType===9?l.head:l,o.insertBefore(i,o.firstChild))}function jp(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function Fp(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var fd=null;function R0(i,o,l){if(fd===null){var u=new Map,y=fd=new Map;y.set(l,u)}else y=fd,u=y.get(l),u||(u=new Map,y.set(l,u));if(u.has(i))return u;for(u.set(i,null),l=l.getElementsByTagName(i),y=0;y<l.length;y++){var x=l[y];if(!(x[un]||x[Ye]||i==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var C=x.getAttribute(o)||"";C=i+C;var V=u.get(C);V?V.push(x):u.set(C,[x])}}return u}function N0(i,o,l){i=i.ownerDocument||i,i.head.insertBefore(l,o==="title"?i.querySelector("head > title"):null)}function v1(i,o,l){if(l===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function M0(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function _1(i,o,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var y=Ga(u.href),x=o.querySelector(fc(y));if(x){o=x._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(i.count++,i=pd.bind(i),o.then(i,i)),l.state.loading|=4,l.instance=x,dn(x);return}x=o.ownerDocument||o,u=A0(u),(y=Qs.get(y))&&jp(u,y),x=x.createElement("link"),dn(x);var C=x;C._p=new Promise(function(V,W){C.onload=V,C.onerror=W}),ns(x,"link",u),l.instance=x}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(l,o),(o=l.state.preload)&&(l.state.loading&3)===0&&(i.count++,l=pd.bind(i),o.addEventListener("load",l),o.addEventListener("error",l))}}var qp=0;function x1(i,o){return i.stylesheets&&i.count===0&&gd(i,i.stylesheets),0<i.count||0<i.imgCount?function(l){var u=setTimeout(function(){if(i.stylesheets&&gd(i,i.stylesheets),i.unsuspend){var x=i.unsuspend;i.unsuspend=null,x()}},6e4+o);0<i.imgBytes&&qp===0&&(qp=62500*e1());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&gd(i,i.stylesheets),i.unsuspend)){var x=i.unsuspend;i.unsuspend=null,x()}},(i.imgBytes>qp?50:800)+o);return i.unsuspend=l,function(){i.unsuspend=null,clearTimeout(u),clearTimeout(y)}}:null}function pd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)gd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var md=null;function gd(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,md=new Map,o.forEach(b1,i),md=null,pd.call(i))}function b1(i,o){if(!(o.state.loading&4)){var l=md.get(i);if(l)var u=l.get(null);else{l=new Map,md.set(i,l);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<y.length;x++){var C=y[x];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(l.set(C.dataset.precedence,C),u=C)}u&&l.set(null,u)}y=o.instance,C=y.getAttribute("data-precedence"),x=l.get(C)||u,x===u&&l.set(null,y),l.set(C,y),this.count++,u=pd.bind(this),y.addEventListener("load",u),y.addEventListener("error",u),x?x.parentNode.insertBefore(y,x.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),o.state.loading|=4}}var mc={$$typeof:j,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function E1(i,o,l,u,y,x,C,V,W){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=at(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=at(0),this.hiddenUpdates=at(null),this.identifierPrefix=u,this.onUncaughtError=y,this.onCaughtError=x,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function k0(i,o,l,u,y,x,C,V,W,oe,me,_e){return i=new E1(i,o,l,C,W,oe,me,_e,V),o=1,x===!0&&(o|=24),x=ks(3,null,null,o),i.current=x,x.stateNode=i,o=Ef(),o.refCount++,i.pooledCache=o,o.refCount++,x.memoizedState={element:u,isDehydrated:l,cache:o},Sf(x),i}function D0(i){return i?(i=Ta,i):Ta}function P0(i,o,l,u,y,x){y=D0(y),u.context===null?u.context=y:u.pendingContext=y,u=kr(o),u.payload={element:l},x=x===void 0?null:x,x!==null&&(u.callback=x),l=Dr(i,u,o),l!==null&&(As(l,i,o),Yl(l,i,o))}function L0(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<o?l:o}}function Hp(i,o){L0(i,o),(i=i.alternate)&&L0(i,o)}function V0(i){if(i.tag===13||i.tag===31){var o=ko(i,67108864);o!==null&&As(o,i,67108864),Hp(i,67108864)}}function U0(i){if(i.tag===13||i.tag===31){var o=Us();o=de(o);var l=ko(i,o);l!==null&&As(l,i,o),Hp(i,o)}}var yd=!0;function T1(i,o,l,u){var y=$.T;$.T=null;var x=G.p;try{G.p=2,Gp(i,o,l,u)}finally{G.p=x,$.T=y}}function w1(i,o,l,u){var y=$.T;$.T=null;var x=G.p;try{G.p=8,Gp(i,o,l,u)}finally{G.p=x,$.T=y}}function Gp(i,o,l,u){if(yd){var y=$p(u);if(y===null)Mp(i,o,u,vd,l),B0(i,u);else if(S1(y,i,o,l,u))u.stopPropagation();else if(B0(i,u),o&4&&-1<C1.indexOf(i)){for(;y!==null;){var x=Hn(y);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var C=At(x.pendingLanes);if(C!==0){var V=x;for(V.pendingLanes|=2,V.entangledLanes|=2;C;){var W=1<<31-Ct(C);V.entanglements[1]|=W,C&=~W}Ii(x),(Jt&6)===0&&(ed=ct()+500,cc(0))}}break;case 31:case 13:V=ko(x,2),V!==null&&As(V,x,2),nd(),Hp(x,2)}if(x=$p(u),x===null&&Mp(i,o,u,vd,l),x===y)break;y=x}y!==null&&u.stopPropagation()}else Mp(i,o,u,null,l)}}function $p(i){return i=Fs(i),Yp(i)}var vd=null;function Yp(i){if(vd=null,i=Xn(i),i!==null){var o=a(i);if(o===null)i=null;else{var l=o.tag;if(l===13){if(i=c(o),i!==null)return i;i=null}else if(l===31){if(i=d(o),i!==null)return i;i=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return vd=i,null}function O0(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Bt()){case qe:return 2;case ot:return 8;case Vt:case Pn:return 32;case rn:return 268435456;default:return 32}default:return 32}}var Jp=!1,Hr=null,Gr=null,$r=null,gc=new Map,yc=new Map,Yr=[],C1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function B0(i,o){switch(i){case"focusin":case"focusout":Hr=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":$r=null;break;case"pointerover":case"pointerout":gc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":yc.delete(o.pointerId)}}function vc(i,o,l,u,y,x){return i===null||i.nativeEvent!==x?(i={blockedOn:o,domEventName:l,eventSystemFlags:u,nativeEvent:x,targetContainers:[y]},o!==null&&(o=Hn(o),o!==null&&V0(o)),i):(i.eventSystemFlags|=u,o=i.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),i)}function S1(i,o,l,u,y){switch(o){case"focusin":return Hr=vc(Hr,i,o,l,u,y),!0;case"dragenter":return Gr=vc(Gr,i,o,l,u,y),!0;case"mouseover":return $r=vc($r,i,o,l,u,y),!0;case"pointerover":var x=y.pointerId;return gc.set(x,vc(gc.get(x)||null,i,o,l,u,y)),!0;case"gotpointercapture":return x=y.pointerId,yc.set(x,vc(yc.get(x)||null,i,o,l,u,y)),!0}return!1}function z0(i){var o=Xn(i.target);if(o!==null){var l=a(o);if(l!==null){if(o=l.tag,o===13){if(o=c(l),o!==null){i.blockedOn=o,ze(i.priority,function(){U0(l)});return}}else if(o===31){if(o=d(l),o!==null){i.blockedOn=o,ze(i.priority,function(){U0(l)});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function _d(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var l=$p(i.nativeEvent);if(l===null){l=i.nativeEvent;var u=new l.constructor(l.type,l);Ml=u,l.target.dispatchEvent(u),Ml=null}else return o=Hn(l),o!==null&&V0(o),i.blockedOn=l,!1;o.shift()}return!0}function j0(i,o,l){_d(i)&&l.delete(o)}function A1(){Jp=!1,Hr!==null&&_d(Hr)&&(Hr=null),Gr!==null&&_d(Gr)&&(Gr=null),$r!==null&&_d($r)&&($r=null),gc.forEach(j0),yc.forEach(j0)}function xd(i,o){i.blockedOn===o&&(i.blockedOn=null,Jp||(Jp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,A1)))}var bd=null;function F0(i){bd!==i&&(bd=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){bd===i&&(bd=null);for(var o=0;o<i.length;o+=3){var l=i[o],u=i[o+1],y=i[o+2];if(typeof u!="function"){if(Yp(u||l)===null)continue;break}var x=Hn(l);x!==null&&(i.splice(o,3),o-=3,$f(x,{pending:!0,data:y,method:l.method,action:u},u,y))}}))}function Ya(i){function o(W){return xd(W,i)}Hr!==null&&xd(Hr,i),Gr!==null&&xd(Gr,i),$r!==null&&xd($r,i),gc.forEach(o),yc.forEach(o);for(var l=0;l<Yr.length;l++){var u=Yr[l];u.blockedOn===i&&(u.blockedOn=null)}for(;0<Yr.length&&(l=Yr[0],l.blockedOn===null);)z0(l),l.blockedOn===null&&Yr.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var y=l[u],x=l[u+1],C=y[dt]||null;if(typeof x=="function")C||F0(l);else if(C){var V=null;if(x&&x.hasAttribute("formAction")){if(y=x,C=x[dt]||null)V=C.formAction;else if(Yp(y)!==null)continue}else V=C.action;typeof V=="function"?l[u+1]=V:(l.splice(u,3),u-=3),F0(l)}}}function q0(){function i(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(C){return y=C})},focusReset:"manual",scroll:"manual"})}function o(){y!==null&&(y(),y=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),y!==null&&(y(),y=null)}}}function Kp(i){this._internalRoot=i}Ed.prototype.render=Kp.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(s(409));var l=o.current,u=Us();P0(l,u,i,o,null,null)},Ed.prototype.unmount=Kp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;P0(i.current,2,null,i,null,null),nd(),o[It]=null}};function Ed(i){this._internalRoot=i}Ed.prototype.unstable_scheduleHydration=function(i){if(i){var o=Le();i={blockedOn:null,target:i,priority:o};for(var l=0;l<Yr.length&&o!==0&&o<Yr[l].priority;l++);Yr.splice(l,0,i),l===0&&z0(i)}};var H0=e.version;if(H0!=="19.2.0")throw Error(s(527,H0,"19.2.0"));G.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=h(o),i=i!==null?_(i):null,i=i===null?null:i.stateNode,i};var I1={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Td.isDisabled&&Td.supportsFiber)try{Ln=Td.inject(I1),an=Td}catch{}}return xc.createRoot=function(i,o){if(!r(i))throw Error(s(299));var l=!1,u="",y=Xv,x=Qv,C=Zv;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(u=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(C=o.onRecoverableError)),o=k0(i,1,!1,null,null,l,u,null,y,x,C,q0),i[It]=o.current,Np(i),new Kp(o)},xc.hydrateRoot=function(i,o,l){if(!r(i))throw Error(s(299));var u=!1,y="",x=Xv,C=Qv,V=Zv,W=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(C=l.onCaughtError),l.onRecoverableError!==void 0&&(V=l.onRecoverableError),l.formState!==void 0&&(W=l.formState)),o=k0(i,1,!0,o,l??null,u,y,W,x,C,V,q0),o.context=D0(null),l=o.current,u=Us(),u=de(u),y=kr(u),y.callback=null,Dr(l,y,u),l=u,o.current.lanes=l,Me(o,l),Ii(o),i[It]=o.current,Np(i),new Ed(o)},xc.version="19.2.0",xc}var ex;function O1(){if(ex)return Qp.exports;ex=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Qp.exports=U1(),Qp.exports}var B1=O1();const z1=ST(B1);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let j1,F1;function q1(){return{geminiUrl:j1,vertexUrl:F1}}function H1(t,e,n,s){var r,a;if(!(t!=null&&t.baseUrl)){const c=q1();return e?(r=c.vertexUrl)!==null&&r!==void 0?r:n:(a=c.geminiUrl)!==null&&a!==void 0?a:s}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aa{}function Je(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(s,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const a=e[r];return a!=null?String(a):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function v(t,e,n){for(let a=0;a<e.length-1;a++){const c=e[a];if(c.endsWith("[]")){const d=c.slice(0,-2);if(!(d in t))if(Array.isArray(n))t[d]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(t[d])){const f=t[d];if(Array.isArray(n))for(let h=0;h<f.length;h++){const _=f[h];v(_,e.slice(a+1),n[h])}else for(const h of f)v(h,e.slice(a+1),n)}return}else if(c.endsWith("[0]")){const d=c.slice(0,-3);d in t||(t[d]=[{}]);const f=t[d];v(f[0],e.slice(a+1),n);return}(!t[c]||typeof t[c]!="object")&&(t[c]={}),t=t[c]}const s=e[e.length-1],r=t[s];if(r!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===r)return;if(typeof r=="object"&&typeof n=="object"&&r!==null&&n!==null)Object.assign(r,n);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else s==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[s]=n}function p(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let s=0;s<e.length;s++){if(typeof t!="object"||t===null)return n;const r=e[s];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in t){const c=t[a];return Array.isArray(c)?c.map(d=>p(d,e.slice(s+1),n)):n}else return n}else t=t[r]}return t}catch(s){if(s instanceof TypeError)return n;throw s}}function G1(t,e){for(const[n,s]of Object.entries(e)){const r=n.split("."),a=s.split("."),c=new Set;let d=-1;for(let f=0;f<r.length;f++)if(r[f]==="*"){d=f;break}if(d!==-1&&a.length>d)for(let f=d;f<a.length;f++){const h=a[f];h!=="*"&&!h.endsWith("[]")&&!h.endsWith("[0]")&&c.add(h)}xm(t,r,a,0,c)}}function xm(t,e,n,s,r){if(s>=e.length||typeof t!="object"||t===null)return;const a=e[s];if(a.endsWith("[]")){const c=a.slice(0,-2),d=t;if(c in d&&Array.isArray(d[c]))for(const f of d[c])xm(f,e,n,s+1,r)}else if(a==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const c=t,d=Object.keys(c).filter(h=>!h.startsWith("_")&&!r.has(h)),f={};for(const h of d)f[h]=c[h];for(const[h,_]of Object.entries(f)){const b=[];for(const E of n.slice(s))E==="*"?b.push(h):b.push(E);v(c,b,_)}for(const h of d)delete c[h]}}else{const c=t;a in c&&xm(c[a],e,n,s+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hg(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $1(t){const e={},n=p(t,["operationName"]);n!=null&&v(e,["operationName"],n);const s=p(t,["resourceName"]);return s!=null&&v(e,["_url","resourceName"],s),e}function Y1(t){const e={},n=p(t,["name"]);n!=null&&v(e,["name"],n);const s=p(t,["metadata"]);s!=null&&v(e,["metadata"],s);const r=p(t,["done"]);r!=null&&v(e,["done"],r);const a=p(t,["error"]);a!=null&&v(e,["error"],a);const c=p(t,["response","generateVideoResponse"]);return c!=null&&v(e,["response"],K1(c)),e}function J1(t){const e={},n=p(t,["name"]);n!=null&&v(e,["name"],n);const s=p(t,["metadata"]);s!=null&&v(e,["metadata"],s);const r=p(t,["done"]);r!=null&&v(e,["done"],r);const a=p(t,["error"]);a!=null&&v(e,["error"],a);const c=p(t,["response"]);return c!=null&&v(e,["response"],W1(c)),e}function K1(t){const e={},n=p(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>X1(c))),v(e,["generatedVideos"],a)}const s=p(t,["raiMediaFilteredCount"]);s!=null&&v(e,["raiMediaFilteredCount"],s);const r=p(t,["raiMediaFilteredReasons"]);return r!=null&&v(e,["raiMediaFilteredReasons"],r),e}function W1(t){const e={},n=p(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>Q1(c))),v(e,["generatedVideos"],a)}const s=p(t,["raiMediaFilteredCount"]);s!=null&&v(e,["raiMediaFilteredCount"],s);const r=p(t,["raiMediaFilteredReasons"]);return r!=null&&v(e,["raiMediaFilteredReasons"],r),e}function X1(t){const e={},n=p(t,["video"]);return n!=null&&v(e,["video"],tI(n)),e}function Q1(t){const e={},n=p(t,["_self"]);return n!=null&&v(e,["video"],nI(n)),e}function Z1(t){const e={},n=p(t,["operationName"]);return n!=null&&v(e,["_url","operationName"],n),e}function eI(t){const e={},n=p(t,["operationName"]);return n!=null&&v(e,["_url","operationName"],n),e}function tI(t){const e={},n=p(t,["uri"]);n!=null&&v(e,["uri"],n);const s=p(t,["encodedVideo"]);s!=null&&v(e,["videoBytes"],hg(s));const r=p(t,["encoding"]);return r!=null&&v(e,["mimeType"],r),e}function nI(t){const e={},n=p(t,["gcsUri"]);n!=null&&v(e,["uri"],n);const s=p(t,["bytesBase64Encoded"]);s!=null&&v(e,["videoBytes"],hg(s));const r=p(t,["mimeType"]);return r!=null&&v(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var tx;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(tx||(tx={}));var nx;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(nx||(nx={}));var sx;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(sx||(sx={}));var to;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(to||(to={}));var ix;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(ix||(ix={}));var rx;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(rx||(rx={}));var ox;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(ox||(ox={}));var ax;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(ax||(ax={}));var lx;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(lx||(lx={}));var cx;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(cx||(cx={}));var ux;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(ux||(ux={}));var dx;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE"})(dx||(dx={}));var hx;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(hx||(hx={}));var fx;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(fx||(fx={}));var px;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(px||(px={}));var mx;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(mx||(mx={}));var cl;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(cl||(cl={}));var gx;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(gx||(gx={}));var bm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(bm||(bm={}));var yx;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(yx||(yx={}));var vx;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(vx||(vx={}));var _x;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V"})(_x||(_x={}));var xx;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(xx||(xx={}));var bx;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(bx||(bx={}));var Ex;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Ex||(Ex={}));var Tx;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Tx||(Tx={}));var wx;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(wx||(wx={}));var Cx;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Cx||(Cx={}));var Sx;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Sx||(Sx={}));var Ax;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Ax||(Ax={}));var Ix;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Ix||(Ix={}));var Rx;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Rx||(Rx={}));var Nx;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Nx||(Nx={}));var Mx;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Mx||(Mx={}));var kx;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(kx||(kx={}));var Dx;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Dx||(Dx={}));var Px;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Px||(Px={}));var Lx;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Lx||(Lx={}));var Vx;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Vx||(Vx={}));var Ux;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Ux||(Ux={}));var Ox;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Ox||(Ox={}));var Bx;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Bx||(Bx={}));var zx;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(zx||(zx={}));var jx;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(jx||(jx={}));var Fx;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Fx||(Fx={}));var qx;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(qx||(qx={}));var Hx;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Hx||(Hx={}));var Gx;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Gx||(Gx={}));var Za;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Za||(Za={}));class Em{constructor(e){const n={};for(const s of e.headers.entries())n[s[0]]=s[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class bc{get text(){var e,n,s,r,a,c,d,f;if(((r=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",_=!1;const b=[];for(const E of(f=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[S,L]of Object.entries(E))S!=="text"&&S!=="thought"&&(L!==null||L!==void 0)&&b.push(S);if(typeof E.text=="string"){if(typeof E.thought=="boolean"&&E.thought)continue;_=!0,h+=E.text}}return b.length>0&&console.warn(`there are non-text parts ${b} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),_?h:void 0}get data(){var e,n,s,r,a,c,d,f;if(((r=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const _=[];for(const b of(f=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[E,S]of Object.entries(b))E!=="inlineData"&&(S!==null||S!==void 0)&&_.push(E);b.inlineData&&typeof b.inlineData.data=="string"&&(h+=atob(b.inlineData.data))}return _.length>0&&console.warn(`there are non-data parts ${_} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var e,n,s,r,a,c,d,f;if(((r=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(f=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(_=>_.functionCall).map(_=>_.functionCall).filter(_=>_!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var e,n,s,r,a,c,d,f,h;if(((r=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const _=(f=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(b=>b.executableCode).map(b=>b.executableCode).filter(b=>b!==void 0);if((_==null?void 0:_.length)!==0)return(h=_==null?void 0:_[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var e,n,s,r,a,c,d,f,h;if(((r=(s=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const _=(f=(d=(c=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(b=>b.codeExecutionResult).map(b=>b.codeExecutionResult).filter(b=>b!==void 0);if((_==null?void 0:_.length)!==0)return(h=_==null?void 0:_[0])===null||h===void 0?void 0:h.output}}class $x{}class Yx{}class sI{}class iI{}class rI{}class oI{}class Jx{}class Kx{}class Wx{}class aI{}class $d{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const s=new $d;let r;const a=e;return n?r=J1(a):r=Y1(a),Object.assign(s,r),s}}class Xx{}class Qx{}class Zx{}class lI{}class cI{}class uI{}class eb{}class dI{get text(){var e,n,s;let r="",a=!1;const c=[];for(const d of(s=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&s!==void 0?s:[]){for(const[f,h]of Object.entries(d))f!=="text"&&f!=="thought"&&h!==null&&c.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;a=!0,r+=d.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?r:void 0}get data(){var e,n,s;let r="";const a=[];for(const c of(s=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&s!==void 0?s:[]){for(const[d,f]of Object.entries(c))d!=="inlineData"&&f!==null&&a.push(d);c.inlineData&&typeof c.inlineData.data=="string"&&(r+=atob(c.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class hI{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ht(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function AT(t,e){const n=Ht(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function IT(t){return Array.isArray(t)?t.map(e=>Yd(e)):[Yd(t)]}function Yd(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function RT(t){const e=Yd(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function NT(t){const e=Yd(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function tb(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function MT(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>tb(e)):[tb(t)]}function Tm(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function nb(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function sb(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function ds(t){if(t==null)throw new Error("ContentUnion is required");return Tm(t)?t:{role:"user",parts:MT(t)}}function fg(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const s=ds(n);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(t.isVertexAI()){const n=ds(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>ds(n)):[ds(e)]}function ti(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(nb(t)||sb(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ds(t)]}const e=[],n=[],s=Tm(t[0]);for(const r of t){const a=Tm(r);if(a!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(r);else{if(nb(r)||sb(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(r)}}return s||e.push({role:"user",parts:MT(n)}),e}function fI(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(s=>s!=="null");if(n.length===1)e.type=Object.values(to).includes(n[0].toUpperCase())?n[0].toUpperCase():to.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of n)e.anyOf.push({type:Object.values(to).includes(s.toUpperCase())?s.toUpperCase():to.TYPE_UNSPECIFIED})}}function tl(t){const e={},n=["items"],s=["anyOf"],r=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=t.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,t=a[1]):a[1].type==="null"&&(e.nullable=!0,t=a[0])),t.type instanceof Array&&fI(t.type,e);for(const[c,d]of Object.entries(t))if(d!=null)if(c=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(to).includes(d.toUpperCase())?d.toUpperCase():to.TYPE_UNSPECIFIED}else if(n.includes(c))e[c]=tl(d);else if(s.includes(c)){const f=[];for(const h of d){if(h.type=="null"){e.nullable=!0;continue}f.push(tl(h))}e[c]=f}else if(r.includes(c)){const f={};for(const[h,_]of Object.entries(d))f[h]=tl(_);e[c]=f}else{if(c==="additionalProperties")continue;e[c]=d}return e}function pg(t){return tl(t)}function mg(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function gg(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function vl(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=tl(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=tl(e.response));return t}function _l(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function pI(t,e,n,s=1){const r=!e.startsWith(`${n}/`)&&e.split("/").length===s;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:r?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:r?`${n}/${e}`:e}function gr(t,e){if(typeof e!="string")throw new Error("name must be a string");return pI(t,e,"cachedContents")}function kT(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function go(t){return hg(t)}function mI(t){return t!=null&&typeof t=="object"&&"name"in t}function gI(t){return t!=null&&typeof t=="object"&&"video"in t}function yI(t){return t!=null&&typeof t=="object"&&"uri"in t}function DT(t){var e;let n;if(mI(t)&&(n=t.name),!(yI(t)&&(n=t.uri,n===void 0))&&!(gI(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const r=n.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${n}`);n=r[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function PT(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function LT(t){for(const e of["models","tunedModels","publisherModels"])if(vI(t,e))return t[e];return[]}function vI(t,e){return t!==null&&typeof t=="object"&&e in t}function _I(t,e={}){const n=t,s={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(s.responseJsonSchema=n.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function xI(t,e={}){const n=[],s=new Set;for(const r of t){const a=r.name;if(s.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);s.add(a);const c=_I(r,e);c.functionDeclarations&&n.push(...c.functionDeclarations)}return{functionDeclarations:n}}function VT(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const s=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,r=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(r>0||s!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function bI(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function UT(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const r=n.inlinedResponses;if(!Array.isArray(r)||r.length===0)return t;let a=!1;for(const c of r){if(typeof c!="object"||c===null)continue;const f=c.response;if(typeof f!="object"||f===null)continue;if(f.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function xl(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function OT(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EI(t){const e={},n=p(t,["responsesFile"]);n!=null&&v(e,["fileName"],n);const s=p(t,["inlinedResponses","inlinedResponses"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>ZI(c))),v(e,["inlinedResponses"],a)}const r=p(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>c)),v(e,["inlinedEmbedContentResponses"],a)}return e}function TI(t){const e={},n=p(t,["predictionsFormat"]);n!=null&&v(e,["format"],n);const s=p(t,["gcsDestination","outputUriPrefix"]);s!=null&&v(e,["gcsUri"],s);const r=p(t,["bigqueryDestination","outputUri"]);return r!=null&&v(e,["bigqueryUri"],r),e}function wI(t){const e={},n=p(t,["format"]);n!=null&&v(e,["predictionsFormat"],n);const s=p(t,["gcsUri"]);s!=null&&v(e,["gcsDestination","outputUriPrefix"],s);const r=p(t,["bigqueryUri"]);if(r!=null&&v(e,["bigqueryDestination","outputUri"],r),p(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(p(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Dd(t){const e={},n=p(t,["name"]);n!=null&&v(e,["name"],n);const s=p(t,["metadata","displayName"]);s!=null&&v(e,["displayName"],s);const r=p(t,["metadata","state"]);r!=null&&v(e,["state"],OT(r));const a=p(t,["metadata","createTime"]);a!=null&&v(e,["createTime"],a);const c=p(t,["metadata","endTime"]);c!=null&&v(e,["endTime"],c);const d=p(t,["metadata","updateTime"]);d!=null&&v(e,["updateTime"],d);const f=p(t,["metadata","model"]);f!=null&&v(e,["model"],f);const h=p(t,["metadata","output"]);return h!=null&&v(e,["dest"],EI(UT(h))),e}function wm(t){const e={},n=p(t,["name"]);n!=null&&v(e,["name"],n);const s=p(t,["displayName"]);s!=null&&v(e,["displayName"],s);const r=p(t,["state"]);r!=null&&v(e,["state"],OT(r));const a=p(t,["error"]);a!=null&&v(e,["error"],a);const c=p(t,["createTime"]);c!=null&&v(e,["createTime"],c);const d=p(t,["startTime"]);d!=null&&v(e,["startTime"],d);const f=p(t,["endTime"]);f!=null&&v(e,["endTime"],f);const h=p(t,["updateTime"]);h!=null&&v(e,["updateTime"],h);const _=p(t,["model"]);_!=null&&v(e,["model"],_);const b=p(t,["inputConfig"]);b!=null&&v(e,["src"],CI(b));const E=p(t,["outputConfig"]);return E!=null&&v(e,["dest"],TI(UT(E))),e}function CI(t){const e={},n=p(t,["instancesFormat"]);n!=null&&v(e,["format"],n);const s=p(t,["gcsSource","uris"]);s!=null&&v(e,["gcsUri"],s);const r=p(t,["bigquerySource","inputUri"]);return r!=null&&v(e,["bigqueryUri"],r),e}function SI(t,e){const n={};if(p(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(p(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=p(e,["fileName"]);s!=null&&v(n,["fileName"],s);const r=p(e,["inlinedRequests"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>QI(t,c))),v(n,["requests","requests"],a)}return n}function AI(t){const e={},n=p(t,["format"]);n!=null&&v(e,["instancesFormat"],n);const s=p(t,["gcsUri"]);s!=null&&v(e,["gcsSource","uris"],s);const r=p(t,["bigqueryUri"]);if(r!=null&&v(e,["bigquerySource","inputUri"],r),p(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(p(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function II(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["data"]);n!=null&&v(e,["data"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function RI(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],xl(t,s)),n}function NI(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],xl(t,s)),n}function MI(t){const e={},n=p(t,["content"]);n!=null&&v(e,["content"],n);const s=p(t,["citationMetadata"]);s!=null&&v(e,["citationMetadata"],kI(s));const r=p(t,["tokenCount"]);r!=null&&v(e,["tokenCount"],r);const a=p(t,["finishReason"]);a!=null&&v(e,["finishReason"],a);const c=p(t,["urlContextMetadata"]);c!=null&&v(e,["urlContextMetadata"],c);const d=p(t,["avgLogprobs"]);d!=null&&v(e,["avgLogprobs"],d);const f=p(t,["groundingMetadata"]);f!=null&&v(e,["groundingMetadata"],f);const h=p(t,["index"]);h!=null&&v(e,["index"],h);const _=p(t,["logprobsResult"]);_!=null&&v(e,["logprobsResult"],_);const b=p(t,["safetyRatings"]);if(b!=null){let E=b;Array.isArray(E)&&(E=E.map(S=>S)),v(e,["safetyRatings"],E)}return e}function kI(t){const e={},n=p(t,["citationSources"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>r)),v(e,["citations"],s)}return e}function BT(t){const e={},n=p(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>o2(a))),v(e,["parts"],r)}const s=p(t,["role"]);return s!=null&&v(e,["role"],s),e}function DI(t,e){const n={},s=p(t,["displayName"]);if(e!==void 0&&s!=null&&v(e,["batch","displayName"],s),p(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function PI(t,e){const n={},s=p(t,["displayName"]);e!==void 0&&s!=null&&v(e,["displayName"],s);const r=p(t,["dest"]);return e!==void 0&&r!=null&&v(e,["outputConfig"],wI(bI(r))),n}function ib(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["src"]);r!=null&&v(n,["batch","inputConfig"],SI(t,VT(t,r)));const a=p(e,["config"]);return a!=null&&DI(a,n),n}function LI(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["model"],Ht(t,s));const r=p(e,["src"]);r!=null&&v(n,["inputConfig"],AI(VT(t,r)));const a=p(e,["config"]);return a!=null&&PI(a,n),n}function VI(t,e){const n={},s=p(t,["displayName"]);return e!==void 0&&s!=null&&v(e,["batch","displayName"],s),n}function UI(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["src"]);r!=null&&v(n,["batch","inputConfig"],HI(t,r));const a=p(e,["config"]);return a!=null&&VI(a,n),n}function OI(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],xl(t,s)),n}function BI(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],xl(t,s)),n}function zI(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["name"]);s!=null&&v(e,["name"],s);const r=p(t,["done"]);r!=null&&v(e,["done"],r);const a=p(t,["error"]);return a!=null&&v(e,["error"],a),e}function jI(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["name"]);s!=null&&v(e,["name"],s);const r=p(t,["done"]);r!=null&&v(e,["done"],r);const a=p(t,["error"]);return a!=null&&v(e,["error"],a),e}function FI(t,e){const n={},s=p(e,["contents"]);if(s!=null){let a=fg(t,s);Array.isArray(a)&&(a=a.map(c=>c)),v(n,["requests[]","request","content"],a)}const r=p(e,["config"]);return r!=null&&(v(n,["_self"],qI(r,n)),G1(n,{"requests[].*":"requests[].request.*"})),n}function qI(t,e){const n={},s=p(t,["taskType"]);e!==void 0&&s!=null&&v(e,["requests[]","taskType"],s);const r=p(t,["title"]);e!==void 0&&r!=null&&v(e,["requests[]","title"],r);const a=p(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&v(e,["requests[]","outputDimensionality"],a),p(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function HI(t,e){const n={},s=p(e,["fileName"]);s!=null&&v(n,["file_name"],s);const r=p(e,["inlinedRequests"]);return r!=null&&v(n,["requests"],FI(t,r)),n}function GI(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["fileUri"]);n!=null&&v(e,["fileUri"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function $I(t,e,n){const s={},r=p(e,["systemInstruction"]);n!==void 0&&r!=null&&v(n,["systemInstruction"],BT(ds(r)));const a=p(e,["temperature"]);a!=null&&v(s,["temperature"],a);const c=p(e,["topP"]);c!=null&&v(s,["topP"],c);const d=p(e,["topK"]);d!=null&&v(s,["topK"],d);const f=p(e,["candidateCount"]);f!=null&&v(s,["candidateCount"],f);const h=p(e,["maxOutputTokens"]);h!=null&&v(s,["maxOutputTokens"],h);const _=p(e,["stopSequences"]);_!=null&&v(s,["stopSequences"],_);const b=p(e,["responseLogprobs"]);b!=null&&v(s,["responseLogprobs"],b);const E=p(e,["logprobs"]);E!=null&&v(s,["logprobs"],E);const S=p(e,["presencePenalty"]);S!=null&&v(s,["presencePenalty"],S);const L=p(e,["frequencyPenalty"]);L!=null&&v(s,["frequencyPenalty"],L);const U=p(e,["seed"]);U!=null&&v(s,["seed"],U);const F=p(e,["responseMimeType"]);F!=null&&v(s,["responseMimeType"],F);const z=p(e,["responseSchema"]);z!=null&&v(s,["responseSchema"],pg(z));const q=p(e,["responseJsonSchema"]);if(q!=null&&v(s,["responseJsonSchema"],q),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const j=p(e,["safetySettings"]);if(n!==void 0&&j!=null){let k=j;Array.isArray(k)&&(k=k.map(M=>a2(M))),v(n,["safetySettings"],k)}const H=p(e,["tools"]);if(n!==void 0&&H!=null){let k=_l(H);Array.isArray(k)&&(k=k.map(M=>l2(vl(M)))),v(n,["tools"],k)}const Y=p(e,["toolConfig"]);if(n!==void 0&&Y!=null&&v(n,["toolConfig"],Y),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const K=p(e,["cachedContent"]);n!==void 0&&K!=null&&v(n,["cachedContent"],gr(t,K));const R=p(e,["responseModalities"]);R!=null&&v(s,["responseModalities"],R);const T=p(e,["mediaResolution"]);T!=null&&v(s,["mediaResolution"],T);const N=p(e,["speechConfig"]);if(N!=null&&v(s,["speechConfig"],mg(N)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const I=p(e,["thinkingConfig"]);I!=null&&v(s,["thinkingConfig"],I);const D=p(e,["imageConfig"]);return D!=null&&v(s,["imageConfig"],D),s}function YI(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["candidates"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(h=>MI(h))),v(e,["candidates"],f)}const r=p(t,["modelVersion"]);r!=null&&v(e,["modelVersion"],r);const a=p(t,["promptFeedback"]);a!=null&&v(e,["promptFeedback"],a);const c=p(t,["responseId"]);c!=null&&v(e,["responseId"],c);const d=p(t,["usageMetadata"]);return d!=null&&v(e,["usageMetadata"],d),e}function JI(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],xl(t,s)),n}function KI(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],xl(t,s)),n}function WI(t){const e={};if(p(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=p(t,["enableWidget"]);return n!=null&&v(e,["enableWidget"],n),e}function XI(t){const e={},n=p(t,["timeRangeFilter"]);if(n!=null&&v(e,["timeRangeFilter"],n),p(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function QI(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["request","model"],Ht(t,s));const r=p(e,["contents"]);if(r!=null){let d=ti(r);Array.isArray(d)&&(d=d.map(f=>BT(f))),v(n,["request","contents"],d)}const a=p(e,["metadata"]);a!=null&&v(n,["metadata"],a);const c=p(e,["config"]);return c!=null&&v(n,["request","generationConfig"],$I(t,c,p(n,["request"],{}))),n}function ZI(t){const e={},n=p(t,["response"]);n!=null&&v(e,["response"],YI(n));const s=p(t,["error"]);return s!=null&&v(e,["error"],s),e}function e2(t,e){const n={},s=p(t,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const r=p(t,["pageToken"]);if(e!==void 0&&r!=null&&v(e,["_query","pageToken"],r),p(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function t2(t,e){const n={},s=p(t,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const r=p(t,["pageToken"]);e!==void 0&&r!=null&&v(e,["_query","pageToken"],r);const a=p(t,["filter"]);return e!==void 0&&a!=null&&v(e,["_query","filter"],a),n}function n2(t){const e={},n=p(t,["config"]);return n!=null&&e2(n,e),e}function s2(t){const e={},n=p(t,["config"]);return n!=null&&t2(n,e),e}function i2(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["nextPageToken"]);s!=null&&v(e,["nextPageToken"],s);const r=p(t,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>Dd(c))),v(e,["batchJobs"],a)}return e}function r2(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["nextPageToken"]);s!=null&&v(e,["nextPageToken"],s);const r=p(t,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>wm(c))),v(e,["batchJobs"],a)}return e}function o2(t){const e={},n=p(t,["videoMetadata"]);n!=null&&v(e,["videoMetadata"],n);const s=p(t,["thought"]);s!=null&&v(e,["thought"],s);const r=p(t,["inlineData"]);r!=null&&v(e,["inlineData"],II(r));const a=p(t,["fileData"]);a!=null&&v(e,["fileData"],GI(a));const c=p(t,["thoughtSignature"]);c!=null&&v(e,["thoughtSignature"],c);const d=p(t,["functionCall"]);d!=null&&v(e,["functionCall"],d);const f=p(t,["codeExecutionResult"]);f!=null&&v(e,["codeExecutionResult"],f);const h=p(t,["executableCode"]);h!=null&&v(e,["executableCode"],h);const _=p(t,["functionResponse"]);_!=null&&v(e,["functionResponse"],_);const b=p(t,["text"]);return b!=null&&v(e,["text"],b),e}function a2(t){const e={};if(p(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=p(t,["category"]);n!=null&&v(e,["category"],n);const s=p(t,["threshold"]);return s!=null&&v(e,["threshold"],s),e}function l2(t){const e={},n=p(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(_=>_)),v(e,["functionDeclarations"],h)}if(p(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(t,["googleSearch"]);s!=null&&v(e,["googleSearch"],XI(s));const r=p(t,["googleSearchRetrieval"]);if(r!=null&&v(e,["googleSearchRetrieval"],r),p(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=p(t,["googleMaps"]);a!=null&&v(e,["googleMaps"],WI(a));const c=p(t,["urlContext"]);c!=null&&v(e,["urlContext"],c);const d=p(t,["computerUse"]);d!=null&&v(e,["computerUse"],d);const f=p(t,["codeExecution"]);return f!=null&&v(e,["codeExecution"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Qo;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Qo||(Qo={}));class Yc{constructor(e,n,s,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,s,r)}init(e,n,s){var r,a;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!s||Object.keys(s).length===0?c={config:{}}:typeof s=="object"?c=Object.assign({},s):c=s,c.config&&(c.config.pageToken=n.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(a=(r=c.config)===null||r===void 0?void 0:r.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class c2 extends aa{constructor(e){super(),this.apiClient=e,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new Yc(Qo.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=ib(this.apiClient,e),s=n._url,r=Je("{model}:batchGenerateContent",s),d=n.batch.inputConfig.requests,f=d.requests,h=[];for(const _ of f){const b=Object.assign({},_);if(b.systemInstruction){const E=b.systemInstruction;delete b.systemInstruction;const S=b.request;S.systemInstruction=E,b.request=S}h.push(b)}return d.requests=h,delete n.config,delete n._url,delete n._query,{path:r,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const s=n?Object.assign({},n):{},r=Date.now().toString();if(s.displayName||(s.displayName=`genaiBatchJob_${r}`),s.dest===void 0){const a=this.getGcsUri(e),c=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?s.dest=`${a.slice(0,-6)}/dest`:s.dest=`${a}_dest_${r}`;else if(c)s.dest=`${c}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return s}async createInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=LI(this.apiClient,e);return d=Je("batchPredictionJobs",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),c.then(_=>wm(_))}else{const h=ib(this.apiClient,e);return d=Je("{model}:batchGenerateContent",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),c.then(_=>Dd(_))}}async createEmbeddingsInternal(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=UI(this.apiClient,e);return a=Je("{model}:asyncBatchEmbedContent",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),r.then(f=>Dd(f))}}async get(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=KI(this.apiClient,e);return d=Je("batchPredictionJobs/{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),c.then(_=>wm(_))}else{const h=JI(this.apiClient,e);return d=Je("batches/{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),c.then(_=>Dd(_))}}async cancel(e){var n,s,r,a;let c="",d={};if(this.apiClient.isVertexAI()){const f=NI(this.apiClient,e);c=Je("batchPredictionJobs/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const f=RI(this.apiClient,e);c=Je("batches/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=s2(e);return d=Je("batchPredictionJobs",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=r2(_),E=new eb;return Object.assign(E,b),E})}else{const h=n2(e);return d=Je("batches",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=i2(_),E=new eb;return Object.assign(E,b),E})}}async delete(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=BI(this.apiClient,e);return d=Je("batchPredictionJobs/{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>jI(_))}else{const h=OI(this.apiClient,e);return d=Je("batches/{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>zI(_))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function u2(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["data"]);n!=null&&v(e,["data"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function rb(t){const e={},n=p(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>M2(a))),v(e,["parts"],r)}const s=p(t,["role"]);return s!=null&&v(e,["role"],s),e}function d2(t,e){const n={},s=p(t,["ttl"]);e!==void 0&&s!=null&&v(e,["ttl"],s);const r=p(t,["expireTime"]);e!==void 0&&r!=null&&v(e,["expireTime"],r);const a=p(t,["displayName"]);e!==void 0&&a!=null&&v(e,["displayName"],a);const c=p(t,["contents"]);if(e!==void 0&&c!=null){let _=ti(c);Array.isArray(_)&&(_=_.map(b=>rb(b))),v(e,["contents"],_)}const d=p(t,["systemInstruction"]);e!==void 0&&d!=null&&v(e,["systemInstruction"],rb(ds(d)));const f=p(t,["tools"]);if(e!==void 0&&f!=null){let _=f;Array.isArray(_)&&(_=_.map(b=>k2(b))),v(e,["tools"],_)}const h=p(t,["toolConfig"]);if(e!==void 0&&h!=null&&v(e,["toolConfig"],h),p(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function h2(t,e){const n={},s=p(t,["ttl"]);e!==void 0&&s!=null&&v(e,["ttl"],s);const r=p(t,["expireTime"]);e!==void 0&&r!=null&&v(e,["expireTime"],r);const a=p(t,["displayName"]);e!==void 0&&a!=null&&v(e,["displayName"],a);const c=p(t,["contents"]);if(e!==void 0&&c!=null){let b=ti(c);Array.isArray(b)&&(b=b.map(E=>E)),v(e,["contents"],b)}const d=p(t,["systemInstruction"]);e!==void 0&&d!=null&&v(e,["systemInstruction"],ds(d));const f=p(t,["tools"]);if(e!==void 0&&f!=null){let b=f;Array.isArray(b)&&(b=b.map(E=>D2(E))),v(e,["tools"],b)}const h=p(t,["toolConfig"]);e!==void 0&&h!=null&&v(e,["toolConfig"],h);const _=p(t,["kmsKeyName"]);return e!==void 0&&_!=null&&v(e,["encryption_spec","kmsKeyName"],_),n}function f2(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["model"],AT(t,s));const r=p(e,["config"]);return r!=null&&d2(r,n),n}function p2(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["model"],AT(t,s));const r=p(e,["config"]);return r!=null&&h2(r,n),n}function m2(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],gr(t,s)),n}function g2(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],gr(t,s)),n}function y2(t){const e={},n=p(t,["sdkHttpResponse"]);return n!=null&&v(e,["sdkHttpResponse"],n),e}function v2(t){const e={},n=p(t,["sdkHttpResponse"]);return n!=null&&v(e,["sdkHttpResponse"],n),e}function _2(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["fileUri"]);n!=null&&v(e,["fileUri"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function x2(t){const e={};if(p(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=p(t,["description"]);n!=null&&v(e,["description"],n);const s=p(t,["name"]);s!=null&&v(e,["name"],s);const r=p(t,["parameters"]);r!=null&&v(e,["parameters"],r);const a=p(t,["parametersJsonSchema"]);a!=null&&v(e,["parametersJsonSchema"],a);const c=p(t,["response"]);c!=null&&v(e,["response"],c);const d=p(t,["responseJsonSchema"]);return d!=null&&v(e,["responseJsonSchema"],d),e}function b2(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],gr(t,s)),n}function E2(t,e){const n={},s=p(e,["name"]);return s!=null&&v(n,["_url","name"],gr(t,s)),n}function T2(t){const e={};if(p(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=p(t,["enableWidget"]);return n!=null&&v(e,["enableWidget"],n),e}function w2(t){const e={},n=p(t,["timeRangeFilter"]);if(n!=null&&v(e,["timeRangeFilter"],n),p(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function C2(t,e){const n={},s=p(t,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const r=p(t,["pageToken"]);return e!==void 0&&r!=null&&v(e,["_query","pageToken"],r),n}function S2(t,e){const n={},s=p(t,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const r=p(t,["pageToken"]);return e!==void 0&&r!=null&&v(e,["_query","pageToken"],r),n}function A2(t){const e={},n=p(t,["config"]);return n!=null&&C2(n,e),e}function I2(t){const e={},n=p(t,["config"]);return n!=null&&S2(n,e),e}function R2(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["nextPageToken"]);s!=null&&v(e,["nextPageToken"],s);const r=p(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>c)),v(e,["cachedContents"],a)}return e}function N2(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["nextPageToken"]);s!=null&&v(e,["nextPageToken"],s);const r=p(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>c)),v(e,["cachedContents"],a)}return e}function M2(t){const e={},n=p(t,["videoMetadata"]);n!=null&&v(e,["videoMetadata"],n);const s=p(t,["thought"]);s!=null&&v(e,["thought"],s);const r=p(t,["inlineData"]);r!=null&&v(e,["inlineData"],u2(r));const a=p(t,["fileData"]);a!=null&&v(e,["fileData"],_2(a));const c=p(t,["thoughtSignature"]);c!=null&&v(e,["thoughtSignature"],c);const d=p(t,["functionCall"]);d!=null&&v(e,["functionCall"],d);const f=p(t,["codeExecutionResult"]);f!=null&&v(e,["codeExecutionResult"],f);const h=p(t,["executableCode"]);h!=null&&v(e,["executableCode"],h);const _=p(t,["functionResponse"]);_!=null&&v(e,["functionResponse"],_);const b=p(t,["text"]);return b!=null&&v(e,["text"],b),e}function k2(t){const e={},n=p(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(_=>_)),v(e,["functionDeclarations"],h)}if(p(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(t,["googleSearch"]);s!=null&&v(e,["googleSearch"],w2(s));const r=p(t,["googleSearchRetrieval"]);if(r!=null&&v(e,["googleSearchRetrieval"],r),p(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=p(t,["googleMaps"]);a!=null&&v(e,["googleMaps"],T2(a));const c=p(t,["urlContext"]);c!=null&&v(e,["urlContext"],c);const d=p(t,["computerUse"]);d!=null&&v(e,["computerUse"],d);const f=p(t,["codeExecution"]);return f!=null&&v(e,["codeExecution"],f),e}function D2(t){const e={},n=p(t,["functionDeclarations"]);if(n!=null){let b=n;Array.isArray(b)&&(b=b.map(E=>x2(E))),v(e,["functionDeclarations"],b)}const s=p(t,["retrieval"]);s!=null&&v(e,["retrieval"],s);const r=p(t,["googleSearch"]);r!=null&&v(e,["googleSearch"],r);const a=p(t,["googleSearchRetrieval"]);a!=null&&v(e,["googleSearchRetrieval"],a);const c=p(t,["enterpriseWebSearch"]);c!=null&&v(e,["enterpriseWebSearch"],c);const d=p(t,["googleMaps"]);d!=null&&v(e,["googleMaps"],d);const f=p(t,["urlContext"]);f!=null&&v(e,["urlContext"],f);const h=p(t,["computerUse"]);h!=null&&v(e,["computerUse"],h);const _=p(t,["codeExecution"]);return _!=null&&v(e,["codeExecution"],_),e}function P2(t,e){const n={},s=p(t,["ttl"]);e!==void 0&&s!=null&&v(e,["ttl"],s);const r=p(t,["expireTime"]);return e!==void 0&&r!=null&&v(e,["expireTime"],r),n}function L2(t,e){const n={},s=p(t,["ttl"]);e!==void 0&&s!=null&&v(e,["ttl"],s);const r=p(t,["expireTime"]);return e!==void 0&&r!=null&&v(e,["expireTime"],r),n}function V2(t,e){const n={},s=p(e,["name"]);s!=null&&v(n,["_url","name"],gr(t,s));const r=p(e,["config"]);return r!=null&&P2(r,n),n}function U2(t,e){const n={},s=p(e,["name"]);s!=null&&v(n,["_url","name"],gr(t,s));const r=p(e,["config"]);return r!=null&&L2(r,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class O2 extends aa{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Yc(Qo.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(n),n)}async create(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=p2(this.apiClient,e);return d=Je("cachedContents",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),c.then(_=>_)}else{const h=f2(this.apiClient,e);return d=Je("cachedContents",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),c.then(_=>_)}}async get(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=E2(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),c.then(_=>_)}else{const h=b2(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),c.then(_=>_)}}async delete(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=g2(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=v2(_),E=new Qx;return Object.assign(E,b),E})}else{const h=m2(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=y2(_),E=new Qx;return Object.assign(E,b),E})}}async update(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=U2(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),c.then(_=>_)}else{const h=V2(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),c.then(_=>_)}}async listInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=I2(e);return d=Je("cachedContents",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=N2(_),E=new Zx;return Object.assign(E,b),E})}else{const h=A2(e);return d=Je("cachedContents",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=R2(_),E=new Zx;return Object.assign(E,b),E})}}}function ob(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function mn(t){return this instanceof mn?(this.v=t,this):new mn(t)}function nl(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(t,e||[]),r,a=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),r[Symbol.asyncIterator]=function(){return this},r;function c(S){return function(L){return Promise.resolve(L).then(S,b)}}function d(S,L){s[S]&&(r[S]=function(U){return new Promise(function(F,z){a.push([S,U,F,z])>1||f(S,U)})},L&&(r[S]=L(r[S])))}function f(S,L){try{h(s[S](L))}catch(U){E(a[0][3],U)}}function h(S){S.value instanceof mn?Promise.resolve(S.value.v).then(_,b):E(a[0][2],S)}function _(S){f("next",S)}function b(S){f("throw",S)}function E(S,L){S(L),a.shift(),a.length&&f(a[0][0],a[0][1])}}function Ac(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof ob=="function"?ob(t):t[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(a){n[a]=t[a]&&function(c){return new Promise(function(d,f){c=t[a](c),r(d,f,c.done,c.value)})}}function r(a,c,d,f){Promise.resolve(f).then(function(h){a({value:h,done:d})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function B2(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:zT(n)}function zT(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function z2(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function ab(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let s=0;for(;s<n;)if(t[s].role==="user")e.push(t[s]),s++;else{const r=[];let a=!0;for(;s<n&&t[s].role==="model";)r.push(t[s]),a&&!zT(t[s])&&(a=!1),s++;a?e.push(...r):e.pop()}return e}class j2{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new F2(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class F2{constructor(e,n,s,r={},a=[]){this.apiClient=e,this.modelsModule=n,this.model=s,this.config=r,this.history=a,this.sendPromise=Promise.resolve(),z2(a)}async sendMessage(e){var n;await this.sendPromise;const s=ds(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var a,c,d;const f=await r,h=(c=(a=f.candidates)===null||a===void 0?void 0:a[0])===null||c===void 0?void 0:c.content,_=f.automaticFunctionCallingHistory,b=this.getHistory(!0).length;let E=[];_!=null&&(E=(d=_.slice(b))!==null&&d!==void 0?d:[]);const S=h?[h]:[];this.recordHistory(s,S,E)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var n;await this.sendPromise;const s=ds(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const a=await r;return this.processStreamResponse(a,s)}getHistory(e=!1){const n=e?ab(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var s,r;return nl(this,arguments,function*(){var c,d,f,h;const _=[];try{for(var b=!0,E=Ac(e),S;S=yield mn(E.next()),c=S.done,!c;b=!0){h=S.value,b=!1;const L=h;if(B2(L)){const U=(r=(s=L.candidates)===null||s===void 0?void 0:s[0])===null||r===void 0?void 0:r.content;U!==void 0&&_.push(U)}yield yield mn(L)}}catch(L){d={error:L}}finally{try{!b&&!c&&(f=E.return)&&(yield mn(f.call(E)))}finally{if(d)throw d.error}}this.recordHistory(n,_)})}recordHistory(e,n,s){let r=[];n.length>0&&n.every(a=>a.role!==void 0)?r=n:r.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...ab(s)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,mh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q2(t){const e={},n=p(t,["file"]);return n!=null&&v(e,["file"],n),e}function H2(t){const e={},n=p(t,["sdkHttpResponse"]);return n!=null&&v(e,["sdkHttpResponse"],n),e}function G2(t){const e={},n=p(t,["name"]);return n!=null&&v(e,["_url","file"],DT(n)),e}function $2(t){const e={},n=p(t,["sdkHttpResponse"]);return n!=null&&v(e,["sdkHttpResponse"],n),e}function Y2(t){const e={},n=p(t,["name"]);return n!=null&&v(e,["_url","file"],DT(n)),e}function J2(t,e){const n={},s=p(t,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const r=p(t,["pageToken"]);return e!==void 0&&r!=null&&v(e,["_query","pageToken"],r),n}function K2(t){const e={},n=p(t,["config"]);return n!=null&&J2(n,e),e}function W2(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["nextPageToken"]);s!=null&&v(e,["nextPageToken"],s);const r=p(t,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>c)),v(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class X2 extends aa{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Yc(Qo.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=K2(e);return a=Je("files",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const _=h;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const h=W2(f),_=new lI;return Object.assign(_,h),_})}}async createInternal(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=q2(e);return a=Je("upload/v1beta/files",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),r.then(f=>{const h=H2(f),_=new cI;return Object.assign(_,h),_})}}async get(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=Y2(e);return a=Je("files/{file}",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),r.then(f=>f)}}async delete(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=G2(e);return a=Je("files/{file}",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const _=h;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const h=$2(f),_=new uI;return Object.assign(_,h),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pd(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["data"]);n!=null&&v(e,["data"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function Q2(t){const e={},n=p(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>fR(a))),v(e,["parts"],r)}const s=p(t,["role"]);return s!=null&&v(e,["role"],s),e}function Z2(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["fileUri"]);n!=null&&v(e,["fileUri"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function eR(t){const e={};if(p(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=p(t,["description"]);n!=null&&v(e,["description"],n);const s=p(t,["name"]);s!=null&&v(e,["name"],s);const r=p(t,["parameters"]);r!=null&&v(e,["parameters"],r);const a=p(t,["parametersJsonSchema"]);a!=null&&v(e,["parametersJsonSchema"],a);const c=p(t,["response"]);c!=null&&v(e,["response"],c);const d=p(t,["responseJsonSchema"]);return d!=null&&v(e,["responseJsonSchema"],d),e}function tR(t){const e={},n=p(t,["modelSelectionConfig"]);n!=null&&v(e,["modelConfig"],n);const s=p(t,["audioTimestamp"]);s!=null&&v(e,["audioTimestamp"],s);const r=p(t,["candidateCount"]);r!=null&&v(e,["candidateCount"],r);const a=p(t,["enableAffectiveDialog"]);a!=null&&v(e,["enableAffectiveDialog"],a);const c=p(t,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const d=p(t,["logprobs"]);d!=null&&v(e,["logprobs"],d);const f=p(t,["maxOutputTokens"]);f!=null&&v(e,["maxOutputTokens"],f);const h=p(t,["mediaResolution"]);h!=null&&v(e,["mediaResolution"],h);const _=p(t,["presencePenalty"]);_!=null&&v(e,["presencePenalty"],_);const b=p(t,["responseJsonSchema"]);b!=null&&v(e,["responseJsonSchema"],b);const E=p(t,["responseLogprobs"]);E!=null&&v(e,["responseLogprobs"],E);const S=p(t,["responseMimeType"]);S!=null&&v(e,["responseMimeType"],S);const L=p(t,["responseModalities"]);L!=null&&v(e,["responseModalities"],L);const U=p(t,["responseSchema"]);U!=null&&v(e,["responseSchema"],U);const F=p(t,["routingConfig"]);F!=null&&v(e,["routingConfig"],F);const z=p(t,["seed"]);z!=null&&v(e,["seed"],z);const q=p(t,["speechConfig"]);q!=null&&v(e,["speechConfig"],jT(q));const j=p(t,["stopSequences"]);j!=null&&v(e,["stopSequences"],j);const H=p(t,["temperature"]);H!=null&&v(e,["temperature"],H);const Y=p(t,["thinkingConfig"]);Y!=null&&v(e,["thinkingConfig"],Y);const K=p(t,["topK"]);K!=null&&v(e,["topK"],K);const R=p(t,["topP"]);if(R!=null&&v(e,["topP"],R),p(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function nR(t){const e={};if(p(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=p(t,["enableWidget"]);return n!=null&&v(e,["enableWidget"],n),e}function sR(t){const e={},n=p(t,["timeRangeFilter"]);if(n!=null&&v(e,["timeRangeFilter"],n),p(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function iR(t,e){const n={},s=p(t,["generationConfig"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig"],s);const r=p(t,["responseModalities"]);e!==void 0&&r!=null&&v(e,["setup","generationConfig","responseModalities"],r);const a=p(t,["temperature"]);e!==void 0&&a!=null&&v(e,["setup","generationConfig","temperature"],a);const c=p(t,["topP"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topP"],c);const d=p(t,["topK"]);e!==void 0&&d!=null&&v(e,["setup","generationConfig","topK"],d);const f=p(t,["maxOutputTokens"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","maxOutputTokens"],f);const h=p(t,["mediaResolution"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","mediaResolution"],h);const _=p(t,["seed"]);e!==void 0&&_!=null&&v(e,["setup","generationConfig","seed"],_);const b=p(t,["speechConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","speechConfig"],gg(b));const E=p(t,["thinkingConfig"]);e!==void 0&&E!=null&&v(e,["setup","generationConfig","thinkingConfig"],E);const S=p(t,["enableAffectiveDialog"]);e!==void 0&&S!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],S);const L=p(t,["systemInstruction"]);e!==void 0&&L!=null&&v(e,["setup","systemInstruction"],Q2(ds(L)));const U=p(t,["tools"]);if(e!==void 0&&U!=null){let K=_l(U);Array.isArray(K)&&(K=K.map(R=>mR(vl(R)))),v(e,["setup","tools"],K)}const F=p(t,["sessionResumption"]);e!==void 0&&F!=null&&v(e,["setup","sessionResumption"],pR(F));const z=p(t,["inputAudioTranscription"]);e!==void 0&&z!=null&&v(e,["setup","inputAudioTranscription"],z);const q=p(t,["outputAudioTranscription"]);e!==void 0&&q!=null&&v(e,["setup","outputAudioTranscription"],q);const j=p(t,["realtimeInputConfig"]);e!==void 0&&j!=null&&v(e,["setup","realtimeInputConfig"],j);const H=p(t,["contextWindowCompression"]);e!==void 0&&H!=null&&v(e,["setup","contextWindowCompression"],H);const Y=p(t,["proactivity"]);return e!==void 0&&Y!=null&&v(e,["setup","proactivity"],Y),n}function rR(t,e){const n={},s=p(t,["generationConfig"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig"],tR(s));const r=p(t,["responseModalities"]);e!==void 0&&r!=null&&v(e,["setup","generationConfig","responseModalities"],r);const a=p(t,["temperature"]);e!==void 0&&a!=null&&v(e,["setup","generationConfig","temperature"],a);const c=p(t,["topP"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topP"],c);const d=p(t,["topK"]);e!==void 0&&d!=null&&v(e,["setup","generationConfig","topK"],d);const f=p(t,["maxOutputTokens"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","maxOutputTokens"],f);const h=p(t,["mediaResolution"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","mediaResolution"],h);const _=p(t,["seed"]);e!==void 0&&_!=null&&v(e,["setup","generationConfig","seed"],_);const b=p(t,["speechConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","speechConfig"],jT(gg(b)));const E=p(t,["thinkingConfig"]);e!==void 0&&E!=null&&v(e,["setup","generationConfig","thinkingConfig"],E);const S=p(t,["enableAffectiveDialog"]);e!==void 0&&S!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],S);const L=p(t,["systemInstruction"]);e!==void 0&&L!=null&&v(e,["setup","systemInstruction"],ds(L));const U=p(t,["tools"]);if(e!==void 0&&U!=null){let K=_l(U);Array.isArray(K)&&(K=K.map(R=>gR(vl(R)))),v(e,["setup","tools"],K)}const F=p(t,["sessionResumption"]);e!==void 0&&F!=null&&v(e,["setup","sessionResumption"],F);const z=p(t,["inputAudioTranscription"]);e!==void 0&&z!=null&&v(e,["setup","inputAudioTranscription"],z);const q=p(t,["outputAudioTranscription"]);e!==void 0&&q!=null&&v(e,["setup","outputAudioTranscription"],q);const j=p(t,["realtimeInputConfig"]);e!==void 0&&j!=null&&v(e,["setup","realtimeInputConfig"],j);const H=p(t,["contextWindowCompression"]);e!==void 0&&H!=null&&v(e,["setup","contextWindowCompression"],H);const Y=p(t,["proactivity"]);return e!==void 0&&Y!=null&&v(e,["setup","proactivity"],Y),n}function oR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["setup","model"],Ht(t,s));const r=p(e,["config"]);return r!=null&&v(n,["config"],iR(r,n)),n}function aR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["setup","model"],Ht(t,s));const r=p(e,["config"]);return r!=null&&v(n,["config"],rR(r,n)),n}function lR(t){const e={},n=p(t,["musicGenerationConfig"]);return n!=null&&v(e,["musicGenerationConfig"],n),e}function cR(t){const e={},n=p(t,["weightedPrompts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>r)),v(e,["weightedPrompts"],s)}return e}function uR(t){const e={},n=p(t,["media"]);if(n!=null){let h=IT(n);Array.isArray(h)&&(h=h.map(_=>Pd(_))),v(e,["mediaChunks"],h)}const s=p(t,["audio"]);s!=null&&v(e,["audio"],Pd(NT(s)));const r=p(t,["audioStreamEnd"]);r!=null&&v(e,["audioStreamEnd"],r);const a=p(t,["video"]);a!=null&&v(e,["video"],Pd(RT(a)));const c=p(t,["text"]);c!=null&&v(e,["text"],c);const d=p(t,["activityStart"]);d!=null&&v(e,["activityStart"],d);const f=p(t,["activityEnd"]);return f!=null&&v(e,["activityEnd"],f),e}function dR(t){const e={},n=p(t,["media"]);if(n!=null){let h=IT(n);Array.isArray(h)&&(h=h.map(_=>_)),v(e,["mediaChunks"],h)}const s=p(t,["audio"]);s!=null&&v(e,["audio"],NT(s));const r=p(t,["audioStreamEnd"]);r!=null&&v(e,["audioStreamEnd"],r);const a=p(t,["video"]);a!=null&&v(e,["video"],RT(a));const c=p(t,["text"]);c!=null&&v(e,["text"],c);const d=p(t,["activityStart"]);d!=null&&v(e,["activityStart"],d);const f=p(t,["activityEnd"]);return f!=null&&v(e,["activityEnd"],f),e}function hR(t){const e={},n=p(t,["setupComplete"]);n!=null&&v(e,["setupComplete"],n);const s=p(t,["serverContent"]);s!=null&&v(e,["serverContent"],s);const r=p(t,["toolCall"]);r!=null&&v(e,["toolCall"],r);const a=p(t,["toolCallCancellation"]);a!=null&&v(e,["toolCallCancellation"],a);const c=p(t,["usageMetadata"]);c!=null&&v(e,["usageMetadata"],yR(c));const d=p(t,["goAway"]);d!=null&&v(e,["goAway"],d);const f=p(t,["sessionResumptionUpdate"]);return f!=null&&v(e,["sessionResumptionUpdate"],f),e}function fR(t){const e={},n=p(t,["videoMetadata"]);n!=null&&v(e,["videoMetadata"],n);const s=p(t,["thought"]);s!=null&&v(e,["thought"],s);const r=p(t,["inlineData"]);r!=null&&v(e,["inlineData"],Pd(r));const a=p(t,["fileData"]);a!=null&&v(e,["fileData"],Z2(a));const c=p(t,["thoughtSignature"]);c!=null&&v(e,["thoughtSignature"],c);const d=p(t,["functionCall"]);d!=null&&v(e,["functionCall"],d);const f=p(t,["codeExecutionResult"]);f!=null&&v(e,["codeExecutionResult"],f);const h=p(t,["executableCode"]);h!=null&&v(e,["executableCode"],h);const _=p(t,["functionResponse"]);_!=null&&v(e,["functionResponse"],_);const b=p(t,["text"]);return b!=null&&v(e,["text"],b),e}function pR(t){const e={},n=p(t,["handle"]);if(n!=null&&v(e,["handle"],n),p(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function jT(t){const e={},n=p(t,["voiceConfig"]);if(n!=null&&v(e,["voiceConfig"],n),p(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=p(t,["languageCode"]);return s!=null&&v(e,["languageCode"],s),e}function mR(t){const e={},n=p(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(_=>_)),v(e,["functionDeclarations"],h)}if(p(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(t,["googleSearch"]);s!=null&&v(e,["googleSearch"],sR(s));const r=p(t,["googleSearchRetrieval"]);if(r!=null&&v(e,["googleSearchRetrieval"],r),p(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=p(t,["googleMaps"]);a!=null&&v(e,["googleMaps"],nR(a));const c=p(t,["urlContext"]);c!=null&&v(e,["urlContext"],c);const d=p(t,["computerUse"]);d!=null&&v(e,["computerUse"],d);const f=p(t,["codeExecution"]);return f!=null&&v(e,["codeExecution"],f),e}function gR(t){const e={},n=p(t,["functionDeclarations"]);if(n!=null){let b=n;Array.isArray(b)&&(b=b.map(E=>eR(E))),v(e,["functionDeclarations"],b)}const s=p(t,["retrieval"]);s!=null&&v(e,["retrieval"],s);const r=p(t,["googleSearch"]);r!=null&&v(e,["googleSearch"],r);const a=p(t,["googleSearchRetrieval"]);a!=null&&v(e,["googleSearchRetrieval"],a);const c=p(t,["enterpriseWebSearch"]);c!=null&&v(e,["enterpriseWebSearch"],c);const d=p(t,["googleMaps"]);d!=null&&v(e,["googleMaps"],d);const f=p(t,["urlContext"]);f!=null&&v(e,["urlContext"],f);const h=p(t,["computerUse"]);h!=null&&v(e,["computerUse"],h);const _=p(t,["codeExecution"]);return _!=null&&v(e,["codeExecution"],_),e}function yR(t){const e={},n=p(t,["promptTokenCount"]);n!=null&&v(e,["promptTokenCount"],n);const s=p(t,["cachedContentTokenCount"]);s!=null&&v(e,["cachedContentTokenCount"],s);const r=p(t,["candidatesTokenCount"]);r!=null&&v(e,["responseTokenCount"],r);const a=p(t,["toolUsePromptTokenCount"]);a!=null&&v(e,["toolUsePromptTokenCount"],a);const c=p(t,["thoughtsTokenCount"]);c!=null&&v(e,["thoughtsTokenCount"],c);const d=p(t,["totalTokenCount"]);d!=null&&v(e,["totalTokenCount"],d);const f=p(t,["promptTokensDetails"]);if(f!=null){let S=f;Array.isArray(S)&&(S=S.map(L=>L)),v(e,["promptTokensDetails"],S)}const h=p(t,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(L=>L)),v(e,["cacheTokensDetails"],S)}const _=p(t,["candidatesTokensDetails"]);if(_!=null){let S=_;Array.isArray(S)&&(S=S.map(L=>L)),v(e,["responseTokensDetails"],S)}const b=p(t,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(L=>L)),v(e,["toolUsePromptTokensDetails"],S)}const E=p(t,["trafficType"]);return E!=null&&v(e,["trafficType"],E),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vR(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["data"]);n!=null&&v(e,["data"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function _R(t){const e={},n=p(t,["content"]);n!=null&&v(e,["content"],n);const s=p(t,["citationMetadata"]);s!=null&&v(e,["citationMetadata"],xR(s));const r=p(t,["tokenCount"]);r!=null&&v(e,["tokenCount"],r);const a=p(t,["finishReason"]);a!=null&&v(e,["finishReason"],a);const c=p(t,["urlContextMetadata"]);c!=null&&v(e,["urlContextMetadata"],c);const d=p(t,["avgLogprobs"]);d!=null&&v(e,["avgLogprobs"],d);const f=p(t,["groundingMetadata"]);f!=null&&v(e,["groundingMetadata"],f);const h=p(t,["index"]);h!=null&&v(e,["index"],h);const _=p(t,["logprobsResult"]);_!=null&&v(e,["logprobsResult"],_);const b=p(t,["safetyRatings"]);if(b!=null){let E=b;Array.isArray(E)&&(E=E.map(S=>S)),v(e,["safetyRatings"],E)}return e}function xR(t){const e={},n=p(t,["citationSources"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>r)),v(e,["citations"],s)}return e}function bR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["contents"]);if(r!=null){let a=ti(r);Array.isArray(a)&&(a=a.map(c=>c)),v(n,["contents"],a)}return n}function ER(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["tokensInfo"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),v(e,["tokensInfo"],r)}return e}function TR(t){const e={},n=p(t,["values"]);n!=null&&v(e,["values"],n);const s=p(t,["statistics"]);return s!=null&&v(e,["statistics"],wR(s)),e}function wR(t){const e={},n=p(t,["truncated"]);n!=null&&v(e,["truncated"],n);const s=p(t,["token_count"]);return s!=null&&v(e,["tokenCount"],s),e}function gh(t){const e={},n=p(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>RN(a))),v(e,["parts"],r)}const s=p(t,["role"]);return s!=null&&v(e,["role"],s),e}function CR(t){const e={},n=p(t,["controlType"]);n!=null&&v(e,["controlType"],n);const s=p(t,["enableControlImageComputation"]);return s!=null&&v(e,["computeControl"],s),e}function SR(t){const e={};if(p(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(p(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(p(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function AR(t,e){const n={},s=p(t,["systemInstruction"]);e!==void 0&&s!=null&&v(e,["systemInstruction"],ds(s));const r=p(t,["tools"]);if(e!==void 0&&r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>$T(d))),v(e,["tools"],c)}const a=p(t,["generationConfig"]);return e!==void 0&&a!=null&&v(e,["generationConfig"],gN(a)),n}function IR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["contents"]);if(r!=null){let c=ti(r);Array.isArray(c)&&(c=c.map(d=>gh(d))),v(n,["contents"],c)}const a=p(e,["config"]);return a!=null&&SR(a),n}function RR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["contents"]);if(r!=null){let c=ti(r);Array.isArray(c)&&(c=c.map(d=>d)),v(n,["contents"],c)}const a=p(e,["config"]);return a!=null&&AR(a,n),n}function NR(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["totalTokens"]);s!=null&&v(e,["totalTokens"],s);const r=p(t,["cachedContentTokenCount"]);return r!=null&&v(e,["cachedContentTokenCount"],r),e}function MR(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["totalTokens"]);return s!=null&&v(e,["totalTokens"],s),e}function kR(t,e){const n={},s=p(e,["model"]);return s!=null&&v(n,["_url","name"],Ht(t,s)),n}function DR(t,e){const n={},s=p(e,["model"]);return s!=null&&v(n,["_url","name"],Ht(t,s)),n}function PR(t){const e={},n=p(t,["sdkHttpResponse"]);return n!=null&&v(e,["sdkHttpResponse"],n),e}function LR(t){const e={},n=p(t,["sdkHttpResponse"]);return n!=null&&v(e,["sdkHttpResponse"],n),e}function VR(t,e){const n={},s=p(t,["outputGcsUri"]);e!==void 0&&s!=null&&v(e,["parameters","storageUri"],s);const r=p(t,["negativePrompt"]);e!==void 0&&r!=null&&v(e,["parameters","negativePrompt"],r);const a=p(t,["numberOfImages"]);e!==void 0&&a!=null&&v(e,["parameters","sampleCount"],a);const c=p(t,["aspectRatio"]);e!==void 0&&c!=null&&v(e,["parameters","aspectRatio"],c);const d=p(t,["guidanceScale"]);e!==void 0&&d!=null&&v(e,["parameters","guidanceScale"],d);const f=p(t,["seed"]);e!==void 0&&f!=null&&v(e,["parameters","seed"],f);const h=p(t,["safetyFilterLevel"]);e!==void 0&&h!=null&&v(e,["parameters","safetySetting"],h);const _=p(t,["personGeneration"]);e!==void 0&&_!=null&&v(e,["parameters","personGeneration"],_);const b=p(t,["includeSafetyAttributes"]);e!==void 0&&b!=null&&v(e,["parameters","includeSafetyAttributes"],b);const E=p(t,["includeRaiReason"]);e!==void 0&&E!=null&&v(e,["parameters","includeRaiReason"],E);const S=p(t,["language"]);e!==void 0&&S!=null&&v(e,["parameters","language"],S);const L=p(t,["outputMimeType"]);e!==void 0&&L!=null&&v(e,["parameters","outputOptions","mimeType"],L);const U=p(t,["outputCompressionQuality"]);e!==void 0&&U!=null&&v(e,["parameters","outputOptions","compressionQuality"],U);const F=p(t,["addWatermark"]);e!==void 0&&F!=null&&v(e,["parameters","addWatermark"],F);const z=p(t,["labels"]);e!==void 0&&z!=null&&v(e,["labels"],z);const q=p(t,["editMode"]);e!==void 0&&q!=null&&v(e,["parameters","editMode"],q);const j=p(t,["baseSteps"]);return e!==void 0&&j!=null&&v(e,["parameters","editConfig","baseSteps"],j),n}function UR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["prompt"]);r!=null&&v(n,["instances[0]","prompt"],r);const a=p(e,["referenceImages"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(f=>LN(f))),v(n,["instances[0]","referenceImages"],d)}const c=p(e,["config"]);return c!=null&&VR(c,n),n}function OR(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>yh(a))),v(e,["generatedImages"],r)}return e}function BR(t,e){const n={},s=p(t,["taskType"]);e!==void 0&&s!=null&&v(e,["requests[]","taskType"],s);const r=p(t,["title"]);e!==void 0&&r!=null&&v(e,["requests[]","title"],r);const a=p(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&v(e,["requests[]","outputDimensionality"],a),p(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(p(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function zR(t,e){const n={},s=p(t,["taskType"]);e!==void 0&&s!=null&&v(e,["instances[]","task_type"],s);const r=p(t,["title"]);e!==void 0&&r!=null&&v(e,["instances[]","title"],r);const a=p(t,["outputDimensionality"]);e!==void 0&&a!=null&&v(e,["parameters","outputDimensionality"],a);const c=p(t,["mimeType"]);e!==void 0&&c!=null&&v(e,["instances[]","mimeType"],c);const d=p(t,["autoTruncate"]);return e!==void 0&&d!=null&&v(e,["parameters","autoTruncate"],d),n}function jR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["contents"]);if(r!=null){let d=fg(t,r);Array.isArray(d)&&(d=d.map(f=>f)),v(n,["requests[]","content"],d)}const a=p(e,["config"]);a!=null&&BR(a,n);const c=p(e,["model"]);return c!==void 0&&v(n,["requests[]","model"],Ht(t,c)),n}function FR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["contents"]);if(r!=null){let c=fg(t,r);Array.isArray(c)&&(c=c.map(d=>d)),v(n,["instances[]","content"],c)}const a=p(e,["config"]);return a!=null&&zR(a,n),n}function qR(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["embeddings"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>c)),v(e,["embeddings"],a)}const r=p(t,["metadata"]);return r!=null&&v(e,["metadata"],r),e}function HR(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["predictions[]","embeddings"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>TR(c))),v(e,["embeddings"],a)}const r=p(t,["metadata"]);return r!=null&&v(e,["metadata"],r),e}function GR(t){const e={},n=p(t,["endpoint"]);n!=null&&v(e,["name"],n);const s=p(t,["deployedModelId"]);return s!=null&&v(e,["deployedModelId"],s),e}function $R(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["fileUri"]);n!=null&&v(e,["fileUri"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function YR(t){const e={};if(p(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=p(t,["description"]);n!=null&&v(e,["description"],n);const s=p(t,["name"]);s!=null&&v(e,["name"],s);const r=p(t,["parameters"]);r!=null&&v(e,["parameters"],r);const a=p(t,["parametersJsonSchema"]);a!=null&&v(e,["parametersJsonSchema"],a);const c=p(t,["response"]);c!=null&&v(e,["response"],c);const d=p(t,["responseJsonSchema"]);return d!=null&&v(e,["responseJsonSchema"],d),e}function JR(t,e,n){const s={},r=p(e,["systemInstruction"]);n!==void 0&&r!=null&&v(n,["systemInstruction"],gh(ds(r)));const a=p(e,["temperature"]);a!=null&&v(s,["temperature"],a);const c=p(e,["topP"]);c!=null&&v(s,["topP"],c);const d=p(e,["topK"]);d!=null&&v(s,["topK"],d);const f=p(e,["candidateCount"]);f!=null&&v(s,["candidateCount"],f);const h=p(e,["maxOutputTokens"]);h!=null&&v(s,["maxOutputTokens"],h);const _=p(e,["stopSequences"]);_!=null&&v(s,["stopSequences"],_);const b=p(e,["responseLogprobs"]);b!=null&&v(s,["responseLogprobs"],b);const E=p(e,["logprobs"]);E!=null&&v(s,["logprobs"],E);const S=p(e,["presencePenalty"]);S!=null&&v(s,["presencePenalty"],S);const L=p(e,["frequencyPenalty"]);L!=null&&v(s,["frequencyPenalty"],L);const U=p(e,["seed"]);U!=null&&v(s,["seed"],U);const F=p(e,["responseMimeType"]);F!=null&&v(s,["responseMimeType"],F);const z=p(e,["responseSchema"]);z!=null&&v(s,["responseSchema"],pg(z));const q=p(e,["responseJsonSchema"]);if(q!=null&&v(s,["responseJsonSchema"],q),p(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(p(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const j=p(e,["safetySettings"]);if(n!==void 0&&j!=null){let k=j;Array.isArray(k)&&(k=k.map(M=>VN(M))),v(n,["safetySettings"],k)}const H=p(e,["tools"]);if(n!==void 0&&H!=null){let k=_l(H);Array.isArray(k)&&(k=k.map(M=>FN(vl(M)))),v(n,["tools"],k)}const Y=p(e,["toolConfig"]);if(n!==void 0&&Y!=null&&v(n,["toolConfig"],Y),p(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const K=p(e,["cachedContent"]);n!==void 0&&K!=null&&v(n,["cachedContent"],gr(t,K));const R=p(e,["responseModalities"]);R!=null&&v(s,["responseModalities"],R);const T=p(e,["mediaResolution"]);T!=null&&v(s,["mediaResolution"],T);const N=p(e,["speechConfig"]);if(N!=null&&v(s,["speechConfig"],mg(N)),p(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const I=p(e,["thinkingConfig"]);I!=null&&v(s,["thinkingConfig"],I);const D=p(e,["imageConfig"]);return D!=null&&v(s,["imageConfig"],D),s}function KR(t,e,n){const s={},r=p(e,["systemInstruction"]);n!==void 0&&r!=null&&v(n,["systemInstruction"],ds(r));const a=p(e,["temperature"]);a!=null&&v(s,["temperature"],a);const c=p(e,["topP"]);c!=null&&v(s,["topP"],c);const d=p(e,["topK"]);d!=null&&v(s,["topK"],d);const f=p(e,["candidateCount"]);f!=null&&v(s,["candidateCount"],f);const h=p(e,["maxOutputTokens"]);h!=null&&v(s,["maxOutputTokens"],h);const _=p(e,["stopSequences"]);_!=null&&v(s,["stopSequences"],_);const b=p(e,["responseLogprobs"]);b!=null&&v(s,["responseLogprobs"],b);const E=p(e,["logprobs"]);E!=null&&v(s,["logprobs"],E);const S=p(e,["presencePenalty"]);S!=null&&v(s,["presencePenalty"],S);const L=p(e,["frequencyPenalty"]);L!=null&&v(s,["frequencyPenalty"],L);const U=p(e,["seed"]);U!=null&&v(s,["seed"],U);const F=p(e,["responseMimeType"]);F!=null&&v(s,["responseMimeType"],F);const z=p(e,["responseSchema"]);z!=null&&v(s,["responseSchema"],pg(z));const q=p(e,["responseJsonSchema"]);q!=null&&v(s,["responseJsonSchema"],q);const j=p(e,["routingConfig"]);j!=null&&v(s,["routingConfig"],j);const H=p(e,["modelSelectionConfig"]);H!=null&&v(s,["modelConfig"],H);const Y=p(e,["safetySettings"]);if(n!==void 0&&Y!=null){let $=Y;Array.isArray($)&&($=$.map(G=>G)),v(n,["safetySettings"],$)}const K=p(e,["tools"]);if(n!==void 0&&K!=null){let $=_l(K);Array.isArray($)&&($=$.map(G=>$T(vl(G)))),v(n,["tools"],$)}const R=p(e,["toolConfig"]);n!==void 0&&R!=null&&v(n,["toolConfig"],R);const T=p(e,["labels"]);n!==void 0&&T!=null&&v(n,["labels"],T);const N=p(e,["cachedContent"]);n!==void 0&&N!=null&&v(n,["cachedContent"],gr(t,N));const I=p(e,["responseModalities"]);I!=null&&v(s,["responseModalities"],I);const D=p(e,["mediaResolution"]);D!=null&&v(s,["mediaResolution"],D);const k=p(e,["speechConfig"]);k!=null&&v(s,["speechConfig"],GT(mg(k)));const M=p(e,["audioTimestamp"]);M!=null&&v(s,["audioTimestamp"],M);const ce=p(e,["thinkingConfig"]);ce!=null&&v(s,["thinkingConfig"],ce);const ge=p(e,["imageConfig"]);return ge!=null&&v(s,["imageConfig"],ge),s}function lb(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["contents"]);if(r!=null){let c=ti(r);Array.isArray(c)&&(c=c.map(d=>gh(d))),v(n,["contents"],c)}const a=p(e,["config"]);return a!=null&&v(n,["generationConfig"],JR(t,a,n)),n}function cb(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["contents"]);if(r!=null){let c=ti(r);Array.isArray(c)&&(c=c.map(d=>d)),v(n,["contents"],c)}const a=p(e,["config"]);return a!=null&&v(n,["generationConfig"],KR(t,a,n)),n}function ub(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["candidates"]);if(s!=null){let f=s;Array.isArray(f)&&(f=f.map(h=>_R(h))),v(e,["candidates"],f)}const r=p(t,["modelVersion"]);r!=null&&v(e,["modelVersion"],r);const a=p(t,["promptFeedback"]);a!=null&&v(e,["promptFeedback"],a);const c=p(t,["responseId"]);c!=null&&v(e,["responseId"],c);const d=p(t,["usageMetadata"]);return d!=null&&v(e,["usageMetadata"],d),e}function db(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["candidates"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(_=>_)),v(e,["candidates"],h)}const r=p(t,["createTime"]);r!=null&&v(e,["createTime"],r);const a=p(t,["modelVersion"]);a!=null&&v(e,["modelVersion"],a);const c=p(t,["promptFeedback"]);c!=null&&v(e,["promptFeedback"],c);const d=p(t,["responseId"]);d!=null&&v(e,["responseId"],d);const f=p(t,["usageMetadata"]);return f!=null&&v(e,["usageMetadata"],f),e}function WR(t,e){const n={};if(p(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=p(t,["numberOfImages"]);e!==void 0&&s!=null&&v(e,["parameters","sampleCount"],s);const r=p(t,["aspectRatio"]);e!==void 0&&r!=null&&v(e,["parameters","aspectRatio"],r);const a=p(t,["guidanceScale"]);if(e!==void 0&&a!=null&&v(e,["parameters","guidanceScale"],a),p(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=p(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&v(e,["parameters","safetySetting"],c);const d=p(t,["personGeneration"]);e!==void 0&&d!=null&&v(e,["parameters","personGeneration"],d);const f=p(t,["includeSafetyAttributes"]);e!==void 0&&f!=null&&v(e,["parameters","includeSafetyAttributes"],f);const h=p(t,["includeRaiReason"]);e!==void 0&&h!=null&&v(e,["parameters","includeRaiReason"],h);const _=p(t,["language"]);e!==void 0&&_!=null&&v(e,["parameters","language"],_);const b=p(t,["outputMimeType"]);e!==void 0&&b!=null&&v(e,["parameters","outputOptions","mimeType"],b);const E=p(t,["outputCompressionQuality"]);if(e!==void 0&&E!=null&&v(e,["parameters","outputOptions","compressionQuality"],E),p(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(p(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const S=p(t,["imageSize"]);if(e!==void 0&&S!=null&&v(e,["parameters","sampleImageSize"],S),p(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function XR(t,e){const n={},s=p(t,["outputGcsUri"]);e!==void 0&&s!=null&&v(e,["parameters","storageUri"],s);const r=p(t,["negativePrompt"]);e!==void 0&&r!=null&&v(e,["parameters","negativePrompt"],r);const a=p(t,["numberOfImages"]);e!==void 0&&a!=null&&v(e,["parameters","sampleCount"],a);const c=p(t,["aspectRatio"]);e!==void 0&&c!=null&&v(e,["parameters","aspectRatio"],c);const d=p(t,["guidanceScale"]);e!==void 0&&d!=null&&v(e,["parameters","guidanceScale"],d);const f=p(t,["seed"]);e!==void 0&&f!=null&&v(e,["parameters","seed"],f);const h=p(t,["safetyFilterLevel"]);e!==void 0&&h!=null&&v(e,["parameters","safetySetting"],h);const _=p(t,["personGeneration"]);e!==void 0&&_!=null&&v(e,["parameters","personGeneration"],_);const b=p(t,["includeSafetyAttributes"]);e!==void 0&&b!=null&&v(e,["parameters","includeSafetyAttributes"],b);const E=p(t,["includeRaiReason"]);e!==void 0&&E!=null&&v(e,["parameters","includeRaiReason"],E);const S=p(t,["language"]);e!==void 0&&S!=null&&v(e,["parameters","language"],S);const L=p(t,["outputMimeType"]);e!==void 0&&L!=null&&v(e,["parameters","outputOptions","mimeType"],L);const U=p(t,["outputCompressionQuality"]);e!==void 0&&U!=null&&v(e,["parameters","outputOptions","compressionQuality"],U);const F=p(t,["addWatermark"]);e!==void 0&&F!=null&&v(e,["parameters","addWatermark"],F);const z=p(t,["labels"]);e!==void 0&&z!=null&&v(e,["labels"],z);const q=p(t,["imageSize"]);e!==void 0&&q!=null&&v(e,["parameters","sampleImageSize"],q);const j=p(t,["enhancePrompt"]);return e!==void 0&&j!=null&&v(e,["parameters","enhancePrompt"],j),n}function QR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["prompt"]);r!=null&&v(n,["instances[0]","prompt"],r);const a=p(e,["config"]);return a!=null&&WR(a,n),n}function ZR(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["prompt"]);r!=null&&v(n,["instances[0]","prompt"],r);const a=p(e,["config"]);return a!=null&&XR(a,n),n}function eN(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["predictions"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>hN(c))),v(e,["generatedImages"],a)}const r=p(t,["positivePromptSafetyAttributes"]);return r!=null&&v(e,["positivePromptSafetyAttributes"],qT(r)),e}function tN(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["predictions"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>yh(c))),v(e,["generatedImages"],a)}const r=p(t,["positivePromptSafetyAttributes"]);return r!=null&&v(e,["positivePromptSafetyAttributes"],HT(r)),e}function nN(t,e){const n={},s=p(t,["numberOfVideos"]);if(e!==void 0&&s!=null&&v(e,["parameters","sampleCount"],s),p(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(p(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=p(t,["durationSeconds"]);if(e!==void 0&&r!=null&&v(e,["parameters","durationSeconds"],r),p(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=p(t,["aspectRatio"]);e!==void 0&&a!=null&&v(e,["parameters","aspectRatio"],a);const c=p(t,["resolution"]);e!==void 0&&c!=null&&v(e,["parameters","resolution"],c);const d=p(t,["personGeneration"]);if(e!==void 0&&d!=null&&v(e,["parameters","personGeneration"],d),p(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=p(t,["negativePrompt"]);e!==void 0&&f!=null&&v(e,["parameters","negativePrompt"],f);const h=p(t,["enhancePrompt"]);if(e!==void 0&&h!=null&&v(e,["parameters","enhancePrompt"],h),p(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const _=p(t,["lastFrame"]);e!==void 0&&_!=null&&v(e,["instances[0]","lastFrame"],vh(_));const b=p(t,["referenceImages"]);if(e!==void 0&&b!=null){let E=b;Array.isArray(E)&&(E=E.map(S=>tM(S))),v(e,["instances[0]","referenceImages"],E)}if(p(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(p(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function sN(t,e){const n={},s=p(t,["numberOfVideos"]);e!==void 0&&s!=null&&v(e,["parameters","sampleCount"],s);const r=p(t,["outputGcsUri"]);e!==void 0&&r!=null&&v(e,["parameters","storageUri"],r);const a=p(t,["fps"]);e!==void 0&&a!=null&&v(e,["parameters","fps"],a);const c=p(t,["durationSeconds"]);e!==void 0&&c!=null&&v(e,["parameters","durationSeconds"],c);const d=p(t,["seed"]);e!==void 0&&d!=null&&v(e,["parameters","seed"],d);const f=p(t,["aspectRatio"]);e!==void 0&&f!=null&&v(e,["parameters","aspectRatio"],f);const h=p(t,["resolution"]);e!==void 0&&h!=null&&v(e,["parameters","resolution"],h);const _=p(t,["personGeneration"]);e!==void 0&&_!=null&&v(e,["parameters","personGeneration"],_);const b=p(t,["pubsubTopic"]);e!==void 0&&b!=null&&v(e,["parameters","pubsubTopic"],b);const E=p(t,["negativePrompt"]);e!==void 0&&E!=null&&v(e,["parameters","negativePrompt"],E);const S=p(t,["enhancePrompt"]);e!==void 0&&S!=null&&v(e,["parameters","enhancePrompt"],S);const L=p(t,["generateAudio"]);e!==void 0&&L!=null&&v(e,["parameters","generateAudio"],L);const U=p(t,["lastFrame"]);e!==void 0&&U!=null&&v(e,["instances[0]","lastFrame"],vi(U));const F=p(t,["referenceImages"]);if(e!==void 0&&F!=null){let j=F;Array.isArray(j)&&(j=j.map(H=>nM(H))),v(e,["instances[0]","referenceImages"],j)}const z=p(t,["mask"]);e!==void 0&&z!=null&&v(e,["instances[0]","mask"],eM(z));const q=p(t,["compressionQuality"]);return e!==void 0&&q!=null&&v(e,["parameters","compressionQuality"],q),n}function iN(t){const e={},n=p(t,["name"]);n!=null&&v(e,["name"],n);const s=p(t,["metadata"]);s!=null&&v(e,["metadata"],s);const r=p(t,["done"]);r!=null&&v(e,["done"],r);const a=p(t,["error"]);a!=null&&v(e,["error"],a);const c=p(t,["response","generateVideoResponse"]);return c!=null&&v(e,["response"],lN(c)),e}function rN(t){const e={},n=p(t,["name"]);n!=null&&v(e,["name"],n);const s=p(t,["metadata"]);s!=null&&v(e,["metadata"],s);const r=p(t,["done"]);r!=null&&v(e,["done"],r);const a=p(t,["error"]);a!=null&&v(e,["error"],a);const c=p(t,["response"]);return c!=null&&v(e,["response"],cN(c)),e}function oN(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["prompt"]);r!=null&&v(n,["instances[0]","prompt"],r);const a=p(e,["image"]);a!=null&&v(n,["instances[0]","image"],vh(a));const c=p(e,["video"]);c!=null&&v(n,["instances[0]","video"],YT(c));const d=p(e,["source"]);d!=null&&uN(d,n);const f=p(e,["config"]);return f!=null&&nN(f,n),n}function aN(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["prompt"]);r!=null&&v(n,["instances[0]","prompt"],r);const a=p(e,["image"]);a!=null&&v(n,["instances[0]","image"],vi(a));const c=p(e,["video"]);c!=null&&v(n,["instances[0]","video"],JT(c));const d=p(e,["source"]);d!=null&&dN(d,n);const f=p(e,["config"]);return f!=null&&sN(f,n),n}function lN(t){const e={},n=p(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>pN(c))),v(e,["generatedVideos"],a)}const s=p(t,["raiMediaFilteredCount"]);s!=null&&v(e,["raiMediaFilteredCount"],s);const r=p(t,["raiMediaFilteredReasons"]);return r!=null&&v(e,["raiMediaFilteredReasons"],r),e}function cN(t){const e={},n=p(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>mN(c))),v(e,["generatedVideos"],a)}const s=p(t,["raiMediaFilteredCount"]);s!=null&&v(e,["raiMediaFilteredCount"],s);const r=p(t,["raiMediaFilteredReasons"]);return r!=null&&v(e,["raiMediaFilteredReasons"],r),e}function uN(t,e){const n={},s=p(t,["prompt"]);e!==void 0&&s!=null&&v(e,["instances[0]","prompt"],s);const r=p(t,["image"]);e!==void 0&&r!=null&&v(e,["instances[0]","image"],vh(r));const a=p(t,["video"]);return e!==void 0&&a!=null&&v(e,["instances[0]","video"],YT(a)),n}function dN(t,e){const n={},s=p(t,["prompt"]);e!==void 0&&s!=null&&v(e,["instances[0]","prompt"],s);const r=p(t,["image"]);e!==void 0&&r!=null&&v(e,["instances[0]","image"],vi(r));const a=p(t,["video"]);return e!==void 0&&a!=null&&v(e,["instances[0]","video"],JT(a)),n}function hN(t){const e={},n=p(t,["_self"]);n!=null&&v(e,["image"],bN(n));const s=p(t,["raiFilteredReason"]);s!=null&&v(e,["raiFilteredReason"],s);const r=p(t,["_self"]);return r!=null&&v(e,["safetyAttributes"],qT(r)),e}function yh(t){const e={},n=p(t,["_self"]);n!=null&&v(e,["image"],FT(n));const s=p(t,["raiFilteredReason"]);s!=null&&v(e,["raiFilteredReason"],s);const r=p(t,["_self"]);r!=null&&v(e,["safetyAttributes"],HT(r));const a=p(t,["prompt"]);return a!=null&&v(e,["enhancedPrompt"],a),e}function fN(t){const e={},n=p(t,["_self"]);n!=null&&v(e,["mask"],FT(n));const s=p(t,["labels"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),v(e,["labels"],r)}return e}function pN(t){const e={},n=p(t,["video"]);return n!=null&&v(e,["video"],QN(n)),e}function mN(t){const e={},n=p(t,["_self"]);return n!=null&&v(e,["video"],ZN(n)),e}function gN(t){const e={},n=p(t,["modelSelectionConfig"]);n!=null&&v(e,["modelConfig"],n);const s=p(t,["audioTimestamp"]);s!=null&&v(e,["audioTimestamp"],s);const r=p(t,["candidateCount"]);r!=null&&v(e,["candidateCount"],r);const a=p(t,["enableAffectiveDialog"]);a!=null&&v(e,["enableAffectiveDialog"],a);const c=p(t,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const d=p(t,["logprobs"]);d!=null&&v(e,["logprobs"],d);const f=p(t,["maxOutputTokens"]);f!=null&&v(e,["maxOutputTokens"],f);const h=p(t,["mediaResolution"]);h!=null&&v(e,["mediaResolution"],h);const _=p(t,["presencePenalty"]);_!=null&&v(e,["presencePenalty"],_);const b=p(t,["responseJsonSchema"]);b!=null&&v(e,["responseJsonSchema"],b);const E=p(t,["responseLogprobs"]);E!=null&&v(e,["responseLogprobs"],E);const S=p(t,["responseMimeType"]);S!=null&&v(e,["responseMimeType"],S);const L=p(t,["responseModalities"]);L!=null&&v(e,["responseModalities"],L);const U=p(t,["responseSchema"]);U!=null&&v(e,["responseSchema"],U);const F=p(t,["routingConfig"]);F!=null&&v(e,["routingConfig"],F);const z=p(t,["seed"]);z!=null&&v(e,["seed"],z);const q=p(t,["speechConfig"]);q!=null&&v(e,["speechConfig"],GT(q));const j=p(t,["stopSequences"]);j!=null&&v(e,["stopSequences"],j);const H=p(t,["temperature"]);H!=null&&v(e,["temperature"],H);const Y=p(t,["thinkingConfig"]);Y!=null&&v(e,["thinkingConfig"],Y);const K=p(t,["topK"]);K!=null&&v(e,["topK"],K);const R=p(t,["topP"]);if(R!=null&&v(e,["topP"],R),p(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function yN(t,e){const n={},s=p(e,["model"]);return s!=null&&v(n,["_url","name"],Ht(t,s)),n}function vN(t,e){const n={},s=p(e,["model"]);return s!=null&&v(n,["_url","name"],Ht(t,s)),n}function _N(t){const e={};if(p(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=p(t,["enableWidget"]);return n!=null&&v(e,["enableWidget"],n),e}function xN(t){const e={},n=p(t,["timeRangeFilter"]);if(n!=null&&v(e,["timeRangeFilter"],n),p(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function bN(t){const e={},n=p(t,["bytesBase64Encoded"]);n!=null&&v(e,["imageBytes"],go(n));const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function FT(t){const e={},n=p(t,["gcsUri"]);n!=null&&v(e,["gcsUri"],n);const s=p(t,["bytesBase64Encoded"]);s!=null&&v(e,["imageBytes"],go(s));const r=p(t,["mimeType"]);return r!=null&&v(e,["mimeType"],r),e}function vh(t){const e={};if(p(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=p(t,["imageBytes"]);n!=null&&v(e,["bytesBase64Encoded"],go(n));const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function vi(t){const e={},n=p(t,["gcsUri"]);n!=null&&v(e,["gcsUri"],n);const s=p(t,["imageBytes"]);s!=null&&v(e,["bytesBase64Encoded"],go(s));const r=p(t,["mimeType"]);return r!=null&&v(e,["mimeType"],r),e}function EN(t,e,n){const s={},r=p(e,["pageSize"]);n!==void 0&&r!=null&&v(n,["_query","pageSize"],r);const a=p(e,["pageToken"]);n!==void 0&&a!=null&&v(n,["_query","pageToken"],a);const c=p(e,["filter"]);n!==void 0&&c!=null&&v(n,["_query","filter"],c);const d=p(e,["queryBase"]);return n!==void 0&&d!=null&&v(n,["_url","models_url"],PT(t,d)),s}function TN(t,e,n){const s={},r=p(e,["pageSize"]);n!==void 0&&r!=null&&v(n,["_query","pageSize"],r);const a=p(e,["pageToken"]);n!==void 0&&a!=null&&v(n,["_query","pageToken"],a);const c=p(e,["filter"]);n!==void 0&&c!=null&&v(n,["_query","filter"],c);const d=p(e,["queryBase"]);return n!==void 0&&d!=null&&v(n,["_url","models_url"],PT(t,d)),s}function wN(t,e){const n={},s=p(e,["config"]);return s!=null&&EN(t,s,n),n}function CN(t,e){const n={},s=p(e,["config"]);return s!=null&&TN(t,s,n),n}function SN(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["nextPageToken"]);s!=null&&v(e,["nextPageToken"],s);const r=p(t,["_self"]);if(r!=null){let a=LT(r);Array.isArray(a)&&(a=a.map(c=>Cm(c))),v(e,["models"],a)}return e}function AN(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["nextPageToken"]);s!=null&&v(e,["nextPageToken"],s);const r=p(t,["_self"]);if(r!=null){let a=LT(r);Array.isArray(a)&&(a=a.map(c=>Sm(c))),v(e,["models"],a)}return e}function IN(t){const e={},n=p(t,["maskMode"]);n!=null&&v(e,["maskMode"],n);const s=p(t,["segmentationClasses"]);s!=null&&v(e,["maskClasses"],s);const r=p(t,["maskDilation"]);return r!=null&&v(e,["dilation"],r),e}function Cm(t){const e={},n=p(t,["name"]);n!=null&&v(e,["name"],n);const s=p(t,["displayName"]);s!=null&&v(e,["displayName"],s);const r=p(t,["description"]);r!=null&&v(e,["description"],r);const a=p(t,["version"]);a!=null&&v(e,["version"],a);const c=p(t,["_self"]);c!=null&&v(e,["tunedModelInfo"],qN(c));const d=p(t,["inputTokenLimit"]);d!=null&&v(e,["inputTokenLimit"],d);const f=p(t,["outputTokenLimit"]);f!=null&&v(e,["outputTokenLimit"],f);const h=p(t,["supportedGenerationMethods"]);return h!=null&&v(e,["supportedActions"],h),e}function Sm(t){const e={},n=p(t,["name"]);n!=null&&v(e,["name"],n);const s=p(t,["displayName"]);s!=null&&v(e,["displayName"],s);const r=p(t,["description"]);r!=null&&v(e,["description"],r);const a=p(t,["versionId"]);a!=null&&v(e,["version"],a);const c=p(t,["deployedModels"]);if(c!=null){let b=c;Array.isArray(b)&&(b=b.map(E=>GR(E))),v(e,["endpoints"],b)}const d=p(t,["labels"]);d!=null&&v(e,["labels"],d);const f=p(t,["_self"]);f!=null&&v(e,["tunedModelInfo"],HN(f));const h=p(t,["defaultCheckpointId"]);h!=null&&v(e,["defaultCheckpointId"],h);const _=p(t,["checkpoints"]);if(_!=null){let b=_;Array.isArray(b)&&(b=b.map(E=>E)),v(e,["checkpoints"],b)}return e}function RN(t){const e={},n=p(t,["videoMetadata"]);n!=null&&v(e,["videoMetadata"],n);const s=p(t,["thought"]);s!=null&&v(e,["thought"],s);const r=p(t,["inlineData"]);r!=null&&v(e,["inlineData"],vR(r));const a=p(t,["fileData"]);a!=null&&v(e,["fileData"],$R(a));const c=p(t,["thoughtSignature"]);c!=null&&v(e,["thoughtSignature"],c);const d=p(t,["functionCall"]);d!=null&&v(e,["functionCall"],d);const f=p(t,["codeExecutionResult"]);f!=null&&v(e,["codeExecutionResult"],f);const h=p(t,["executableCode"]);h!=null&&v(e,["executableCode"],h);const _=p(t,["functionResponse"]);_!=null&&v(e,["functionResponse"],_);const b=p(t,["text"]);return b!=null&&v(e,["text"],b),e}function NN(t){const e={},n=p(t,["productImage"]);return n!=null&&v(e,["image"],vi(n)),e}function MN(t,e){const n={},s=p(t,["numberOfImages"]);e!==void 0&&s!=null&&v(e,["parameters","sampleCount"],s);const r=p(t,["baseSteps"]);e!==void 0&&r!=null&&v(e,["parameters","editConfig","baseSteps"],r);const a=p(t,["outputGcsUri"]);e!==void 0&&a!=null&&v(e,["parameters","storageUri"],a);const c=p(t,["seed"]);e!==void 0&&c!=null&&v(e,["parameters","seed"],c);const d=p(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&v(e,["parameters","safetySetting"],d);const f=p(t,["personGeneration"]);e!==void 0&&f!=null&&v(e,["parameters","personGeneration"],f);const h=p(t,["addWatermark"]);e!==void 0&&h!=null&&v(e,["parameters","addWatermark"],h);const _=p(t,["outputMimeType"]);e!==void 0&&_!=null&&v(e,["parameters","outputOptions","mimeType"],_);const b=p(t,["outputCompressionQuality"]);e!==void 0&&b!=null&&v(e,["parameters","outputOptions","compressionQuality"],b);const E=p(t,["enhancePrompt"]);e!==void 0&&E!=null&&v(e,["parameters","enhancePrompt"],E);const S=p(t,["labels"]);return e!==void 0&&S!=null&&v(e,["labels"],S),n}function kN(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["source"]);r!=null&&PN(r,n);const a=p(e,["config"]);return a!=null&&MN(a,n),n}function DN(t){const e={},n=p(t,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>yh(r))),v(e,["generatedImages"],s)}return e}function PN(t,e){const n={},s=p(t,["prompt"]);e!==void 0&&s!=null&&v(e,["instances[0]","prompt"],s);const r=p(t,["personImage"]);e!==void 0&&r!=null&&v(e,["instances[0]","personImage","image"],vi(r));const a=p(t,["productImages"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(d=>NN(d))),v(e,["instances[0]","productImages"],c)}return n}function LN(t){const e={},n=p(t,["referenceImage"]);n!=null&&v(e,["referenceImage"],vi(n));const s=p(t,["referenceId"]);s!=null&&v(e,["referenceId"],s);const r=p(t,["referenceType"]);r!=null&&v(e,["referenceType"],r);const a=p(t,["maskImageConfig"]);a!=null&&v(e,["maskImageConfig"],IN(a));const c=p(t,["controlImageConfig"]);c!=null&&v(e,["controlImageConfig"],CR(c));const d=p(t,["styleImageConfig"]);d!=null&&v(e,["styleImageConfig"],d);const f=p(t,["subjectImageConfig"]);return f!=null&&v(e,["subjectImageConfig"],f),e}function qT(t){const e={},n=p(t,["safetyAttributes","categories"]);n!=null&&v(e,["categories"],n);const s=p(t,["safetyAttributes","scores"]);s!=null&&v(e,["scores"],s);const r=p(t,["contentType"]);return r!=null&&v(e,["contentType"],r),e}function HT(t){const e={},n=p(t,["safetyAttributes","categories"]);n!=null&&v(e,["categories"],n);const s=p(t,["safetyAttributes","scores"]);s!=null&&v(e,["scores"],s);const r=p(t,["contentType"]);return r!=null&&v(e,["contentType"],r),e}function VN(t){const e={};if(p(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=p(t,["category"]);n!=null&&v(e,["category"],n);const s=p(t,["threshold"]);return s!=null&&v(e,["threshold"],s),e}function UN(t){const e={},n=p(t,["image"]);return n!=null&&v(e,["image"],vi(n)),e}function ON(t,e){const n={},s=p(t,["mode"]);e!==void 0&&s!=null&&v(e,["parameters","mode"],s);const r=p(t,["maxPredictions"]);e!==void 0&&r!=null&&v(e,["parameters","maxPredictions"],r);const a=p(t,["confidenceThreshold"]);e!==void 0&&a!=null&&v(e,["parameters","confidenceThreshold"],a);const c=p(t,["maskDilation"]);e!==void 0&&c!=null&&v(e,["parameters","maskDilation"],c);const d=p(t,["binaryColorThreshold"]);e!==void 0&&d!=null&&v(e,["parameters","binaryColorThreshold"],d);const f=p(t,["labels"]);return e!==void 0&&f!=null&&v(e,["labels"],f),n}function BN(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["source"]);r!=null&&jN(r,n);const a=p(e,["config"]);return a!=null&&ON(a,n),n}function zN(t){const e={},n=p(t,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>fN(r))),v(e,["generatedMasks"],s)}return e}function jN(t,e){const n={},s=p(t,["prompt"]);e!==void 0&&s!=null&&v(e,["instances[0]","prompt"],s);const r=p(t,["image"]);e!==void 0&&r!=null&&v(e,["instances[0]","image"],vi(r));const a=p(t,["scribbleImage"]);return e!==void 0&&a!=null&&v(e,["instances[0]","scribble"],UN(a)),n}function GT(t){const e={},n=p(t,["voiceConfig"]);if(n!=null&&v(e,["voiceConfig"],n),p(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=p(t,["languageCode"]);return s!=null&&v(e,["languageCode"],s),e}function FN(t){const e={},n=p(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(_=>_)),v(e,["functionDeclarations"],h)}if(p(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(t,["googleSearch"]);s!=null&&v(e,["googleSearch"],xN(s));const r=p(t,["googleSearchRetrieval"]);if(r!=null&&v(e,["googleSearchRetrieval"],r),p(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=p(t,["googleMaps"]);a!=null&&v(e,["googleMaps"],_N(a));const c=p(t,["urlContext"]);c!=null&&v(e,["urlContext"],c);const d=p(t,["computerUse"]);d!=null&&v(e,["computerUse"],d);const f=p(t,["codeExecution"]);return f!=null&&v(e,["codeExecution"],f),e}function $T(t){const e={},n=p(t,["functionDeclarations"]);if(n!=null){let b=n;Array.isArray(b)&&(b=b.map(E=>YR(E))),v(e,["functionDeclarations"],b)}const s=p(t,["retrieval"]);s!=null&&v(e,["retrieval"],s);const r=p(t,["googleSearch"]);r!=null&&v(e,["googleSearch"],r);const a=p(t,["googleSearchRetrieval"]);a!=null&&v(e,["googleSearchRetrieval"],a);const c=p(t,["enterpriseWebSearch"]);c!=null&&v(e,["enterpriseWebSearch"],c);const d=p(t,["googleMaps"]);d!=null&&v(e,["googleMaps"],d);const f=p(t,["urlContext"]);f!=null&&v(e,["urlContext"],f);const h=p(t,["computerUse"]);h!=null&&v(e,["computerUse"],h);const _=p(t,["codeExecution"]);return _!=null&&v(e,["codeExecution"],_),e}function qN(t){const e={},n=p(t,["baseModel"]);n!=null&&v(e,["baseModel"],n);const s=p(t,["createTime"]);s!=null&&v(e,["createTime"],s);const r=p(t,["updateTime"]);return r!=null&&v(e,["updateTime"],r),e}function HN(t){const e={},n=p(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&v(e,["baseModel"],n);const s=p(t,["createTime"]);s!=null&&v(e,["createTime"],s);const r=p(t,["updateTime"]);return r!=null&&v(e,["updateTime"],r),e}function GN(t,e){const n={},s=p(t,["displayName"]);e!==void 0&&s!=null&&v(e,["displayName"],s);const r=p(t,["description"]);e!==void 0&&r!=null&&v(e,["description"],r);const a=p(t,["defaultCheckpointId"]);return e!==void 0&&a!=null&&v(e,["defaultCheckpointId"],a),n}function $N(t,e){const n={},s=p(t,["displayName"]);e!==void 0&&s!=null&&v(e,["displayName"],s);const r=p(t,["description"]);e!==void 0&&r!=null&&v(e,["description"],r);const a=p(t,["defaultCheckpointId"]);return e!==void 0&&a!=null&&v(e,["defaultCheckpointId"],a),n}function YN(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","name"],Ht(t,s));const r=p(e,["config"]);return r!=null&&GN(r,n),n}function JN(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["config"]);return r!=null&&$N(r,n),n}function KN(t,e){const n={},s=p(t,["outputGcsUri"]);e!==void 0&&s!=null&&v(e,["parameters","storageUri"],s);const r=p(t,["includeRaiReason"]);e!==void 0&&r!=null&&v(e,["parameters","includeRaiReason"],r);const a=p(t,["outputMimeType"]);e!==void 0&&a!=null&&v(e,["parameters","outputOptions","mimeType"],a);const c=p(t,["outputCompressionQuality"]);e!==void 0&&c!=null&&v(e,["parameters","outputOptions","compressionQuality"],c);const d=p(t,["enhanceInputImage"]);e!==void 0&&d!=null&&v(e,["parameters","upscaleConfig","enhanceInputImage"],d);const f=p(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&v(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const h=p(t,["labels"]);e!==void 0&&h!=null&&v(e,["labels"],h);const _=p(t,["numberOfImages"]);e!==void 0&&_!=null&&v(e,["parameters","sampleCount"],_);const b=p(t,["mode"]);return e!==void 0&&b!=null&&v(e,["parameters","mode"],b),n}function WN(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["_url","model"],Ht(t,s));const r=p(e,["image"]);r!=null&&v(n,["instances[0]","image"],vi(r));const a=p(e,["upscaleFactor"]);a!=null&&v(n,["parameters","upscaleConfig","upscaleFactor"],a);const c=p(e,["config"]);return c!=null&&KN(c,n),n}function XN(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>yh(a))),v(e,["generatedImages"],r)}return e}function QN(t){const e={},n=p(t,["uri"]);n!=null&&v(e,["uri"],n);const s=p(t,["encodedVideo"]);s!=null&&v(e,["videoBytes"],go(s));const r=p(t,["encoding"]);return r!=null&&v(e,["mimeType"],r),e}function ZN(t){const e={},n=p(t,["gcsUri"]);n!=null&&v(e,["uri"],n);const s=p(t,["bytesBase64Encoded"]);s!=null&&v(e,["videoBytes"],go(s));const r=p(t,["mimeType"]);return r!=null&&v(e,["mimeType"],r),e}function eM(t){const e={},n=p(t,["image"]);n!=null&&v(e,["_self"],vi(n));const s=p(t,["maskMode"]);return s!=null&&v(e,["maskMode"],s),e}function tM(t){const e={},n=p(t,["image"]);n!=null&&v(e,["image"],vh(n));const s=p(t,["referenceType"]);return s!=null&&v(e,["referenceType"],s),e}function nM(t){const e={},n=p(t,["image"]);n!=null&&v(e,["image"],vi(n));const s=p(t,["referenceType"]);return s!=null&&v(e,["referenceType"],s),e}function YT(t){const e={},n=p(t,["uri"]);n!=null&&v(e,["uri"],n);const s=p(t,["videoBytes"]);s!=null&&v(e,["encodedVideo"],go(s));const r=p(t,["mimeType"]);return r!=null&&v(e,["encoding"],r),e}function JT(t){const e={},n=p(t,["uri"]);n!=null&&v(e,["gcsUri"],n);const s=p(t,["videoBytes"]);s!=null&&v(e,["bytesBase64Encoded"],go(s));const r=p(t,["mimeType"]);return r!=null&&v(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sM="Content-Type",iM="X-Server-Timeout",rM="User-Agent",Am="x-goog-api-client",oM="1.26.0",aM=`google-genai-sdk/${oM}`,lM="v1beta1",cM="v1beta",hb=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class uM{constructor(e){var n,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:lM,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:cM,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,s){const r=[this.getRequestUrlInternal(n)];return s&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,n,s);if(e.queryParams)for(const[c,d]of Object.entries(e.queryParams))r.searchParams.append(c,String(d));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,n,e.abortSignal),this.unaryApiCall(r,a,e.httpMethod)}patchHttpOptions(e,n){const s=JSON.parse(JSON.stringify(e));for(const[r,a]of Object.entries(n))typeof a=="object"?s[r]=Object.assign(Object.assign({},s[r]),a):a!==void 0&&(s[r]=a);return s}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,n,s);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,n,e.abortSignal),this.streamApiCall(r,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,s){if(n&&n.timeout||s){const r=new AbortController,a=r.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const c=setTimeout(()=>r.abort(),n.timeout);c&&typeof c.unref=="function"&&c.unref()}s&&s.addEventListener("abort",()=>{r.abort()}),e.signal=a}return n&&n.extraBody!==null&&dM(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:s})).then(async r=>(await fb(r),new Em(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,n,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:s})).then(async r=>(await fb(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var n;return nl(this,arguments,function*(){const r=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),a=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let c="";for(;;){const{done:d,value:f}=yield mn(r.read());if(d){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=a.decode(f,{stream:!0});try{const b=JSON.parse(h);if("error"in b){const E=JSON.parse(JSON.stringify(b.error)),S=E.status,L=E.code,U=`got status: ${S}. ${JSON.stringify(b)}`;if(L>=400&&L<600)throw new mh({message:U,status:L})}}catch(b){if(b.name==="ApiError")throw b}c+=h;let _=c.match(hb);for(;_;){const b=_[1];try{const E=new Response(b,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield mn(new Em(E)),c=c.slice(_[0].length),_=c.match(hb)}catch(E){throw new Error(`exception parsing stream chunk ${b}. ${E}`)}}}}finally{r.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},n=aM+" "+this.clientOptions.userAgentExtra;return e[rM]=n,e[Am]=n,e[sM]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[s,r]of Object.entries(e.headers))n.append(s,r);e.timeout&&e.timeout>0&&n.append(iM,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var s;const r={};n!=null&&(r.mimeType=n.mimeType,r.name=n.name,r.displayName=n.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const a=this.clientOptions.uploader,c=await a.stat(e);r.sizeBytes=String(c.size);const d=(s=n==null?void 0:n.mimeType)!==null&&s!==void 0?s:c.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=d;const f=await this.fetchUploadUrl(r,n);return a.upload(e,f,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var s;let r={};n!=null&&n.httpOptions?r=n.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},c=await this.request({path:Je("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:r});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(s=c==null?void 0:c.headers)===null||s===void 0?void 0:s["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function fb(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const r=JSON.stringify(s);throw n>=400&&n<600?new mh({message:r,status:n}):new Error(r)}}function dM(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const a=JSON.parse(t.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))n=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function s(a,c){const d=Object.assign({},a);for(const f in c)if(Object.prototype.hasOwnProperty.call(c,f)){const h=c[f],_=d[f];h&&typeof h=="object"&&!Array.isArray(h)&&_&&typeof _=="object"&&!Array.isArray(_)?d[f]=s(_,h):(_&&h&&typeof _!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof _}, New type: ${typeof h}. Overwriting.`),d[f]=h)}return d}const r=s(n,e);t.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hM="mcp_used/unknown";let fM=!1;function KT(t){for(const e of t)if(pM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return fM}function WT(t){var e;const n=(e=t[Am])!==null&&e!==void 0?e:"";t[Am]=(n+` ${hM}`).trimStart()}function pM(t){return t!==null&&typeof t=="object"&&t instanceof yg}function mM(t,e=100){return nl(this,arguments,function*(){let s,r=0;for(;r<e;){const a=yield mn(t.listTools({cursor:s}));for(const c of a.tools)yield yield mn(c),r++;if(!a.nextCursor)break;s=a.nextCursor}})}class yg{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new yg(e,n)}async initialize(){var e,n,s,r;if(this.mcpTools.length>0)return;const a={},c=[];for(const _ of this.mcpClients)try{for(var d=!0,f=(n=void 0,Ac(mM(_))),h;h=await f.next(),e=h.done,!e;d=!0){r=h.value,d=!1;const b=r;c.push(b);const E=b.name;if(a[E])throw new Error(`Duplicate function name ${E} found in MCP tools. Please ensure function names are unique.`);a[E]=_}}catch(b){n={error:b}}finally{try{!d&&!e&&(s=f.return)&&await s.call(f)}finally{if(n)throw n.error}}this.mcpTools=c,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),xI(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[s.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const c=await r.callTool({name:s.name,arguments:s.args},void 0,a);n.push({functionResponse:{name:s.name,response:c.isError?{error:c}:c}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function gM(t,e,n){const s=new hI;let r;n.data instanceof Blob?r=JSON.parse(await n.data.text()):r=JSON.parse(n.data),Object.assign(s,r),e(s)}class yM{constructor(e,n,s){this.apiClient=e,this.auth=n,this.webSocketFactory=s}async connect(e){var n,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),c=xM(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),f=`${r}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${d}`;let h=()=>{};const _=new Promise(j=>{h=j}),b=e.callbacks,E=function(){h({})},S=this.apiClient,L={onopen:E,onmessage:j=>{gM(S,b.onmessage,j)},onerror:(n=b==null?void 0:b.onerror)!==null&&n!==void 0?n:function(j){},onclose:(s=b==null?void 0:b.onclose)!==null&&s!==void 0?s:function(j){}},U=this.webSocketFactory.create(f,_M(c),L);U.connect(),await _;const q={setup:{model:Ht(this.apiClient,e.model)}};return U.send(JSON.stringify(q)),new vM(U,this.apiClient)}}class vM{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=cR(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=lR(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Za.PLAY)}pause(){this.sendPlaybackControl(Za.PAUSE)}stop(){this.sendPlaybackControl(Za.STOP)}resetContext(){this.sendPlaybackControl(Za.RESET_CONTEXT)}close(){this.conn.close()}}function _M(t){const e={};return t.forEach((n,s)=>{e[s]=n}),e}function xM(t){const e=new Headers;for(const[n,s]of Object.entries(t))e.append(n,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function EM(t,e,n){const s=new dI;let r;n.data instanceof Blob?r=await n.data.text():n.data instanceof ArrayBuffer?r=new TextDecoder().decode(n.data):r=n.data;const a=JSON.parse(r);if(t.isVertexAI()){const c=hR(a);Object.assign(s,c)}else Object.assign(s,a);e(s)}class TM{constructor(e,n,s){this.apiClient=e,this.auth=n,this.webSocketFactory=s,this.music=new yM(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,s,r,a,c,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const f=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let _;const b=this.apiClient.getHeaders();e.config&&e.config.tools&&KT(e.config.tools)&&WT(b);const E=AM(b);if(this.apiClient.isVertexAI())_=`${f}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(E);else{const N=this.apiClient.getApiKey();let I="BidiGenerateContent",D="key";N!=null&&N.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),I="BidiGenerateContentConstrained",D="access_token"),_=`${f}/ws/google.ai.generativelanguage.${h}.GenerativeService.${I}?${D}=${N}`}let S=()=>{};const L=new Promise(N=>{S=N}),U=e.callbacks,F=function(){var N;(N=U==null?void 0:U.onopen)===null||N===void 0||N.call(U),S({})},z=this.apiClient,q={onopen:F,onmessage:N=>{EM(z,U.onmessage,N)},onerror:(n=U==null?void 0:U.onerror)!==null&&n!==void 0?n:function(N){},onclose:(s=U==null?void 0:U.onclose)!==null&&s!==void 0?s:function(N){}},j=this.webSocketFactory.create(_,SM(E),q);j.connect(),await L;let H=Ht(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&H.startsWith("publishers/")){const N=this.apiClient.getProject(),I=this.apiClient.getLocation();H=`projects/${N}/locations/${I}/`+H}let Y={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[cl.AUDIO]}:e.config.responseModalities=[cl.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const K=(d=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[],R=[];for(const N of K)if(this.isCallableTool(N)){const I=N;R.push(await I.tool())}else R.push(N);R.length>0&&(e.config.tools=R);const T={model:H,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?Y=aR(this.apiClient,T):Y=oR(this.apiClient,T),delete Y.config,j.send(JSON.stringify(Y)),new CM(j,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const wM={turnComplete:!0};class CM{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let s=[];try{s=ti(n.turns),e.isVertexAI()||(s=s.map(r=>gh(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:s,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let s=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?s=n.functionResponses:s=[n.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const a of s){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(bM)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},wM),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:dR(e)}:n={realtimeInput:uR(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function SM(t){const e={};return t.forEach((n,s)=>{e[s]=n}),e}function AM(t){const e=new Headers;for(const[n,s]of Object.entries(t))e.append(n,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pb=10;function mb(t){var e,n,s;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const c of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(sl(c)){r=!0;break}if(!r)return!0;const a=(s=t==null?void 0:t.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function sl(t){return"callTool"in t&&typeof t.callTool=="function"}function IM(t){var e,n,s;return(s=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(r=>sl(r)))!==null&&s!==void 0?s:!1}function RM(t){var e,n,s;return(s=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(r=>!sl(r)))!==null&&s!==void 0?s:!1}function gb(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NM extends aa{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var s,r,a,c,d;const f=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!IM(n)||mb(n.config))return await this.generateContentInternal(f);if(RM(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,_;const b=ti(f.contents),E=(a=(r=(s=f.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:pb;let S=0;for(;S<E&&(h=await this.generateContentInternal(f),!(!h.functionCalls||h.functionCalls.length===0));){const L=h.candidates[0].content,U=[];for(const F of(d=(c=n.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[])if(sl(F)){const q=await F.callTool(h.functionCalls);U.push(...q)}S++,_={role:"user",parts:U},f.contents=ti(f.contents),f.contents.push(L),f.contents.push(_),gb(f.config)&&(b.push(L),b.push(_))}return gb(f.config)&&(h.automaticFunctionCallingHistory=b),h},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),mb(n.config)){const s=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(s)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(s=>{var r;let a;const c=[];if(s!=null&&s.generatedImages)for(const f of s.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((r=f==null?void 0:f.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?a=f==null?void 0:f.safetyAttributes:c.push(f);let d;return a?d={generatedImages:c,positivePromptSafetyAttributes:a,sdkHttpResponse:s.sdkHttpResponse}:d={generatedImages:c,sdkHttpResponse:s.sdkHttpResponse},d}),this.list=async n=>{var s;const c={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((s=c.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new Yc(Qo.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(c),c)},this.editImage=async n=>{const s={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(s.referenceImages=n.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async n=>{let s={numberOfImages:1,mode:"upscale"};n.config&&(s=Object.assign(Object.assign({},s),n.config));const r={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:s};return await this.upscaleImageInternal(r)},this.generateVideos=async n=>{var s,r,a,c,d,f;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((s=n.video)===null||s===void 0)&&s.uri&&(!((r=n.video)===null||r===void 0)&&r.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((c=(a=n.source)===null||a===void 0?void 0:a.video)===null||c===void 0)&&c.uri&&(!((f=(d=n.source)===null||d===void 0?void 0:d.video)===null||f===void 0)&&f.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,s,r;const a=(n=e.config)===null||n===void 0?void 0:n.tools;if(!a)return e;const c=await Promise.all(a.map(async f=>sl(f)?await f.tool():f)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(d.config.tools=c,e.config&&e.config.tools&&KT(e.config.tools)){const f=(r=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&r!==void 0?r:{};let h=Object.assign({},f);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),WT(h),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:h})}return d}async initAfcToolsMap(e){var n,s,r;const a=new Map;for(const c of(s=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&s!==void 0?s:[])if(sl(c)){const d=c,f=await d.tool();for(const h of(r=f.functionDeclarations)!==null&&r!==void 0?r:[]){if(!h.name)throw new Error("Function declaration name is required.");if(a.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);a.set(h.name,d)}}return a}async processAfcStream(e){var n,s,r;const a=(r=(s=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:pb;let c=!1,d=0;const f=await this.initAfcToolsMap(e);return(function(h,_,b){var E,S;return nl(this,arguments,function*(){for(var L,U,F,z;d<a;){c&&(d++,c=!1);const Y=yield mn(h.processParamsMaybeAddMcpUsage(b)),K=yield mn(h.generateContentStreamInternal(Y)),R=[],T=[];try{for(var q=!0,j=(U=void 0,Ac(K)),H;H=yield mn(j.next()),L=H.done,!L;q=!0){z=H.value,q=!1;const N=z;if(yield yield mn(N),N.candidates&&(!((E=N.candidates[0])===null||E===void 0)&&E.content)){T.push(N.candidates[0].content);for(const I of(S=N.candidates[0].content.parts)!==null&&S!==void 0?S:[])if(d<a&&I.functionCall){if(!I.functionCall.name)throw new Error("Function call name was not returned by the model.");if(_.has(I.functionCall.name)){const D=yield mn(_.get(I.functionCall.name).callTool([I.functionCall]));R.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${_.keys()}, mising tool: ${I.functionCall.name}`)}}}}catch(N){U={error:N}}finally{try{!q&&!L&&(F=j.return)&&(yield mn(F.call(j)))}finally{if(U)throw U.error}}if(R.length>0){c=!0;const N=new bc;N.candidates=[{content:{role:"user",parts:R}}],yield yield mn(N);const I=[];I.push(...T),I.push({role:"user",parts:R});const D=ti(b.contents).concat(I);b.contents=D}else break}})})(this,f,e)}async generateContentInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=cb(this.apiClient,e);return d=Je("{model}:generateContent",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=db(_),E=new bc;return Object.assign(E,b),E})}else{const h=lb(this.apiClient,e);return d=Je("{model}:generateContent",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=ub(_),E=new bc;return Object.assign(E,b),E})}}async generateContentStreamInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=cb(this.apiClient,e);return d=Je("{model}:streamGenerateContent?alt=sse",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),c.then(function(b){return nl(this,arguments,function*(){var E,S,L,U;try{for(var F=!0,z=Ac(b),q;q=yield mn(z.next()),E=q.done,!E;F=!0){U=q.value,F=!1;const j=U,H=db(yield mn(j.json()));H.sdkHttpResponse={headers:j.headers};const Y=new bc;Object.assign(Y,H),yield yield mn(Y)}}catch(j){S={error:j}}finally{try{!F&&!E&&(L=z.return)&&(yield mn(L.call(z)))}finally{if(S)throw S.error}}})})}else{const h=lb(this.apiClient,e);return d=Je("{model}:streamGenerateContent?alt=sse",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),c.then(function(b){return nl(this,arguments,function*(){var E,S,L,U;try{for(var F=!0,z=Ac(b),q;q=yield mn(z.next()),E=q.done,!E;F=!0){U=q.value,F=!1;const j=U,H=ub(yield mn(j.json()));H.sdkHttpResponse={headers:j.headers};const Y=new bc;Object.assign(Y,H),yield yield mn(Y)}}catch(j){S={error:j}}finally{try{!F&&!E&&(L=z.return)&&(yield mn(L.call(z)))}finally{if(S)throw S.error}}})})}}async embedContent(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=FR(this.apiClient,e);return d=Je("{model}:predict",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=HR(_),E=new $x;return Object.assign(E,b),E})}else{const h=jR(this.apiClient,e);return d=Je("{model}:batchEmbedContents",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=qR(_),E=new $x;return Object.assign(E,b),E})}}async generateImagesInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=ZR(this.apiClient,e);return d=Je("{model}:predict",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=tN(_),E=new Yx;return Object.assign(E,b),E})}else{const h=QR(this.apiClient,e);return d=Je("{model}:predict",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=eN(_),E=new Yx;return Object.assign(E,b),E})}}async editImageInternal(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI()){const d=UR(this.apiClient,e);return a=Je("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const _=h;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const h=OR(f),_=new sI;return Object.assign(_,h),_})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI()){const d=WN(this.apiClient,e);return a=Je("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const _=h;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const h=XN(f),_=new iI;return Object.assign(_,h),_})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI()){const d=kN(this.apiClient,e);return a=Je("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),r.then(f=>{const h=DN(f),_=new rI;return Object.assign(_,h),_})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI()){const d=BN(this.apiClient,e);return a=Je("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),r.then(f=>{const h=zN(f),_=new oI;return Object.assign(_,h),_})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=vN(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),c.then(_=>Sm(_))}else{const h=yN(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),c.then(_=>Cm(_))}}async listInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=CN(this.apiClient,e);return d=Je("{models_url}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=AN(_),E=new Jx;return Object.assign(E,b),E})}else{const h=wN(this.apiClient,e);return d=Je("{models_url}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=SN(_),E=new Jx;return Object.assign(E,b),E})}}async update(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=JN(this.apiClient,e);return d=Je("{model}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),c.then(_=>Sm(_))}else{const h=YN(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),c.then(_=>Cm(_))}}async delete(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=DR(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=LR(_),E=new Kx;return Object.assign(E,b),E})}else{const h=kR(this.apiClient,e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=PR(_),E=new Kx;return Object.assign(E,b),E})}}async countTokens(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=RR(this.apiClient,e);return d=Je("{model}:countTokens",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=MR(_),E=new Wx;return Object.assign(E,b),E})}else{const h=IR(this.apiClient,e);return d=Je("{model}:countTokens",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=NR(_),E=new Wx;return Object.assign(E,b),E})}}async computeTokens(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI()){const d=bR(this.apiClient,e);return a=Je("{model}:computeTokens",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const _=h;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const h=ER(f),_=new aI;return Object.assign(_,h),_})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=aN(this.apiClient,e);return d=Je("{model}:predictLongRunning",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),c.then(_=>{const b=rN(_),E=new $d;return Object.assign(E,b),E})}else{const h=oN(this.apiClient,e);return d=Je("{model}:predictLongRunning",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),c.then(_=>{const b=iN(_),E=new $d;return Object.assign(E,b),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MM extends aa{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,s=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let a;s&&"httpOptions"in s&&(a=s.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:a}});return n._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:s});return n._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async get(e){const n=e.operation,s=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=n.name.split("/operations/")[0];let a;s&&"httpOptions"in s&&(a=s.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:r,config:{httpOptions:a}});return n._fromAPIResponse({apiResponse:c,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:n.name,config:s});return n._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=eI(e);return d=Je("{operationName}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json()),c}else{const h=Z1(e);return d=Je("{operationName}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),c}}async fetchPredictVideosOperationInternal(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI()){const d=$1(e);return a=Je("{resourceName}:fetchPredictOperation",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kM(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["data"]);n!=null&&v(e,["data"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function DM(t){const e={},n=p(t,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>jM(a))),v(e,["parts"],r)}const s=p(t,["role"]);return s!=null&&v(e,["role"],s),e}function PM(t,e,n){const s={},r=p(e,["expireTime"]);n!==void 0&&r!=null&&v(n,["expireTime"],r);const a=p(e,["newSessionExpireTime"]);n!==void 0&&a!=null&&v(n,["newSessionExpireTime"],a);const c=p(e,["uses"]);n!==void 0&&c!=null&&v(n,["uses"],c);const d=p(e,["liveConnectConstraints"]);n!==void 0&&d!=null&&v(n,["bidiGenerateContentSetup"],zM(t,d));const f=p(e,["lockAdditionalFields"]);return n!==void 0&&f!=null&&v(n,["fieldMask"],f),s}function LM(t,e){const n={},s=p(e,["config"]);return s!=null&&v(n,["config"],PM(t,s,n)),n}function VM(t){const e={};if(p(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=p(t,["fileUri"]);n!=null&&v(e,["fileUri"],n);const s=p(t,["mimeType"]);return s!=null&&v(e,["mimeType"],s),e}function UM(t){const e={};if(p(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=p(t,["enableWidget"]);return n!=null&&v(e,["enableWidget"],n),e}function OM(t){const e={},n=p(t,["timeRangeFilter"]);if(n!=null&&v(e,["timeRangeFilter"],n),p(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function BM(t,e){const n={},s=p(t,["generationConfig"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig"],s);const r=p(t,["responseModalities"]);e!==void 0&&r!=null&&v(e,["setup","generationConfig","responseModalities"],r);const a=p(t,["temperature"]);e!==void 0&&a!=null&&v(e,["setup","generationConfig","temperature"],a);const c=p(t,["topP"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topP"],c);const d=p(t,["topK"]);e!==void 0&&d!=null&&v(e,["setup","generationConfig","topK"],d);const f=p(t,["maxOutputTokens"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","maxOutputTokens"],f);const h=p(t,["mediaResolution"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","mediaResolution"],h);const _=p(t,["seed"]);e!==void 0&&_!=null&&v(e,["setup","generationConfig","seed"],_);const b=p(t,["speechConfig"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","speechConfig"],gg(b));const E=p(t,["thinkingConfig"]);e!==void 0&&E!=null&&v(e,["setup","generationConfig","thinkingConfig"],E);const S=p(t,["enableAffectiveDialog"]);e!==void 0&&S!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],S);const L=p(t,["systemInstruction"]);e!==void 0&&L!=null&&v(e,["setup","systemInstruction"],DM(ds(L)));const U=p(t,["tools"]);if(e!==void 0&&U!=null){let K=_l(U);Array.isArray(K)&&(K=K.map(R=>qM(vl(R)))),v(e,["setup","tools"],K)}const F=p(t,["sessionResumption"]);e!==void 0&&F!=null&&v(e,["setup","sessionResumption"],FM(F));const z=p(t,["inputAudioTranscription"]);e!==void 0&&z!=null&&v(e,["setup","inputAudioTranscription"],z);const q=p(t,["outputAudioTranscription"]);e!==void 0&&q!=null&&v(e,["setup","outputAudioTranscription"],q);const j=p(t,["realtimeInputConfig"]);e!==void 0&&j!=null&&v(e,["setup","realtimeInputConfig"],j);const H=p(t,["contextWindowCompression"]);e!==void 0&&H!=null&&v(e,["setup","contextWindowCompression"],H);const Y=p(t,["proactivity"]);return e!==void 0&&Y!=null&&v(e,["setup","proactivity"],Y),n}function zM(t,e){const n={},s=p(e,["model"]);s!=null&&v(n,["setup","model"],Ht(t,s));const r=p(e,["config"]);return r!=null&&v(n,["config"],BM(r,n)),n}function jM(t){const e={},n=p(t,["videoMetadata"]);n!=null&&v(e,["videoMetadata"],n);const s=p(t,["thought"]);s!=null&&v(e,["thought"],s);const r=p(t,["inlineData"]);r!=null&&v(e,["inlineData"],kM(r));const a=p(t,["fileData"]);a!=null&&v(e,["fileData"],VM(a));const c=p(t,["thoughtSignature"]);c!=null&&v(e,["thoughtSignature"],c);const d=p(t,["functionCall"]);d!=null&&v(e,["functionCall"],d);const f=p(t,["codeExecutionResult"]);f!=null&&v(e,["codeExecutionResult"],f);const h=p(t,["executableCode"]);h!=null&&v(e,["executableCode"],h);const _=p(t,["functionResponse"]);_!=null&&v(e,["functionResponse"],_);const b=p(t,["text"]);return b!=null&&v(e,["text"],b),e}function FM(t){const e={},n=p(t,["handle"]);if(n!=null&&v(e,["handle"],n),p(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function qM(t){const e={},n=p(t,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(_=>_)),v(e,["functionDeclarations"],h)}if(p(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=p(t,["googleSearch"]);s!=null&&v(e,["googleSearch"],OM(s));const r=p(t,["googleSearchRetrieval"]);if(r!=null&&v(e,["googleSearchRetrieval"],r),p(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=p(t,["googleMaps"]);a!=null&&v(e,["googleMaps"],UM(a));const c=p(t,["urlContext"]);c!=null&&v(e,["urlContext"],c);const d=p(t,["computerUse"]);d!=null&&v(e,["computerUse"],d);const f=p(t,["codeExecution"]);return f!=null&&v(e,["codeExecution"],f),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HM(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const s=t[n];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const r=Object.keys(s).map(a=>`${n}.${a}`);e.push(...r)}else e.push(n)}return e.join(",")}function GM(t,e){let n=null;const s=t.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const a=s.setup;typeof a=="object"&&a!==null?(t.bidiGenerateContentSetup=a,n=a):delete t.bidiGenerateContentSetup}else s!==void 0&&delete t.bidiGenerateContentSetup;const r=t.fieldMask;if(n){const a=HM(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?t.fieldMask=a:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];r.length>0&&(d=r.map(h=>c.includes(h)?`generationConfig.${h}`:h));const f=[];a&&f.push(a),d.length>0&&f.push(...d),f.length>0?t.fieldMask=f.join(","):delete t.fieldMask}else delete t.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?t.fieldMask=r.join(","):delete t.fieldMask;return t}class $M extends aa{constructor(e){super(),this.apiClient=e}async create(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=LM(this.apiClient,e);a=Je("auth_tokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const f=GM(d,e.config);return r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),r.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YM(t){const e={},n=p(t,["name"]);return n!=null&&v(e,["_url","name"],n),e}function JM(t){const e={},n=p(t,["name"]);return n!=null&&v(e,["_url","name"],n),e}function KM(t,e){const n={};if(p(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=p(t,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&v(e,["displayName"],s),p(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=p(t,["epochCount"]);e!==void 0&&r!=null&&v(e,["tuningTask","hyperparameters","epochCount"],r);const a=p(t,["learningRateMultiplier"]);if(a!=null&&v(n,["tuningTask","hyperparameters","learningRateMultiplier"],a),p(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(p(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(p(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=p(t,["batchSize"]);e!==void 0&&c!=null&&v(e,["tuningTask","hyperparameters","batchSize"],c);const d=p(t,["learningRate"]);if(e!==void 0&&d!=null&&v(e,["tuningTask","hyperparameters","learningRate"],d),p(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function WM(t,e){const n={},s=p(t,["validationDataset"]);e!==void 0&&s!=null&&v(e,["supervisedTuningSpec"],dk(s,n));const r=p(t,["tunedModelDisplayName"]);e!==void 0&&r!=null&&v(e,["tunedModelDisplayName"],r);const a=p(t,["description"]);e!==void 0&&a!=null&&v(e,["description"],a);const c=p(t,["epochCount"]);e!==void 0&&c!=null&&v(e,["supervisedTuningSpec","hyperParameters","epochCount"],c);const d=p(t,["learningRateMultiplier"]);e!==void 0&&d!=null&&v(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const f=p(t,["exportLastCheckpointOnly"]);e!==void 0&&f!=null&&v(e,["supervisedTuningSpec","exportLastCheckpointOnly"],f);const h=p(t,["adapterSize"]);if(e!==void 0&&h!=null&&v(e,["supervisedTuningSpec","hyperParameters","adapterSize"],h),p(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(p(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const _=p(t,["labels"]);return e!==void 0&&_!=null&&v(e,["labels"],_),n}function XM(t){const e={},n=p(t,["baseModel"]);n!=null&&v(e,["baseModel"],n);const s=p(t,["preTunedModel"]);s!=null&&v(e,["preTunedModel"],s);const r=p(t,["trainingDataset"]);r!=null&&v(e,["tuningTask","trainingData"],lk(r));const a=p(t,["config"]);return a!=null&&KM(a,e),e}function QM(t){const e={},n=p(t,["baseModel"]);n!=null&&v(e,["baseModel"],n);const s=p(t,["preTunedModel"]);s!=null&&v(e,["preTunedModel"],s);const r=p(t,["trainingDataset"]);r!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],ck(r,e));const a=p(t,["config"]);return a!=null&&WM(a,e),e}function ZM(t){const e={},n=p(t,["name"]);return n!=null&&v(e,["_url","name"],n),e}function ek(t){const e={},n=p(t,["name"]);return n!=null&&v(e,["_url","name"],n),e}function tk(t,e){const n={},s=p(t,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const r=p(t,["pageToken"]);e!==void 0&&r!=null&&v(e,["_query","pageToken"],r);const a=p(t,["filter"]);return e!==void 0&&a!=null&&v(e,["_query","filter"],a),n}function nk(t,e){const n={},s=p(t,["pageSize"]);e!==void 0&&s!=null&&v(e,["_query","pageSize"],s);const r=p(t,["pageToken"]);e!==void 0&&r!=null&&v(e,["_query","pageToken"],r);const a=p(t,["filter"]);return e!==void 0&&a!=null&&v(e,["_query","filter"],a),n}function sk(t){const e={},n=p(t,["config"]);return n!=null&&tk(n,e),e}function ik(t){const e={},n=p(t,["config"]);return n!=null&&nk(n,e),e}function rk(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["nextPageToken"]);s!=null&&v(e,["nextPageToken"],s);const r=p(t,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>XT(c))),v(e,["tuningJobs"],a)}return e}function ok(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["nextPageToken"]);s!=null&&v(e,["nextPageToken"],s);const r=p(t,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>Im(c))),v(e,["tuningJobs"],a)}return e}function ak(t){const e={},n=p(t,["name"]);n!=null&&v(e,["model"],n);const s=p(t,["name"]);return s!=null&&v(e,["endpoint"],s),e}function lk(t){const e={};if(p(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(p(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=p(t,["examples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>r)),v(e,["examples","examples"],s)}return e}function ck(t,e){const n={},s=p(t,["gcsUri"]);e!==void 0&&s!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],s);const r=p(t,["vertexDatasetResource"]);if(e!==void 0&&r!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],r),p(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function XT(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["name"]);s!=null&&v(e,["name"],s);const r=p(t,["state"]);r!=null&&v(e,["state"],kT(r));const a=p(t,["createTime"]);a!=null&&v(e,["createTime"],a);const c=p(t,["tuningTask","startTime"]);c!=null&&v(e,["startTime"],c);const d=p(t,["tuningTask","completeTime"]);d!=null&&v(e,["endTime"],d);const f=p(t,["updateTime"]);f!=null&&v(e,["updateTime"],f);const h=p(t,["description"]);h!=null&&v(e,["description"],h);const _=p(t,["baseModel"]);_!=null&&v(e,["baseModel"],_);const b=p(t,["_self"]);return b!=null&&v(e,["tunedModel"],ak(b)),e}function Im(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["name"]);s!=null&&v(e,["name"],s);const r=p(t,["state"]);r!=null&&v(e,["state"],kT(r));const a=p(t,["createTime"]);a!=null&&v(e,["createTime"],a);const c=p(t,["startTime"]);c!=null&&v(e,["startTime"],c);const d=p(t,["endTime"]);d!=null&&v(e,["endTime"],d);const f=p(t,["updateTime"]);f!=null&&v(e,["updateTime"],f);const h=p(t,["error"]);h!=null&&v(e,["error"],h);const _=p(t,["description"]);_!=null&&v(e,["description"],_);const b=p(t,["baseModel"]);b!=null&&v(e,["baseModel"],b);const E=p(t,["tunedModel"]);E!=null&&v(e,["tunedModel"],E);const S=p(t,["preTunedModel"]);S!=null&&v(e,["preTunedModel"],S);const L=p(t,["supervisedTuningSpec"]);L!=null&&v(e,["supervisedTuningSpec"],L);const U=p(t,["tuningDataStats"]);U!=null&&v(e,["tuningDataStats"],U);const F=p(t,["encryptionSpec"]);F!=null&&v(e,["encryptionSpec"],F);const z=p(t,["partnerModelTuningSpec"]);z!=null&&v(e,["partnerModelTuningSpec"],z);const q=p(t,["customBaseModel"]);q!=null&&v(e,["customBaseModel"],q);const j=p(t,["experiment"]);j!=null&&v(e,["experiment"],j);const H=p(t,["labels"]);H!=null&&v(e,["labels"],H);const Y=p(t,["outputUri"]);Y!=null&&v(e,["outputUri"],Y);const K=p(t,["pipelineJob"]);K!=null&&v(e,["pipelineJob"],K);const R=p(t,["serviceAccount"]);R!=null&&v(e,["serviceAccount"],R);const T=p(t,["tunedModelDisplayName"]);T!=null&&v(e,["tunedModelDisplayName"],T);const N=p(t,["veoTuningSpec"]);return N!=null&&v(e,["veoTuningSpec"],N),e}function uk(t){const e={},n=p(t,["sdkHttpResponse"]);n!=null&&v(e,["sdkHttpResponse"],n);const s=p(t,["name"]);s!=null&&v(e,["name"],s);const r=p(t,["metadata"]);r!=null&&v(e,["metadata"],r);const a=p(t,["done"]);a!=null&&v(e,["done"],a);const c=p(t,["error"]);return c!=null&&v(e,["error"],c),e}function dk(t,e){const n={},s=p(t,["gcsUri"]);s!=null&&v(n,["validationDatasetUri"],s);const r=p(t,["vertexDatasetResource"]);return e!==void 0&&r!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],r),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hk extends aa{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new Yc(Qo.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(n),n),this.tune=async n=>{var s;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const r={tunedModelName:n.baseModel};!((s=n.config)===null||s===void 0)&&s.preTunedModelCheckpointId&&(r.checkpointId=n.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},n),{preTunedModel:r});return a.baseModel=void 0,await this.tuneInternal(a)}else{const r=Object.assign({},n);return await this.tuneInternal(r)}else{const r=Object.assign({},n),a=await this.tuneMldevInternal(r);let c="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?c=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(c=a.name.split("/operations/")[0]),{name:c,state:bm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=ek(e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>Im(_))}else{const h=ZM(e);return d=Je("{name}",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>XT(_))}}async listInternal(e){var n,s,r,a;let c,d="",f={};if(this.apiClient.isVertexAI()){const h=ik(e);return d=Je("tuningJobs",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=ok(_),E=new Xx;return Object.assign(E,b),E})}else{const h=sk(e);return d=Je("tunedModels",h._url),f=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(b=>{const E=b;return E.sdkHttpResponse={headers:_.headers},E})),c.then(_=>{const b=rk(_),E=new Xx;return Object.assign(E,b),E})}}async cancel(e){var n,s,r,a;let c="",d={};if(this.apiClient.isVertexAI()){const f=JM(e);c=Je("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const f=YM(e);c=Je("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async tuneInternal(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI()){const d=QM(e);return a=Je("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const _=h;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>Im(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,s;let r,a="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=XM(e);return a=Je("tunedModels",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(f=>f.json().then(h=>{const _=h;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>uk(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fk{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const pk=1024*1024*8,mk=3,gk=1e3,yk=2,nm="x-goog-upload-status";async function vk(t,e,n){var s,r,a;let c=0,d=0,f=new Em(new Response),h="upload";for(c=t.size;d<c;){const b=Math.min(pk,c-d),E=t.slice(d,d+b);d+b>=c&&(h+=", finalize");let S=0,L=gk;for(;S<mk&&(f=await n.request({path:"",body:E,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(d),"Content-Length":String(b)}}}),!(!((s=f==null?void 0:f.headers)===null||s===void 0)&&s[nm]));)S++,await xk(L),L=L*yk;if(d+=b,((r=f==null?void 0:f.headers)===null||r===void 0?void 0:r[nm])!=="active")break;if(c<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const _=await(f==null?void 0:f.json());if(((a=f==null?void 0:f.headers)===null||a===void 0?void 0:a[nm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return _.file}async function _k(t){return{size:t.size,type:t.type}}function xk(t){return new Promise(e=>setTimeout(e,t))}class bk{async upload(e,n,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await vk(e,n,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await _k(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ek{create(e,n,s){return new Tk(e,n,s)}}class Tk{constructor(e,n,s){this.url=e,this.headers=n,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yb="x-goog-api-key";class wk{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(yb)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(yb,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ck="gl-node/";class Sk{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const s=H1(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion;const r=new wk(this.apiKey);this.apiClient=new uM({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Ck+"web",uploader:new bk,downloader:new fk}),this.models=new NM(this.apiClient),this.live=new TM(this.apiClient,r,new Ek),this.batches=new c2(this.apiClient),this.chats=new j2(this.models,this.apiClient),this.caches=new O2(this.apiClient),this.files=new X2(this.apiClient),this.operations=new MM(this.apiClient),this.authTokens=new $M(this.apiClient),this.tunings=new hk(this.apiClient)}}const Ak=()=>{};var vb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Ik=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const a=t[n++];e[s++]=String.fromCharCode((r&31)<<6|a&63)}else if(r>239&&r<365){const a=t[n++],c=t[n++],d=t[n++],f=((r&7)<<18|(a&63)<<12|(c&63)<<6|d&63)-65536;e[s++]=String.fromCharCode(55296+(f>>10)),e[s++]=String.fromCharCode(56320+(f&1023))}else{const a=t[n++],c=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(a&63)<<6|c&63)}}return e.join("")},ZT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const a=t[r],c=r+1<t.length,d=c?t[r+1]:0,f=r+2<t.length,h=f?t[r+2]:0,_=a>>2,b=(a&3)<<4|d>>4;let E=(d&15)<<2|h>>6,S=h&63;f||(S=64,c||(E=64)),s.push(n[_],n[b],n[E],n[S])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(QT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Ik(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const a=n[t.charAt(r++)],d=r<t.length?n[t.charAt(r)]:0;++r;const h=r<t.length?n[t.charAt(r)]:64;++r;const b=r<t.length?n[t.charAt(r)]:64;if(++r,a==null||d==null||h==null||b==null)throw new Rk;const E=a<<2|d>>4;if(s.push(E),h!==64){const S=d<<4&240|h>>2;if(s.push(S),b!==64){const L=h<<6&192|b;s.push(L)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Rk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Nk=function(t){const e=QT(t);return ZT.encodeByteArray(e,!0)},Jd=function(t){return Nk(t).replace(/\./g,"")},ew=function(t){try{return ZT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk=()=>Mk().__FIREBASE_DEFAULTS__,Dk=()=>{if(typeof process>"u"||typeof vb>"u")return;const t=vb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Pk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ew(t[1]);return e&&JSON.parse(e)},_h=()=>{try{return Ak()||kk()||Dk()||Pk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},tw=t=>{var e,n;return(n=(e=_h())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},nw=t=>{const e=tw(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},sw=()=>{var t;return(t=_h())==null?void 0:t.config},iw=t=>{var e;return(e=_h())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yo(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function vg(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Jd(JSON.stringify(n)),Jd(JSON.stringify(c)),""].join(".")}const Ic={};function Vk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ic))Ic[e]?t.emulator.push(e):t.prod.push(e);return t}function Uk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let _b=!1;function _g(t,e){if(typeof window>"u"||typeof document>"u"||!yo(window.location.host)||Ic[t]===e||Ic[t]||_b)return;Ic[t]=e;function n(E){return`__firebase__banner__${E}`}const s="__firebase__banner",a=Vk().prod.length>0;function c(){const E=document.getElementById(s);E&&E.remove()}function d(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function f(E,S){E.setAttribute("width","24"),E.setAttribute("id",S),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function h(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{_b=!0,c()},E}function _(E,S){E.setAttribute("id",S),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function b(){const E=Uk(s),S=n("text"),L=document.getElementById(S)||document.createElement("span"),U=n("learnmore"),F=document.getElementById(U)||document.createElement("a"),z=n("preprendIcon"),q=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const j=E.element;d(j),_(F,U);const H=h();f(q,z),j.append(q,L,F,H),document.body.appendChild(j)}a?(L.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,L.innerText="Preview backend running in this workspace."),L.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ok(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(hs())}function Bk(){var e;const t=(e=_h())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function jk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Fk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function qk(){const t=hs();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Hk(){return!Bk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gk(){try{return typeof indexedDB=="object"}catch{return!1}}function $k(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var a;e(((a=r.error)==null?void 0:a.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk="FirebaseError";class qi extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=Yk,Object.setPrototypeOf(this,qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jc.prototype.create)}}class Jc{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,a=this.errors[e],c=a?Jk(a,s):"Error",d=`${this.serviceName}: ${c} (${r}).`;return new qi(r,d,s)}}function Jk(t,e){return t.replace(Kk,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const Kk=/\{\$([^}]+)}/g;function Wk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Zo(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const a=t[r],c=e[r];if(xb(a)&&xb(c)){if(!Zo(a,c))return!1}else if(a!==c)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function xb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Xk(t,e){const n=new Qk(t,e);return n.subscribe.bind(n)}class Qk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");Zk(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=sm),r.error===void 0&&(r.error=sm),r.complete===void 0&&(r.complete=sm);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Zk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function sm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(t){return t&&t._delegate?t._delegate:t}class lo{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Lk;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(nD(e))try{this.getOrInitializeService({instanceIdentifier:Go})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const a=this.getOrInitializeService({instanceIdentifier:r});s.resolve(a)}catch{}}}}clearInstance(e=Go){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Go){return this.instances.has(e)}getOptions(e=Go){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[a,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);s===d&&c.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const a=this.instances.get(s);return a&&e(a,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:tD(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Go){return this.component?this.component.multipleInstances?e:Go:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tD(t){return t===Go?void 0:t}function nD(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new eD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Dt||(Dt={}));const iD={debug:Dt.DEBUG,verbose:Dt.VERBOSE,info:Dt.INFO,warn:Dt.WARN,error:Dt.ERROR,silent:Dt.SILENT},rD=Dt.INFO,oD={[Dt.DEBUG]:"log",[Dt.VERBOSE]:"log",[Dt.INFO]:"info",[Dt.WARN]:"warn",[Dt.ERROR]:"error"},aD=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=oD[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xg{constructor(e){this.name=e,this._logLevel=rD,this._logHandler=aD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?iD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Dt.DEBUG,...e),this._logHandler(this,Dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Dt.VERBOSE,...e),this._logHandler(this,Dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Dt.INFO,...e),this._logHandler(this,Dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Dt.WARN,...e),this._logHandler(this,Dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Dt.ERROR,...e),this._logHandler(this,Dt.ERROR,...e)}}const lD=(t,e)=>e.some(n=>t instanceof n);let bb,Eb;function cD(){return bb||(bb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uD(){return Eb||(Eb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ow=new WeakMap,Rm=new WeakMap,aw=new WeakMap,im=new WeakMap,bg=new WeakMap;function dD(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",a),t.removeEventListener("error",c)},a=()=>{n(so(t.result)),r()},c=()=>{s(t.error),r()};t.addEventListener("success",a),t.addEventListener("error",c)});return e.then(n=>{n instanceof IDBCursor&&ow.set(n,t)}).catch(()=>{}),bg.set(e,t),e}function hD(t){if(Rm.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",c),t.removeEventListener("abort",c)},a=()=>{n(),r()},c=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",a),t.addEventListener("error",c),t.addEventListener("abort",c)});Rm.set(t,e)}let Nm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Rm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||aw.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return so(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function fD(t){Nm=t(Nm)}function pD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(rm(this),e,...n);return aw.set(s,e.sort?e.sort():[e]),so(s)}:uD().includes(t)?function(...e){return t.apply(rm(this),e),so(ow.get(this))}:function(...e){return so(t.apply(rm(this),e))}}function mD(t){return typeof t=="function"?pD(t):(t instanceof IDBTransaction&&hD(t),lD(t,cD())?new Proxy(t,Nm):t)}function so(t){if(t instanceof IDBRequest)return dD(t);if(im.has(t))return im.get(t);const e=mD(t);return e!==t&&(im.set(t,e),bg.set(e,t)),e}const rm=t=>bg.get(t);function gD(t,e,{blocked:n,upgrade:s,blocking:r,terminated:a}={}){const c=indexedDB.open(t,e),d=so(c);return s&&c.addEventListener("upgradeneeded",f=>{s(so(c.result),f.oldVersion,f.newVersion,so(c.transaction),f)}),n&&c.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),d.then(f=>{a&&f.addEventListener("close",()=>a()),r&&f.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),d}const yD=["get","getKey","getAll","getAllKeys","count"],vD=["put","add","delete","clear"],om=new Map;function Tb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(om.get(e))return om.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=vD.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||yD.includes(n)))return;const a=async function(c,...d){const f=this.transaction(c,r?"readwrite":"readonly");let h=f.store;return s&&(h=h.index(d.shift())),(await Promise.all([h[n](...d),r&&f.done]))[0]};return om.set(e,a),a}fD(t=>({...t,get:(e,n,s)=>Tb(e,n)||t.get(e,n,s),has:(e,n)=>!!Tb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(xD(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function xD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mm="@firebase/app",wb="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hr=new xg("@firebase/app"),bD="@firebase/app-compat",ED="@firebase/analytics-compat",TD="@firebase/analytics",wD="@firebase/app-check-compat",CD="@firebase/app-check",SD="@firebase/auth",AD="@firebase/auth-compat",ID="@firebase/database",RD="@firebase/data-connect",ND="@firebase/database-compat",MD="@firebase/functions",kD="@firebase/functions-compat",DD="@firebase/installations",PD="@firebase/installations-compat",LD="@firebase/messaging",VD="@firebase/messaging-compat",UD="@firebase/performance",OD="@firebase/performance-compat",BD="@firebase/remote-config",zD="@firebase/remote-config-compat",jD="@firebase/storage",FD="@firebase/storage-compat",qD="@firebase/firestore",HD="@firebase/ai",GD="@firebase/firestore-compat",$D="firebase",YD="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const km="[DEFAULT]",JD={[Mm]:"fire-core",[bD]:"fire-core-compat",[TD]:"fire-analytics",[ED]:"fire-analytics-compat",[CD]:"fire-app-check",[wD]:"fire-app-check-compat",[SD]:"fire-auth",[AD]:"fire-auth-compat",[ID]:"fire-rtdb",[RD]:"fire-data-connect",[ND]:"fire-rtdb-compat",[MD]:"fire-fn",[kD]:"fire-fn-compat",[DD]:"fire-iid",[PD]:"fire-iid-compat",[LD]:"fire-fcm",[VD]:"fire-fcm-compat",[UD]:"fire-perf",[OD]:"fire-perf-compat",[BD]:"fire-rc",[zD]:"fire-rc-compat",[jD]:"fire-gcs",[FD]:"fire-gcs-compat",[qD]:"fire-fst",[GD]:"fire-fst-compat",[HD]:"fire-vertex","fire-js":"fire-js",[$D]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kd=new Map,KD=new Map,Dm=new Map;function Cb(t,e){try{t.container.addComponent(e)}catch(n){hr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ea(t){const e=t.name;if(Dm.has(e))return hr.debug(`There were multiple attempts to register component ${e}.`),!1;Dm.set(e,t);for(const n of Kd.values())Cb(n,t);for(const n of KD.values())Cb(n,t);return!0}function xh(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Zs(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},io=new Jc("app","Firebase",WD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw io.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=YD;function lw(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:km,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw io.create("bad-app-name",{appName:String(r)});if(n||(n=sw()),!n)throw io.create("no-options");const a=Kd.get(r);if(a){if(Zo(n,a.options)&&Zo(s,a.config))return a;throw io.create("duplicate-app",{appName:r})}const c=new sD(r);for(const f of Dm.values())c.addComponent(f);const d=new XD(n,s,c);return Kd.set(r,d),d}function Eg(t=km){const e=Kd.get(t);if(!e&&t===km&&sw())return lw();if(!e)throw io.create("no-app",{appName:t});return e}function Pi(t,e,n){let s=JD[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),a=e.match(/\s|\//);if(r||a){const c=[`Unable to register library "${s}" with version "${e}":`];r&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hr.warn(c.join(" "));return}ea(new lo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD="firebase-heartbeat-database",ZD=1,Vc="firebase-heartbeat-store";let am=null;function cw(){return am||(am=gD(QD,ZD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Vc)}catch(n){console.warn(n)}}}}).catch(t=>{throw io.create("idb-open",{originalErrorMessage:t.message})})),am}async function eP(t){try{const n=(await cw()).transaction(Vc),s=await n.objectStore(Vc).get(uw(t));return await n.done,s}catch(e){if(e instanceof qi)hr.warn(e.message);else{const n=io.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});hr.warn(n.message)}}}async function Sb(t,e){try{const s=(await cw()).transaction(Vc,"readwrite");await s.objectStore(Vc).put(e,uw(t)),await s.done}catch(n){if(n instanceof qi)hr.warn(n.message);else{const s=io.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});hr.warn(s.message)}}}function uw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=1024,nP=30;class sP{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new rP(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Ab();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(c=>c.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:r}),this._heartbeatsCache.heartbeats.length>nP){const c=oP(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){hr.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ab(),{heartbeatsToSend:s,unsentEntries:r}=iP(this._heartbeatsCache.heartbeats),a=Jd(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(n){return hr.warn(n),""}}}function Ab(){return new Date().toISOString().substring(0,10)}function iP(t,e=tP){const n=[];let s=t.slice();for(const r of t){const a=n.find(c=>c.agent===r.agent);if(a){if(a.dates.push(r.date),Ib(n)>e){a.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Ib(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class rP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Gk()?$k().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await eP(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Sb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Sb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ib(t){return Jd(JSON.stringify({version:2,heartbeats:t})).length}function oP(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aP(t){ea(new lo("platform-logger",e=>new _D(e),"PRIVATE")),ea(new lo("heartbeat",e=>new sP(e),"PRIVATE")),Pi(Mm,wb,t),Pi(Mm,wb,"esm2020"),Pi("fire-js","")}aP("");function dw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lP=dw,hw=new Jc("auth","Firebase",dw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd=new xg("@firebase/auth");function cP(t,...e){Wd.logLevel<=Dt.WARN&&Wd.warn(`Auth (${la}): ${t}`,...e)}function Ld(t,...e){Wd.logLevel<=Dt.ERROR&&Wd.error(`Auth (${la}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(t,...e){throw wg(t,...e)}function mi(t,...e){return wg(t,...e)}function Tg(t,e,n){const s={...lP(),[e]:n};return new Jc("auth","Firebase",s).create(e,{appName:t.name})}function Jo(t){return Tg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uP(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&ji(t,"argument-error"),Tg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wg(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return hw.create(t,...e)}function ft(t,e,...n){if(!t)throw wg(e,...n)}function ur(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ld(e),new Error(e)}function fr(t,e){t||ur(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function dP(){return Rb()==="http:"||Rb()==="https:"}function Rb(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(dP()||jk()||"connection"in navigator)?navigator.onLine:!0}function fP(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e,n){this.shortDelay=e,this.longDelay=n,fr(n>e,"Short delay should be less than long delay!"),this.isMobile=Ok()||Fk()}get(){return hP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cg(t,e){fr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ur("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ur("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ur("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mP=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gP=new Wc(3e4,6e4);function Sg(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function bl(t,e,n,s,r={}){return pw(t,r,async()=>{let a={},c={};s&&(e==="GET"?c=s:a={body:JSON.stringify(s)});const d=Kc({key:t.config.apiKey,...c}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:f,...a};return zk()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&yo(t.emulatorConfig.host)&&(h.credentials="include"),fw.fetch()(await mw(t,t.config.apiHost,n,d),h)})}async function pw(t,e,n){t._canInitEmulator=!1;const s={...pP,...e};try{const r=new vP(t),a=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const c=await a.json();if("needConfirmation"in c)throw wd(t,"account-exists-with-different-credential",c);if(a.ok&&!("errorMessage"in c))return c;{const d=a.ok?c.errorMessage:c.error.message,[f,h]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw wd(t,"credential-already-in-use",c);if(f==="EMAIL_EXISTS")throw wd(t,"email-already-in-use",c);if(f==="USER_DISABLED")throw wd(t,"user-disabled",c);const _=s[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Tg(t,_,h);ji(t,_)}}catch(r){if(r instanceof qi)throw r;ji(t,"network-request-failed",{message:String(r)})}}async function yP(t,e,n,s,r={}){const a=await bl(t,e,n,s,r);return"mfaPendingCredential"in a&&ji(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function mw(t,e,n,s){const r=`${e}${n}?${s}`,a=t,c=a.config.emulator?Cg(t.config,r):`${t.config.apiScheme}://${r}`;return mP.includes(n)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(c).toString():c}class vP{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(mi(this.auth,"network-request-failed")),gP.get())})}}function wd(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=mi(t,e,s);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _P(t,e){return bl(t,"POST","/v1/accounts:delete",e)}async function Xd(t,e){return bl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function xP(t,e=!1){const n=xn(t),s=await n.getIdToken(e),r=Ag(s);ft(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const a=typeof r.firebase=="object"?r.firebase:void 0,c=a==null?void 0:a.sign_in_provider;return{claims:r,token:s,authTime:Rc(lm(r.auth_time)),issuedAtTime:Rc(lm(r.iat)),expirationTime:Rc(lm(r.exp)),signInProvider:c||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function lm(t){return Number(t)*1e3}function Ag(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return Ld("JWT malformed, contained fewer than 3 sections"),null;try{const r=ew(n);return r?JSON.parse(r):(Ld("Failed to decode base64 JWT payload"),null)}catch(r){return Ld("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Nb(t){const e=Ag(t);return ft(e,"internal-error"),ft(typeof e.exp<"u","internal-error"),ft(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uc(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof qi&&bP(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function bP({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rc(this.lastLoginAt),this.creationTime=Rc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qd(t){var b;const e=t.auth,n=await t.getIdToken(),s=await Uc(t,Xd(e,{idToken:n}));ft(s==null?void 0:s.users.length,e,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const a=(b=r.providerUserInfo)!=null&&b.length?gw(r.providerUserInfo):[],c=wP(t.providerData,a),d=t.isAnonymous,f=!(t.email&&r.passwordHash)&&!(c!=null&&c.length),h=d?f:!1,_={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:c,metadata:new Lm(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(t,_)}async function TP(t){const e=xn(t);await Qd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function wP(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function gw(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CP(t,e){const n=await pw(t,{},async()=>{const s=Kc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:a}=t.config,c=await mw(t,r,"/v1/token",`key=${a}`),d=await t._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:s};return t.emulatorConfig&&yo(t.emulatorConfig.host)&&(f.credentials="include"),fw.fetch()(c,f)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function SP(t,e){return bl(t,"POST","/v2/accounts:revokeToken",Sg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ft(e.idToken,"internal-error"),ft(typeof e.idToken<"u","internal-error"),ft(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Nb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ft(e.length!==0,"internal-error");const n=Nb(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ft(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:a}=await CP(e,n);this.updateTokensAndExpiration(s,r,Number(a))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:a}=n,c=new il;return s&&(ft(typeof s=="string","internal-error",{appName:e}),c.refreshToken=s),r&&(ft(typeof r=="string","internal-error",{appName:e}),c.accessToken=r),a&&(ft(typeof a=="number","internal-error",{appName:e}),c.expirationTime=a),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new il,this.toJSON())}_performRefresh(){return ur("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(t,e){ft(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class pi{constructor({uid:e,auth:n,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new EP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Lm(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await Uc(this,this.stsTokenManager.getToken(this.auth,e));return ft(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return xP(this,e)}reload(){return TP(this)}_assign(e){this!==e&&(ft(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new pi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Qd(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zs(this.auth.app))return Promise.reject(Jo(this.auth));const e=await this.getIdToken();return await Uc(this,_P(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,r=n.email??void 0,a=n.phoneNumber??void 0,c=n.photoURL??void 0,d=n.tenantId??void 0,f=n._redirectEventId??void 0,h=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:b,emailVerified:E,isAnonymous:S,providerData:L,stsTokenManager:U}=n;ft(b&&U,e,"internal-error");const F=il.fromJSON(this.name,U);ft(typeof b=="string",e,"internal-error"),Kr(s,e.name),Kr(r,e.name),ft(typeof E=="boolean",e,"internal-error"),ft(typeof S=="boolean",e,"internal-error"),Kr(a,e.name),Kr(c,e.name),Kr(d,e.name),Kr(f,e.name),Kr(h,e.name),Kr(_,e.name);const z=new pi({uid:b,auth:e,email:r,emailVerified:E,displayName:s,isAnonymous:S,photoURL:c,phoneNumber:a,tenantId:d,stsTokenManager:F,createdAt:h,lastLoginAt:_});return L&&Array.isArray(L)&&(z.providerData=L.map(q=>({...q}))),f&&(z._redirectEventId=f),z}static async _fromIdTokenResponse(e,n,s=!1){const r=new il;r.updateFromServerResponse(n);const a=new pi({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Qd(a),a}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];ft(r.localId!==void 0,"internal-error");const a=r.providerUserInfo!==void 0?gw(r.providerUserInfo):[],c=!(r.email&&r.passwordHash)&&!(a!=null&&a.length),d=new il;d.updateFromIdToken(s);const f=new pi({uid:r.localId,auth:e,stsTokenManager:d,isAnonymous:c}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Lm(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(a!=null&&a.length)};return Object.assign(f,h),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mb=new Map;function dr(t){fr(t instanceof Function,"Expected a class definition");let e=Mb.get(t);return e?(fr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Mb.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}yw.type="NONE";const kb=yw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(t,e,n){return`firebase:${t}:${e}:${n}`}class rl{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:a}=this.auth;this.fullUserKey=Vd(this.userKey,r.apiKey,a),this.fullPersistenceKey=Vd("persistence",r.apiKey,a),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Xd(this.auth,{idToken:e}).catch(()=>{});return n?pi._fromGetAccountInfoResponse(this.auth,n,e):null}return pi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new rl(dr(kb),e,s);const r=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let a=r[0]||dr(kb);const c=Vd(s,e.config.apiKey,e.name);let d=null;for(const h of n)try{const _=await h._get(c);if(_){let b;if(typeof _=="string"){const E=await Xd(e,{idToken:_}).catch(()=>{});if(!E)break;b=await pi._fromGetAccountInfoResponse(e,E,_)}else b=pi._fromJSON(e,_);h!==a&&(d=b),a=h;break}}catch{}const f=r.filter(h=>h._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new rl(a,e,s):(a=f[0],d&&await a._set(c,d.toJSON()),await Promise.all(n.map(async h=>{if(h!==a)try{await h._remove(c)}catch{}})),new rl(a,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Tw(e))return"Blackberry";if(ww(e))return"Webos";if(_w(e))return"Safari";if((e.includes("chrome/")||xw(e))&&!e.includes("edge/"))return"Chrome";if(Ew(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function vw(t=hs()){return/firefox\//i.test(t)}function _w(t=hs()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xw(t=hs()){return/crios\//i.test(t)}function bw(t=hs()){return/iemobile/i.test(t)}function Ew(t=hs()){return/android/i.test(t)}function Tw(t=hs()){return/blackberry/i.test(t)}function ww(t=hs()){return/webos/i.test(t)}function Ig(t=hs()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function AP(t=hs()){var e;return Ig(t)&&!!((e=window.navigator)!=null&&e.standalone)}function IP(){return qk()&&document.documentMode===10}function Cw(t=hs()){return Ig(t)||Ew(t)||ww(t)||Tw(t)||/windows phone/i.test(t)||bw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t,e=[]){let n;switch(t){case"Browser":n=Db(hs());break;case"Worker":n=`${Db(hs())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${la}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=a=>new Promise((c,d)=>{try{const f=e(a);c(f)}catch(f){d(f)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NP(t,e={}){return bl(t,"GET","/v2/passwordPolicy",Sg(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=6;class kP{constructor(e){var s;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??MP,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((s=e.allowedNonAlphanumericCharacters)==null?void 0:s.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Pb(this),this.idTokenSubscription=new Pb(this),this.beforeStateQueue=new RP(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=dr(n)),this._initializationPromise=this.queue(async()=>{var s,r,a;if(!this._deleted&&(this.persistenceManager=await rl.create(this,e),(s=this._resolvePersistenceManagerAvailable)==null||s.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Xd(this,{idToken:e}),s=await pi._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(Zs(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(a=this.redirectUser)==null?void 0:a._redirectEventId,d=s==null?void 0:s._redirectEventId,f=await this.tryRedirectSignIn(e);(!c||c===d)&&(f!=null&&f.user)&&(s=f.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Qd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zs(this.app))return Promise.reject(Jo(this));const n=e?xn(e):null;return n&&ft(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ft(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zs(this.app)?Promise.reject(Jo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zs(this.app)?Promise.reject(Jo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(dr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await NP(this),n=new kP(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Jc("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await SP(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&dr(e)||this._popupRedirectResolver;ft(n,this,"argument-error"),this.redirectPersistenceManager=await rl.create(this,[dr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)==null?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const a=typeof n=="function"?n:n.next.bind(n);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(d,this,"internal-error"),d.then(()=>{c||a(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,s,r);return()=>{c=!0,f()}}else{const f=e.addObserver(n);return()=>{c=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Sw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var n;if(Zs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&cP(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function bh(t){return xn(t)}class Pb{constructor(e){this.auth=e,this.observer=null,this.addObserver=Xk(n=>this.observer=n)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function PP(t){Rg=t}function LP(t){return Rg.loadJS(t)}function VP(){return Rg.gapiScript}function UP(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(t,e){const n=xh(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),a=n.getOptions();if(Zo(a,e??{}))return r;ji(r,"already-initialized")}return n.initialize({options:e})}function BP(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(dr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function zP(t,e,n){const s=bh(t);ft(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,a=Aw(e),{host:c,port:d}=jP(e),f=d===null?"":`:${d}`,h={url:`${a}//${c}${f}/`},_=Object.freeze({host:c,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){ft(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),ft(Zo(h,s.config.emulator)&&Zo(_,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=h,s.emulatorConfig=_,s.settings.appVerificationDisabledForTesting=!0,yo(c)?(vg(`${a}//${c}${f}`),_g("Auth",!0)):FP()}function Aw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function jP(t){const e=Aw(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const a=r[1];return{host:a,port:Lb(s.substr(a.length+1))}}else{const[a,c]=s.split(":");return{host:a,port:Lb(c)}}}function Lb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function FP(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ur("not implemented")}_getIdTokenResponse(e){return ur("not implemented")}_linkToIdToken(e,n){return ur("not implemented")}_getReauthenticationResolver(e){return ur("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ol(t,e){return yP(t,"POST","/v1/accounts:signInWithIdp",Sg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qP="http://localhost";class ta extends Iw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ta(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ji("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...a}=n;if(!s||!r)return null;const c=new ta(s,r);return c.idToken=a.idToken||void 0,c.accessToken=a.accessToken||void 0,c.secret=a.secret,c.nonce=a.nonce,c.pendingToken=a.pendingToken||null,c}_getIdTokenResponse(e){const n=this.buildRequest();return ol(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,ol(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ol(e,n)}buildRequest(){const e={requestUri:qP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Kc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc extends Ng{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends Xc{constructor(){super("facebook.com")}static credential(e){return ta._fromParams({providerId:Wr.PROVIDER_ID,signInMethod:Wr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wr.credentialFromTaggedObject(e)}static credentialFromError(e){return Wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wr.credential(e.oauthAccessToken)}catch{return null}}}Wr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Wr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr extends Xc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ta._fromParams({providerId:lr.PROVIDER_ID,signInMethod:lr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return lr.credentialFromTaggedObject(e)}static credentialFromError(e){return lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return lr.credential(n,s)}catch{return null}}}lr.GOOGLE_SIGN_IN_METHOD="google.com";lr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends Xc{constructor(){super("github.com")}static credential(e){return ta._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xr.credential(e.oauthAccessToken)}catch{return null}}}Xr.GITHUB_SIGN_IN_METHOD="github.com";Xr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr extends Xc{constructor(){super("twitter.com")}static credential(e,n){return ta._fromParams({providerId:Qr.PROVIDER_ID,signInMethod:Qr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Qr.credentialFromTaggedObject(e)}static credentialFromError(e){return Qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Qr.credential(n,s)}catch{return null}}}Qr.TWITTER_SIGN_IN_METHOD="twitter.com";Qr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const a=await pi._fromIdTokenResponse(e,s,r),c=Vb(s);return new ul({user:a,providerId:c,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=Vb(s);return new ul({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function Vb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd extends qi{constructor(e,n,s,r){super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,Zd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new Zd(e,n,s,r)}}function Rw(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Zd._fromErrorAndOperation(t,a,e,s):a})}async function HP(t,e,n=!1){const s=await Uc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ul._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GP(t,e,n=!1){const{auth:s}=t;if(Zs(s.app))return Promise.reject(Jo(s));const r="reauthenticate";try{const a=await Uc(t,Rw(s,r,e,t),n);ft(a.idToken,s,"internal-error");const c=Ag(a.idToken);ft(c,s,"internal-error");const{sub:d}=c;return ft(t.uid===d,s,"user-mismatch"),ul._forOperation(t,r,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&ji(s,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $P(t,e,n=!1){if(Zs(t.app))return Promise.reject(Jo(t));const s="signIn",r=await Rw(t,s,e),a=await ul._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(a.user),a}function YP(t,e,n,s){return xn(t).onIdTokenChanged(e,n,s)}function JP(t,e,n){return xn(t).beforeAuthStateChanged(e,n)}function KP(t,e,n,s){return xn(t).onAuthStateChanged(e,n,s)}function WP(t){return xn(t).signOut()}const eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(eh,"1"),this.storage.removeItem(eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP=1e3,QP=10;class Mw extends Nw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Cw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((c,d,f)=>{this.notifyListeners(c,f)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const c=this.storage.getItem(s);!n&&this.localCache[s]===c||this.notifyListeners(s,c)},a=this.storage.getItem(s);IP()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,QP):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},XP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Mw.type="LOCAL";const ZP=Mw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw extends Nw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}kw.type="SESSION";const Dw=kw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eL(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new Eh(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:a}=n.data,c=this.handlersMap[r];if(!(c!=null&&c.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const d=Array.from(c).map(async h=>h(n.origin,a)),f=await eL(d);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Eh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mg(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,c;return new Promise((d,f)=>{const h=Mg("",20);r.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},s);c={messageChannel:r,onMessage(b){const E=b;if(E.data.eventId===h)switch(E.data.status){case"ack":clearTimeout(_),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(E.data.response);break;default:clearTimeout(_),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(c),r.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[r.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(){return window}function nL(t){Li().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(){return typeof Li().WorkerGlobalScope<"u"&&typeof Li().importScripts=="function"}async function sL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function iL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function rL(){return Pw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lw="firebaseLocalStorageDb",oL=1,th="firebaseLocalStorage",Vw="fbase_key";class Qc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Th(t,e){return t.transaction([th],e?"readwrite":"readonly").objectStore(th)}function aL(){const t=indexedDB.deleteDatabase(Lw);return new Qc(t).toPromise()}function Vm(){const t=indexedDB.open(Lw,oL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(th,{keyPath:Vw})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(th)?e(s):(s.close(),await aL(),e(await Vm()))})})}async function Ub(t,e,n){const s=Th(t,!0).put({[Vw]:e,value:n});return new Qc(s).toPromise()}async function lL(t,e){const n=Th(t,!1).get(e),s=await new Qc(n).toPromise();return s===void 0?null:s.value}function Ob(t,e){const n=Th(t,!0).delete(e);return new Qc(n).toPromise()}const cL=800,uL=3;class Uw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>uL)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Pw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Eh._getInstance(rL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,s;if(this.activeServiceWorker=await sL(),!this.activeServiceWorker)return;this.sender=new tL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(s=e[0])!=null&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||iL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vm();return await Ub(e,eh,"1"),await Ob(e,eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>Ub(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>lL(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ob(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const a=Th(r,!1).getAll();return new Qc(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:a}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),cL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Uw.type="LOCAL";const dL=Uw;new Wc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ow(t,e){return e?dr(e):(ft(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg extends Iw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ol(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ol(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ol(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function hL(t){return $P(t.auth,new kg(t),t.bypassAuthState)}function fL(t){const{auth:e,user:n}=t;return ft(n,e,"internal-error"),GP(n,new kg(t),t.bypassAuthState)}async function pL(t){const{auth:e,user:n}=t;return ft(n,e,"internal-error"),HP(n,new kg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e,n,s,r,a=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:a,error:c,type:d}=e;if(c){this.reject(c);return}const f={auth:this.auth,requestUri:n,sessionId:s,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hL;case"linkViaPopup":case"linkViaRedirect":return pL;case"reauthViaPopup":case"reauthViaRedirect":return fL;default:ji(this.auth,"internal-error")}}resolve(e){fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mL=new Wc(2e3,1e4);async function gL(t,e,n){if(Zs(t.app))return Promise.reject(mi(t,"operation-not-supported-in-this-environment"));const s=bh(t);uP(t,e,Ng);const r=Ow(s,n);return new $o(s,"signInViaPopup",e,r).executeNotNull()}class $o extends Bw{constructor(e,n,s,r,a){super(e,n,r,a),this.provider=s,this.authWindow=null,this.pollId=null,$o.currentPopupAction&&$o.currentPopupAction.cancel(),$o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ft(e,this.auth,"internal-error"),e}async onExecution(){fr(this.filter.length===1,"Popup operations only handle one event");const e=Mg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(mi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(mi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$o.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if((s=(n=this.authWindow)==null?void 0:n.window)!=null&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,mL.get())};e()}}$o.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yL="pendingRedirect",Ud=new Map;class vL extends Bw{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=Ud.get(this.auth._key());if(!e){try{const s=await _L(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}Ud.set(this.auth._key(),e)}return this.bypassAuthState||Ud.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _L(t,e){const n=EL(e),s=bL(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}function xL(t,e){Ud.set(t._key(),e)}function bL(t){return dr(t._redirectPersistence)}function EL(t){return Vd(yL,t.config.apiKey,t.name)}async function TL(t,e,n=!1){if(Zs(t.app))return Promise.reject(Jo(t));const s=bh(t),r=Ow(s,e),c=await new vL(s,r,n).execute();return c&&!n&&(delete c.user._redirectEventId,await s._persistUserIfCurrent(c.user),await s._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL=600*1e3;class CL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!SL(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!zw(e)){const r=((s=e.error.code)==null?void 0:s.split("auth/")[1])||"internal-error";n.onError(mi(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wL&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bb(e))}saveEventToCache(e){this.cachedEventUids.add(Bb(e)),this.lastProcessedEventTime=Date.now()}}function Bb(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function zw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function SL(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AL(t,e={}){return bl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,RL=/^https?/;async function NL(t){if(t.config.emulator)return;const{authorizedDomains:e}=await AL(t);for(const n of e)try{if(ML(n))return}catch{}ji(t,"unauthorized-domain")}function ML(t){const e=Pm(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&c.hostname===s}if(!RL.test(n))return!1;if(IL.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kL=new Wc(3e4,6e4);function zb(){const t=Li().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function DL(t){return new Promise((e,n)=>{var r,a,c;function s(){zb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zb(),n(mi(t,"network-request-failed"))},timeout:kL.get()})}if((a=(r=Li().gapi)==null?void 0:r.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((c=Li().gapi)!=null&&c.load)s();else{const d=UP("iframefcb");return Li()[d]=()=>{gapi.load?s():n(mi(t,"network-request-failed"))},LP(`${VP()}?onload=${d}`).catch(f=>n(f))}}).catch(e=>{throw Od=null,e})}let Od=null;function PL(t){return Od=Od||DL(t),Od}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL=new Wc(5e3,15e3),VL="__/auth/iframe",UL="emulator/auth/iframe",OL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},BL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function zL(t){const e=t.config;ft(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Cg(e,UL):`https://${t.config.authDomain}/${VL}`,s={apiKey:e.apiKey,appName:t.name,v:la},r=BL.get(t.config.apiHost);r&&(s.eid=r);const a=t._getFrameworks();return a.length&&(s.fw=a.join(",")),`${n}?${Kc(s).slice(1)}`}async function jL(t){const e=await PL(t),n=Li().gapi;return ft(n,t,"internal-error"),e.open({where:document.body,url:zL(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:OL,dontclear:!0},s=>new Promise(async(r,a)=>{await s.restyle({setHideOnLeave:!1});const c=mi(t,"network-request-failed"),d=Li().setTimeout(()=>{a(c)},LL.get());function f(){Li().clearTimeout(d),r(s)}s.ping(f).then(f,()=>{a(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qL=500,HL=600,GL="_blank",$L="http://localhost";class jb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function YL(t,e,n,s=qL,r=HL){const a=Math.max((window.screen.availHeight-r)/2,0).toString(),c=Math.max((window.screen.availWidth-s)/2,0).toString();let d="";const f={...FL,width:s.toString(),height:r.toString(),top:a,left:c},h=hs().toLowerCase();n&&(d=xw(h)?GL:n),vw(h)&&(e=e||$L,f.scrollbars="yes");const _=Object.entries(f).reduce((E,[S,L])=>`${E}${S}=${L},`,"");if(AP(h)&&d!=="_self")return JL(e||"",d),new jb(null);const b=window.open(e||"",d,_);ft(b,t,"popup-blocked");try{b.focus()}catch{}return new jb(b)}function JL(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KL="__/auth/handler",WL="emulator/auth/handler",XL=encodeURIComponent("fac");async function Fb(t,e,n,s,r,a){ft(t.config.authDomain,t,"auth-domain-config-required"),ft(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:la,eventId:r};if(e instanceof Ng){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",Wk(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,b]of Object.entries({}))c[_]=b}if(e instanceof Xc){const _=e.getScopes().filter(b=>b!=="");_.length>0&&(c.scopes=_.join(","))}t.tenantId&&(c.tid=t.tenantId);const d=c;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const f=await t._getAppCheckToken(),h=f?`#${XL}=${encodeURIComponent(f)}`:"";return`${QL(t)}?${Kc(d).slice(1)}${h}`}function QL({config:t}){return t.emulator?Cg(t,WL):`https://${t.authDomain}/${KL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm="webStorageSupport";class ZL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Dw,this._completeRedirectFn=TL,this._overrideRedirectResult=xL}async _openPopup(e,n,s,r){var c;fr((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const a=await Fb(e,n,s,Pm(),r);return YL(e,a,Mg())}async _openRedirect(e,n,s,r){await this._originValidation(e);const a=await Fb(e,n,s,Pm(),r);return nL(a),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:a}=this.eventManagers[n];return r?Promise.resolve(r):(fr(a,"If manager is not set, promise should be"),a)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await jL(e),s=new CL(e);return n.register("authEvent",r=>(ft(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(cm,{type:cm},r=>{var c;const a=(c=r==null?void 0:r[0])==null?void 0:c[cm];a!==void 0&&n(!!a),ji(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=NL(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Cw()||_w()||Ig()}}const e4=ZL;var qb="@firebase/auth",Hb="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function s4(t){ea(new lo("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=s.options;ft(c&&!c.includes(":"),"invalid-api-key",{appName:s.name});const f={apiKey:c,authDomain:d,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Sw(t)},h=new DP(s,r,a,f);return BP(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),ea(new lo("auth-internal",e=>{const n=bh(e.getProvider("auth").getImmediate());return(s=>new t4(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pi(qb,Hb,n4(t)),Pi(qb,Hb,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=300,r4=iw("authIdTokenMaxAge")||i4;let Gb=null;const o4=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>r4)return;const r=n==null?void 0:n.token;Gb!==r&&(Gb=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function a4(t=Eg()){const e=xh(t,"auth");if(e.isInitialized())return e.getImmediate();const n=OP(t,{popupRedirectResolver:e4,persistence:[dL,ZP,Dw]}),s=iw("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(s,location.origin);if(location.origin===a.origin){const c=o4(a.toString());JP(n,c,()=>c(n.currentUser)),YP(n,d=>c(d))}}const r=tw("auth");return r&&zP(n,`http://${r}`),n}function l4(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}PP({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const a=mi("internal-error");a.customData=r,n(a)},s.type="text/javascript",s.charset="UTF-8",l4().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});s4("Browser");var c4="firebase",u4="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pi(c4,u4,"app");var $b=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ro,jw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,T){function N(){}N.prototype=T.prototype,R.F=T.prototype,R.prototype=new N,R.prototype.constructor=R,R.D=function(I,D,k){for(var M=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)M[ce-2]=arguments[ce];return T.prototype[D].apply(I,M)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,n),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(R,T,N){N||(N=0);const I=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)I[D]=T.charCodeAt(N++)|T.charCodeAt(N++)<<8|T.charCodeAt(N++)<<16|T.charCodeAt(N++)<<24;else for(D=0;D<16;++D)I[D]=T[N++]|T[N++]<<8|T[N++]<<16|T[N++]<<24;T=R.g[0],N=R.g[1],D=R.g[2];let k=R.g[3],M;M=T+(k^N&(D^k))+I[0]+3614090360&4294967295,T=N+(M<<7&4294967295|M>>>25),M=k+(D^T&(N^D))+I[1]+3905402710&4294967295,k=T+(M<<12&4294967295|M>>>20),M=D+(N^k&(T^N))+I[2]+606105819&4294967295,D=k+(M<<17&4294967295|M>>>15),M=N+(T^D&(k^T))+I[3]+3250441966&4294967295,N=D+(M<<22&4294967295|M>>>10),M=T+(k^N&(D^k))+I[4]+4118548399&4294967295,T=N+(M<<7&4294967295|M>>>25),M=k+(D^T&(N^D))+I[5]+1200080426&4294967295,k=T+(M<<12&4294967295|M>>>20),M=D+(N^k&(T^N))+I[6]+2821735955&4294967295,D=k+(M<<17&4294967295|M>>>15),M=N+(T^D&(k^T))+I[7]+4249261313&4294967295,N=D+(M<<22&4294967295|M>>>10),M=T+(k^N&(D^k))+I[8]+1770035416&4294967295,T=N+(M<<7&4294967295|M>>>25),M=k+(D^T&(N^D))+I[9]+2336552879&4294967295,k=T+(M<<12&4294967295|M>>>20),M=D+(N^k&(T^N))+I[10]+4294925233&4294967295,D=k+(M<<17&4294967295|M>>>15),M=N+(T^D&(k^T))+I[11]+2304563134&4294967295,N=D+(M<<22&4294967295|M>>>10),M=T+(k^N&(D^k))+I[12]+1804603682&4294967295,T=N+(M<<7&4294967295|M>>>25),M=k+(D^T&(N^D))+I[13]+4254626195&4294967295,k=T+(M<<12&4294967295|M>>>20),M=D+(N^k&(T^N))+I[14]+2792965006&4294967295,D=k+(M<<17&4294967295|M>>>15),M=N+(T^D&(k^T))+I[15]+1236535329&4294967295,N=D+(M<<22&4294967295|M>>>10),M=T+(D^k&(N^D))+I[1]+4129170786&4294967295,T=N+(M<<5&4294967295|M>>>27),M=k+(N^D&(T^N))+I[6]+3225465664&4294967295,k=T+(M<<9&4294967295|M>>>23),M=D+(T^N&(k^T))+I[11]+643717713&4294967295,D=k+(M<<14&4294967295|M>>>18),M=N+(k^T&(D^k))+I[0]+3921069994&4294967295,N=D+(M<<20&4294967295|M>>>12),M=T+(D^k&(N^D))+I[5]+3593408605&4294967295,T=N+(M<<5&4294967295|M>>>27),M=k+(N^D&(T^N))+I[10]+38016083&4294967295,k=T+(M<<9&4294967295|M>>>23),M=D+(T^N&(k^T))+I[15]+3634488961&4294967295,D=k+(M<<14&4294967295|M>>>18),M=N+(k^T&(D^k))+I[4]+3889429448&4294967295,N=D+(M<<20&4294967295|M>>>12),M=T+(D^k&(N^D))+I[9]+568446438&4294967295,T=N+(M<<5&4294967295|M>>>27),M=k+(N^D&(T^N))+I[14]+3275163606&4294967295,k=T+(M<<9&4294967295|M>>>23),M=D+(T^N&(k^T))+I[3]+4107603335&4294967295,D=k+(M<<14&4294967295|M>>>18),M=N+(k^T&(D^k))+I[8]+1163531501&4294967295,N=D+(M<<20&4294967295|M>>>12),M=T+(D^k&(N^D))+I[13]+2850285829&4294967295,T=N+(M<<5&4294967295|M>>>27),M=k+(N^D&(T^N))+I[2]+4243563512&4294967295,k=T+(M<<9&4294967295|M>>>23),M=D+(T^N&(k^T))+I[7]+1735328473&4294967295,D=k+(M<<14&4294967295|M>>>18),M=N+(k^T&(D^k))+I[12]+2368359562&4294967295,N=D+(M<<20&4294967295|M>>>12),M=T+(N^D^k)+I[5]+4294588738&4294967295,T=N+(M<<4&4294967295|M>>>28),M=k+(T^N^D)+I[8]+2272392833&4294967295,k=T+(M<<11&4294967295|M>>>21),M=D+(k^T^N)+I[11]+1839030562&4294967295,D=k+(M<<16&4294967295|M>>>16),M=N+(D^k^T)+I[14]+4259657740&4294967295,N=D+(M<<23&4294967295|M>>>9),M=T+(N^D^k)+I[1]+2763975236&4294967295,T=N+(M<<4&4294967295|M>>>28),M=k+(T^N^D)+I[4]+1272893353&4294967295,k=T+(M<<11&4294967295|M>>>21),M=D+(k^T^N)+I[7]+4139469664&4294967295,D=k+(M<<16&4294967295|M>>>16),M=N+(D^k^T)+I[10]+3200236656&4294967295,N=D+(M<<23&4294967295|M>>>9),M=T+(N^D^k)+I[13]+681279174&4294967295,T=N+(M<<4&4294967295|M>>>28),M=k+(T^N^D)+I[0]+3936430074&4294967295,k=T+(M<<11&4294967295|M>>>21),M=D+(k^T^N)+I[3]+3572445317&4294967295,D=k+(M<<16&4294967295|M>>>16),M=N+(D^k^T)+I[6]+76029189&4294967295,N=D+(M<<23&4294967295|M>>>9),M=T+(N^D^k)+I[9]+3654602809&4294967295,T=N+(M<<4&4294967295|M>>>28),M=k+(T^N^D)+I[12]+3873151461&4294967295,k=T+(M<<11&4294967295|M>>>21),M=D+(k^T^N)+I[15]+530742520&4294967295,D=k+(M<<16&4294967295|M>>>16),M=N+(D^k^T)+I[2]+3299628645&4294967295,N=D+(M<<23&4294967295|M>>>9),M=T+(D^(N|~k))+I[0]+4096336452&4294967295,T=N+(M<<6&4294967295|M>>>26),M=k+(N^(T|~D))+I[7]+1126891415&4294967295,k=T+(M<<10&4294967295|M>>>22),M=D+(T^(k|~N))+I[14]+2878612391&4294967295,D=k+(M<<15&4294967295|M>>>17),M=N+(k^(D|~T))+I[5]+4237533241&4294967295,N=D+(M<<21&4294967295|M>>>11),M=T+(D^(N|~k))+I[12]+1700485571&4294967295,T=N+(M<<6&4294967295|M>>>26),M=k+(N^(T|~D))+I[3]+2399980690&4294967295,k=T+(M<<10&4294967295|M>>>22),M=D+(T^(k|~N))+I[10]+4293915773&4294967295,D=k+(M<<15&4294967295|M>>>17),M=N+(k^(D|~T))+I[1]+2240044497&4294967295,N=D+(M<<21&4294967295|M>>>11),M=T+(D^(N|~k))+I[8]+1873313359&4294967295,T=N+(M<<6&4294967295|M>>>26),M=k+(N^(T|~D))+I[15]+4264355552&4294967295,k=T+(M<<10&4294967295|M>>>22),M=D+(T^(k|~N))+I[6]+2734768916&4294967295,D=k+(M<<15&4294967295|M>>>17),M=N+(k^(D|~T))+I[13]+1309151649&4294967295,N=D+(M<<21&4294967295|M>>>11),M=T+(D^(N|~k))+I[4]+4149444226&4294967295,T=N+(M<<6&4294967295|M>>>26),M=k+(N^(T|~D))+I[11]+3174756917&4294967295,k=T+(M<<10&4294967295|M>>>22),M=D+(T^(k|~N))+I[2]+718787259&4294967295,D=k+(M<<15&4294967295|M>>>17),M=N+(k^(D|~T))+I[9]+3951481745&4294967295,R.g[0]=R.g[0]+T&4294967295,R.g[1]=R.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+k&4294967295}s.prototype.v=function(R,T){T===void 0&&(T=R.length);const N=T-this.blockSize,I=this.C;let D=this.h,k=0;for(;k<T;){if(D==0)for(;k<=N;)r(this,R,k),k+=this.blockSize;if(typeof R=="string"){for(;k<T;)if(I[D++]=R.charCodeAt(k++),D==this.blockSize){r(this,I),D=0;break}}else for(;k<T;)if(I[D++]=R[k++],D==this.blockSize){r(this,I),D=0;break}}this.h=D,this.o+=T},s.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var T=1;T<R.length-8;++T)R[T]=0;T=this.o*8;for(var N=R.length-8;N<R.length;++N)R[N]=T&255,T/=256;for(this.v(R),R=Array(16),T=0,N=0;N<4;++N)for(let I=0;I<32;I+=8)R[T++]=this.g[N]>>>I&255;return R};function a(R,T){var N=d;return Object.prototype.hasOwnProperty.call(N,R)?N[R]:N[R]=T(R)}function c(R,T){this.h=T;const N=[];let I=!0;for(let D=R.length-1;D>=0;D--){const k=R[D]|0;I&&k==T||(N[D]=k,I=!1)}this.g=N}var d={};function f(R){return-128<=R&&R<128?a(R,function(T){return new c([T|0],T<0?-1:0)}):new c([R|0],R<0?-1:0)}function h(R){if(isNaN(R)||!isFinite(R))return b;if(R<0)return F(h(-R));const T=[];let N=1;for(let I=0;R>=N;I++)T[I]=R/N|0,N*=4294967296;return new c(T,0)}function _(R,T){if(R.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(R.charAt(0)=="-")return F(_(R.substring(1),T));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=h(Math.pow(T,8));let I=b;for(let k=0;k<R.length;k+=8){var D=Math.min(8,R.length-k);const M=parseInt(R.substring(k,k+D),T);D<8?(D=h(Math.pow(T,D)),I=I.j(D).add(h(M))):(I=I.j(N),I=I.add(h(M)))}return I}var b=f(0),E=f(1),S=f(16777216);t=c.prototype,t.m=function(){if(U(this))return-F(this).m();let R=0,T=1;for(let N=0;N<this.g.length;N++){const I=this.i(N);R+=(I>=0?I:4294967296+I)*T,T*=4294967296}return R},t.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(L(this))return"0";if(U(this))return"-"+F(this).toString(R);const T=h(Math.pow(R,6));var N=this;let I="";for(;;){const D=H(N,T).g;N=z(N,D.j(T));let k=((N.g.length>0?N.g[0]:N.h)>>>0).toString(R);if(N=D,L(N))return k+I;for(;k.length<6;)k="0"+k;I=k+I}},t.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function L(R){if(R.h!=0)return!1;for(let T=0;T<R.g.length;T++)if(R.g[T]!=0)return!1;return!0}function U(R){return R.h==-1}t.l=function(R){return R=z(this,R),U(R)?-1:L(R)?0:1};function F(R){const T=R.g.length,N=[];for(let I=0;I<T;I++)N[I]=~R.g[I];return new c(N,~R.h).add(E)}t.abs=function(){return U(this)?F(this):this},t.add=function(R){const T=Math.max(this.g.length,R.g.length),N=[];let I=0;for(let D=0;D<=T;D++){let k=I+(this.i(D)&65535)+(R.i(D)&65535),M=(k>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);I=M>>>16,k&=65535,M&=65535,N[D]=M<<16|k}return new c(N,N[N.length-1]&-2147483648?-1:0)};function z(R,T){return R.add(F(T))}t.j=function(R){if(L(this)||L(R))return b;if(U(this))return U(R)?F(this).j(F(R)):F(F(this).j(R));if(U(R))return F(this.j(F(R)));if(this.l(S)<0&&R.l(S)<0)return h(this.m()*R.m());const T=this.g.length+R.g.length,N=[];for(var I=0;I<2*T;I++)N[I]=0;for(I=0;I<this.g.length;I++)for(let D=0;D<R.g.length;D++){const k=this.i(I)>>>16,M=this.i(I)&65535,ce=R.i(D)>>>16,ge=R.i(D)&65535;N[2*I+2*D]+=M*ge,q(N,2*I+2*D),N[2*I+2*D+1]+=k*ge,q(N,2*I+2*D+1),N[2*I+2*D+1]+=M*ce,q(N,2*I+2*D+1),N[2*I+2*D+2]+=k*ce,q(N,2*I+2*D+2)}for(R=0;R<T;R++)N[R]=N[2*R+1]<<16|N[2*R];for(R=T;R<2*T;R++)N[R]=0;return new c(N,0)};function q(R,T){for(;(R[T]&65535)!=R[T];)R[T+1]+=R[T]>>>16,R[T]&=65535,T++}function j(R,T){this.g=R,this.h=T}function H(R,T){if(L(T))throw Error("division by zero");if(L(R))return new j(b,b);if(U(R))return T=H(F(R),T),new j(F(T.g),F(T.h));if(U(T))return T=H(R,F(T)),new j(F(T.g),T.h);if(R.g.length>30){if(U(R)||U(T))throw Error("slowDivide_ only works with positive integers.");for(var N=E,I=T;I.l(R)<=0;)N=Y(N),I=Y(I);var D=K(N,1),k=K(I,1);for(I=K(I,2),N=K(N,2);!L(I);){var M=k.add(I);M.l(R)<=0&&(D=D.add(N),k=M),I=K(I,1),N=K(N,1)}return T=z(R,D.j(T)),new j(D,T)}for(D=b;R.l(T)>=0;){for(N=Math.max(1,Math.floor(R.m()/T.m())),I=Math.ceil(Math.log(N)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),k=h(N),M=k.j(T);U(M)||M.l(R)>0;)N-=I,k=h(N),M=k.j(T);L(k)&&(k=E),D=D.add(k),R=z(R,M)}return new j(D,R)}t.B=function(R){return H(this,R).h},t.and=function(R){const T=Math.max(this.g.length,R.g.length),N=[];for(let I=0;I<T;I++)N[I]=this.i(I)&R.i(I);return new c(N,this.h&R.h)},t.or=function(R){const T=Math.max(this.g.length,R.g.length),N=[];for(let I=0;I<T;I++)N[I]=this.i(I)|R.i(I);return new c(N,this.h|R.h)},t.xor=function(R){const T=Math.max(this.g.length,R.g.length),N=[];for(let I=0;I<T;I++)N[I]=this.i(I)^R.i(I);return new c(N,this.h^R.h)};function Y(R){const T=R.g.length+1,N=[];for(let I=0;I<T;I++)N[I]=R.i(I)<<1|R.i(I-1)>>>31;return new c(N,R.h)}function K(R,T){const N=T>>5;T%=32;const I=R.g.length-N,D=[];for(let k=0;k<I;k++)D[k]=T>0?R.i(k+N)>>>T|R.i(k+N+1)<<32-T:R.i(k+N);return new c(D,R.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,jw=s,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=h,c.fromString=_,ro=c}).apply(typeof $b<"u"?$b:typeof self<"u"?self:typeof window<"u"?window:{});var Cd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fw,Tc,qw,Bd,Um,Hw,Gw,$w;(function(){var t,e=Object.defineProperty;function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cd=="object"&&Cd];for(var w=0;w<m.length;++w){var A=m[w];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var s=n(this);function r(m,w){if(w)e:{var A=s;m=m.split(".");for(var B=0;B<m.length-1;B++){var se=m[B];if(!(se in A))break e;A=A[se]}m=m[m.length-1],B=A[m],w=w(B),w!=B&&w!=null&&e(A,m,{configurable:!0,writable:!0,value:w})}}r("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(m){return m||function(w){var A=[],B;for(B in w)Object.prototype.hasOwnProperty.call(w,B)&&A.push([B,w[B]]);return A}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},c=this||self;function d(m){var w=typeof m;return w=="object"&&m!=null||w=="function"}function f(m,w,A){return m.call.apply(m.bind,arguments)}function h(m,w,A){return h=f,h.apply(null,arguments)}function _(m,w){var A=Array.prototype.slice.call(arguments,1);return function(){var B=A.slice();return B.push.apply(B,arguments),m.apply(this,B)}}function b(m,w){function A(){}A.prototype=w.prototype,m.Z=w.prototype,m.prototype=new A,m.prototype.constructor=m,m.Ob=function(B,se,ue){for(var ke=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)ke[xt-2]=arguments[xt];return w.prototype[se].apply(B,ke)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function S(m){const w=m.length;if(w>0){const A=Array(w);for(let B=0;B<w;B++)A[B]=m[B];return A}return[]}function L(m,w){for(let B=1;B<arguments.length;B++){const se=arguments[B];var A=typeof se;if(A=A!="object"?A:se?Array.isArray(se)?"array":A:"null",A=="array"||A=="object"&&typeof se.length=="number"){A=m.length||0;const ue=se.length||0;m.length=A+ue;for(let ke=0;ke<ue;ke++)m[A+ke]=se[ke]}else m.push(se)}}class U{constructor(w,A){this.i=w,this.j=A,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function F(m){c.setTimeout(()=>{throw m},0)}function z(){var m=R;let w=null;return m.g&&(w=m.g,m.g=m.g.next,m.g||(m.h=null),w.next=null),w}class q{constructor(){this.h=this.g=null}add(w,A){const B=j.get();B.set(w,A),this.h?this.h.next=B:this.g=B,this.h=B}}var j=new U(()=>new H,m=>m.reset());class H{constructor(){this.next=this.g=this.h=null}set(w,A){this.h=w,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,K=!1,R=new q,T=()=>{const m=Promise.resolve(void 0);Y=()=>{m.then(N)}};function N(){for(var m;m=z();){try{m.h.call(m.g)}catch(A){F(A)}var w=j;w.j(m),w.h<100&&(w.h++,m.next=w.g,w.g=m)}K=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(m,w){this.type=m,this.g=this.target=w,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var k=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var m=!1,w=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const A=()=>{};c.addEventListener("test",A,w),c.removeEventListener("test",A,w)}catch{}return m})();function M(m){return/^[\s\xa0]*$/.test(m)}function ce(m,w){D.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,w)}b(ce,D),ce.prototype.init=function(m,w){const A=this.type=m.type,B=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=w,w=m.relatedTarget,w||(A=="mouseover"?w=m.fromElement:A=="mouseout"&&(w=m.toElement)),this.relatedTarget=w,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&ce.Z.h.call(this)},ce.prototype.h=function(){ce.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var ge="closure_listenable_"+(Math.random()*1e6|0),$=0;function G(m,w,A,B,se){this.listener=m,this.proxy=null,this.src=w,this.type=A,this.capture=!!B,this.ha=se,this.key=++$,this.da=this.fa=!1}function ae(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function ve(m,w,A){for(const B in m)w.call(A,m[B],B,m)}function X(m,w){for(const A in m)w.call(void 0,m[A],A,m)}function O(m){const w={};for(const A in m)w[A]=m[A];return w}const Q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function te(m,w){let A,B;for(let se=1;se<arguments.length;se++){B=arguments[se];for(A in B)m[A]=B[A];for(let ue=0;ue<Q.length;ue++)A=Q[ue],Object.prototype.hasOwnProperty.call(B,A)&&(m[A]=B[A])}}function ie(m){this.src=m,this.g={},this.h=0}ie.prototype.add=function(m,w,A,B,se){const ue=m.toString();m=this.g[ue],m||(m=this.g[ue]=[],this.h++);const ke=be(m,w,B,se);return ke>-1?(w=m[ke],A||(w.fa=!1)):(w=new G(w,this.src,ue,!!B,se),w.fa=A,m.push(w)),w};function Ce(m,w){const A=w.type;if(A in m.g){var B=m.g[A],se=Array.prototype.indexOf.call(B,w,void 0),ue;(ue=se>=0)&&Array.prototype.splice.call(B,se,1),ue&&(ae(w),m.g[A].length==0&&(delete m.g[A],m.h--))}}function be(m,w,A,B){for(let se=0;se<m.length;++se){const ue=m[se];if(!ue.da&&ue.listener==w&&ue.capture==!!A&&ue.ha==B)return se}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),Ue={};function Oe(m,w,A,B,se){if(Array.isArray(w)){for(let ue=0;ue<w.length;ue++)Oe(m,w[ue],A,B,se);return null}return A=We(A),m&&m[ge]?m.J(w,A,d(B)?!!B.capture:!1,se):tt(m,w,A,!1,B,se)}function tt(m,w,A,B,se,ue){if(!w)throw Error("Invalid event type");const ke=d(se)?!!se.capture:!!se;let xt=De(m);if(xt||(m[Fe]=xt=new ie(m)),A=xt.add(w,A,B,ke,ue),A.proxy)return A;if(B=Ot(),A.proxy=B,B.src=m,B.listener=A,m.addEventListener)k||(se=ke),se===void 0&&(se=!1),m.addEventListener(w.toString(),B,se);else if(m.attachEvent)m.attachEvent(Ne(w.toString()),B);else if(m.addListener&&m.removeListener)m.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Ot(){function m(A){return w.call(m.src,m.listener,A)}const w=Se;return m}function vt(m,w,A,B,se){if(Array.isArray(w))for(var ue=0;ue<w.length;ue++)vt(m,w[ue],A,B,se);else B=d(B)?!!B.capture:!!B,A=We(A),m&&m[ge]?(m=m.i,ue=String(w).toString(),ue in m.g&&(w=m.g[ue],A=be(w,A,B,se),A>-1&&(ae(w[A]),Array.prototype.splice.call(w,A,1),w.length==0&&(delete m.g[ue],m.h--)))):m&&(m=De(m))&&(w=m.g[w.toString()],m=-1,w&&(m=be(w,A,B,se)),(A=m>-1?w[m]:null)&&Ae(A))}function Ae(m){if(typeof m!="number"&&m&&!m.da){var w=m.src;if(w&&w[ge])Ce(w.i,m);else{var A=m.type,B=m.proxy;w.removeEventListener?w.removeEventListener(A,B,m.capture):w.detachEvent?w.detachEvent(Ne(A),B):w.addListener&&w.removeListener&&w.removeListener(B),(A=De(w))?(Ce(A,m),A.h==0&&(A.src=null,w[Fe]=null)):ae(m)}}}function Ne(m){return m in Ue?Ue[m]:Ue[m]="on"+m}function Se(m,w){if(m.da)m=!0;else{w=new ce(w,this);const A=m.listener,B=m.ha||m.src;m.fa&&Ae(m),m=A.call(B,w)}return m}function De(m){return m=m[Fe],m instanceof ie?m:null}var et="__closure_events_fn_"+(Math.random()*1e9>>>0);function We(m){return typeof m=="function"?m:(m[et]||(m[et]=function(w){return m.handleEvent(w)}),m[et])}function it(){I.call(this),this.i=new ie(this),this.M=this,this.G=null}b(it,I),it.prototype[ge]=!0,it.prototype.removeEventListener=function(m,w,A,B){vt(this,m,w,A,B)};function rt(m,w){var A,B=m.G;if(B)for(A=[];B;B=B.G)A.push(B);if(m=m.M,B=w.type||w,typeof w=="string")w=new D(w,m);else if(w instanceof D)w.target=w.target||m;else{var se=w;w=new D(B,m),te(w,se)}se=!0;let ue,ke;if(A)for(ke=A.length-1;ke>=0;ke--)ue=w.g=A[ke],se=St(ue,B,!0,w)&&se;if(ue=w.g=m,se=St(ue,B,!0,w)&&se,se=St(ue,B,!1,w)&&se,A)for(ke=0;ke<A.length;ke++)ue=w.g=A[ke],se=St(ue,B,!1,w)&&se}it.prototype.N=function(){if(it.Z.N.call(this),this.i){var m=this.i;for(const w in m.g){const A=m.g[w];for(let B=0;B<A.length;B++)ae(A[B]);delete m.g[w],m.h--}}this.G=null},it.prototype.J=function(m,w,A,B){return this.i.add(String(m),w,!1,A,B)},it.prototype.K=function(m,w,A,B){return this.i.add(String(m),w,!0,A,B)};function St(m,w,A,B){if(w=m.i.g[String(w)],!w)return!0;w=w.concat();let se=!0;for(let ue=0;ue<w.length;++ue){const ke=w[ue];if(ke&&!ke.da&&ke.capture==A){const xt=ke.listener,Nn=ke.ha||ke.src;ke.fa&&Ce(m.i,ke),se=xt.call(Nn,B)!==!1&&se}}return se&&!B.defaultPrevented}function _t(m,w){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=h(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:c.setTimeout(m,w||0)}function Gt(m){m.g=_t(()=>{m.g=null,m.i&&(m.i=!1,Gt(m))},m.l);const w=m.h;m.h=null,m.m.apply(null,w)}class ct extends I{constructor(w,A){super(),this.m=w,this.l=A,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Gt(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bt(m){I.call(this),this.h=m,this.g={}}b(Bt,I);var qe=[];function ot(m){ve(m.g,function(w,A){this.g.hasOwnProperty(A)&&Ae(w)},m),m.g={}}Bt.prototype.N=function(){Bt.Z.N.call(this),ot(this)},Bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Vt=c.JSON.stringify,Pn=c.JSON.parse,rn=class{stringify(m){return c.JSON.stringify(m,void 0)}parse(m){return c.JSON.parse(m,void 0)}};function $t(){}function on(){}var Ln={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function an(){D.call(this,"d")}b(an,D);function In(){D.call(this,"c")}b(In,D);var Ct={},_s=null;function ln(){return _s=_s||new it}Ct.Ia="serverreachability";function Ie(m){D.call(this,Ct.Ia,m)}b(Ie,D);function Pe(m){const w=ln();rt(w,new Ie(w))}Ct.STAT_EVENT="statevent";function ht(m,w){D.call(this,Ct.STAT_EVENT,m),this.stat=w}b(ht,D);function $e(m){const w=ln();rt(w,new ht(w,m))}Ct.Ja="timingevent";function At(m,w){D.call(this,Ct.Ja,m),this.size=w}b(At,D);function wt(m,w){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){m()},w)}function Qe(){this.g=!0}Qe.prototype.ua=function(){this.g=!1};function we(m,w,A,B,se,ue){m.info(function(){if(m.g)if(ue){var ke="",xt=ue.split("&");for(let Yt=0;Yt<xt.length;Yt++){var Nn=xt[Yt].split("=");if(Nn.length>1){const yn=Nn[0];Nn=Nn[1];const Hs=yn.split("_");ke=Hs.length>=2&&Hs[1]=="type"?ke+(yn+"="+Nn+"&"):ke+(yn+"=redacted&")}}}else ke=null;else ke=ue;return"XMLHTTP REQ ("+B+") [attempt "+se+"]: "+w+`
`+A+`
`+ke})}function Xe(m,w,A,B,se,ue,ke){m.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+se+"]: "+w+`
`+A+`
`+ue+" "+ke})}function at(m,w,A,B){m.info(function(){return"XMLHTTP TEXT ("+w+"): "+Re(m,A)+(B?" "+B:"")})}function Me(m,w){m.info(function(){return"TIMEOUT: "+w})}Qe.prototype.info=function(){};function Re(m,w){if(!m.g)return w;if(!w)return null;try{const ue=JSON.parse(w);if(ue){for(m=0;m<ue.length;m++)if(Array.isArray(ue[m])){var A=ue[m];if(!(A.length<2)){var B=A[1];if(Array.isArray(B)&&!(B.length<1)){var se=B[0];if(se!="noop"&&se!="stop"&&se!="close")for(let ke=1;ke<B.length;ke++)B[ke]=""}}}}return Vt(ue)}catch{return w}}var Be={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},fe={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ee;function de(){}b(de,$t),de.prototype.g=function(){return new XMLHttpRequest},ee=new de;function Te(m){return encodeURIComponent(String(m))}function Le(m){var w=1;m=m.split(":");const A=[];for(;w>0&&m.length;)A.push(m.shift()),w--;return m.length&&A.push(m.join(":")),A}function ze(m,w,A,B){this.j=m,this.i=w,this.l=A,this.S=B||1,this.V=new Bt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ke}function Ke(){this.i=null,this.g="",this.h=!1}var Ye={},dt={};function It(m,w,A){m.M=1,m.A=pe(Tn(w)),m.u=A,m.R=!0,jt(m,null)}function jt(m,w){m.F=Date.now(),un(m),m.B=Tn(m.A);var A=m.B,B=m.S;Array.isArray(B)||(B=[String(B)]),ha(A.i,"t",B),m.C=0,A=m.j.L,m.h=new Ke,m.g=yu(m.j,A?w:null,!m.u),m.P>0&&(m.O=new ct(h(m.Y,m,m.g),m.P)),w=m.V,A=m.g,B=m.ba;var se="readystatechange";Array.isArray(se)||(se&&(qe[0]=se.toString()),se=qe);for(let ue=0;ue<se.length;ue++){const ke=Oe(A,se[ue],B||w.handleEvent,!1,w.h||w);if(!ke)break;w.g[ke.key]=ke}w=m.J?O(m.J):{},m.u?(m.v||(m.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,w)):(m.v="GET",m.g.ea(m.B,m.v,null,w)),Pe(),we(m.i,m.v,m.B,m.l,m.S,m.u)}ze.prototype.ba=function(m){m=m.target;const w=this.O;w&&ai(m)==3?w.j():this.Y(m)},ze.prototype.Y=function(m){try{if(m==this.g)e:{const xt=ai(this.g),Nn=this.g.ya(),Yt=this.g.ca();if(!(xt<3)&&(xt!=3||this.g&&(this.h.h||this.g.la()||Qn(this.g)))){this.K||xt!=4||Nn==7||(Nn==8||Yt<=0?Pe(3):Pe(2)),Xn(this);var w=this.g.ca();this.X=w;var A=Kt(this);if(this.o=w==200,Xe(this.i,this.v,this.B,this.l,this.S,xt,w),this.o){if(this.U&&!this.L){t:{if(this.g){var B,se=this.g;if((B=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(B)){var ue=B;break t}}ue=null}if(m=ue)at(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,fs(this,m);else{this.o=!1,this.m=3,$e(12),Jn(this),Hn(this);break e}}if(this.R){m=!0;let yn;for(;!this.K&&this.C<A.length;)if(yn=En(this,A),yn==dt){xt==4&&(this.m=4,$e(14),m=!1),at(this.i,this.l,null,"[Incomplete Response]");break}else if(yn==Ye){this.m=4,$e(15),at(this.i,this.l,A,"[Invalid Chunk]"),m=!1;break}else at(this.i,this.l,yn,null),fs(this,yn);if(Xt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xt!=4||A.length!=0||this.h.h||(this.m=1,$e(16),m=!1),this.o=this.o&&m,!m)at(this.i,this.l,A,"[Invalid Chunked Response]"),Jn(this),Hn(this);else if(A.length>0&&!this.W){this.W=!0;var ke=this.j;ke.g==this&&ke.aa&&!ke.P&&(ke.j.info("Great, no buffering proxy detected. Bytes received: "+A.length),Vl(ke),ke.P=!0,$e(11))}}else at(this.i,this.l,A,null),fs(this,A);xt==4&&Jn(this),this.o&&!this.K&&(xt==4?fu(this.j,this):(this.o=!1,un(this)))}else Gi(this.g),w==400&&A.indexOf("Unknown SID")>0?(this.m=3,$e(12)):(this.m=0,$e(13)),Jn(this),Hn(this)}}}catch{}finally{}};function Kt(m){if(!Xt(m))return m.g.la();const w=Qn(m.g);if(w==="")return"";let A="";const B=w.length,se=ai(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Jn(m),Hn(m),"";m.h.i=new c.TextDecoder}for(let ue=0;ue<B;ue++)m.h.h=!0,A+=m.h.i.decode(w[ue],{stream:!(se&&ue==B-1)});return w.length=0,m.h.g+=A,m.C=0,m.h.g}function Xt(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function En(m,w){var A=m.C,B=w.indexOf(`
`,A);return B==-1?dt:(A=Number(w.substring(A,B)),isNaN(A)?Ye:(B+=1,B+A>w.length?dt:(w=w.slice(B,B+A),m.C=B+A,w)))}ze.prototype.cancel=function(){this.K=!0,Jn(this)};function un(m){m.T=Date.now()+m.H,xs(m,m.H)}function xs(m,w){if(m.D!=null)throw Error("WatchDog timer not null");m.D=wt(h(m.aa,m),w)}function Xn(m){m.D&&(c.clearTimeout(m.D),m.D=null)}ze.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(Me(this.i,this.B),this.M!=2&&(Pe(),$e(17)),Jn(this),this.m=2,Hn(this)):xs(this,this.T-m)};function Hn(m){m.j.I==0||m.K||fu(m.j,m)}function Jn(m){Xn(m);var w=m.O;w&&typeof w.dispose=="function"&&w.dispose(),m.O=null,ot(m.V),m.g&&(w=m.g,m.g=null,w.abort(),w.dispose())}function fs(m,w){try{var A=m.j;if(A.I!=0&&(A.g==m||ps(A.h,m))){if(!m.L&&ps(A.h,m)&&A.I==3){try{var B=A.Ba.g.parse(w)}catch{B=null}if(Array.isArray(B)&&B.length==3){var se=B;if(se[0]==0){e:if(!A.v){if(A.g)if(A.g.F+3e3<m.F)ya(A),Cr(A);else break e;Io(A),$e(18)}}else A.xa=se[1],0<A.xa-A.K&&se[2]<37500&&A.F&&A.A==0&&!A.C&&(A.C=wt(h(A.Va,A),6e3));bs(A.h)<=1&&A.ta&&(A.ta=void 0)}else Ti(A,11)}else if((m.L||A.g==m)&&ya(A),!M(w))for(se=A.Ba.g.parse(w),w=0;w<se.length;w++){let Yt=se[w];const yn=Yt[0];if(!(yn<=A.K))if(A.K=yn,Yt=Yt[1],A.I==2)if(Yt[0]=="c"){A.M=Yt[1],A.ba=Yt[2];const Hs=Yt[3];Hs!=null&&(A.ka=Hs,A.j.info("VER="+A.ka));const wi=Yt[4];wi!=null&&(A.za=wi,A.j.info("SVER="+A.za));const li=Yt[5];li!=null&&typeof li=="number"&&li>0&&(B=1.5*li,A.O=B,A.j.info("backChannelRequestTimeoutMs_="+B)),B=A;const ci=m.g;if(ci){const Ro=ci.g?ci.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ro){var ue=B.h;ue.g||Ro.indexOf("spdy")==-1&&Ro.indexOf("quic")==-1&&Ro.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(_n(ue,ue.h),ue.h=null))}if(B.G){const va=ci.g?ci.g.getResponseHeader("X-HTTP-Session-Id"):null;va&&(B.wa=va,J(B.J,B.G,va))}}A.I=3,A.l&&A.l.ra(),A.aa&&(A.T=Date.now()-m.F,A.j.info("Handshake RTT: "+A.T+"ms")),B=A;var ke=m;if(B.na=gu(B,B.L?B.ba:null,B.W),ke.L){si(B.h,ke);var xt=ke,Nn=B.O;Nn&&(xt.H=Nn),xt.D&&(Xn(xt),un(xt)),B.g=ke}else du(B);A.i.length>0&&Ei(A)}else Yt[0]!="stop"&&Yt[0]!="close"||Ti(A,7);else A.I==3&&(Yt[0]=="stop"||Yt[0]=="close"?Yt[0]=="stop"?Ti(A,7):Pl(A):Yt[0]!="noop"&&A.l&&A.l.qa(Yt),A.A=0)}}Pe(4)}catch{}}var dn=class{constructor(m,w){this.g=m,this.map=w}};function Ns(m){this.l=m||10,c.PerformanceNavigationTiming?(m=c.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ni(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function bs(m){return m.h?1:m.g?m.g.size:0}function ps(m,w){return m.h?m.h==w:m.g?m.g.has(w):!1}function _n(m,w){m.g?m.g.add(w):m.h=w}function si(m,w){m.h&&m.h==w?m.h=null:m.g&&m.g.has(w)&&m.g.delete(w)}Ns.prototype.cancel=function(){if(this.i=Eo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Eo(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let w=m.i;for(const A of m.g.values())w=w.concat(A.G);return w}return S(m.i)}var da=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vr(m,w){if(m){m=m.split("&");for(let A=0;A<m.length;A++){const B=m[A].indexOf("=");let se,ue=null;B>=0?(se=m[A].substring(0,B),ue=m[A].substring(B+1)):se=m[A],w(se,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function ms(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;m instanceof ms?(this.l=m.l,Rn(this,m.j),this.o=m.o,this.g=m.g,ii(this,m.u),this.h=m.h,js(this,cu(m.i)),this.m=m.m):m&&(w=String(m).match(da))?(this.l=!1,Rn(this,w[1]||"",!0),this.o=He(w[2]||""),this.g=He(w[3]||"",!0),ii(this,w[4]),this.h=He(w[5]||"",!0),js(this,w[6]||"",!0),this.m=He(w[7]||"")):(this.l=!1,this.i=new xr(null,this.l))}ms.prototype.toString=function(){const m=[];var w=this.j;w&&m.push(Et(w,Gn,!0),":");var A=this.g;return(A||w=="file")&&(m.push("//"),(w=this.o)&&m.push(Et(w,Gn,!0),"@"),m.push(Te(A).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.u,A!=null&&m.push(":",String(A))),(A=this.h)&&(this.g&&A.charAt(0)!="/"&&m.push("/"),m.push(Et(A,A.charAt(0)=="/"?Il:os,!0))),(A=this.i.toString())&&m.push("?",A),(A=this.m)&&m.push("#",Et(A,au)),m.join("")},ms.prototype.resolve=function(m){const w=Tn(this);let A=!!m.j;A?Rn(w,m.j):A=!!m.o,A?w.o=m.o:A=!!m.g,A?w.g=m.g:A=m.u!=null;var B=m.h;if(A)ii(w,m.u);else if(A=!!m.h){if(B.charAt(0)!="/")if(this.g&&!this.h)B="/"+B;else{var se=w.h.lastIndexOf("/");se!=-1&&(B=w.h.slice(0,se+1)+B)}if(se=B,se==".."||se==".")B="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){B=se.lastIndexOf("/",0)==0,se=se.split("/");const ue=[];for(let ke=0;ke<se.length;){const xt=se[ke++];xt=="."?B&&ke==se.length&&ue.push(""):xt==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),B&&ke==se.length&&ue.push("")):(ue.push(xt),B=!0)}B=ue.join("/")}else B=se}return A?w.h=B:A=m.i.toString()!=="",A?js(w,cu(m.i)):A=!!m.m,A&&(w.m=m.m),w};function Tn(m){return new ms(m)}function Rn(m,w,A){m.j=A?He(w,!0):w,m.j&&(m.j=m.j.replace(/:$/,""))}function ii(m,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);m.u=w}else m.u=null}function js(m,w,A){w instanceof xr?(m.i=w,fa(m.i,m.l)):(A||(w=Et(w,_r)),m.i=new xr(w,m.l))}function J(m,w,A){m.i.set(w,A)}function pe(m){return J(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function He(m,w){return m?w?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Et(m,w,A){return typeof m=="string"?(m=encodeURI(m).replace(w,mt),A&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function mt(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Gn=/[#\/\?@]/g,os=/[#\?:]/g,Il=/[#\?]/g,_r=/[#\?@]/g,au=/#/g;function xr(m,w){this.h=this.g=null,this.i=m||null,this.j=!!w}function Es(m){m.g||(m.g=new Map,m.h=0,m.i&&vr(m.i,function(w,A){m.add(decodeURIComponent(w.replace(/\+/g," ")),A)}))}t=xr.prototype,t.add=function(m,w){Es(this),this.i=null,m=br(this,m);let A=this.g.get(m);return A||this.g.set(m,A=[]),A.push(w),this.h+=1,this};function lu(m,w){Es(m),w=br(m,w),m.g.has(w)&&(m.i=null,m.h-=m.g.get(w).length,m.g.delete(w))}function Rl(m,w){return Es(m),w=br(m,w),m.g.has(w)}t.forEach=function(m,w){Es(this),this.g.forEach(function(A,B){A.forEach(function(se){m.call(w,se,B,this)},this)},this)};function Nl(m,w){Es(m);let A=[];if(typeof w=="string")Rl(m,w)&&(A=A.concat(m.g.get(br(m,w))));else for(m=Array.from(m.g.values()),w=0;w<m.length;w++)A=A.concat(m[w]);return A}t.set=function(m,w){return Es(this),this.i=null,m=br(this,m),Rl(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[w]),this.h+=1,this},t.get=function(m,w){return m?(m=Nl(this,m),m.length>0?String(m[0]):w):w};function ha(m,w,A){lu(m,w),A.length>0&&(m.i=null,m.g.set(br(m,w),S(A)),m.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],w=Array.from(this.g.keys());for(let B=0;B<w.length;B++){var A=w[B];const se=Te(A);A=Nl(this,A);for(let ue=0;ue<A.length;ue++){let ke=se;A[ue]!==""&&(ke+="="+Te(A[ue])),m.push(ke)}}return this.i=m.join("&")};function cu(m){const w=new xr;return w.i=m.i,m.g&&(w.g=new Map(m.g),w.h=m.h),w}function br(m,w){return w=String(w),m.j&&(w=w.toLowerCase()),w}function fa(m,w){w&&!m.j&&(Es(m),m.i=null,m.g.forEach(function(A,B){const se=B.toLowerCase();B!=se&&(lu(this,B),ha(this,se,A))},m)),m.j=w}function ri(m,w){const A=new Qe;if(c.Image){const B=new Image;B.onload=_(Fs,A,"TestLoadImage: loaded",!0,w,B),B.onerror=_(Fs,A,"TestLoadImage: error",!1,w,B),B.onabort=_(Fs,A,"TestLoadImage: abort",!1,w,B),B.ontimeout=_(Fs,A,"TestLoadImage: timeout",!1,w,B),c.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=m}else w(!1)}function Ml(m,w){const A=new Qe,B=new AbortController,se=setTimeout(()=>{B.abort(),Fs(A,"TestPingServer: timeout",!1,w)},1e4);fetch(m,{signal:B.signal}).then(ue=>{clearTimeout(se),ue.ok?Fs(A,"TestPingServer: ok",!0,w):Fs(A,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(se),Fs(A,"TestPingServer: error",!1,w)})}function Fs(m,w,A,B,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),B(A)}catch{}}function Er(){this.g=new rn}function _i(m){this.i=m.Sb||null,this.h=m.ab||!1}b(_i,$t),_i.prototype.g=function(){return new To(this.i,this.h)};function To(m,w){it.call(this),this.H=m,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(To,it),t=To.prototype,t.open=function(m,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=w,this.readyState=1,oi(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(w.body=m),(this.H||c).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Tr(this)),this.readyState=0},t.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,oi(this)),this.g&&(this.readyState=3,oi(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;pa(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function pa(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}t.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var w=m.value?m.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!m.done}))&&(this.response=this.responseText+=w)}m.done?Tr(this):oi(this),this.readyState==3&&pa(this)}},t.Oa=function(m){this.g&&(this.response=this.responseText=m,Tr(this))},t.Na=function(m){this.g&&(this.response=m,Tr(this))},t.ga=function(){this.g&&Tr(this)};function Tr(m){m.readyState=4,m.l=null,m.j=null,m.B=null,oi(m)}t.setRequestHeader=function(m,w){this.A.append(m,w)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],w=this.h.entries();for(var A=w.next();!A.done;)A=A.value,m.push(A[0]+": "+A[1]),A=w.next();return m.join(`\r
`)};function oi(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(To.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function qs(m){let w="";return ve(m,function(A,B){w+=B,w+=":",w+=A,w+=`\r
`}),w}function wo(m,w,A){e:{for(B in A){var B=!1;break e}B=!0}B||(A=qs(A),typeof m=="string"?A!=null&&Te(A):J(m,w,A))}function en(m){it.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(en,it);var xi=/^https?$/i,kl=["POST","PUT"];t=en.prototype,t.Fa=function(m){this.H=m},t.ea=function(m,w,A,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);w=w?w.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ee.g(),this.g.onreadystatechange=E(h(this.Ca,this));try{this.B=!0,this.g.open(w,String(m),!0),this.B=!1}catch(ue){Co(this,ue);return}if(m=A||"",A=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var se in B)A.set(se,B[se]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const ue of B.keys())A.set(ue,B.get(ue));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(A.keys()).find(ue=>ue.toLowerCase()=="content-type"),se=c.FormData&&m instanceof c.FormData,!(Array.prototype.indexOf.call(kl,w,void 0)>=0)||B||se||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,ke]of A)this.g.setRequestHeader(ue,ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(ue){Co(this,ue)}};function Co(m,w){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=w,m.o=5,Dl(m),Hi(m)}function Dl(m){m.A||(m.A=!0,rt(m,"complete"),rt(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,rt(this,"complete"),rt(this,"abort"),Hi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hi(this,!0)),en.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?So(this):this.Xa())},t.Xa=function(){So(this)};function So(m){if(m.h&&typeof a<"u"){if(m.v&&ai(m)==4)setTimeout(m.Ca.bind(m),0);else if(rt(m,"readystatechange"),ai(m)==4){m.h=!1;try{const ue=m.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var A;if(!(A=w)){var B;if(B=ue===0){let ke=String(m.D).match(da)[1]||null;!ke&&c.self&&c.self.location&&(ke=c.self.location.protocol.slice(0,-1)),B=!xi.test(ke?ke.toLowerCase():"")}A=B}if(A)rt(m,"complete"),rt(m,"success");else{m.o=6;try{var se=ai(m)>2?m.g.statusText:""}catch{se=""}m.l=se+" ["+m.ca()+"]",Dl(m)}}finally{Hi(m)}}}}function Hi(m,w){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const A=m.g;m.g=null,w||rt(m,"ready");try{A.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ai(m){return m.g?m.g.readyState:0}t.ca=function(){try{return ai(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(m){if(this.g){var w=this.g.responseText;return m&&w.indexOf(m)==0&&(w=w.substring(m.length)),Pn(w)}};function Qn(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Gi(m){const w={};m=(m.g&&ai(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<m.length;B++){if(M(m[B]))continue;var A=Le(m[B]);const se=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const ue=w[se]||[];w[se]=ue,ue.push(A)}X(w,function(B){return B.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function bi(m,w,A){return A&&A.internalChannelParams&&A.internalChannelParams[m]||w}function wr(m){this.za=0,this.i=[],this.j=new Qe,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=bi("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=bi("baseRetryDelayMs",5e3,m),this.Za=bi("retryDelaySeedMs",1e4,m),this.Ta=bi("forwardChannelMaxRetries",2,m),this.va=bi("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Ns(m&&m.concurrentRequestLimit),this.Ba=new Er,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=wr.prototype,t.ka=8,t.I=1,t.connect=function(m,w,A,B){$e(0),this.W=m,this.H=w||{},A&&B!==void 0&&(this.H.OSID=A,this.H.OAID=B),this.F=this.X,this.J=gu(this,null,this.W),Ei(this)};function Pl(m){if(ma(m),m.I==3){var w=m.V++,A=Tn(m.J);if(J(A,"SID",m.M),J(A,"RID",w),J(A,"TYPE","terminate"),Ao(m,A),w=new ze(m,m.j,w),w.M=2,w.A=pe(Tn(A)),A=!1,c.navigator&&c.navigator.sendBeacon)try{A=c.navigator.sendBeacon(w.A.toString(),"")}catch{}!A&&c.Image&&(new Image().src=w.A,A=!0),A||(w.g=yu(w.j,null),w.g.ea(w.A)),w.F=Date.now(),un(w)}mu(m)}function Cr(m){m.g&&(Vl(m),m.g.cancel(),m.g=null)}function ma(m){Cr(m),m.v&&(c.clearTimeout(m.v),m.v=null),ya(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&c.clearTimeout(m.m),m.m=null)}function Ei(m){if(!ni(m.h)&&!m.m){m.m=!0;var w=m.Ea;Y||T(),K||(Y(),K=!0),R.add(w,m),m.D=0}}function ga(m,w){return bs(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=w.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=wt(h(m.Ea,m,w),pu(m,m.D)),m.D++,!0)}t.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const se=new ze(this,this.j,m);let ue=this.o;if(this.U&&(ue?(ue=O(ue),te(ue,this.U)):ue=this.U),this.u!==null||this.R||(se.J=ue,ue=null),this.S)e:{for(var w=0,A=0;A<this.i.length;A++){t:{var B=this.i[A];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(w+=B,w>4096){w=A;break e}if(w===4096||A===this.i.length-1){w=A+1;break e}}w=1e3}else w=1e3;w=uu(this,se,w),A=Tn(this.J),J(A,"RID",m),J(A,"CVER",22),this.G&&J(A,"X-HTTP-Session-Id",this.G),Ao(this,A),ue&&(this.R?w="headers="+Te(qs(ue))+"&"+w:this.u&&wo(A,this.u,ue)),_n(this.h,se),this.Ra&&J(A,"TYPE","init"),this.S?(J(A,"$req",w),J(A,"SID","null"),se.U=!0,It(se,A,null)):It(se,A,w),this.I=2}}else this.I==3&&(m?Ll(this,m):this.i.length==0||ni(this.h)||Ll(this))};function Ll(m,w){var A;w?A=w.l:A=m.V++;const B=Tn(m.J);J(B,"SID",m.M),J(B,"RID",A),J(B,"AID",m.K),Ao(m,B),m.u&&m.o&&wo(B,m.u,m.o),A=new ze(m,m.j,A,m.D+1),m.u===null&&(A.J=m.o),w&&(m.i=w.G.concat(m.i)),w=uu(m,A,1e3),A.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),_n(m.h,A),It(A,B,w)}function Ao(m,w){m.H&&ve(m.H,function(A,B){J(w,B,A)}),m.l&&ve({},function(A,B){J(w,B,A)})}function uu(m,w,A){A=Math.min(m.i.length,A);const B=m.l?h(m.l.Ka,m.l,m):null;e:{var se=m.i;let xt=-1;for(;;){const Nn=["count="+A];xt==-1?A>0?(xt=se[0].g,Nn.push("ofs="+xt)):xt=0:Nn.push("ofs="+xt);let Yt=!0;for(let yn=0;yn<A;yn++){var ue=se[yn].g;const Hs=se[yn].map;if(ue-=xt,ue<0)xt=Math.max(0,se[yn].g-100),Yt=!1;else try{ue="req"+ue+"_"||"";try{var ke=Hs instanceof Map?Hs:Object.entries(Hs);for(const[wi,li]of ke){let ci=li;d(li)&&(ci=Vt(li)),Nn.push(ue+wi+"="+encodeURIComponent(ci))}}catch(wi){throw Nn.push(ue+"type="+encodeURIComponent("_badmap")),wi}}catch{B&&B(Hs)}}if(Yt){ke=Nn.join("&");break e}}ke=void 0}return m=m.i.splice(0,A),w.G=m,ke}function du(m){if(!m.g&&!m.v){m.Y=1;var w=m.Da;Y||T(),K||(Y(),K=!0),R.add(w,m),m.A=0}}function Io(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=wt(h(m.Da,m),pu(m,m.A)),m.A++,!0)}t.Da=function(){if(this.v=null,hu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=wt(h(this.Wa,this),m)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,$e(10),Cr(this),hu(this))};function Vl(m){m.B!=null&&(c.clearTimeout(m.B),m.B=null)}function hu(m){m.g=new ze(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var w=Tn(m.na);J(w,"RID","rpc"),J(w,"SID",m.M),J(w,"AID",m.K),J(w,"CI",m.F?"0":"1"),!m.F&&m.ia&&J(w,"TO",m.ia),J(w,"TYPE","xmlhttp"),Ao(m,w),m.u&&m.o&&wo(w,m.u,m.o),m.O&&(m.g.H=m.O);var A=m.g;m=m.ba,A.M=1,A.A=pe(Tn(w)),A.u=null,A.R=!0,jt(A,m)}t.Va=function(){this.C!=null&&(this.C=null,Cr(this),Io(this),$e(19))};function ya(m){m.C!=null&&(c.clearTimeout(m.C),m.C=null)}function fu(m,w){var A=null;if(m.g==w){ya(m),Vl(m),m.g=null;var B=2}else if(ps(m.h,w))A=w.G,si(m.h,w),B=1;else return;if(m.I!=0){if(w.o)if(B==1){A=w.u?w.u.length:0,w=Date.now()-w.F;var se=m.D;B=ln(),rt(B,new At(B,A)),Ei(m)}else du(m);else if(se=w.m,se==3||se==0&&w.X>0||!(B==1&&ga(m,w)||B==2&&Io(m)))switch(A&&A.length>0&&(w=m.h,w.i=w.i.concat(A)),se){case 1:Ti(m,5);break;case 4:Ti(m,10);break;case 3:Ti(m,6);break;default:Ti(m,2)}}}function pu(m,w){let A=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(A*=2),A*w}function Ti(m,w){if(m.j.info("Error code "+w),w==2){var A=h(m.bb,m),B=m.Ua;const se=!B;B=new ms(B||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Rn(B,"https"),pe(B),se?ri(B.toString(),A):Ml(B.toString(),A)}else $e(2);m.I=0,m.l&&m.l.pa(w),mu(m),ma(m)}t.bb=function(m){m?(this.j.info("Successfully pinged google.com"),$e(2)):(this.j.info("Failed to ping google.com"),$e(1))};function mu(m){if(m.I=0,m.ja=[],m.l){const w=Eo(m.h);(w.length!=0||m.i.length!=0)&&(L(m.ja,w),L(m.ja,m.i),m.h.i.length=0,S(m.i),m.i.length=0),m.l.oa()}}function gu(m,w,A){var B=A instanceof ms?Tn(A):new ms(A);if(B.g!="")w&&(B.g=w+"."+B.g),ii(B,B.u);else{var se=c.location;B=se.protocol,w=w?w+"."+se.hostname:se.hostname,se=+se.port;const ue=new ms(null);B&&Rn(ue,B),w&&(ue.g=w),se&&ii(ue,se),A&&(ue.h=A),B=ue}return A=m.G,w=m.wa,A&&w&&J(B,A,w),J(B,"VER",m.ka),Ao(m,B),B}function yu(m,w,A){if(w&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=m.Aa&&!m.ma?new en(new _i({ab:A})):new en(m.ma),w.Fa(m.L),w}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function vu(){}t=vu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Sr(){}Sr.prototype.g=function(m,w){return new gs(m,w)};function gs(m,w){it.call(this),this.g=new wr(w),this.l=m,this.h=w&&w.messageUrlParams||null,m=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(m?m["X-WebChannel-Content-Type"]=w.messageContentType:m={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(m?m["X-WebChannel-Client-Profile"]=w.sa:m={"X-WebChannel-Client-Profile":w.sa}),this.g.U=m,(m=w&&w.Qb)&&!M(m)&&(this.g.u=m),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!M(w)&&(this.g.G=w,m=this.h,m!==null&&w in m&&(m=this.h,w in m&&delete m[w])),this.j=new $i(this)}b(gs,it),gs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},gs.prototype.close=function(){Pl(this.g)},gs.prototype.o=function(m){var w=this.g;if(typeof m=="string"){var A={};A.__data__=m,m=A}else this.v&&(A={},A.__data__=Vt(m),m=A);w.i.push(new dn(w.Ya++,m)),w.I==3&&Ei(w)},gs.prototype.N=function(){this.g.l=null,delete this.j,Pl(this.g),delete this.g,gs.Z.N.call(this)};function _u(m){an.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var w=m.__sm__;if(w){e:{for(const A in w){m=A;break e}m=void 0}(this.i=m)&&(m=this.i,w=w!==null&&m in w?w[m]:void 0),this.data=w}else this.data=m}b(_u,an);function xu(){In.call(this),this.status=1}b(xu,In);function $i(m){this.g=m}b($i,vu),$i.prototype.ra=function(){rt(this.g,"a")},$i.prototype.qa=function(m){rt(this.g,new _u(m))},$i.prototype.pa=function(m){rt(this.g,new xu)},$i.prototype.oa=function(){rt(this.g,"b")},Sr.prototype.createWebChannel=Sr.prototype.g,gs.prototype.send=gs.prototype.o,gs.prototype.open=gs.prototype.m,gs.prototype.close=gs.prototype.close,$w=function(){return new Sr},Gw=function(){return ln()},Hw=Ct,Um={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Be.NO_ERROR=0,Be.TIMEOUT=8,Be.HTTP_ERROR=6,Bd=Be,fe.COMPLETE="complete",qw=fe,on.EventType=Ln,Ln.OPEN="a",Ln.CLOSE="b",Ln.ERROR="c",Ln.MESSAGE="d",it.prototype.listen=it.prototype.J,Tc=on,en.prototype.listenOnce=en.prototype.K,en.prototype.getLastError=en.prototype.Ha,en.prototype.getLastErrorCode=en.prototype.ya,en.prototype.getStatus=en.prototype.ca,en.prototype.getResponseJson=en.prototype.La,en.prototype.getResponseText=en.prototype.la,en.prototype.send=en.prototype.ea,en.prototype.setWithCredentials=en.prototype.Fa,Fw=en}).apply(typeof Cd<"u"?Cd:typeof self<"u"?self:typeof window<"u"?window:{});const Yb="@firebase/firestore",Jb="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cs.UNAUTHENTICATED=new cs(null),cs.GOOGLE_CREDENTIALS=new cs("google-credentials-uid"),cs.FIRST_PARTY=new cs("first-party-uid"),cs.MOCK_USER=new cs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let El="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=new xg("@firebase/firestore");function Ka(){return na.logLevel}function je(t,...e){if(na.logLevel<=Dt.DEBUG){const n=e.map(Dg);na.debug(`Firestore (${El}): ${t}`,...n)}}function pr(t,...e){if(na.logLevel<=Dt.ERROR){const n=e.map(Dg);na.error(`Firestore (${El}): ${t}`,...n)}}function dl(t,...e){if(na.logLevel<=Dt.WARN){const n=e.map(Dg);na.warn(`Firestore (${El}): ${t}`,...n)}}function Dg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(n){return JSON.stringify(n)})(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,Yw(t,s,n)}function Yw(t,e,n){let s=`FIRESTORE (${El}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw pr(s),new Error(s)}function Wt(t,e,n,s){let r="Unexpected state";typeof n=="string"?r=n:s=n,t||Yw(e,r,s)}function yt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends qi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class d4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(cs.UNAUTHENTICATED)))}shutdown(){}}class h4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class f4{constructor(e){this.t=e,this.currentUser=cs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Wt(this.o===void 0,42304);let s=this.i;const r=f=>this.i!==s?(s=this.i,n(f)):Promise.resolve();let a=new oo;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new oo,e.enqueueRetryable((()=>r(this.currentUser)))};const c=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await r(this.currentUser)}))},d=f=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new oo)}}),0),c()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((s=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Wt(typeof s.accessToken=="string",31837,{l:s}),new Jw(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Wt(e===null||typeof e=="string",2055,{h:e}),new cs(e)}}class p4{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=cs.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class m4{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new p4(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(cs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Kb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class g4{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Zs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Wt(this.o===void 0,3512);const s=a=>{a.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const c=a.token!==this.m;return this.m=a.token,je("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?n(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>s(a)))};const r=a=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>r(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?r(a):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Kb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(Wt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Kb(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y4(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=y4(40);for(let a=0;a<r.length;++a)s.length<20&&r[a]<n&&(s+=e.charAt(r[a]%62))}return s}}function Pt(t,e){return t<e?-1:t>e?1:0}function Om(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const r=t.charAt(s),a=e.charAt(s);if(r!==a)return um(r)===um(a)?Pt(r,a):um(r)?1:-1}return Pt(t.length,e.length)}const v4=55296,_4=57343;function um(t){const e=t.charCodeAt(0);return e>=v4&&e<=_4}function hl(t,e,n){return t.length===e.length&&t.every(((s,r)=>n(s,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb="__name__";class Ri{constructor(e,n,s){n===void 0?n=0:n>e.length&&ut(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&ut(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return Ri.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ri?e.forEach((s=>{n.push(s)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const a=Ri.compareSegments(e.get(r),n.get(r));if(a!==0)return a}return Pt(e.length,n.length)}static compareSegments(e,n){const s=Ri.isNumericId(e),r=Ri.isNumericId(n);return s&&!r?-1:!s&&r?1:s&&r?Ri.extractNumericId(e).compare(Ri.extractNumericId(n)):Om(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ro.fromString(e.substring(4,e.length-2))}}class hn extends Ri{construct(e,n,s){return new hn(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ve(xe.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter((r=>r.length>0)))}return new hn(n)}static emptyPath(){return new hn([])}}const x4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class is extends Ri{construct(e,n,s){return new is(e,n,s)}static isValidIdentifier(e){return x4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),is.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Wb}static keyField(){return new is([Wb])}static fromServerFormat(e){const n=[];let s="",r=0;const a=()=>{if(s.length===0)throw new Ve(xe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let c=!1;for(;r<e.length;){const d=e[r];if(d==="\\"){if(r+1===e.length)throw new Ve(xe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[r+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Ve(xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=f,r+=2}else d==="`"?(c=!c,r++):d!=="."||c?(s+=d,r++):(a(),r++)}if(a(),c)throw new Ve(xe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new is(n)}static emptyPath(){return new is([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.path=e}static fromPath(e){return new st(hn.fromString(e))}static fromName(e){return new st(hn.fromString(e).popFirst(5))}static empty(){return new st(hn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&hn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return hn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new st(new hn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(t,e,n){if(!n)throw new Ve(xe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function b4(t,e,n,s){if(e===!0&&s===!0)throw new Ve(xe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Xb(t){if(!st.isDocumentKey(t))throw new Ve(xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qb(t){if(st.isDocumentKey(t))throw new Ve(xe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ww(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function wh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ut(12329,{type:typeof t})}function Vi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ve(xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=wh(t);throw new Ve(xe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(t,e){const n={typeString:t};return e&&(n.value=e),n}function Zc(t,e){if(!Ww(t))throw new Ve(xe.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const r=e[s].typeString,a="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const c=t[s];if(r&&typeof c!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(a!==void 0&&c!==a.value){n=`Expected '${s}' field to equal '${a.value}'`;break}}if(n)throw new Ve(xe.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb=-62135596800,eE=1e6;class gn{static now(){return gn.fromMillis(Date.now())}static fromDate(e){return gn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*eE);return new gn(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Ve(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ve(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Zb)throw new Ve(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/eE}_compareTo(e){return this.seconds===e.seconds?Pt(this.nanoseconds,e.nanoseconds):Pt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Zc(e,gn._jsonSchema))return new gn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Zb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gn._jsonSchemaVersion="firestore/timestamp/1.0",gn._jsonSchema={type:Fn("string",gn._jsonSchemaVersion),seconds:Fn("number"),nanoseconds:Fn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{static fromTimestamp(e){return new pt(e)}static min(){return new pt(new gn(0,0))}static max(){return new pt(new gn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc=-1;function E4(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=pt.fromTimestamp(s===1e9?new gn(n+1,0):new gn(n,s));return new co(r,st.empty(),e)}function T4(t){return new co(t.readTime,t.key,Oc)}class co{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new co(pt.min(),st.empty(),Oc)}static max(){return new co(pt.max(),st.empty(),Oc)}}function w4(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=st.comparator(t.documentKey,e.documentKey),n!==0?n:Pt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class S4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tl(t){if(t.code!==xe.FAILED_PRECONDITION||t.message!==C4)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ut(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Ee(((s,r)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(s,r)},this.catchCallback=a=>{this.wrapFailure(n,a).next(s,r)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof Ee?n:Ee.resolve(n)}catch(n){return Ee.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):Ee.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):Ee.reject(n)}static resolve(e){return new Ee(((n,s)=>{n(e)}))}static reject(e){return new Ee(((n,s)=>{s(e)}))}static waitFor(e){return new Ee(((n,s)=>{let r=0,a=0,c=!1;e.forEach((d=>{++r,d.next((()=>{++a,c&&a===r&&n()}),(f=>s(f)))})),c=!0,a===r&&n()}))}static or(e){let n=Ee.resolve(!1);for(const s of e)n=n.next((r=>r?Ee.resolve(r):s()));return n}static forEach(e,n){const s=[];return e.forEach(((r,a)=>{s.push(n.call(this,r,a))})),this.waitFor(s)}static mapArray(e,n){return new Ee(((s,r)=>{const a=e.length,c=new Array(a);let d=0;for(let f=0;f<a;f++){const h=f;n(e[h]).next((_=>{c[h]=_,++d,d===a&&s(c)}),(_=>r(_)))}}))}static doWhile(e,n){return new Ee(((s,r)=>{const a=()=>{e()===!0?n().next((()=>{a()}),r):s()};a()}))}}function A4(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function wl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ch.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg=-1;function Sh(t){return t==null}function nh(t){return t===0&&1/t==-1/0}function I4(t){return typeof t=="number"&&Number.isInteger(t)&&!nh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw="";function R4(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=tE(e)),e=N4(t.get(n),e);return tE(e)}function N4(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const a=t.charAt(r);switch(a){case"\0":n+="";break;case Xw:n+="";break;default:n+=a}}return n}function tE(t){return t+Xw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function vo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Qw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n){this.comparator=e,this.root=n||ss.EMPTY}insert(e,n){return new bn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ss.BLACK,null,null))}remove(e){return new bn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ss.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,s)=>(e(n,s),!1)))}toString(){const e=[];return this.inorderTraversal(((n,s)=>(e.push(`${n}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sd(this.root,e,this.comparator,!0)}}class Sd{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=n?s(e.key,n):1,n&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ss{constructor(e,n,s,r,a){this.key=e,this.value=n,this.color=s??ss.RED,this.left=r??ss.EMPTY,this.right=a??ss.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,a){return new ss(e??this.key,n??this.value,s??this.color,r??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const a=s(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,n,s),null):a===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ss.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return ss.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ss.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ss.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ut(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ut(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ut(27949);return e+(this.isRed()?0:1)}}ss.EMPTY=null,ss.RED=!0,ss.BLACK=!1;ss.EMPTY=new class{constructor(){this.size=0}get key(){throw ut(57766)}get value(){throw ut(16141)}get color(){throw ut(16727)}get left(){throw ut(29726)}get right(){throw ut(36894)}copy(e,n,s,r,a){return this}insert(e,n,s){return new ss(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.comparator=e,this.data=new bn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,s)=>(e(n),!1)))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new sE(this.data.getIterator())}getIteratorFrom(e){return new sE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((s=>{n=n.add(s)})),n}isEqual(e){if(!(e instanceof Yn)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,a=s.getNext().key;if(this.comparator(r,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Yn(this.comparator);return n.data=e,n}}class sE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e){this.fields=e,e.sort(is.comparator)}static empty(){return new Bs([])}unionWith(e){let n=new Yn(is.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new Bs(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return hl(this.fields,e.fields,((n,s)=>n.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(r){try{return atob(r)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Zw("Invalid base64 string: "+a):a}})(e);return new rs(n)}static fromUint8Array(e){const n=(function(r){let a="";for(let c=0;c<r.length;++c)a+=String.fromCharCode(r[c]);return a})(e);return new rs(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rs.EMPTY_BYTE_STRING=new rs("");const M4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uo(t){if(Wt(!!t,39018),typeof t=="string"){let e=0;const n=M4.exec(t);if(Wt(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Dn(t.seconds),nanos:Dn(t.nanos)}}function Dn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ho(t){return typeof t=="string"?rs.fromBase64String(t):rs.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC="server_timestamp",tC="__type__",nC="__previous_value__",sC="__local_write_time__";function Vg(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[tC])==null?void 0:s.stringValue)===eC}function Ah(t){const e=t.mapValue.fields[nC];return Vg(e)?Ah(e):e}function Bc(t){const e=uo(t.mapValue.fields[sC].timestampValue);return new gn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(e,n,s,r,a,c,d,f,h,_){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=a,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=h,this.isUsingEmulator=_}}const sh="(default)";class zc{constructor(e,n){this.projectId=e,this.database=n||sh}static empty(){return new zc("","")}get isDefaultDatabase(){return this.database===sh}isEqual(e){return e instanceof zc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC="__type__",D4="__max__",Ad={mapValue:{}},rC="__vector__",ih="value";function fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Vg(t)?4:L4(t)?9007199254740991:P4(t)?10:11:ut(28295,{value:t})}function Fi(t,e){if(t===e)return!0;const n=fo(t);if(n!==fo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Bc(t).isEqual(Bc(e));case 3:return(function(r,a){if(typeof r.timestampValue=="string"&&typeof a.timestampValue=="string"&&r.timestampValue.length===a.timestampValue.length)return r.timestampValue===a.timestampValue;const c=uo(r.timestampValue),d=uo(a.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(r,a){return ho(r.bytesValue).isEqual(ho(a.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(r,a){return Dn(r.geoPointValue.latitude)===Dn(a.geoPointValue.latitude)&&Dn(r.geoPointValue.longitude)===Dn(a.geoPointValue.longitude)})(t,e);case 2:return(function(r,a){if("integerValue"in r&&"integerValue"in a)return Dn(r.integerValue)===Dn(a.integerValue);if("doubleValue"in r&&"doubleValue"in a){const c=Dn(r.doubleValue),d=Dn(a.doubleValue);return c===d?nh(c)===nh(d):isNaN(c)&&isNaN(d)}return!1})(t,e);case 9:return hl(t.arrayValue.values||[],e.arrayValue.values||[],Fi);case 10:case 11:return(function(r,a){const c=r.mapValue.fields||{},d=a.mapValue.fields||{};if(nE(c)!==nE(d))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(d[f]===void 0||!Fi(c[f],d[f])))return!1;return!0})(t,e);default:return ut(52216,{left:t})}}function jc(t,e){return(t.values||[]).find((n=>Fi(n,e)))!==void 0}function fl(t,e){if(t===e)return 0;const n=fo(t),s=fo(e);if(n!==s)return Pt(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Pt(t.booleanValue,e.booleanValue);case 2:return(function(a,c){const d=Dn(a.integerValue||a.doubleValue),f=Dn(c.integerValue||c.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(t,e);case 3:return iE(t.timestampValue,e.timestampValue);case 4:return iE(Bc(t),Bc(e));case 5:return Om(t.stringValue,e.stringValue);case 6:return(function(a,c){const d=ho(a),f=ho(c);return d.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(a,c){const d=a.split("/"),f=c.split("/");for(let h=0;h<d.length&&h<f.length;h++){const _=Pt(d[h],f[h]);if(_!==0)return _}return Pt(d.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(a,c){const d=Pt(Dn(a.latitude),Dn(c.latitude));return d!==0?d:Pt(Dn(a.longitude),Dn(c.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return rE(t.arrayValue,e.arrayValue);case 10:return(function(a,c){var E,S,L,U;const d=a.fields||{},f=c.fields||{},h=(E=d[ih])==null?void 0:E.arrayValue,_=(S=f[ih])==null?void 0:S.arrayValue,b=Pt(((L=h==null?void 0:h.values)==null?void 0:L.length)||0,((U=_==null?void 0:_.values)==null?void 0:U.length)||0);return b!==0?b:rE(h,_)})(t.mapValue,e.mapValue);case 11:return(function(a,c){if(a===Ad.mapValue&&c===Ad.mapValue)return 0;if(a===Ad.mapValue)return 1;if(c===Ad.mapValue)return-1;const d=a.fields||{},f=Object.keys(d),h=c.fields||{},_=Object.keys(h);f.sort(),_.sort();for(let b=0;b<f.length&&b<_.length;++b){const E=Om(f[b],_[b]);if(E!==0)return E;const S=fl(d[f[b]],h[_[b]]);if(S!==0)return S}return Pt(f.length,_.length)})(t.mapValue,e.mapValue);default:throw ut(23264,{he:n})}}function iE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Pt(t,e);const n=uo(t),s=uo(e),r=Pt(n.seconds,s.seconds);return r!==0?r:Pt(n.nanos,s.nanos)}function rE(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const a=fl(n[r],s[r]);if(a)return a}return Pt(n.length,s.length)}function pl(t){return Bm(t)}function Bm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const s=uo(n);return`time(${s.seconds},${s.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return ho(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return st.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let s="[",r=!0;for(const a of n.values||[])r?r=!1:s+=",",s+=Bm(a);return s+"]"})(t.arrayValue):"mapValue"in t?(function(n){const s=Object.keys(n.fields||{}).sort();let r="{",a=!0;for(const c of s)a?a=!1:r+=",",r+=`${c}:${Bm(n.fields[c])}`;return r+"}"})(t.mapValue):ut(61005,{value:t})}function zd(t){switch(fo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ah(t);return e?16+zd(e):16;case 5:return 2*t.stringValue.length;case 6:return ho(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((r,a)=>r+zd(a)),0)})(t.arrayValue);case 10:case 11:return(function(s){let r=0;return vo(s.fields,((a,c)=>{r+=a.length+zd(c)})),r})(t.mapValue);default:throw ut(13486,{value:t})}}function oE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function zm(t){return!!t&&"integerValue"in t}function Ug(t){return!!t&&"arrayValue"in t}function aE(t){return!!t&&"nullValue"in t}function lE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function jd(t){return!!t&&"mapValue"in t}function P4(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[iC])==null?void 0:s.stringValue)===rC}function Nc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return vo(t.mapValue.fields,((n,s)=>e.mapValue.fields[n]=Nc(s))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Nc(t.arrayValue.values[n]);return e}return{...t}}function L4(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===D4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this.value=e}static empty(){return new Rs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!jd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nc(n)}setAll(e){let n=is.emptyPath(),s={},r=[];e.forEach(((c,d)=>{if(!n.isImmediateParentOf(d)){const f=this.getFieldsMap(n);this.applyChanges(f,s,r),s={},r=[],n=d.popLast()}c?s[d.lastSegment()]=Nc(c):r.push(d.lastSegment())}));const a=this.getFieldsMap(n);this.applyChanges(a,s,r)}delete(e){const n=this.field(e.popLast());jd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];jd(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){vo(n,((r,a)=>e[r]=a));for(const r of s)delete e[r]}clone(){return new Rs(Nc(this.value))}}function oC(t){const e=[];return vo(t.fields,((n,s)=>{const r=new is([n]);if(jd(s)){const a=oC(s.mapValue).fields;if(a.length===0)e.push(r);else for(const c of a)e.push(r.child(c))}else e.push(r)})),new Bs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n,s,r,a,c,d){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=a,this.data=c,this.documentState=d}static newInvalidDocument(e){return new us(e,0,pt.min(),pt.min(),pt.min(),Rs.empty(),0)}static newFoundDocument(e,n,s,r){return new us(e,1,n,pt.min(),s,r,0)}static newNoDocument(e,n){return new us(e,2,n,pt.min(),pt.min(),Rs.empty(),0)}static newUnknownDocument(e,n){return new us(e,3,n,pt.min(),pt.min(),Rs.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof us&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new us(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,n){this.position=e,this.inclusive=n}}function cE(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const a=e[r],c=t.position[r];if(a.field.isKeyField()?s=st.comparator(st.fromName(c.referenceValue),n.key):s=fl(c,n.data.field(a.field)),a.dir==="desc"&&(s*=-1),s!==0)break}return s}function uE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,n="asc"){this.field=e,this.dir=n}}function V4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{}class jn extends aC{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new O4(e,n,s):n==="array-contains"?new j4(e,s):n==="in"?new F4(e,s):n==="not-in"?new q4(e,s):n==="array-contains-any"?new H4(e,s):new jn(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new B4(e,s):new z4(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(fl(n,this.value)):n!==null&&fo(this.value)===fo(n)&&this.matchesComparison(fl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ut(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yi extends aC{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new yi(e,n)}matches(e){return lC(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function lC(t){return t.op==="and"}function cC(t){return U4(t)&&lC(t)}function U4(t){for(const e of t.filters)if(e instanceof yi)return!1;return!0}function jm(t){if(t instanceof jn)return t.field.canonicalString()+t.op.toString()+pl(t.value);if(cC(t))return t.filters.map((e=>jm(e))).join(",");{const e=t.filters.map((n=>jm(n))).join(",");return`${t.op}(${e})`}}function uC(t,e){return t instanceof jn?(function(s,r){return r instanceof jn&&s.op===r.op&&s.field.isEqual(r.field)&&Fi(s.value,r.value)})(t,e):t instanceof yi?(function(s,r){return r instanceof yi&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce(((a,c,d)=>a&&uC(c,r.filters[d])),!0):!1})(t,e):void ut(19439)}function dC(t){return t instanceof jn?(function(n){return`${n.field.canonicalString()} ${n.op} ${pl(n.value)}`})(t):t instanceof yi?(function(n){return n.op.toString()+" {"+n.getFilters().map(dC).join(" ,")+"}"})(t):"Filter"}class O4 extends jn{constructor(e,n,s){super(e,n,s),this.key=st.fromName(s.referenceValue)}matches(e){const n=st.comparator(e.key,this.key);return this.matchesComparison(n)}}class B4 extends jn{constructor(e,n){super(e,"in",n),this.keys=hC("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class z4 extends jn{constructor(e,n){super(e,"not-in",n),this.keys=hC("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function hC(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map((s=>st.fromName(s.referenceValue)))}class j4 extends jn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ug(n)&&jc(n.arrayValue,this.value)}}class F4 extends jn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&jc(this.value.arrayValue,n)}}class q4 extends jn{constructor(e,n){super(e,"not-in",n)}matches(e){if(jc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!jc(this.value.arrayValue,n)}}class H4 extends jn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ug(n)||!n.arrayValue.values)&&n.arrayValue.values.some((s=>jc(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e,n=null,s=[],r=[],a=null,c=null,d=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=a,this.startAt=c,this.endAt=d,this.Te=null}}function dE(t,e=null,n=[],s=[],r=null,a=null,c=null){return new G4(t,e,n,s,r,a,c)}function Og(t){const e=yt(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((s=>jm(s))).join(","),n+="|ob:",n+=e.orderBy.map((s=>(function(a){return a.field.canonicalString()+a.dir})(s))).join(","),Sh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((s=>pl(s))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((s=>pl(s))).join(",")),e.Te=n}return e.Te}function Bg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!V4(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!uC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!uE(t.startAt,e.startAt)&&uE(t.endAt,e.endAt)}function Fm(t){return st.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,n=null,s=[],r=[],a=null,c="F",d=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=a,this.limitType=c,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function $4(t,e,n,s,r,a,c,d){return new Cl(t,e,n,s,r,a,c,d)}function zg(t){return new Cl(t)}function hE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function fC(t){return t.collectionGroup!==null}function Mc(t){const e=yt(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),n.add(a.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new Yn(is.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((h=>{h.isInequality()&&(d=d.add(h.field))}))})),d})(e).forEach((a=>{n.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Fc(a,s))})),n.has(is.keyField().canonicalString())||e.Ie.push(new Fc(is.keyField(),s))}return e.Ie}function Ui(t){const e=yt(t);return e.Ee||(e.Ee=Y4(e,Mc(t))),e.Ee}function Y4(t,e){if(t.limitType==="F")return dE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((r=>{const a=r.dir==="desc"?"asc":"desc";return new Fc(r.field,a)}));const n=t.endAt?new rh(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new rh(t.startAt.position,t.startAt.inclusive):null;return dE(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function qm(t,e){const n=t.filters.concat([e]);return new Cl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Hm(t,e,n){return new Cl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ih(t,e){return Bg(Ui(t),Ui(e))&&t.limitType===e.limitType}function pC(t){return`${Og(Ui(t))}|lt:${t.limitType}`}function Wa(t){return`Query(target=${(function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map((r=>dC(r))).join(", ")}]`),Sh(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map((r=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(r))).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map((r=>pl(r))).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map((r=>pl(r))).join(",")),`Target(${s})`})(Ui(t))}; limitType=${t.limitType})`}function Rh(t,e){return e.isFoundDocument()&&(function(s,r){const a=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(a):st.isDocumentKey(s.path)?s.path.isEqual(a):s.path.isImmediateParentOf(a)})(t,e)&&(function(s,r){for(const a of Mc(s))if(!a.field.isKeyField()&&r.data.field(a.field)===null)return!1;return!0})(t,e)&&(function(s,r){for(const a of s.filters)if(!a.matches(r))return!1;return!0})(t,e)&&(function(s,r){return!(s.startAt&&!(function(c,d,f){const h=cE(c,d,f);return c.inclusive?h<=0:h<0})(s.startAt,Mc(s),r)||s.endAt&&!(function(c,d,f){const h=cE(c,d,f);return c.inclusive?h>=0:h>0})(s.endAt,Mc(s),r))})(t,e)}function J4(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function mC(t){return(e,n)=>{let s=!1;for(const r of Mc(t)){const a=K4(r,e,n);if(a!==0)return a;s=s||r.field.isKeyField()}return 0}}function K4(t,e,n){const s=t.field.isKeyField()?st.comparator(e.key,n.key):(function(a,c,d){const f=c.data.field(a),h=d.data.field(a);return f!==null&&h!==null?fl(f,h):ut(42886)})(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return ut(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,a]of s)if(this.equalsFn(r,e))return a}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){vo(this.inner,((n,s)=>{for(const[r,a]of s)e(r,a)}))}isEmpty(){return Qw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4=new bn(st.comparator);function mr(){return W4}const gC=new bn(st.comparator);function wc(...t){let e=gC;for(const n of t)e=e.insert(n.key,n);return e}function yC(t){let e=gC;return t.forEach(((n,s)=>e=e.insert(n,s.overlayedDocument))),e}function Yo(){return kc()}function vC(){return kc()}function kc(){return new ca((t=>t.toString()),((t,e)=>t.isEqual(e)))}const X4=new bn(st.comparator),Q4=new Yn(st.comparator);function Lt(...t){let e=Q4;for(const n of t)e=e.add(n);return e}const Z4=new Yn(Pt);function eV(){return Z4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nh(e)?"-0":e}}function _C(t){return{integerValue:""+t}}function tV(t,e){return I4(e)?_C(e):jg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(){this._=void 0}}function nV(t,e,n){return t instanceof qc?(function(r,a){const c={fields:{[tC]:{stringValue:eC},[sC]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return a&&Vg(a)&&(a=Ah(a)),a&&(c.fields[nC]=a),{mapValue:c}})(n,e):t instanceof Hc?bC(t,e):t instanceof Gc?EC(t,e):(function(r,a){const c=xC(r,a),d=fE(c)+fE(r.Ae);return zm(c)&&zm(r.Ae)?_C(d):jg(r.serializer,d)})(t,e)}function sV(t,e,n){return t instanceof Hc?bC(t,e):t instanceof Gc?EC(t,e):n}function xC(t,e){return t instanceof oh?(function(s){return zm(s)||(function(a){return!!a&&"doubleValue"in a})(s)})(e)?e:{integerValue:0}:null}class qc extends Nh{}class Hc extends Nh{constructor(e){super(),this.elements=e}}function bC(t,e){const n=TC(e);for(const s of t.elements)n.some((r=>Fi(r,s)))||n.push(s);return{arrayValue:{values:n}}}class Gc extends Nh{constructor(e){super(),this.elements=e}}function EC(t,e){let n=TC(e);for(const s of t.elements)n=n.filter((r=>!Fi(r,s)));return{arrayValue:{values:n}}}class oh extends Nh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function fE(t){return Dn(t.integerValue||t.doubleValue)}function TC(t){return Ug(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e,n){this.field=e,this.transform=n}}function rV(t,e){return t.field.isEqual(e.field)&&(function(s,r){return s instanceof Hc&&r instanceof Hc||s instanceof Gc&&r instanceof Gc?hl(s.elements,r.elements,Fi):s instanceof oh&&r instanceof oh?Fi(s.Ae,r.Ae):s instanceof qc&&r instanceof qc})(t.transform,e.transform)}class oV{constructor(e,n){this.version=e,this.transformResults=n}}class gi{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gi}static exists(e){return new gi(void 0,e)}static updateTime(e){return new gi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Fd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Mh{}function wC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Fg(t.key,gi.none()):new eu(t.key,t.data,gi.none());{const n=t.data,s=Rs.empty();let r=new Yn(is.comparator);for(let a of e.fields)if(!r.has(a)){let c=n.field(a);c===null&&a.length>1&&(a=a.popLast(),c=n.field(a)),c===null?s.delete(a):s.set(a,c),r=r.add(a)}return new _o(t.key,s,new Bs(r.toArray()),gi.none())}}function aV(t,e,n){t instanceof eu?(function(r,a,c){const d=r.value.clone(),f=mE(r.fieldTransforms,a,c.transformResults);d.setAll(f),a.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(t,e,n):t instanceof _o?(function(r,a,c){if(!Fd(r.precondition,a))return void a.convertToUnknownDocument(c.version);const d=mE(r.fieldTransforms,a,c.transformResults),f=a.data;f.setAll(CC(r)),f.setAll(d),a.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(t,e,n):(function(r,a,c){a.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,n)}function Dc(t,e,n,s){return t instanceof eu?(function(a,c,d,f){if(!Fd(a.precondition,c))return d;const h=a.value.clone(),_=gE(a.fieldTransforms,f,c);return h.setAll(_),c.convertToFoundDocument(c.version,h).setHasLocalMutations(),null})(t,e,n,s):t instanceof _o?(function(a,c,d,f){if(!Fd(a.precondition,c))return d;const h=gE(a.fieldTransforms,f,c),_=c.data;return _.setAll(CC(a)),_.setAll(h),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((b=>b.field)))})(t,e,n,s):(function(a,c,d){return Fd(a.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(t,e,n)}function lV(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),a=xC(s.transform,r||null);a!=null&&(n===null&&(n=Rs.empty()),n.set(s.field,a))}return n||null}function pE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&hl(s,r,((a,c)=>rV(a,c)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class eu extends Mh{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class _o extends Mh{constructor(e,n,s,r,a=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function CC(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}})),e}function mE(t,e,n){const s=new Map;Wt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const a=t[r],c=a.transform,d=e.data.field(a.field);s.set(a.field,sV(c,d,n[r]))}return s}function gE(t,e,n){const s=new Map;for(const r of t){const a=r.transform,c=n.data.field(r.field);s.set(r.field,nV(a,c,e))}return s}class Fg extends Mh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cV extends Mh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const a=this.mutations[r];a.key.isEqual(e.key)&&aV(a,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Dc(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Dc(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=vC();return this.mutations.forEach((r=>{const a=e.get(r.key),c=a.overlayedDocument;let d=this.applyToLocalView(c,a.mutatedFields);d=n.has(r.key)?null:d;const f=wC(c,d);f!==null&&s.set(r.key,f),c.isValidDocument()||c.convertToNoDocument(pt.min())})),s}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Lt())}isEqual(e){return this.batchId===e.batchId&&hl(this.mutations,e.mutations,((n,s)=>pE(n,s)))&&hl(this.baseMutations,e.baseMutations,((n,s)=>pE(n,s)))}}class qg{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){Wt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=(function(){return X4})();const a=e.mutations;for(let c=0;c<a.length;c++)r=r.insert(a[c].key,s[c].version);return new qg(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zn,zt;function fV(t){switch(t){case xe.OK:return ut(64938);case xe.CANCELLED:case xe.UNKNOWN:case xe.DEADLINE_EXCEEDED:case xe.RESOURCE_EXHAUSTED:case xe.INTERNAL:case xe.UNAVAILABLE:case xe.UNAUTHENTICATED:return!1;case xe.INVALID_ARGUMENT:case xe.NOT_FOUND:case xe.ALREADY_EXISTS:case xe.PERMISSION_DENIED:case xe.FAILED_PRECONDITION:case xe.ABORTED:case xe.OUT_OF_RANGE:case xe.UNIMPLEMENTED:case xe.DATA_LOSS:return!0;default:return ut(15467,{code:t})}}function SC(t){if(t===void 0)return pr("GRPC error has no .code"),xe.UNKNOWN;switch(t){case zn.OK:return xe.OK;case zn.CANCELLED:return xe.CANCELLED;case zn.UNKNOWN:return xe.UNKNOWN;case zn.DEADLINE_EXCEEDED:return xe.DEADLINE_EXCEEDED;case zn.RESOURCE_EXHAUSTED:return xe.RESOURCE_EXHAUSTED;case zn.INTERNAL:return xe.INTERNAL;case zn.UNAVAILABLE:return xe.UNAVAILABLE;case zn.UNAUTHENTICATED:return xe.UNAUTHENTICATED;case zn.INVALID_ARGUMENT:return xe.INVALID_ARGUMENT;case zn.NOT_FOUND:return xe.NOT_FOUND;case zn.ALREADY_EXISTS:return xe.ALREADY_EXISTS;case zn.PERMISSION_DENIED:return xe.PERMISSION_DENIED;case zn.FAILED_PRECONDITION:return xe.FAILED_PRECONDITION;case zn.ABORTED:return xe.ABORTED;case zn.OUT_OF_RANGE:return xe.OUT_OF_RANGE;case zn.UNIMPLEMENTED:return xe.UNIMPLEMENTED;case zn.DATA_LOSS:return xe.DATA_LOSS;default:return ut(39323,{code:t})}}(zt=zn||(zn={}))[zt.OK=0]="OK",zt[zt.CANCELLED=1]="CANCELLED",zt[zt.UNKNOWN=2]="UNKNOWN",zt[zt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",zt[zt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",zt[zt.NOT_FOUND=5]="NOT_FOUND",zt[zt.ALREADY_EXISTS=6]="ALREADY_EXISTS",zt[zt.PERMISSION_DENIED=7]="PERMISSION_DENIED",zt[zt.UNAUTHENTICATED=16]="UNAUTHENTICATED",zt[zt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",zt[zt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",zt[zt.ABORTED=10]="ABORTED",zt[zt.OUT_OF_RANGE=11]="OUT_OF_RANGE",zt[zt.UNIMPLEMENTED=12]="UNIMPLEMENTED",zt[zt.INTERNAL=13]="INTERNAL",zt[zt.UNAVAILABLE=14]="UNAVAILABLE",zt[zt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mV=new ro([4294967295,4294967295],0);function yE(t){const e=pV().encode(t),n=new jw;return n.update(e),new Uint8Array(n.digest())}function vE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new ro([n,s],0),new ro([r,a],0)]}class Hg{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new Cc(`Invalid padding: ${n}`);if(s<0)throw new Cc(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Cc(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new Cc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ro.fromNumber(this.ge)}ye(e,n,s){let r=e.add(n.multiply(ro.fromNumber(s)));return r.compare(mV)===1&&(r=new ro([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=yE(e),[s,r]=vE(n);for(let a=0;a<this.hashCount;a++){const c=this.ye(s,r,a);if(!this.we(c))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),c=new Hg(a,r,n);return s.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const n=yE(e),[s,r]=vE(n);for(let a=0;a<this.hashCount;a++){const c=this.ye(s,r,a);this.Se(c)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class Cc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n,s,r,a){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,tu.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new kh(pt.min(),r,new bn(Pt),mr(),Lt())}}class tu{constructor(e,n,s,r,a){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new tu(s,n,Lt(),Lt(),Lt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd{constructor(e,n,s,r){this.be=e,this.removedTargetIds=n,this.key=s,this.De=r}}class AC{constructor(e,n){this.targetId=e,this.Ce=n}}class IC{constructor(e,n,s=rs.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class _E{constructor(){this.ve=0,this.Fe=xE(),this.Me=rs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Lt(),n=Lt(),s=Lt();return this.Fe.forEach(((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:ut(38017,{changeType:a})}})),new tu(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=xE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Wt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class gV{constructor(e){this.Ge=e,this.ze=new Map,this.je=mr(),this.Je=Id(),this.He=Id(),this.Ye=new bn(Pt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:ut(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((s,r)=>{this.rt(r)&&n(r)}))}st(e){const n=e.targetId,s=e.Ce.count,r=this.ot(n);if(r){const a=r.target;if(Fm(a))if(s===0){const c=new st(a.path);this.et(n,c,us.newNoDocument(c,pt.min()))}else Wt(s===1,20013,{expectedCount:s});else{const c=this._t(n);if(c!==s){const d=this.ut(e),f=d?this.ct(d,e,c):1;if(f!==0){this.it(n);const h=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,h)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:a=0}=n;let c,d;try{c=ho(s).toUint8Array()}catch(f){if(f instanceof Zw)return dl("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new Hg(c,r,a)}catch(f){return dl(f instanceof Cc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let r=0;return s.forEach((a=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.et(n,a,null),r++)})),r}Tt(e){const n=new Map;this.ze.forEach(((a,c)=>{const d=this.ot(c);if(d){if(a.current&&Fm(d.target)){const f=new st(d.target.path);this.It(f).has(c)||this.Et(c,f)||this.et(c,f,us.newNoDocument(f,e))}a.Be&&(n.set(c,a.ke()),a.qe())}}));let s=Lt();this.He.forEach(((a,c)=>{let d=!0;c.forEachWhile((f=>{const h=this.ot(f);return!h||h.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(s=s.add(a))})),this.je.forEach(((a,c)=>c.setReadTime(e)));const r=new kh(e,n,this.Ye,this.je,s);return this.je=mr(),this.Je=Id(),this.He=Id(),this.Ye=new bn(Pt),r}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new _E,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Yn(Pt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Yn(Pt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||je("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new _E),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Id(){return new bn(st.comparator)}function xE(){return new bn(st.comparator)}const yV={asc:"ASCENDING",desc:"DESCENDING"},vV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_V={and:"AND",or:"OR"};class xV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Gm(t,e){return t.useProto3Json||Sh(e)?e:{value:e}}function ah(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function RC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function bV(t,e){return ah(t,e.toTimestamp())}function Oi(t){return Wt(!!t,49232),pt.fromTimestamp((function(n){const s=uo(n);return new gn(s.seconds,s.nanos)})(t))}function Gg(t,e){return $m(t,e).canonicalString()}function $m(t,e){const n=(function(r){return new hn(["projects",r.projectId,"databases",r.database])})(t).child("documents");return e===void 0?n:n.child(e)}function NC(t){const e=hn.fromString(t);return Wt(LC(e),10190,{key:e.toString()}),e}function Ym(t,e){return Gg(t.databaseId,e.path)}function dm(t,e){const n=NC(e);if(n.get(1)!==t.databaseId.projectId)throw new Ve(xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Ve(xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new st(kC(n))}function MC(t,e){return Gg(t.databaseId,e)}function EV(t){const e=NC(t);return e.length===4?hn.emptyPath():kC(e)}function Jm(t){return new hn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function kC(t){return Wt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function bE(t,e,n){return{name:Ym(t,e),fields:n.value.mapValue.fields}}function TV(t,e){let n;if("targetChange"in e){e.targetChange;const s=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ut(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],a=(function(h,_){return h.useProto3Json?(Wt(_===void 0||typeof _=="string",58123),rs.fromBase64String(_||"")):(Wt(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),rs.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(h){const _=h.code===void 0?xe.UNKNOWN:SC(h.code);return new Ve(_,h.message||"")})(c);n=new IC(s,r,a,d||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=dm(t,s.document.name),a=Oi(s.document.updateTime),c=s.document.createTime?Oi(s.document.createTime):pt.min(),d=new Rs({mapValue:{fields:s.document.fields}}),f=us.newFoundDocument(r,a,c,d),h=s.targetIds||[],_=s.removedTargetIds||[];n=new qd(h,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=dm(t,s.document),a=s.readTime?Oi(s.readTime):pt.min(),c=us.newNoDocument(r,a),d=s.removedTargetIds||[];n=new qd([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=dm(t,s.document),a=s.removedTargetIds||[];n=new qd([],a,r,null)}else{if(!("filter"in e))return ut(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:a}=s,c=new hV(r,a),d=s.targetId;n=new AC(d,c)}}return n}function wV(t,e){let n;if(e instanceof eu)n={update:bE(t,e.key,e.value)};else if(e instanceof Fg)n={delete:Ym(t,e.key)};else if(e instanceof _o)n={update:bE(t,e.key,e.data),updateMask:DV(e.fieldMask)};else{if(!(e instanceof cV))return ut(16599,{Vt:e.type});n={verify:Ym(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((s=>(function(a,c){const d=c.transform;if(d instanceof qc)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Hc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Gc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof oh)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw ut(20930,{transform:c.transform})})(0,s)))),e.precondition.isNone||(n.currentDocument=(function(r,a){return a.updateTime!==void 0?{updateTime:bV(r,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ut(27497)})(t,e.precondition)),n}function CV(t,e){return t&&t.length>0?(Wt(e!==void 0,14353),t.map((n=>(function(r,a){let c=r.updateTime?Oi(r.updateTime):Oi(a);return c.isEqual(pt.min())&&(c=Oi(a)),new oV(c,r.transformResults||[])})(n,e)))):[]}function SV(t,e){return{documents:[MC(t,e.path)]}}function AV(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=MC(t,r);const a=(function(h){if(h.length!==0)return PC(yi.create(h,"and"))})(e.filters);a&&(n.structuredQuery.where=a);const c=(function(h){if(h.length!==0)return h.map((_=>(function(E){return{field:Xa(E.field),direction:NV(E.dir)}})(_)))})(e.orderBy);c&&(n.structuredQuery.orderBy=c);const d=Gm(t,e.limit);return d!==null&&(n.structuredQuery.limit=d),e.startAt&&(n.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:n,parent:r}}function IV(t){let e=EV(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){Wt(s===1,65062);const _=n.from[0];_.allDescendants?r=_.collectionId:e=e.child(_.collectionId)}let a=[];n.where&&(a=(function(b){const E=DC(b);return E instanceof yi&&cC(E)?E.getFilters():[E]})(n.where));let c=[];n.orderBy&&(c=(function(b){return b.map((E=>(function(L){return new Fc(Qa(L.field),(function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(L.direction))})(E)))})(n.orderBy));let d=null;n.limit&&(d=(function(b){let E;return E=typeof b=="object"?b.value:b,Sh(E)?null:E})(n.limit));let f=null;n.startAt&&(f=(function(b){const E=!!b.before,S=b.values||[];return new rh(S,E)})(n.startAt));let h=null;return n.endAt&&(h=(function(b){const E=!b.before,S=b.values||[];return new rh(S,E)})(n.endAt)),$4(e,r,c,a,d,"F",f,h)}function RV(t,e){const n=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ut(28987,{purpose:r})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function DC(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=Qa(n.unaryFilter.field);return jn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=Qa(n.unaryFilter.field);return jn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Qa(n.unaryFilter.field);return jn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Qa(n.unaryFilter.field);return jn.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ut(61313);default:return ut(60726)}})(t):t.fieldFilter!==void 0?(function(n){return jn.create(Qa(n.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ut(58110);default:return ut(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return yi.create(n.compositeFilter.filters.map((s=>DC(s))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ut(1026)}})(n.compositeFilter.op))})(t):ut(30097,{filter:t})}function NV(t){return yV[t]}function MV(t){return vV[t]}function kV(t){return _V[t]}function Xa(t){return{fieldPath:t.canonicalString()}}function Qa(t){return is.fromServerFormat(t.fieldPath)}function PC(t){return t instanceof jn?(function(n){if(n.op==="=="){if(lE(n.value))return{unaryFilter:{field:Xa(n.field),op:"IS_NAN"}};if(aE(n.value))return{unaryFilter:{field:Xa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(lE(n.value))return{unaryFilter:{field:Xa(n.field),op:"IS_NOT_NAN"}};if(aE(n.value))return{unaryFilter:{field:Xa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xa(n.field),op:MV(n.op),value:n.value}}})(t):t instanceof yi?(function(n){const s=n.getFilters().map((r=>PC(r)));return s.length===1?s[0]:{compositeFilter:{op:kV(n.op),filters:s}}})(t):ut(54877,{filter:t})}function DV(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function LC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n,s,r,a=pt.min(),c=pt.min(),d=rs.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new no(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new no(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new no(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new no(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{constructor(e){this.yt=e}}function LV(t){const e=IV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Hm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(){this.Cn=new UV}addToCollectionParentIndex(e,n){return this.Cn.add(n),Ee.resolve()}getCollectionParents(e,n){return Ee.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return Ee.resolve()}deleteFieldIndex(e,n){return Ee.resolve()}deleteAllFieldIndexes(e){return Ee.resolve()}createTargetIndexes(e,n){return Ee.resolve()}getDocumentsMatchingTarget(e,n){return Ee.resolve(null)}getIndexType(e,n){return Ee.resolve(0)}getFieldIndexes(e,n){return Ee.resolve([])}getNextCollectionGroupToUpdate(e){return Ee.resolve(null)}getMinOffset(e,n){return Ee.resolve(co.min())}getMinOffsetFromCollectionGroup(e,n){return Ee.resolve(co.min())}updateCollectionGroup(e,n,s){return Ee.resolve()}updateIndexEntries(e,n){return Ee.resolve()}}class UV{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new Yn(hn.comparator),a=!r.has(s);return this.index[n]=r.add(s),a}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Yn(hn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},VC=41943040;class Is{static withCacheSize(e){return new Is(e,Is.DEFAULT_COLLECTION_PERCENTILE,Is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Is.DEFAULT_COLLECTION_PERCENTILE=10,Is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Is.DEFAULT=new Is(VC,Is.DEFAULT_COLLECTION_PERCENTILE,Is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Is.DISABLED=new Is(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ml(0)}static cr(){return new ml(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE="LruGarbageCollector",OV=1048576;function wE([t,e],[n,s]){const r=Pt(t,n);return r===0?Pt(e,s):r}class BV{constructor(e){this.Ir=e,this.buffer=new Yn(wE),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();wE(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class zV{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){je(TE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){wl(n)?je(TE,"Ignoring IndexedDB error during garbage collection: ",n):await Tl(n)}await this.Vr(3e5)}))}}class jV{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((s=>Math.floor(n/100*s)))}nthSequenceNumber(e,n){if(n===0)return Ee.resolve(Ch.ce);const s=new BV(n);return this.mr.forEachTarget(e,(r=>s.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>s.Ar(r))))).next((()=>s.maxValue))}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),Ee.resolve(EE)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),EE):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,r,a,c,d,f,h;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),r=this.params.maximumSequenceNumbersToCollect):r=b,c=Date.now(),this.nthSequenceNumber(e,r)))).next((b=>(s=b,d=Date.now(),this.removeTargets(e,s,n)))).next((b=>(a=b,f=Date.now(),this.removeOrphanedDocuments(e,s)))).next((b=>(h=Date.now(),Ka()<=Dt.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${r} in `+(d-c)+`ms
	Removed ${a} targets in `+(f-d)+`ms
	Removed ${b} documents in `+(h-f)+`ms
Total Duration: ${h-_}ms`),Ee.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:b}))))}}function FV(t,e){return new jV(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(){this.changes=new ca((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,us.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?Ee.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next((r=>(s=r,this.remoteDocumentCache.getEntry(e,n)))).next((r=>(s!==null&&Dc(s.mutation,r,Bs.empty(),gn.now()),r)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((s=>this.getLocalViewOfDocuments(e,s,Lt()).next((()=>s))))}getLocalViewOfDocuments(e,n,s=Lt()){const r=Yo();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,s).next((a=>{let c=wc();return a.forEach(((d,f)=>{c=c.insert(d,f.overlayedDocument)})),c}))))}getOverlayedDocuments(e,n){const s=Yo();return this.populateOverlays(e,s,n).next((()=>this.computeViews(e,n,s,Lt())))}populateOverlays(e,n,s){const r=[];return s.forEach((a=>{n.has(a)||r.push(a)})),this.documentOverlayCache.getOverlays(e,r).next((a=>{a.forEach(((c,d)=>{n.set(c,d)}))}))}computeViews(e,n,s,r){let a=mr();const c=kc(),d=(function(){return kc()})();return n.forEach(((f,h)=>{const _=s.get(h.key);r.has(h.key)&&(_===void 0||_.mutation instanceof _o)?a=a.insert(h.key,h):_!==void 0?(c.set(h.key,_.mutation.getFieldMask()),Dc(_.mutation,h,_.mutation.getFieldMask(),gn.now())):c.set(h.key,Bs.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((h,_)=>c.set(h,_))),n.forEach(((h,_)=>d.set(h,new HV(_,c.get(h)??null)))),d)))}recalculateAndSaveOverlays(e,n){const s=kc();let r=new bn(((c,d)=>c-d)),a=Lt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((c=>{for(const d of c)d.keys().forEach((f=>{const h=n.get(f);if(h===null)return;let _=s.get(f)||Bs.empty();_=d.applyToLocalView(h,_),s.set(f,_);const b=(r.get(d.batchId)||Lt()).add(f);r=r.insert(d.batchId,b)}))})).next((()=>{const c=[],d=r.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),h=f.key,_=f.value,b=vC();_.forEach((E=>{if(!a.has(E)){const S=wC(n.get(E),s.get(E));S!==null&&b.set(E,S),a=a.add(E)}})),c.push(this.documentOverlayCache.saveOverlays(e,h,b))}return Ee.waitFor(c)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,n,s,r){return(function(c){return st.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):fC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next((a=>{const c=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-a.size):Ee.resolve(Yo());let d=Oc,f=a;return c.next((h=>Ee.forEach(h,((_,b)=>(d<b.largestBatchId&&(d=b.largestBatchId),a.get(_)?Ee.resolve():this.remoteDocumentCache.getEntry(e,_).next((E=>{f=f.insert(_,E)}))))).next((()=>this.populateOverlays(e,h,a))).next((()=>this.computeViews(e,f,h,Lt()))).next((_=>({batchId:d,changes:yC(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new st(n)).next((s=>{let r=wc();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r}))}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const a=n.collectionGroup;let c=wc();return this.indexManager.getCollectionParents(e,a).next((d=>Ee.forEach(d,(f=>{const h=(function(b,E){return new Cl(E,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(n,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,h,s,r).next((_=>{_.forEach(((b,E)=>{c=c.insert(b,E)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,n,s,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next((c=>(a=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,a,r)))).next((c=>{a.forEach(((f,h)=>{const _=h.getKey();c.get(_)===null&&(c=c.insert(_,us.newInvalidDocument(_)))}));let d=wc();return c.forEach(((f,h)=>{const _=a.get(f);_!==void 0&&Dc(_.mutation,h,Bs.empty(),gn.now()),Rh(n,h)&&(d=d.insert(f,h))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return Ee.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(r){return{id:r.id,version:r.version,createTime:Oi(r.createTime)}})(n)),Ee.resolve()}getNamedQuery(e,n){return Ee.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(r){return{name:r.name,query:LV(r.bundledQuery),readTime:Oi(r.readTime)}})(n)),Ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(){this.overlays=new bn(st.comparator),this.qr=new Map}getOverlay(e,n){return Ee.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Yo();return Ee.forEach(n,(r=>this.getOverlay(e,r).next((a=>{a!==null&&s.set(r,a)})))).next((()=>s))}saveOverlays(e,n,s){return s.forEach(((r,a)=>{this.St(e,n,a)})),Ee.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(s)),Ee.resolve()}getOverlaysForCollection(e,n,s){const r=Yo(),a=n.length+1,c=new st(n.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const f=d.getNext().value,h=f.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===a&&f.largestBatchId>s&&r.set(f.getKey(),f)}return Ee.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let a=new bn(((h,_)=>h-_));const c=this.overlays.getIterator();for(;c.hasNext();){const h=c.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>s){let _=a.get(h.largestBatchId);_===null&&(_=Yo(),a=a.insert(h.largestBatchId,_)),_.set(h.getKey(),h)}}const d=Yo(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((h,_)=>d.set(h,_))),!(d.size()>=r)););return Ee.resolve(d)}St(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const c=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,c)}this.overlays=this.overlays.insert(s.key,new dV(n,s));let a=this.qr.get(n);a===void 0&&(a=Lt(),this.qr.set(n,a)),this.qr.set(n,a.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(){this.sessionToken=rs.EMPTY_BYTE_STRING}getSessionToken(e){return Ee.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(){this.Qr=new Yn(Wn.$r),this.Ur=new Yn(Wn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new Wn(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach((s=>this.addReference(s,n)))}removeReference(e,n){this.Gr(new Wn(e,n))}zr(e,n){e.forEach((s=>this.removeReference(s,n)))}jr(e){const n=new st(new hn([])),s=new Wn(n,e),r=new Wn(n,e+1),a=[];return this.Ur.forEachInRange([s,r],(c=>{this.Gr(c),a.push(c.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new st(new hn([])),s=new Wn(n,e),r=new Wn(n,e+1);let a=Lt();return this.Ur.forEachInRange([s,r],(c=>{a=a.add(c.key)})),a}containsKey(e){const n=new Wn(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Wn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return st.comparator(e.key,n.key)||Pt(e.Yr,n.Yr)}static Kr(e,n){return Pt(e.Yr,n.Yr)||st.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Yn(Wn.$r)}checkEmpty(e){return Ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new uV(a,n,s,r);this.mutationQueue.push(c);for(const d of r)this.Zr=this.Zr.add(new Wn(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return Ee.resolve(c)}lookupMutationBatch(e,n){return Ee.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ei(s),a=r<0?0:r;return Ee.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Ee.resolve(this.mutationQueue.length===0?Lg:this.tr-1)}getAllMutationBatches(e){return Ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Wn(n,0),r=new Wn(n,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([s,r],(c=>{const d=this.Xr(c.Yr);a.push(d)})),Ee.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Yn(Pt);return n.forEach((r=>{const a=new Wn(r,0),c=new Wn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,c],(d=>{s=s.add(d.Yr)}))})),Ee.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let a=s;st.isDocumentKey(a)||(a=a.child(""));const c=new Wn(new st(a),0);let d=new Yn(Pt);return this.Zr.forEachWhile((f=>{const h=f.key.path;return!!s.isPrefixOf(h)&&(h.length===r&&(d=d.add(f.Yr)),!0)}),c),Ee.resolve(this.ti(d))}ti(e){const n=[];return e.forEach((s=>{const r=this.Xr(s);r!==null&&n.push(r)})),n}removeMutationBatch(e,n){Wt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return Ee.forEach(n.mutations,(r=>{const a=new Wn(r.key,n.batchId);return s=s.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,n){const s=new Wn(n,0),r=this.Zr.firstAfterOrEqual(s);return Ee.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ee.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e){this.ri=e,this.docs=(function(){return new bn(st.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),a=r?r.size:0,c=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:c}),this.size+=c-a,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return Ee.resolve(s?s.document.mutableCopy():us.newInvalidDocument(n))}getEntries(e,n){let s=mr();return n.forEach((r=>{const a=this.docs.get(r);s=s.insert(r,a?a.document.mutableCopy():us.newInvalidDocument(r))})),Ee.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let a=mr();const c=n.path,d=new st(c.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:h,value:{document:_}}=f.getNext();if(!c.isPrefixOf(h.path))break;h.path.length>c.length+1||w4(T4(_),s)<=0||(r.has(_.key)||Rh(n,_))&&(a=a.insert(_.key,_.mutableCopy()))}return Ee.resolve(a)}getAllFromCollectionGroup(e,n,s,r){ut(9500)}ii(e,n){return Ee.forEach(this.docs,(s=>n(s)))}newChangeBuffer(e){return new XV(this)}getSize(e){return Ee.resolve(this.size)}}class XV extends qV{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((s,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)})),Ee.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(e){this.persistence=e,this.si=new ca((n=>Og(n)),Bg),this.lastRemoteSnapshotVersion=pt.min(),this.highestTargetId=0,this.oi=0,this._i=new $g,this.targetCount=0,this.ai=ml.ur()}forEachTarget(e,n){return this.si.forEach(((s,r)=>n(r))),Ee.resolve()}getLastRemoteSnapshotVersion(e){return Ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ee.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ee.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),Ee.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new ml(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,Ee.resolve()}updateTargetData(e,n){return this.Pr(n),Ee.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,Ee.resolve()}removeTargets(e,n,s){let r=0;const a=[];return this.si.forEach(((c,d)=>{d.sequenceNumber<=n&&s.get(d.targetId)===null&&(this.si.delete(c),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),r++)})),Ee.waitFor(a).next((()=>r))}getTargetCount(e){return Ee.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return Ee.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),Ee.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const r=this.persistence.referenceDelegate,a=[];return r&&n.forEach((c=>{a.push(r.markPotentiallyOrphaned(e,c))})),Ee.waitFor(a)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),Ee.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return Ee.resolve(s)}containsKey(e,n){return Ee.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e,n){this.ui={},this.overlays={},this.ci=new Ch(0),this.li=!1,this.li=!0,this.hi=new JV,this.referenceDelegate=e(this),this.Pi=new QV(this),this.indexManager=new VV,this.remoteDocumentCache=(function(r){return new WV(r)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new PV(n),this.Ii=new $V(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new YV,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new KV(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){je("MemoryPersistence","Starting transaction:",e);const r=new ZV(this.ci.next());return this.referenceDelegate.Ei(),s(r).next((a=>this.referenceDelegate.di(r).next((()=>a)))).toPromise().then((a=>(r.raiseOnCommittedEvent(),a)))}Ai(e,n){return Ee.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,n))))}}class ZV extends S4{constructor(e){super(),this.currentSequenceNumber=e}}class Yg{constructor(e){this.persistence=e,this.Ri=new $g,this.Vi=null}static mi(e){return new Yg(e)}get fi(){if(this.Vi)return this.Vi;throw ut(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),Ee.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),Ee.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),Ee.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((r=>this.fi.add(r.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next((r=>{r.forEach((a=>this.fi.add(a.toString())))})).next((()=>s.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ee.forEach(this.fi,(s=>{const r=st.fromPath(s);return this.gi(e,r).next((a=>{a||n.removeEntry(r,pt.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return Ee.or([()=>Ee.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class lh{constructor(e,n){this.persistence=e,this.pi=new ca((s=>R4(s.path)),((s,r)=>s.isEqual(r))),this.garbageCollector=FV(this,n)}static mi(e,n){return new lh(e,n)}Ei(){}di(e){return Ee.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>n.next((r=>s+r))))}wr(e){let n=0;return this.pr(e,(s=>{n++})).next((()=>n))}pr(e,n){return Ee.forEach(this.pi,((s,r)=>this.br(e,s,r).next((a=>a?Ee.resolve():n(r)))))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.ii(e,(c=>this.br(e,c,n).next((d=>{d||(s++,a.removeEntry(c,pt.min()))})))).next((()=>a.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),Ee.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),Ee.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),Ee.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),Ee.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=zd(e.data.value)),n}br(e,n,s){return Ee.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return Ee.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=r}static As(e,n){let s=Lt(),r=Lt();for(const a of n.docChanges)switch(a.type){case 0:s=s.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new Jg(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Hk()?8:A4(hs())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,r){const a={result:null};return this.ys(e,n).next((c=>{a.result=c})).next((()=>{if(!a.result)return this.ws(e,n,r,s).next((c=>{a.result=c}))})).next((()=>{if(a.result)return;const c=new eU;return this.Ss(e,n,c).next((d=>{if(a.result=d,this.Vs)return this.bs(e,n,c,d.size)}))})).next((()=>a.result))}bs(e,n,s,r){return s.documentReadCount<this.fs?(Ka()<=Dt.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",Wa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ee.resolve()):(Ka()<=Dt.DEBUG&&je("QueryEngine","Query:",Wa(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Ka()<=Dt.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",Wa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ui(n))):Ee.resolve())}ys(e,n){if(hE(n))return Ee.resolve(null);let s=Ui(n);return this.indexManager.getIndexType(e,s).next((r=>r===0?null:(n.limit!==null&&r===1&&(n=Hm(n,null,"F"),s=Ui(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next((a=>{const c=Lt(...a);return this.ps.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,s).next((f=>{const h=this.Ds(n,d);return this.Cs(n,h,c,f.readTime)?this.ys(e,Hm(n,null,"F")):this.vs(e,h,n,f)}))))})))))}ws(e,n,s,r){return hE(n)||r.isEqual(pt.min())?Ee.resolve(null):this.ps.getDocuments(e,s).next((a=>{const c=this.Ds(n,a);return this.Cs(n,c,s,r)?Ee.resolve(null):(Ka()<=Dt.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Wa(n)),this.vs(e,c,n,E4(r,Oc)).next((d=>d)))}))}Ds(e,n){let s=new Yn(mC(e));return n.forEach(((r,a)=>{Rh(e,a)&&(s=s.add(a))})),s}Cs(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const a=e.limitType==="F"?n.last():n.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}Ss(e,n,s){return Ka()<=Dt.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",Wa(n)),this.ps.getDocumentsMatchingQuery(e,n,co.min(),s)}vs(e,n,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next((a=>(n.forEach((c=>{a=a.insert(c.key,c)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg="LocalStore",nU=3e8;class sU{constructor(e,n,s,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new bn(Pt),this.xs=new ca((a=>Og(a)),Bg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new GV(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function iU(t,e,n,s){return new sU(t,e,n,s)}async function OC(t,e){const n=yt(t);return await n.persistence.runTransaction("Handle user change","readonly",(s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next((a=>(r=a,n.Bs(e),n.mutationQueue.getAllMutationBatches(s)))).next((a=>{const c=[],d=[];let f=Lt();for(const h of r){c.push(h.batchId);for(const _ of h.mutations)f=f.add(_.key)}for(const h of a){d.push(h.batchId);for(const _ of h.mutations)f=f.add(_.key)}return n.localDocuments.getDocuments(s,f).next((h=>({Ls:h,removedBatchIds:c,addedBatchIds:d})))}))}))}function rU(t,e){const n=yt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const r=e.batch.keys(),a=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,f,h,_){const b=h.batch,E=b.keys();let S=Ee.resolve();return E.forEach((L=>{S=S.next((()=>_.getEntry(f,L))).next((U=>{const F=h.docVersions.get(L);Wt(F!==null,48541),U.version.compareTo(F)<0&&(b.applyToRemoteDocument(U,h),U.isValidDocument()&&(U.setReadTime(h.commitVersion),_.addEntry(U)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(f,b)))})(n,s,e,a).next((()=>a.apply(s))).next((()=>n.mutationQueue.performConsistencyCheck(s))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(d){let f=Lt();for(let h=0;h<d.mutationResults.length;++h)d.mutationResults[h].transformResults.length>0&&(f=f.add(d.batch.mutations[h].key));return f})(e)))).next((()=>n.localDocuments.getDocuments(s,r)))}))}function BC(t){const e=yt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function oU(t,e){const n=yt(t),s=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const c=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const d=[];e.targetChanges.forEach(((_,b)=>{const E=r.get(b);if(!E)return;d.push(n.Pi.removeMatchingKeys(a,_.removedDocuments,b).next((()=>n.Pi.addMatchingKeys(a,_.addedDocuments,b))));let S=E.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(b)!==null?S=S.withResumeToken(rs.EMPTY_BYTE_STRING,pt.min()).withLastLimboFreeSnapshotVersion(pt.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,s)),r=r.insert(b,S),(function(U,F,z){return U.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=nU?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0})(E,S,_)&&d.push(n.Pi.updateTargetData(a,S))}));let f=mr(),h=Lt();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(n.persistence.referenceDelegate.updateLimboDocument(a,_))})),d.push(aU(a,c,e.documentUpdates).next((_=>{f=_.ks,h=_.qs}))),!s.isEqual(pt.min())){const _=n.Pi.getLastRemoteSnapshotVersion(a).next((b=>n.Pi.setTargetsMetadata(a,a.currentSequenceNumber,s)));d.push(_)}return Ee.waitFor(d).next((()=>c.apply(a))).next((()=>n.localDocuments.getLocalViewOfDocuments(a,f,h))).next((()=>f))})).then((a=>(n.Ms=r,a)))}function aU(t,e,n){let s=Lt(),r=Lt();return n.forEach((a=>s=s.add(a))),e.getEntries(t,s).next((a=>{let c=mr();return n.forEach(((d,f)=>{const h=a.get(d);f.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(d)),f.isNoDocument()&&f.version.isEqual(pt.min())?(e.removeEntry(d,f.readTime),c=c.insert(d,f)):!h.isValidDocument()||f.version.compareTo(h.version)>0||f.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(f),c=c.insert(d,f)):je(Kg,"Ignoring outdated watch update for ",d,". Current version:",h.version," Watch version:",f.version)})),{ks:c,qs:r}}))}function lU(t,e){const n=yt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Lg),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function cU(t,e){const n=yt(t);return n.persistence.runTransaction("Allocate target","readwrite",(s=>{let r;return n.Pi.getTargetData(s,e).next((a=>a?(r=a,Ee.resolve(r)):n.Pi.allocateTargetId(s).next((c=>(r=new no(e,c,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,r).next((()=>r)))))))})).then((s=>{const r=n.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s}))}async function Km(t,e,n){const s=yt(t),r=s.Ms.get(e),a=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",a,(c=>s.persistence.referenceDelegate.removeTarget(c,r)))}catch(c){if(!wl(c))throw c;je(Kg,`Failed to update sequence numbers for target ${e}: ${c}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function CE(t,e,n){const s=yt(t);let r=pt.min(),a=Lt();return s.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,h,_){const b=yt(f),E=b.xs.get(_);return E!==void 0?Ee.resolve(b.Ms.get(E)):b.Pi.getTargetData(h,_)})(s,c,Ui(e)).next((d=>{if(d)return r=d.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(c,d.targetId).next((f=>{a=f}))})).next((()=>s.Fs.getDocumentsMatchingQuery(c,e,n?r:pt.min(),n?a:Lt()))).next((d=>(uU(s,J4(e),d),{documents:d,Qs:a})))))}function uU(t,e,n){let s=t.Os.get(e)||pt.min();n.forEach(((r,a)=>{a.readTime.compareTo(s)>0&&(s=a.readTime)})),t.Os.set(e,s)}class SE{constructor(){this.activeTargetIds=eV()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class dU{constructor(){this.Mo=new SE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new SE,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AE="ConnectivityMonitor";class IE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){je(AE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){je(AE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rd=null;function Wm(){return Rd===null?Rd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Rd++,"0x"+Rd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hm="RestConnection",fU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pU{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===sh?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,n,s,r,a){const c=Wm(),d=this.zo(e,n.toUriEncodedString());je(hm,`Sending RPC '${e}' ${c}:`,d,s);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,r,a);const{host:h}=new URL(d),_=yo(h);return this.Jo(e,d,f,s,_).then((b=>(je(hm,`Received RPC '${e}' ${c}: `,b),b)),(b=>{throw dl(hm,`RPC '${e}' ${c} failed with error: `,b,"url: ",d,"request:",s),b}))}Ho(e,n,s,r,a,c){return this.Go(e,n,s,r,a)}jo(e,n,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+El})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((r,a)=>e[a]=r)),s&&s.headers.forEach(((r,a)=>e[a]=r))}zo(e,n){const s=fU[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls="WebChannelConnection";class gU extends pU{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,r,a){const c=Wm();return new Promise(((d,f)=>{const h=new Fw;h.setWithCredentials(!0),h.listenOnce(qw.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Bd.NO_ERROR:const b=h.getResponseJson();je(ls,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(b)),d(b);break;case Bd.TIMEOUT:je(ls,`RPC '${e}' ${c} timed out`),f(new Ve(xe.DEADLINE_EXCEEDED,"Request time out"));break;case Bd.HTTP_ERROR:const E=h.getStatus();if(je(ls,`RPC '${e}' ${c} failed with status:`,E,"response text:",h.getResponseText()),E>0){let S=h.getResponseJson();Array.isArray(S)&&(S=S[0]);const L=S==null?void 0:S.error;if(L&&L.status&&L.message){const U=(function(z){const q=z.toLowerCase().replace(/_/g,"-");return Object.values(xe).indexOf(q)>=0?q:xe.UNKNOWN})(L.status);f(new Ve(U,L.message))}else f(new Ve(xe.UNKNOWN,"Server responded with status "+h.getStatus()))}else f(new Ve(xe.UNAVAILABLE,"Connection failed."));break;default:ut(9055,{l_:e,streamId:c,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{je(ls,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(r);je(ls,`RPC '${e}' ${c} sending request:`,r),h.send(n,"POST",_,s,15)}))}T_(e,n,s){const r=Wm(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=$w(),d=Gw(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(f.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,n,s),f.encodeInitMessageHeaders=!0;const _=a.join("");je(ls,`Creating RPC '${e}' stream ${r}: ${_}`,f);const b=c.createWebChannel(_,f);this.I_(b);let E=!1,S=!1;const L=new mU({Yo:F=>{S?je(ls,`Not sending because RPC '${e}' stream ${r} is closed:`,F):(E||(je(ls,`Opening RPC '${e}' stream ${r} transport.`),b.open(),E=!0),je(ls,`RPC '${e}' stream ${r} sending:`,F),b.send(F))},Zo:()=>b.close()}),U=(F,z,q)=>{F.listen(z,(j=>{try{q(j)}catch(H){setTimeout((()=>{throw H}),0)}}))};return U(b,Tc.EventType.OPEN,(()=>{S||(je(ls,`RPC '${e}' stream ${r} transport opened.`),L.o_())})),U(b,Tc.EventType.CLOSE,(()=>{S||(S=!0,je(ls,`RPC '${e}' stream ${r} transport closed`),L.a_(),this.E_(b))})),U(b,Tc.EventType.ERROR,(F=>{S||(S=!0,dl(ls,`RPC '${e}' stream ${r} transport errored. Name:`,F.name,"Message:",F.message),L.a_(new Ve(xe.UNAVAILABLE,"The operation could not be completed")))})),U(b,Tc.EventType.MESSAGE,(F=>{var z;if(!S){const q=F.data[0];Wt(!!q,16349);const j=q,H=(j==null?void 0:j.error)||((z=j[0])==null?void 0:z.error);if(H){je(ls,`RPC '${e}' stream ${r} received error:`,H);const Y=H.status;let K=(function(N){const I=zn[N];if(I!==void 0)return SC(I)})(Y),R=H.message;K===void 0&&(K=xe.INTERNAL,R="Unknown error status: "+Y+" with message "+H.message),S=!0,L.a_(new Ve(K,R)),b.close()}else je(ls,`RPC '${e}' stream ${r} received:`,q),L.u_(q)}})),U(d,Hw.STAT_EVENT,(F=>{F.stat===Um.PROXY?je(ls,`RPC '${e}' stream ${r} detected buffering proxy`):F.stat===Um.NOPROXY&&je(ls,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{L.__()}),0),L}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function fm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dh(t){return new xV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,n,s=1e3,r=1.5,a=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=r,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-s);r>0&&je("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE="PersistentStream";class jC{constructor(e,n,s,r,a,c,d,f){this.Mi=e,this.S_=s,this.b_=r,this.connection=a,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new zC(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===xe.RESOURCE_EXHAUSTED?(pr(n.toString()),pr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,r])=>{this.D_===n&&this.G_(s,r)}),(s=>{e((()=>{const r=new Ve(xe.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)}))}))}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{s((()=>this.z_(r)))})),this.stream.onMessage((r=>{s((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return je(RE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(je(RE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class yU extends jC{constructor(e,n,s,r,a,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,c),this.serializer=a}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=TV(this.serializer,e),s=(function(a){if(!("targetChange"in a))return pt.min();const c=a.targetChange;return c.targetIds&&c.targetIds.length?pt.min():c.readTime?Oi(c.readTime):pt.min()})(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=Jm(this.serializer),n.addTarget=(function(a,c){let d;const f=c.target;if(d=Fm(f)?{documents:SV(a,f)}:{query:AV(a,f).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=RC(a,c.resumeToken);const h=Gm(a,c.expectedCount);h!==null&&(d.expectedCount=h)}else if(c.snapshotVersion.compareTo(pt.min())>0){d.readTime=ah(a,c.snapshotVersion.toTimestamp());const h=Gm(a,c.expectedCount);h!==null&&(d.expectedCount=h)}return d})(this.serializer,e);const s=RV(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=Jm(this.serializer),n.removeTarget=e,this.q_(n)}}class vU extends jC{constructor(e,n,s,r,a,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,c),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Wt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Wt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Wt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=CV(e.writeResults,e.commitTime),s=Oi(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=Jm(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((s=>wV(this.serializer,s)))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{}class xU extends _U{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ve(xe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Go(e,$m(n,s),r,a,c))).catch((a=>{throw a.name==="FirebaseError"?(a.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ve(xe.UNKNOWN,a.toString())}))}Ho(e,n,s,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Ho(e,$m(n,s),r,c,d,a))).catch((c=>{throw c.name==="FirebaseError"?(c.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Ve(xe.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class bU{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(pr(n),this.aa=!1):je("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sa="RemoteStore";class EU{constructor(e,n,s,r,a){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((c=>{s.enqueueAndForget((async()=>{ua(this)&&(je(sa,"Restarting streams for network reachability change."),await(async function(f){const h=yt(f);h.Ea.add(4),await nu(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Ph(h)})(this))}))})),this.Ra=new bU(s,r)}}async function Ph(t){if(ua(t))for(const e of t.da)await e(!0)}async function nu(t){for(const e of t.da)await e(!1)}function FC(t,e){const n=yt(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Zg(n)?Qg(n):Sl(n).O_()&&Xg(n,e))}function Wg(t,e){const n=yt(t),s=Sl(n);n.Ia.delete(e),s.O_()&&qC(n,e),n.Ia.size===0&&(s.O_()?s.L_():ua(n)&&n.Ra.set("Unknown"))}function Xg(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Sl(t).Y_(e)}function qC(t,e){t.Va.Ue(e),Sl(t).Z_(e)}function Qg(t){t.Va=new gV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Sl(t).start(),t.Ra.ua()}function Zg(t){return ua(t)&&!Sl(t).x_()&&t.Ia.size>0}function ua(t){return yt(t).Ea.size===0}function HC(t){t.Va=void 0}async function TU(t){t.Ra.set("Online")}async function wU(t){t.Ia.forEach(((e,n)=>{Xg(t,e)}))}async function CU(t,e){HC(t),Zg(t)?(t.Ra.ha(e),Qg(t)):t.Ra.set("Unknown")}async function SU(t,e,n){if(t.Ra.set("Online"),e instanceof IC&&e.state===2&&e.cause)try{await(async function(r,a){const c=a.cause;for(const d of a.targetIds)r.Ia.has(d)&&(await r.remoteSyncer.rejectListen(d,c),r.Ia.delete(d),r.Va.removeTarget(d))})(t,e)}catch(s){je(sa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await ch(t,s)}else if(e instanceof qd?t.Va.Ze(e):e instanceof AC?t.Va.st(e):t.Va.tt(e),!n.isEqual(pt.min()))try{const s=await BC(t.localStore);n.compareTo(s)>=0&&await(function(a,c){const d=a.Va.Tt(c);return d.targetChanges.forEach(((f,h)=>{if(f.resumeToken.approximateByteSize()>0){const _=a.Ia.get(h);_&&a.Ia.set(h,_.withResumeToken(f.resumeToken,c))}})),d.targetMismatches.forEach(((f,h)=>{const _=a.Ia.get(f);if(!_)return;a.Ia.set(f,_.withResumeToken(rs.EMPTY_BYTE_STRING,_.snapshotVersion)),qC(a,f);const b=new no(_.target,f,h,_.sequenceNumber);Xg(a,b)})),a.remoteSyncer.applyRemoteEvent(d)})(t,n)}catch(s){je(sa,"Failed to raise snapshot:",s),await ch(t,s)}}async function ch(t,e,n){if(!wl(e))throw e;t.Ea.add(1),await nu(t),t.Ra.set("Offline"),n||(n=()=>BC(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{je(sa,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ph(t)}))}function GC(t,e){return e().catch((n=>ch(t,n,e)))}async function Lh(t){const e=yt(t),n=po(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Lg;for(;AU(e);)try{const r=await lU(e.localStore,s);if(r===null){e.Ta.length===0&&n.L_();break}s=r.batchId,IU(e,r)}catch(r){await ch(e,r)}$C(e)&&YC(e)}function AU(t){return ua(t)&&t.Ta.length<10}function IU(t,e){t.Ta.push(e);const n=po(t);n.O_()&&n.X_&&n.ea(e.mutations)}function $C(t){return ua(t)&&!po(t).x_()&&t.Ta.length>0}function YC(t){po(t).start()}async function RU(t){po(t).ra()}async function NU(t){const e=po(t);for(const n of t.Ta)e.ea(n.mutations)}async function MU(t,e,n){const s=t.Ta.shift(),r=qg.from(s,e,n);await GC(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await Lh(t)}async function kU(t,e){e&&po(t).X_&&await(async function(s,r){if((function(c){return fV(c)&&c!==xe.ABORTED})(r.code)){const a=s.Ta.shift();po(s).B_(),await GC(s,(()=>s.remoteSyncer.rejectFailedWrite(a.batchId,r))),await Lh(s)}})(t,e),$C(t)&&YC(t)}async function NE(t,e){const n=yt(t);n.asyncQueue.verifyOperationInProgress(),je(sa,"RemoteStore received new credentials");const s=ua(n);n.Ea.add(3),await nu(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ph(n)}async function DU(t,e){const n=yt(t);e?(n.Ea.delete(2),await Ph(n)):e||(n.Ea.add(2),await nu(n),n.Ra.set("Unknown"))}function Sl(t){return t.ma||(t.ma=(function(n,s,r){const a=yt(n);return a.sa(),new yU(s,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)})(t.datastore,t.asyncQueue,{Xo:TU.bind(null,t),t_:wU.bind(null,t),r_:CU.bind(null,t),H_:SU.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Zg(t)?Qg(t):t.Ra.set("Unknown")):(await t.ma.stop(),HC(t))}))),t.ma}function po(t){return t.fa||(t.fa=(function(n,s,r){const a=yt(n);return a.sa(),new vU(s,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:RU.bind(null,t),r_:kU.bind(null,t),ta:NU.bind(null,t),na:MU.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await Lh(t)):(await t.fa.stop(),t.Ta.length>0&&(je(sa,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,n,s,r,a){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=a,this.deferred=new oo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,a){const c=Date.now()+s,d=new ey(e,n,c,r,a);return d.start(s),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(xe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ty(t,e){if(pr("AsyncQueue",`${e}: ${t}`),wl(t))return new Ve(xe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{static emptySet(e){return new al(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||st.comparator(n.key,s.key):(n,s)=>st.comparator(n.key,s.key),this.keyedMap=wc(),this.sortedSet=new bn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,s)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof al)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,a=s.getNext().key;if(!r.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new al;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(){this.ga=new bn(st.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ut(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,s)=>{e.push(s)})),e}}class gl{constructor(e,n,s,r,a,c,d,f,h){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=a,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=h}static fromInitialDocuments(e,n,s,r,a){const c=[];return n.forEach((d=>{c.push({type:0,doc:d})})),new gl(e,n,al.emptySet(n),c,s,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ih(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class LU{constructor(){this.queries=kE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const r=yt(n),a=r.queries;r.queries=kE(),a.forEach(((c,d)=>{for(const f of d.Sa)f.onError(s)}))})(this,new Ve(xe.ABORTED,"Firestore shutting down"))}}function kE(){return new ca((t=>pC(t)),Ih)}async function JC(t,e){const n=yt(t);let s=3;const r=e.query;let a=n.queries.get(r);a?!a.ba()&&e.Da()&&(s=2):(a=new PU,s=e.Da()?0:1);try{switch(s){case 0:a.wa=await n.onListen(r,!0);break;case 1:a.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(c){const d=ty(c,`Initialization of query '${Wa(e.query)}' failed`);return void e.onError(d)}n.queries.set(r,a),a.Sa.push(e),e.va(n.onlineState),a.wa&&e.Fa(a.wa)&&ny(n)}async function KC(t,e){const n=yt(t),s=e.query;let r=3;const a=n.queries.get(s);if(a){const c=a.Sa.indexOf(e);c>=0&&(a.Sa.splice(c,1),a.Sa.length===0?r=e.Da()?0:1:!a.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function VU(t,e){const n=yt(t);let s=!1;for(const r of e){const a=r.query,c=n.queries.get(a);if(c){for(const d of c.Sa)d.Fa(r)&&(s=!0);c.wa=r}}s&&ny(n)}function UU(t,e,n){const s=yt(t),r=s.queries.get(e);if(r)for(const a of r.Sa)a.onError(n);s.queries.delete(e)}function ny(t){t.Ca.forEach((e=>{e.next()}))}var Xm,DE;(DE=Xm||(Xm={})).Ma="default",DE.Cache="cache";class WC{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new gl(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=gl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Xm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e){this.key=e}}class QC{constructor(e){this.key=e}}class OU{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Lt(),this.mutatedKeys=Lt(),this.eu=mC(e),this.tu=new al(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new ME,r=n?n.tu:this.tu;let a=n?n.mutatedKeys:this.mutatedKeys,c=r,d=!1;const f=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((_,b)=>{const E=r.get(_),S=Rh(this.query,b)?b:null,L=!!E&&this.mutatedKeys.has(E.key),U=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let F=!1;E&&S?E.data.isEqual(S.data)?L!==U&&(s.track({type:3,doc:S}),F=!0):this.su(E,S)||(s.track({type:2,doc:S}),F=!0,(f&&this.eu(S,f)>0||h&&this.eu(S,h)<0)&&(d=!0)):!E&&S?(s.track({type:0,doc:S}),F=!0):E&&!S&&(s.track({type:1,doc:E}),F=!0,(f||h)&&(d=!0)),F&&(S?(c=c.add(S),a=U?a.add(_):a.delete(_)):(c=c.delete(_),a=a.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),a=a.delete(_.key),s.track({type:1,doc:_})}return{tu:c,iu:s,Cs:d,mutatedKeys:a}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,b)=>(function(S,L){const U=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ut(20277,{Rt:F})}};return U(S)-U(L)})(_.type,b.type)||this.eu(_.doc,b.doc))),this.ou(s),r=r??!1;const d=n&&!r?this._u():[],f=this.Xa.size===0&&this.current&&!r?1:0,h=f!==this.Za;return this.Za=f,c.length!==0||h?{snapshot:new gl(this.query,e.tu,a,c,e.mutatedKeys,f===0,h,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ME,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Lt(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const n=[];return e.forEach((s=>{this.Xa.has(s)||n.push(new QC(s))})),this.Xa.forEach((s=>{e.has(s)||n.push(new XC(s))})),n}cu(e){this.Ya=e.Qs,this.Xa=Lt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return gl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const sy="SyncEngine";class BU{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class zU{constructor(e){this.key=e,this.hu=!1}}class jU{constructor(e,n,s,r,a,c){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new ca((d=>pC(d)),Ih),this.Iu=new Map,this.Eu=new Set,this.du=new bn(st.comparator),this.Au=new Map,this.Ru=new $g,this.Vu={},this.mu=new Map,this.fu=ml.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function FU(t,e,n=!0){const s=iS(t);let r;const a=s.Tu.get(e);return a?(s.sharedClientState.addLocalQueryTarget(a.targetId),r=a.view.lu()):r=await ZC(s,e,n,!0),r}async function qU(t,e){const n=iS(t);await ZC(n,e,!0,!1)}async function ZC(t,e,n,s){const r=await cU(t.localStore,Ui(e)),a=r.targetId,c=t.sharedClientState.addLocalQueryTarget(a,n);let d;return s&&(d=await HU(t,e,a,c==="current",r.resumeToken)),t.isPrimaryClient&&n&&FC(t.remoteStore,r),d}async function HU(t,e,n,s,r){t.pu=(b,E,S)=>(async function(U,F,z,q){let j=F.view.ru(z);j.Cs&&(j=await CE(U.localStore,F.query,!1).then((({documents:R})=>F.view.ru(R,j))));const H=q&&q.targetChanges.get(F.targetId),Y=q&&q.targetMismatches.get(F.targetId)!=null,K=F.view.applyChanges(j,U.isPrimaryClient,H,Y);return LE(U,F.targetId,K.au),K.snapshot})(t,b,E,S);const a=await CE(t.localStore,e,!0),c=new OU(e,a.Qs),d=c.ru(a.documents),f=tu.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),h=c.applyChanges(d,t.isPrimaryClient,f);LE(t,n,h.au);const _=new BU(e,n,c);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),h.snapshot}async function GU(t,e,n){const s=yt(t),r=s.Tu.get(e),a=s.Iu.get(r.targetId);if(a.length>1)return s.Iu.set(r.targetId,a.filter((c=>!Ih(c,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await Km(s.localStore,r.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(r.targetId),n&&Wg(s.remoteStore,r.targetId),Qm(s,r.targetId)})).catch(Tl)):(Qm(s,r.targetId),await Km(s.localStore,r.targetId,!0))}async function $U(t,e){const n=yt(t),s=n.Tu.get(e),r=n.Iu.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),Wg(n.remoteStore,s.targetId))}async function YU(t,e,n){const s=e5(t);try{const r=await(function(c,d){const f=yt(c),h=gn.now(),_=d.reduce(((S,L)=>S.add(L.key)),Lt());let b,E;return f.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let L=mr(),U=Lt();return f.Ns.getEntries(S,_).next((F=>{L=F,L.forEach(((z,q)=>{q.isValidDocument()||(U=U.add(z))}))})).next((()=>f.localDocuments.getOverlayedDocuments(S,L))).next((F=>{b=F;const z=[];for(const q of d){const j=lV(q,b.get(q.key).overlayedDocument);j!=null&&z.push(new _o(q.key,j,oC(j.value.mapValue),gi.exists(!0)))}return f.mutationQueue.addMutationBatch(S,h,z,d)})).next((F=>{E=F;const z=F.applyToLocalDocumentSet(b,U);return f.documentOverlayCache.saveOverlays(S,F.batchId,z)}))})).then((()=>({batchId:E.batchId,changes:yC(b)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),(function(c,d,f){let h=c.Vu[c.currentUser.toKey()];h||(h=new bn(Pt)),h=h.insert(d,f),c.Vu[c.currentUser.toKey()]=h})(s,r.batchId,n),await su(s,r.changes),await Lh(s.remoteStore)}catch(r){const a=ty(r,"Failed to persist write");n.reject(a)}}async function eS(t,e){const n=yt(t);try{const s=await oU(n.localStore,e);e.targetChanges.forEach(((r,a)=>{const c=n.Au.get(a);c&&(Wt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?c.hu=!0:r.modifiedDocuments.size>0?Wt(c.hu,14607):r.removedDocuments.size>0&&(Wt(c.hu,42227),c.hu=!1))})),await su(n,s,e)}catch(s){await Tl(s)}}function PE(t,e,n){const s=yt(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Tu.forEach(((a,c)=>{const d=c.view.va(e);d.snapshot&&r.push(d.snapshot)})),(function(c,d){const f=yt(c);f.onlineState=d;let h=!1;f.queries.forEach(((_,b)=>{for(const E of b.Sa)E.va(d)&&(h=!0)})),h&&ny(f)})(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function JU(t,e,n){const s=yt(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Au.get(e),a=r&&r.key;if(a){let c=new bn(st.comparator);c=c.insert(a,us.newNoDocument(a,pt.min()));const d=Lt().add(a),f=new kh(pt.min(),new Map,new bn(Pt),c,d);await eS(s,f),s.du=s.du.remove(a),s.Au.delete(e),iy(s)}else await Km(s.localStore,e,!1).then((()=>Qm(s,e,n))).catch(Tl)}async function KU(t,e){const n=yt(t),s=e.batch.batchId;try{const r=await rU(n.localStore,e);nS(n,s,null),tS(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await su(n,r)}catch(r){await Tl(r)}}async function WU(t,e,n){const s=yt(t);try{const r=await(function(c,d){const f=yt(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let _;return f.mutationQueue.lookupMutationBatch(h,d).next((b=>(Wt(b!==null,37113),_=b.keys(),f.mutationQueue.removeMutationBatch(h,b)))).next((()=>f.mutationQueue.performConsistencyCheck(h))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(h,_,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,_))).next((()=>f.localDocuments.getDocuments(h,_)))}))})(s.localStore,e);nS(s,e,n),tS(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await su(s,r)}catch(r){await Tl(r)}}function tS(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function nS(t,e,n){const s=yt(t);let r=s.Vu[s.currentUser.toKey()];if(r){const a=r.get(e);a&&(n?a.reject(n):a.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function Qm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((s=>{t.Ru.containsKey(s)||sS(t,s)}))}function sS(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Wg(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),iy(t))}function LE(t,e,n){for(const s of n)s instanceof XC?(t.Ru.addReference(s.key,e),XU(t,s)):s instanceof QC?(je(sy,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||sS(t,s.key)):ut(19791,{wu:s})}function XU(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(je(sy,"New document in limbo: "+n),t.Eu.add(s),iy(t))}function iy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new st(hn.fromString(e)),s=t.fu.next();t.Au.set(s,new zU(n)),t.du=t.du.insert(n,s),FC(t.remoteStore,new no(Ui(zg(n.path)),s,"TargetPurposeLimboResolution",Ch.ce))}}async function su(t,e,n){const s=yt(t),r=[],a=[],c=[];s.Tu.isEmpty()||(s.Tu.forEach(((d,f)=>{c.push(s.pu(f,e,n).then((h=>{var _;if((h||n)&&s.isPrimaryClient){const b=h?!h.fromCache:(_=n==null?void 0:n.targetChanges.get(f.targetId))==null?void 0:_.current;s.sharedClientState.updateQueryState(f.targetId,b?"current":"not-current")}if(h){r.push(h);const b=Jg.As(f.targetId,h);a.push(b)}})))})),await Promise.all(c),s.Pu.H_(r),await(async function(f,h){const _=yt(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>Ee.forEach(h,(E=>Ee.forEach(E.Es,(S=>_.persistence.referenceDelegate.addReference(b,E.targetId,S))).next((()=>Ee.forEach(E.ds,(S=>_.persistence.referenceDelegate.removeReference(b,E.targetId,S)))))))))}catch(b){if(!wl(b))throw b;je(Kg,"Failed to update sequence numbers: "+b)}for(const b of h){const E=b.targetId;if(!b.fromCache){const S=_.Ms.get(E),L=S.snapshotVersion,U=S.withLastLimboFreeSnapshotVersion(L);_.Ms=_.Ms.insert(E,U)}}})(s.localStore,a))}async function QU(t,e){const n=yt(t);if(!n.currentUser.isEqual(e)){je(sy,"User change. New user:",e.toKey());const s=await OC(n.localStore,e);n.currentUser=e,(function(a,c){a.mu.forEach((d=>{d.forEach((f=>{f.reject(new Ve(xe.CANCELLED,c))}))})),a.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await su(n,s.Ls)}}function ZU(t,e){const n=yt(t),s=n.Au.get(e);if(s&&s.hu)return Lt().add(s.key);{let r=Lt();const a=n.Iu.get(e);if(!a)return r;for(const c of a){const d=n.Tu.get(c);r=r.unionWith(d.view.nu)}return r}}function iS(t){const e=yt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=eS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ZU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JU.bind(null,e),e.Pu.H_=VU.bind(null,e.eventManager),e.Pu.yu=UU.bind(null,e.eventManager),e}function e5(t){const e=yt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WU.bind(null,e),e}class uh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Dh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return iU(this.persistence,new tU,e.initialUser,this.serializer)}Cu(e){return new UC(Yg.mi,this.serializer)}Du(e){return new dU}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}uh.provider={build:()=>new uh};class t5 extends uh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Wt(this.persistence.referenceDelegate instanceof lh,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new zV(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Is.withCacheSize(this.cacheSizeBytes):Is.DEFAULT;return new UC((s=>lh.mi(s,n)),this.serializer)}}class Zm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>PE(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=QU.bind(null,this.syncEngine),await DU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new LU})()}createDatastore(e){const n=Dh(e.databaseInfo.databaseId),s=(function(a){return new gU(a)})(e.databaseInfo);return(function(a,c,d,f){return new xU(a,c,d,f)})(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return(function(s,r,a,c,d){return new EU(s,r,a,c,d)})(this.localStore,this.datastore,e.asyncQueue,(n=>PE(this.syncEngine,n,0)),(function(){return IE.v()?new IE:new hU})())}createSyncEngine(e,n){return(function(r,a,c,d,f,h,_){const b=new jU(r,a,c,d,f,h);return _&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await(async function(r){const a=yt(r);je(sa,"RemoteStore shutting down."),a.Ea.add(5),await nu(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Zm.provider={build:()=>new Zm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):pr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="FirestoreClient";class n5{constructor(e,n,s,r,a){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=cs.UNAUTHENTICATED,this.clientId=Pg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(s,(async c=>{je(mo,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(s,(c=>(je(mo,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new oo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=ty(n,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function pm(t,e){t.asyncQueue.verifyOperationInProgress(),je(mo,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener((async r=>{s.isEqual(r)||(await OC(e.localStore,r),s=r)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function VE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await s5(t);je(mo,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((s=>NE(e.remoteStore,s))),t.setAppCheckTokenChangeListener(((s,r)=>NE(e.remoteStore,r))),t._onlineComponents=e}async function s5(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je(mo,"Using user provided OfflineComponentProvider");try{await pm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(r){return r.name==="FirebaseError"?r.code===xe.FAILED_PRECONDITION||r.code===xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(n))throw n;dl("Error using user provided cache. Falling back to memory cache: "+n),await pm(t,new uh)}}else je(mo,"Using default OfflineComponentProvider"),await pm(t,new t5(void 0));return t._offlineComponents}async function oS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je(mo,"Using user provided OnlineComponentProvider"),await VE(t,t._uninitializedComponentsProvider._online)):(je(mo,"Using default OnlineComponentProvider"),await VE(t,new Zm))),t._onlineComponents}function i5(t){return oS(t).then((e=>e.syncEngine))}async function eg(t){const e=await oS(t),n=e.eventManager;return n.onListen=FU.bind(null,e.syncEngine),n.onUnlisten=GU.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=qU.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=$U.bind(null,e.syncEngine),n}function r5(t,e,n={}){const s=new oo;return t.asyncQueue.enqueueAndForget((async()=>(function(a,c,d,f,h){const _=new rS({next:E=>{_.Nu(),c.enqueueAndForget((()=>KC(a,b))),E.fromCache&&f.source==="server"?h.reject(new Ve(xe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(E)},error:E=>h.reject(E)}),b=new WC(d,_,{includeMetadataChanges:!0,qa:!0});return JC(a,b)})(await eg(t),t.asyncQueue,e,n,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lS="firestore.googleapis.com",OE=!0;class BE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ve(xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=lS,this.ssl=OE}else this.host=e.host,this.ssl=e.ssl??OE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=VC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<OV)throw new Ve(xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}b4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aS(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ve(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ve(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ve(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,r){return s.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Vh{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new BE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ve(xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ve(xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new BE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new d4;switch(s.type){case"firstParty":return new m4(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ve(xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const s=UE.get(n);s&&(je("ComponentProvider","Removing Datastore"),UE.delete(n),s.terminate())})(this),Promise.resolve()}}function o5(t,e,n,s={}){var h;t=Vi(t,Vh);const r=yo(e),a=t._getSettings(),c={...a,emulatorOptions:t._getEmulatorOptions()},d=`${e}:${n}`;r&&(vg(`https://${d}`),_g("Firestore",!0)),a.host!==lS&&a.host!==d&&dl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...a,host:d,ssl:r,emulatorOptions:s};if(!Zo(f,c)&&(t._setSettings(f),s.mockUserToken)){let _,b;if(typeof s.mockUserToken=="string")_=s.mockUserToken,b=cs.MOCK_USER;else{_=rw(s.mockUserToken,(h=t._app)==null?void 0:h.options.projectId);const E=s.mockUserToken.sub||s.mockUserToken.user_id;if(!E)throw new Ve(xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new cs(E)}t._authCredentials=new h4(new Jw(_,b))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new xo(this.firestore,e,this._query)}}class qn{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ao(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qn(this.firestore,e,this._key)}toJSON(){return{type:qn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(Zc(n,qn._jsonSchema))return new qn(e,s||null,new st(hn.fromString(n.referencePath)))}}qn._jsonSchemaVersion="firestore/documentReference/1.0",qn._jsonSchema={type:Fn("string",qn._jsonSchemaVersion),referencePath:Fn("string")};class ao extends xo{constructor(e,n,s){super(e,n,zg(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qn(this.firestore,null,new st(e))}withConverter(e){return new ao(this.firestore,e,this._path)}}function Zr(t,e,...n){if(t=xn(t),Kw("collection","path",e),t instanceof Vh){const s=hn.fromString(e,...n);return Qb(s),new ao(t,null,s)}{if(!(t instanceof qn||t instanceof ao))throw new Ve(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(hn.fromString(e,...n));return Qb(s),new ao(t.firestore,null,s)}}function ll(t,e,...n){if(t=xn(t),arguments.length===1&&(e=Pg.newId()),Kw("doc","path",e),t instanceof Vh){const s=hn.fromString(e,...n);return Xb(s),new qn(t,null,new st(s))}{if(!(t instanceof qn||t instanceof ao))throw new Ve(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(hn.fromString(e,...n));return Xb(s),new qn(t.firestore,t instanceof ao?t.converter:null,new st(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="AsyncQueue";class jE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new zC(this,"async_queue_retry"),this._c=()=>{const s=fm();s&&je(zE,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=fm();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=fm();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new oo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!wl(e))throw e;je(zE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,pr("INTERNAL UNHANDLED ERROR: ",FE(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=ey.createAndSchedule(this,e,n,s,(a=>this.hc(a)));return this.tc.push(r),r}uc(){this.nc&&ut(47125,{Pc:FE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,s)=>n.targetTimeMs-s.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function FE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(t){return(function(n,s){if(typeof n!="object"||n===null)return!1;const r=n;for(const a of s)if(a in r&&typeof r[a]=="function")return!0;return!1})(t,["next","error","complete"])}class ia extends Vh{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new jE,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new jE(e),this._firestoreClient=void 0,await e}}}function a5(t,e){const n=typeof t=="object"?t:Eg(),s=typeof t=="string"?t:sh,r=xh(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const a=nw("firestore");a&&o5(r,...a)}return r}function ry(t){if(t._terminated)throw new Ve(xe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||l5(t),t._firestoreClient}function l5(t){var s,r,a;const e=t._freezeSettings(),n=(function(d,f,h,_){return new k4(d,f,h,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,aS(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)})(t._databaseId,((s=t._app)==null?void 0:s.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new n5(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(d){const f=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(f),_online:f}})(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ei(rs.fromBase64String(e))}catch(n){throw new Ve(xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ei(rs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ei._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Zc(e,ei._jsonSchema))return ei.fromBase64String(e.bytes)}}ei._jsonSchemaVersion="firestore/bytes/1.0",ei._jsonSchema={type:Fn("string",ei._jsonSchemaVersion),bytes:Fn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Ve(xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new is(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Ve(xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Ve(xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Pt(this._lat,e._lat)||Pt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bi._jsonSchemaVersion}}static fromJSON(e){if(Zc(e,Bi._jsonSchema))return new Bi(e.latitude,e.longitude)}}Bi._jsonSchemaVersion="firestore/geoPoint/1.0",Bi._jsonSchema={type:Fn("string",Bi._jsonSchemaVersion),latitude:Fn("number"),longitude:Fn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,r){if(s.length!==r.length)return!1;for(let a=0;a<s.length;++a)if(s[a]!==r[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:zi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Zc(e,zi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new zi(e.vectorValues);throw new Ve(xe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}zi._jsonSchemaVersion="firestore/vectorValue/1.0",zi._jsonSchema={type:Fn("string",zi._jsonSchemaVersion),vectorValues:Fn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c5=/^__.*__$/;class u5{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new _o(e,this.data,this.fieldMask,n,this.fieldTransforms):new eu(e,this.data,n,this.fieldTransforms)}}class cS{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new _o(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function uS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ut(40011,{Ac:t})}}class oy{constructor(e,n,s,r,a,c){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new oy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return dh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(uS(this.Ac)&&c5.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class d5{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||Dh(e)}Cc(e,n,s,r=!1){return new oy({Ac:e,methodName:n,Dc:s,path:is.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ay(t){const e=t._freezeSettings(),n=Dh(t._databaseId);return new d5(t._databaseId,!!e.ignoreUndefinedProperties,n)}function h5(t,e,n,s,r,a={}){const c=t.Cc(a.merge||a.mergeFields?2:0,e,n,r);cy("Data must be an object, but it was:",c,s);const d=dS(s,c);let f,h;if(a.merge)f=new Bs(c.fieldMask),h=c.fieldTransforms;else if(a.mergeFields){const _=[];for(const b of a.mergeFields){const E=tg(e,b,n);if(!c.contains(E))throw new Ve(xe.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);fS(_,E)||_.push(E)}f=new Bs(_),h=c.fieldTransforms.filter((b=>f.covers(b.field)))}else f=null,h=c.fieldTransforms;return new u5(new Rs(d),f,h)}class Bh extends Oh{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Bh}}class ly extends Oh{_toFieldTransform(e){return new iV(e.path,new qc)}isEqual(e){return e instanceof ly}}function f5(t,e,n,s){const r=t.Cc(1,e,n);cy("Data must be an object, but it was:",r,s);const a=[],c=Rs.empty();vo(s,((f,h)=>{const _=uy(e,f,n);h=xn(h);const b=r.yc(_);if(h instanceof Bh)a.push(_);else{const E=iu(h,b);E!=null&&(a.push(_),c.set(_,E))}}));const d=new Bs(a);return new cS(c,d,r.fieldTransforms)}function p5(t,e,n,s,r,a){const c=t.Cc(1,e,n),d=[tg(e,s,n)],f=[r];if(a.length%2!=0)throw new Ve(xe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<a.length;E+=2)d.push(tg(e,a[E])),f.push(a[E+1]);const h=[],_=Rs.empty();for(let E=d.length-1;E>=0;--E)if(!fS(h,d[E])){const S=d[E];let L=f[E];L=xn(L);const U=c.yc(S);if(L instanceof Bh)h.push(S);else{const F=iu(L,U);F!=null&&(h.push(S),_.set(S,F))}}const b=new Bs(h);return new cS(_,b,c.fieldTransforms)}function m5(t,e,n,s=!1){return iu(n,t.Cc(s?4:3,e))}function iu(t,e){if(hS(t=xn(t)))return cy("Unsupported field value:",e,t),dS(t,e);if(t instanceof Oh)return(function(s,r){if(!uS(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const a=s._toFieldTransform(r);a&&r.fieldTransforms.push(a)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,r){const a=[];let c=0;for(const d of s){let f=iu(d,r.wc(c));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),c++}return{arrayValue:{values:a}}})(t,e)}return(function(s,r){if((s=xn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return tV(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const a=gn.fromDate(s);return{timestampValue:ah(r.serializer,a)}}if(s instanceof gn){const a=new gn(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:ah(r.serializer,a)}}if(s instanceof Bi)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ei)return{bytesValue:RC(r.serializer,s._byteString)};if(s instanceof qn){const a=r.databaseId,c=s.firestore._databaseId;if(!c.isEqual(a))throw r.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Gg(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof zi)return(function(c,d){return{mapValue:{fields:{[iC]:{stringValue:rC},[ih]:{arrayValue:{values:c.toArray().map((h=>{if(typeof h!="number")throw d.Sc("VectorValues must only contain numeric values.");return jg(d.serializer,h)}))}}}}}})(s,r);throw r.Sc(`Unsupported field value: ${wh(s)}`)})(t,e)}function dS(t,e){const n={};return Qw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vo(t,((s,r)=>{const a=iu(r,e.mc(s));a!=null&&(n[s]=a)})),{mapValue:{fields:n}}}function hS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gn||t instanceof Bi||t instanceof ei||t instanceof qn||t instanceof Oh||t instanceof zi)}function cy(t,e,n){if(!hS(n)||!Ww(n)){const s=wh(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function tg(t,e,n){if((e=xn(e))instanceof Uh)return e._internalPath;if(typeof e=="string")return uy(t,e);throw dh("Field path arguments must be of type string or ",t,!1,void 0,n)}const g5=new RegExp("[~\\*/\\[\\]]");function uy(t,e,n){if(e.search(g5)>=0)throw dh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Uh(...e.split("."))._internalPath}catch{throw dh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function dh(t,e,n,s,r){const a=s&&!s.isEmpty(),c=r!==void 0;let d=`Function ${e}() called with invalid data`;n&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(a||c)&&(f+=" (found",a&&(f+=` in field ${s}`),c&&(f+=` in document ${r}`),f+=")"),new Ve(xe.INVALID_ARGUMENT,d+t+f)}function fS(t,e){return t.some((n=>n.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,n,s,r,a){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new qn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new y5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(zh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class y5 extends pS{data(){return super.data()}}function zh(t,e){return typeof e=="string"?uy(t,e):e instanceof Uh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ve(xe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dy{}class gS extends dy{}function ng(t,e,...n){let s=[];e instanceof dy&&s.push(e),s=s.concat(n),(function(a){const c=a.filter((f=>f instanceof hy)).length,d=a.filter((f=>f instanceof jh)).length;if(c>1||c>0&&d>0)throw new Ve(xe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const r of s)t=r._apply(t);return t}class jh extends gS{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new jh(e,n,s)}_apply(e){const n=this._parse(e);return vS(e._query,n),new xo(e.firestore,e.converter,qm(e._query,n))}_parse(e){const n=ay(e.firestore);return(function(a,c,d,f,h,_,b){let E;if(h.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new Ve(xe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){GE(b,_);const L=[];for(const U of b)L.push(HE(f,a,U));E={arrayValue:{values:L}}}else E=HE(f,a,b)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||GE(b,_),E=m5(d,c,b,_==="in"||_==="not-in");return jn.create(h,_,E)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function v5(t,e,n){const s=e,r=zh("where",t);return jh._create(r,s,n)}class hy extends dy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new hy(e,n)}_parse(e){const n=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return n.length===1?n[0]:yi.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(r,a){let c=r;const d=a.getFlattenedFilters();for(const f of d)vS(c,f),c=qm(c,f)})(e._query,n),new xo(e.firestore,e.converter,qm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class fy extends gS{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new fy(e,n)}_apply(e){const n=(function(r,a,c){if(r.startAt!==null)throw new Ve(xe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Ve(xe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Fc(a,c)})(e._query,this._field,this._direction);return new xo(e.firestore,e.converter,(function(r,a){const c=r.explicitOrderBy.concat([a]);return new Cl(r.path,r.collectionGroup,c,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)})(e._query,n))}}function yS(t,e="asc"){const n=e,s=zh("orderBy",t);return fy._create(s,n)}function HE(t,e,n){if(typeof(n=xn(n))=="string"){if(n==="")throw new Ve(xe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fC(e)&&n.indexOf("/")!==-1)throw new Ve(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(hn.fromString(n));if(!st.isDocumentKey(s))throw new Ve(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return oE(t,new st(s))}if(n instanceof qn)return oE(t,n._key);throw new Ve(xe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wh(n)}.`)}function GE(t,e){if(!Array.isArray(t)||t.length===0)throw new Ve(xe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vS(t,e){const n=(function(r,a){for(const c of r)for(const d of c.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null})(t.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Ve(xe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ve(xe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class _5{convertValue(e,n="none"){switch(fo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ho(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ut(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return vo(e,((r,a)=>{s[r]=this.convertValue(a,n)})),s}convertVectorValue(e){var s,r,a;const n=(a=(r=(s=e.fields)==null?void 0:s[ih].arrayValue)==null?void 0:r.values)==null?void 0:a.map((c=>Dn(c.doubleValue)));return new zi(n)}convertGeoPoint(e){return new Bi(Dn(e.latitude),Dn(e.longitude))}convertArray(e,n){return(e.values||[]).map((s=>this.convertValue(s,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const s=Ah(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Bc(e));default:return null}}convertTimestamp(e){const n=uo(e);return new gn(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=hn.fromString(e);Wt(LC(s),9688,{name:e});const r=new zc(s.get(1),s.get(3)),a=new st(s.popFirst(5));return r.isEqual(n)||pr(`Document ${a} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x5(t,e,n){let s;return s=t?t.toFirestore(e):e,s}class Sc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ko extends pS{constructor(e,n,s,r,a,c){super(e,n,s,r,c),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Hd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(zh("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(xe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ko._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ko._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ko._jsonSchema={type:Fn("string",Ko._jsonSchemaVersion),bundleSource:Fn("string","DocumentSnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class Hd extends Ko{data(e={}){return super.data(e)}}class Wo{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Sc(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((s=>{e.call(n,new Hd(this._firestore,this._userDataWriter,s.key,s,new Sc(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Ve(xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(r,a){if(r._snapshot.oldDocs.isEmpty()){let c=0;return r._snapshot.docChanges.map((d=>{const f=new Hd(r._firestore,r._userDataWriter,d.doc.key,d.doc,new Sc(r._snapshot.mutatedKeys.has(d.doc.key),r._snapshot.fromCache),r.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:c++}}))}{let c=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const f=new Hd(r._firestore,r._userDataWriter,d.doc.key,d.doc,new Sc(r._snapshot.mutatedKeys.has(d.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,_=-1;return d.type!==0&&(h=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),_=c.indexOf(d.doc.key)),{type:b5(d.type),doc:f,oldIndex:h,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(xe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Wo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Pg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],r=[];return this.docs.forEach((a=>{a._document!==null&&(n.push(a._document),s.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),r.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function b5(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ut(61501,{type:t})}}Wo._jsonSchemaVersion="firestore/querySnapshot/1.0",Wo._jsonSchema={type:Fn("string",Wo._jsonSchemaVersion),bundleSource:Fn("string","QuerySnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class py extends _5{constructor(e){super(),this.firestore=e}convertBytes(e){return new ei(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new qn(this.firestore,null,n)}}function E5(t){t=Vi(t,xo);const e=Vi(t.firestore,ia),n=ry(e),s=new py(e);return mS(t._query),r5(n,t._query).then((r=>new Wo(e,s,t,r)))}function $E(t,e,n,...s){t=Vi(t,qn);const r=Vi(t.firestore,ia),a=ay(r);let c;return c=typeof(e=xn(e))=="string"||e instanceof Uh?p5(a,"updateDoc",t._key,e,n,s):f5(a,"updateDoc",t._key,e),my(r,[c.toMutation(t._key,gi.exists(!0))])}function _S(t){return my(Vi(t.firestore,ia),[new Fg(t._key,gi.none())])}function sg(t,e){const n=Vi(t.firestore,ia),s=ll(t),r=x5(t.converter,e);return my(n,[h5(ay(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,gi.exists(!1))]).then((()=>s))}function xS(t,...e){var f,h,_;t=xn(t);let n={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||qE(e[s])||(n=e[s++]);const r={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(qE(e[s])){const b=e[s];e[s]=(f=b.next)==null?void 0:f.bind(b),e[s+1]=(h=b.error)==null?void 0:h.bind(b),e[s+2]=(_=b.complete)==null?void 0:_.bind(b)}let a,c,d;if(t instanceof qn)c=Vi(t.firestore,ia),d=zg(t._key.path),a={next:b=>{e[s]&&e[s](T5(c,t,b))},error:e[s+1],complete:e[s+2]};else{const b=Vi(t,xo);c=Vi(b.firestore,ia),d=b._query;const E=new py(c);a={next:S=>{e[s]&&e[s](new Wo(c,E,b,S))},error:e[s+1],complete:e[s+2]},mS(t._query)}return(function(E,S,L,U){const F=new rS(U),z=new WC(S,F,L);return E.asyncQueue.enqueueAndForget((async()=>JC(await eg(E),z))),()=>{F.Nu(),E.asyncQueue.enqueueAndForget((async()=>KC(await eg(E),z)))}})(ry(c),d,r,a)}function my(t,e){return(function(s,r){const a=new oo;return s.asyncQueue.enqueueAndForget((async()=>YU(await i5(s),r,a))),a.promise})(ry(t),e)}function T5(t,e,n){const s=n.docs.get(e._key),r=new py(t);return new Ko(t,r,e._key,s,new Sc(n.hasPendingWrites,n.fromCache),e.converter)}function ig(){return new ly("serverTimestamp")}(function(e,n=!0){(function(r){El=r})(la),ea(new lo("firestore",((s,{instanceIdentifier:r,options:a})=>{const c=s.getProvider("app").getImmediate(),d=new ia(new f4(s.getProvider("auth-internal")),new g4(c,s.getProvider("app-check-internal")),(function(h,_){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ve(xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zc(h.options.projectId,_)})(c,r),c);return a={useFetchStreams:n,...a},d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),Pi(Yb,Jb,e),Pi(Yb,Jb,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS="firebasestorage.googleapis.com",ES="storageBucket",w5=120*1e3,C5=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An extends qi{constructor(e,n,s=0){super(mm(e),`Firebase Storage: ${n} (${mm(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,An.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return mm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Sn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Sn||(Sn={}));function mm(t){return"storage/"+t}function gy(){const t="An unknown error occurred, please check the error payload for server response.";return new An(Sn.UNKNOWN,t)}function S5(t){return new An(Sn.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function A5(t){return new An(Sn.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function I5(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new An(Sn.UNAUTHENTICATED,t)}function R5(){return new An(Sn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function N5(t){return new An(Sn.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function M5(){return new An(Sn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function k5(){return new An(Sn.CANCELED,"User canceled the upload/download.")}function D5(t){return new An(Sn.INVALID_URL,"Invalid URL '"+t+"'.")}function P5(t){return new An(Sn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function L5(){return new An(Sn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+ES+"' property when initializing the app?")}function V5(){return new An(Sn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function U5(){return new An(Sn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function O5(t){return new An(Sn.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function rg(t){return new An(Sn.INVALID_ARGUMENT,t)}function TS(){return new An(Sn.APP_DELETED,"The Firebase app was deleted.")}function B5(t){return new An(Sn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Pc(t,e){return new An(Sn.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Ec(t){throw new An(Sn.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=zs.makeFromUrl(e,n)}catch{return new zs(e,"")}if(s.path==="")return s;throw P5(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function a(H){H.path.charAt(H.path.length-1)==="/"&&(H.path_=H.path_.slice(0,-1))}const c="(/(.*))?$",d=new RegExp("^gs://"+r+c,"i"),f={bucket:1,path:3};function h(H){H.path_=decodeURIComponent(H.path)}const _="v[A-Za-z0-9_]+",b=n.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",S=new RegExp(`^https?://${b}/${_}/b/${r}/o${E}`,"i"),L={bucket:1,path:3},U=n===bS?"(?:storage.googleapis.com|storage.cloud.google.com)":n,F="([^?#]*)",z=new RegExp(`^https?://${U}/${r}/${F}`,"i"),j=[{regex:d,indices:f,postModify:a},{regex:S,indices:L,postModify:h},{regex:z,indices:{bucket:1,path:2},postModify:h}];for(let H=0;H<j.length;H++){const Y=j[H],K=Y.regex.exec(e);if(K){const R=K[Y.indices.bucket];let T=K[Y.indices.path];T||(T=""),s=new zs(R,T),Y.postModify(s);break}}if(s==null)throw D5(e);return s}}class z5{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j5(t,e,n){let s=1,r=null,a=null,c=!1,d=0;function f(){return d===2}let h=!1;function _(...F){h||(h=!0,e.apply(null,F))}function b(F){r=setTimeout(()=>{r=null,t(S,f())},F)}function E(){a&&clearTimeout(a)}function S(F,...z){if(h){E();return}if(F){E(),_.call(null,F,...z);return}if(f()||c){E(),_.call(null,F,...z);return}s<64&&(s*=2);let j;d===1?(d=2,j=0):j=(s+Math.random())*1e3,b(j)}let L=!1;function U(F){L||(L=!0,E(),!h&&(r!==null?(F||(d=2),clearTimeout(r),b(0)):F||(d=1)))}return b(0),a=setTimeout(()=>{c=!0,U(!0)},n),U}function F5(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q5(t){return t!==void 0}function H5(t){return typeof t=="object"&&!Array.isArray(t)}function yy(t){return typeof t=="string"||t instanceof String}function YE(t){return vy()&&t instanceof Blob}function vy(){return typeof Blob<"u"}function JE(t,e,n,s){if(s<e)throw rg(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw rg(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fh(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function wS(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}var Xo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Xo||(Xo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G5(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return n||r||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e,n,s,r,a,c,d,f,h,_,b,E=!0,S=!1){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=a,this.additionalRetryCodes_=c,this.callback_=d,this.errorCallback_=f,this.timeout_=h,this.progressCallback_=_,this.connectionFactory_=b,this.retry=E,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((L,U)=>{this.resolve_=L,this.reject_=U,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Nd(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const c=d=>{const f=d.loaded,h=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,h)};this.progressCallback_!==null&&a.addUploadProgressListener(c),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(c),this.pendingConnection_=null;const d=a.getErrorCode()===Xo.NO_ERROR,f=a.getStatus();if(!d||G5(f,this.additionalRetryCodes_)&&this.retry){const _=a.getErrorCode()===Xo.ABORT;s(!1,new Nd(!1,null,_));return}const h=this.successCodes_.indexOf(f)!==-1;s(!0,new Nd(h,a))})},n=(s,r)=>{const a=this.resolve_,c=this.reject_,d=r.connection;if(r.wasSuccessCode)try{const f=this.callback_(d,d.getResponse());q5(f)?a(f):a()}catch(f){c(f)}else if(d!==null){const f=gy();f.serverResponse=d.getErrorText(),this.errorCallback_?c(this.errorCallback_(d,f)):c(f)}else if(r.canceled){const f=this.appDelete_?TS():k5();c(f)}else{const f=M5();c(f)}};this.canceled_?n(!1,new Nd(!1,null,!0)):this.backoffId_=j5(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&F5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Nd{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function Y5(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function J5(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function K5(t,e){e&&(t["X-Firebase-GMPID"]=e)}function W5(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function X5(t,e,n,s,r,a,c=!0,d=!1){const f=wS(t.urlParams),h=t.url+f,_=Object.assign({},t.headers);return K5(_,e),Y5(_,n),J5(_,a),W5(_,s),new $5(h,t.method,_,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,c,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q5(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Z5(...t){const e=Q5();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(vy())return new Blob(t);throw new An(Sn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function e3(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(t){if(typeof atob>"u")throw O5("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class gm{constructor(e,n){this.data=e,this.contentType=n||null}}function n3(t,e){switch(t){case Di.RAW:return new gm(CS(e));case Di.BASE64:case Di.BASE64URL:return new gm(SS(t,e));case Di.DATA_URL:return new gm(i3(e),r3(e))}throw gy()}function CS(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const a=s,c=t.charCodeAt(++n);s=65536|(a&1023)<<10|c&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function s3(t){let e;try{e=decodeURIComponent(t)}catch{throw Pc(Di.DATA_URL,"Malformed data URL.")}return CS(e)}function SS(t,e){switch(t){case Di.BASE64:{const r=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(r||a)throw Pc(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Di.BASE64URL:{const r=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(r||a)throw Pc(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=t3(e)}catch(r){throw r.message.includes("polyfill")?r:Pc(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class AS{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Pc(Di.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=o3(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function i3(t){const e=new AS(t);return e.base64?SS(Di.BASE64,e.rest):s3(e.rest)}function r3(t){return new AS(t).contentType}function o3(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,n){let s=0,r="";YE(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(YE(this.data_)){const s=this.data_,r=e3(s,e,n);return r===null?null:new eo(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new eo(s,!0)}}static getBlob(...e){if(vy()){const n=e.map(s=>s instanceof eo?s.data_:s);return new eo(Z5.apply(null,n))}else{const n=e.map(c=>yy(c)?n3(Di.RAW,c).data:c.data_);let s=0;n.forEach(c=>{s+=c.byteLength});const r=new Uint8Array(s);let a=0;return n.forEach(c=>{for(let d=0;d<c.length;d++)r[a++]=c[d]}),new eo(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(t){let e;try{e=JSON.parse(t)}catch{return null}return H5(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a3(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function l3(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function RS(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c3(t,e){return e}class vs{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||c3}}let Md=null;function u3(t){return!yy(t)||t.length<2?t:RS(t)}function NS(){if(Md)return Md;const t=[];t.push(new vs("bucket")),t.push(new vs("generation")),t.push(new vs("metageneration")),t.push(new vs("name","fullPath",!0));function e(a,c){return u3(c)}const n=new vs("name");n.xform=e,t.push(n);function s(a,c){return c!==void 0?Number(c):c}const r=new vs("size");return r.xform=s,t.push(r),t.push(new vs("timeCreated")),t.push(new vs("updated")),t.push(new vs("md5Hash",null,!0)),t.push(new vs("cacheControl",null,!0)),t.push(new vs("contentDisposition",null,!0)),t.push(new vs("contentEncoding",null,!0)),t.push(new vs("contentLanguage",null,!0)),t.push(new vs("contentType",null,!0)),t.push(new vs("metadata","customMetadata",!0)),Md=t,Md}function d3(t,e){function n(){const s=t.bucket,r=t.fullPath,a=new zs(s,r);return e._makeStorageReference(a)}Object.defineProperty(t,"ref",{get:n})}function h3(t,e,n){const s={};s.type="file";const r=n.length;for(let a=0;a<r;a++){const c=n[a];s[c.local]=c.xform(s,e[c.server])}return d3(s,t),s}function MS(t,e,n){const s=IS(e);return s===null?null:h3(t,s,n)}function f3(t,e,n,s){const r=IS(e);if(r===null||!yy(r.downloadTokens))return null;const a=r.downloadTokens;if(a.length===0)return null;const c=encodeURIComponent;return a.split(",").map(h=>{const _=t.bucket,b=t.fullPath,E="/b/"+c(_)+"/o/"+c(b),S=Fh(E,n,s),L=wS({alt:"media",token:h});return S+L})[0]}function p3(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const a=e[r];a.writable&&(n[a.server]=t[a.local])}return JSON.stringify(n)}class _y{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kS(t){if(!t)throw gy()}function m3(t,e){function n(s,r){const a=MS(t,r,e);return kS(a!==null),a}return n}function g3(t,e){function n(s,r){const a=MS(t,r,e);return kS(a!==null),f3(a,r,t.host,t._protocol)}return n}function DS(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=R5():r=I5():n.getStatus()===402?r=A5(t.bucket):n.getStatus()===403?r=N5(t.path):r=s,r.status=n.getStatus(),r.serverResponse=s.serverResponse,r}return e}function PS(t){const e=DS(t);function n(s,r){let a=e(s,r);return s.getStatus()===404&&(a=S5(t.path)),a.serverResponse=r.serverResponse,a}return n}function y3(t,e,n){const s=e.fullServerUrl(),r=Fh(s,t.host,t._protocol),a="GET",c=t.maxOperationRetryTime,d=new _y(r,a,g3(t,n),c);return d.errorHandler=PS(e),d}function v3(t,e){const n=e.fullServerUrl(),s=Fh(n,t.host,t._protocol),r="DELETE",a=t.maxOperationRetryTime;function c(f,h){}const d=new _y(s,r,c,a);return d.successCodes=[200,204],d.errorHandler=PS(e),d}function _3(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function x3(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=_3(null,e)),s}function b3(t,e,n,s,r){const a=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"};function d(){let j="";for(let H=0;H<2;H++)j=j+Math.random().toString().slice(2);return j}const f=d();c["Content-Type"]="multipart/related; boundary="+f;const h=x3(e,s,r),_=p3(h,n),b="--"+f+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+_+`\r
--`+f+`\r
Content-Type: `+h.contentType+`\r
\r
`,E=`\r
--`+f+"--",S=eo.getBlob(b,s,E);if(S===null)throw V5();const L={name:h.fullPath},U=Fh(a,t.host,t._protocol),F="POST",z=t.maxUploadRetryTime,q=new _y(U,F,m3(t,n),z);return q.urlParams=L,q.headers=c,q.body=S.uploadData(),q.errorHandler=DS(e),q}class E3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Xo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Xo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Xo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r,a){if(this.sent_)throw Ec("cannot .send() more than once");if(yo(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),a!==void 0)for(const c in a)a.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,a[c].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ec("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ec("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ec("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ec("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class T3 extends E3{initXhr(){this.xhr_.responseType="text"}}function xy(){return new T3}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e,n){this._service=e,n instanceof zs?this._location=n:this._location=zs.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ra(e,n)}get root(){const e=new zs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return RS(this._location.path)}get storage(){return this._service}get parent(){const e=a3(this._location.path);if(e===null)return null;const n=new zs(this._location.bucket,e);return new ra(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw B5(e)}}function w3(t,e,n){t._throwIfRoot("uploadBytes");const s=b3(t.storage,t._location,NS(),new eo(e,!0),n);return t.storage.makeRequestWithTokens(s,xy).then(r=>({metadata:r,ref:t}))}function C3(t){t._throwIfRoot("getDownloadURL");const e=y3(t.storage,t._location,NS());return t.storage.makeRequestWithTokens(e,xy).then(n=>{if(n===null)throw U5();return n})}function S3(t){t._throwIfRoot("deleteObject");const e=v3(t.storage,t._location);return t.storage.makeRequestWithTokens(e,xy)}function A3(t,e){const n=l3(t._location.path,e),s=new zs(t._location.bucket,n);return new ra(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(t){return/^[A-Za-z]+:\/\//.test(t)}function R3(t,e){return new ra(t,e)}function LS(t,e){if(t instanceof by){const n=t;if(n._bucket==null)throw L5();const s=new ra(n,n._bucket);return e!=null?LS(s,e):s}else return e!==void 0?A3(t,e):t}function N3(t,e){if(e&&I3(e)){if(t instanceof by)return R3(t,e);throw rg("To use ref(service, url), the first argument must be a Storage instance.")}else return LS(t,e)}function KE(t,e){const n=e==null?void 0:e[ES];return n==null?null:zs.makeFromBucketSpec(n,t)}function M3(t,e,n,s={}){t.host=`${e}:${n}`;const r=yo(e);r&&(vg(`https://${t.host}/b`),_g("Storage",!0)),t._isUsingEmulator=!0,t._protocol=r?"https":"http";const{mockUserToken:a}=s;a&&(t._overrideAuthToken=typeof a=="string"?a:rw(a,t.app.options.projectId))}class by{constructor(e,n,s,r,a,c=!1){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=a,this._isUsingEmulator=c,this._bucket=null,this._host=bS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=w5,this._maxUploadRetryTime=C5,this._requests=new Set,r!=null?this._bucket=zs.makeFromBucketSpec(r,this._host):this._bucket=KE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=zs.makeFromBucketSpec(this._url,e):this._bucket=KE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){JE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){JE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Zs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ra(this,e)}_makeRequest(e,n,s,r,a=!0){if(this._deleted)return new z5(TS());{const c=X5(e,this._appId,s,r,n,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const WE="@firebase/storage",XE="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VS="storage";function hh(t,e,n){return t=xn(t),w3(t,e,n)}function fh(t){return t=xn(t),C3(t)}function og(t){return t=xn(t),S3(t)}function Ni(t,e){return t=xn(t),N3(t,e)}function k3(t=Eg(),e){t=xn(t);const s=xh(t,VS).getImmediate({identifier:e}),r=nw("storage");return r&&D3(s,...r),s}function D3(t,e,n,s={}){M3(t,e,n,s)}function P3(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new by(n,s,r,e,la)}function L3(){ea(new lo(VS,P3,"PUBLIC").setMultipleInstances(!0)),Pi(WE,XE,""),Pi(WE,XE,"esm2020")}L3();const V3={apiKey:"AIzaSyBK5eiKiX7GFTVMy_LrTYDKYVEfoV8vImY",authDomain:"sketcher-companion.firebaseapp.com",projectId:"sketcher-companion",storageBucket:"sketcher-companion.firebasestorage.app",messagingSenderId:"629894472307",appId:"1:629894472307:web:7be8c8a190d1e9a25e4006"},Ey=lw(V3),ag=a4(Ey),Mi=a5(Ey),ki=k3(Ey),$c=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"m4 4 7.07 17 2.51-7.39 7.39-2.51L4 4z"})}),yl=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:t,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})}),ru=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21H7Z"}),g.jsx("path",{d:"M18 9 9.5 17.5"})]}),qh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M17 3l5 5L9 21H4v-5L17 3z"}),g.jsx("path",{d:"M15 5l5 5"}),g.jsx("path",{d:"M7 13l-2.5 2.5"}),g.jsx("path",{d:"M14 20h5"})]}),Hh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M5 3h14"}),g.jsx("path",{d:"M12 3v18"})]}),U3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),g.jsx("polyline",{points:"2 17 12 22 22 17"}),g.jsx("polyline",{points:"2 12 12 17 22 12"})]}),QE=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),g.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),ZE=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"m9.9 9.9 4.2 4.2"}),g.jsx("path",{d:"M10.5 10.5c.5.5.8 1.2.8 2s-.3 1.5-.8 2"}),g.jsx("path",{d:"M13.5 13.5c-.5-.5-.8-1.2-.8-2s.3-1.5.8-2"}),g.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7a13.3 13.3 0 0 1-5-1.2"}),g.jsx("path",{d:"m2 2 20 20"})]}),ph=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),g.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Gh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M4 20L17 7"}),g.jsx("path",{d:"M17 5H21M19 3V7"}),g.jsx("path",{d:"M18 4L20 6M18 6L20 4"})]}),$h=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"2 2",children:g.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"})}),Yh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M12 22a7 7 0 0 0-7-7c0-4 7-4 7-10 0 6 7 6 7 10a7 7 0 0 0-7 7z"}),g.jsx("path",{d:"M12 15a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"})]}),ou=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"m9.88 2.88 1.42 1.42"}),g.jsx("path",{d:"m14.12 2.88 1.42-1.42"}),g.jsx("path",{d:"m12 6.88-1.42-1.42"}),g.jsx("path",{d:"M16 8 2 2"}),g.jsx("path",{d:"M12 22V10"}),g.jsx("path",{d:"M7 10H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2"}),g.jsx("path",{d:"m19 10 2 2"}),g.jsx("path",{d:"M17 10h2a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-2"})]}),oa=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("polyline",{points:"3 6 5 6 21 6"}),g.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),Ty=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),g.jsx("polyline",{points:"17 8 12 3 7 8"}),g.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),Gd=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.23A2 2 0 0 0 8.27 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"})}),eT=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),g.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),g.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),US=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"11",cy:"11",r:"8"}),g.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),g.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),g.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"})]}),OS=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"11",cy:"11",r:"8"}),g.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),g.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"})]}),BS=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:t,children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.05 4.575a1.575 1.575 0 1 0-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 0 1 3.15 0v1.5m-3.15 0 .075 5.925m3.075.75V4.575m0 0a1.575 1.575 0 0 1 3.15 0V15M6.9 7.575a1.575 1.575 0 1 0-3.15 0v8.175a6.75 6.75 0 0 0 6.75 6.75h2.018a5.25 5.25 0 0 0 3.712-1.538l1.732-1.732a5.25 5.25 0 0 0 1.538-3.712l.003-2.024a.668.668 0 0 1 .198-.471 1.575 1.575 0 1 0-2.228-2.228 3.818 3.818 0 0 0-1.12 2.687M6.9 7.575V12m6.27 4.318A4.49 4.49 0 0 1 16.35 15m.002 0h-.002"})}),zS=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"12",cy:"12",r:"10"}),g.jsx("line",{x1:"22",y1:"12",x2:"18",y2:"12"}),g.jsx("line",{x1:"6",y1:"12",x2:"2",y2:"12"}),g.jsx("line",{x1:"12",y1:"6",x2:"12",y2:"2"}),g.jsx("line",{x1:"12",y1:"22",x2:"12",y2:"18"})]}),tT=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M12 22v-8"}),g.jsx("path",{d:"m15 17-3 3-3-3"}),g.jsx("path",{d:"M3 3v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3"})]}),O3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M12 2v8"}),g.jsx("path",{d:"m15 7-3-3-3 3"}),g.jsx("path",{d:"M3 21v-10a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10"})]}),B3=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"m6 9 6 6 6-6"})}),z3=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"m18 15-6-6-6 6"})}),jS=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M3 7v6h6"}),g.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]}),FS=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M21 7v6h-6"}),g.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"})]}),j3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),g.jsx("path",{d:"M21 3v5h-5"}),g.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),g.jsx("path",{d:"M3 21v-5h5"})]}),qS=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),g.jsx("polyline",{points:"15 3 21 3 21 9"}),g.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]}),Jh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M6.13 1L6 16a2 2 0 0 0 2 2h15"}),g.jsx("path",{d:"M1 6.13L16 6a2 2 0 0 1 2 2v15"})]}),HS=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("polyline",{points:"20 6 9 17 4 12"})}),bo=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),g.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),F3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"6",cy:"6",r:"3"}),g.jsx("circle",{cx:"18",cy:"18",r:"3"}),g.jsx("line",{x1:"8.12",y1:"8.12",x2:"15.88",y2:"15.88"})]}),q3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M3 21h18"}),g.jsx("path",{d:"M7 21l3-14"}),g.jsx("path",{d:"M17 21l-3-14"}),g.jsx("path",{d:"M10 7h4"})]}),H3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),g.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),G3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M12 2v20"}),g.jsx("path",{d:"M5 12a7.7 7.7 0 0 0 7 7.7 7.7 7.7 0 0 0 7-7.7c0-4.5-3-7.7-7-7.7-4 0-7 3.2-7 7.7z"}),g.jsx("path",{d:"M19 12a7.7 7.7 0 0 1-7 7.7 7.7 7.7 0 0 1-7-7.7c0-4.5 3-7.7 7-7.7 4 0 7 3.2 7 7.7z"})]}),nT=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}),g.jsx("path",{d:"M3 9h18M3 15h18M9 3v18M15 3v18"})]}),$3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M12 2 22 8 12 14 2 8 12 2z"}),g.jsx("path",{d:"m2 8 v8 l10 6 10-6 V8"}),g.jsx("path",{d:"m12 14 v8"})]}),sT=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),g.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),iT=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),g.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),Kh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M4 4L20 4L20 20L4 20Z",strokeDasharray:"2 2",strokeWidth:"1.5"}),g.jsx("path",{d:"M7 7L17 7L17 17L7 17Z"}),g.jsx("path",{d:"M4 4m-1.5 0a1.5 1.5 0 1 0 3 0a1.5 1.5 0 1 0-3 0"}),g.jsx("path",{d:"M20 4m-1.5 0a1.5 1.5 0 1 0 3 0a1.5 1.5 0 1 0-3 0"}),g.jsx("path",{d:"M4 20m-1.5 0a1.5 1.5 0 1 0 3 0a1.5 1.5 0 1 0-3 0"}),g.jsx("path",{d:"M20 20m-1.5 0a1.5 1.5 0 1 0 3 0a1.5 1.5 0 1 0-3 0"})]}),Wh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M5 5L19 3l-1 16L4 18z"}),g.jsx("circle",{cx:"5",cy:"5",r:"1.5"}),g.jsx("circle",{cx:"19",cy:"3",r:"1.5"}),g.jsx("circle",{cx:"18",cy:"19",r:"1.5"}),g.jsx("circle",{cx:"4",cy:"18",r:"1.5"})]}),Y3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"12",cy:"12",r:"4"}),g.jsx("path",{d:"M12 2v2"}),g.jsx("path",{d:"M12 20v2"}),g.jsx("path",{d:"m4.93 4.93 1.41 1.41"}),g.jsx("path",{d:"m17.66 17.66 1.41 1.41"}),g.jsx("path",{d:"M2 12h2"}),g.jsx("path",{d:"M20 12h2"}),g.jsx("path",{d:"m6.34 17.66-1.41 1.41"}),g.jsx("path",{d:"m19.07 4.93-1.41 1.41"})]}),J3=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})}),GS=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),g.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),K3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"6",cy:"6",r:"3"}),g.jsx("circle",{cx:"6",cy:"18",r:"3"}),g.jsx("line",{x1:"20",y1:"4",x2:"8.12",y2:"15.88"}),g.jsx("line",{x1:"14.47",y1:"14.48",x2:"20",y2:"20"}),g.jsx("line",{x1:"8.12",y1:"8.12",x2:"12",y2:"12"})]}),W3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),g.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})]}),rT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"m15 18-6-6 6-6"})}),lg=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"m9 18 6-6-6-6"})}),$S=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),g.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),X3=({className:t})=>g.jsxs("svg",{className:t,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[g.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),g.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),g.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z",fill:"#FBBC05"}),g.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),Q3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),g.jsx("polyline",{points:"16 17 21 12 16 7"}),g.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),YS=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),g.jsx("polyline",{points:"5 12 12 5 19 12"})]}),Z3=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),g.jsx("polyline",{points:"19 12 12 19 5 12"})]}),ym=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M4 13a8 8 0 0 1 8-8v8h8a8 8 0 0 1-8 8 8 8 0 0 1-8-8z"}),g.jsx("path",{d:"M4 21V19"}),g.jsx("path",{d:"M20 21V19"}),g.jsx("path",{d:"M12 4V2"})]}),JS=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"m19 21-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"})}),KS=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),g.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),g.jsx("polyline",{points:"7 3 7 8 15 8"})]}),eO=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),tO=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),g.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),g.jsx("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}),oT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M4 12c4 0 8-4 16-4"})}),aT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("line",{x1:"4",y1:"20",x2:"20",y2:"4"})}),lT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M4 20 10 4 16 16 20 12"})}),cT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M4 12A8 8 0 0 1 12 4"})}),uT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M4 4c4 0 8 8 16 8"})}),nO=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M15 3h6v6"}),g.jsx("path",{d:"M9 21H3v-6"}),g.jsx("path",{d:"M21 3l-7 7"}),g.jsx("path",{d:"M3 21l7-7"})]}),sO=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M4 14h6v6"}),g.jsx("path",{d:"M20 10h-6V4"}),g.jsx("path",{d:"M14 10l7-7"}),g.jsx("path",{d:"M3 21l7-7"})]}),dT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12"})}),hT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M4 12h4m6 0h4m-5 0h2"})}),fT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M4 12h.01M8 12h.01M12 12h.01M16 12h.01M20 12h.01"})}),pT=({className:t})=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M4 12h4m4 0h.01M16 12h4"})}),iO=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),g.jsx("path",{d:"M3 3v5h5"}),g.jsx("path",{d:"M12 7v5l4 2"})]}),cg=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("circle",{cx:"12",cy:"12",r:"1"}),g.jsx("circle",{cx:"12",cy:"5",r:"1"}),g.jsx("circle",{cx:"12",cy:"19",r:"1"})]}),rO=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"12",y1:"13",x2:"12",y2:"23"}),g.jsx("line",{x1:"7",y1:"18",x2:"17",y2:"18"}),g.jsx("line",{x1:"12",y1:"7",x2:"12",y2:"1"}),g.jsx("polyline",{points:"9 4 12 1 15 4"})]}),oO=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"11"}),g.jsx("line",{x1:"7",y1:"6",x2:"17",y2:"6"}),g.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"23"}),g.jsx("polyline",{points:"9 20 12 23 15 20"})]}),Xh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M20.7 7.3c-2-2.7-5.3-4.3-8.7-4.3-4.9 0-9 4-9 9 0 2.6.9 5 2.5 6.7"}),g.jsx("path",{d:"M12 21c-2.4 0-4.6-.9-6.3-2.5"}),g.jsx("path",{d:"m15.5 13.5-3.8 2.3"}),g.jsx("path",{d:"M18 10.2s-2.3 2.5-5.5 1.6"}),g.jsx("path",{d:"M13.2 5.3s3.1-1.1 5.4 1.1"})]}),Qh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M6 18h4"}),g.jsx("path",{d:"M14 18h4"}),g.jsx("path",{d:"M10 22h4"}),g.jsx("path",{d:"M12 18v-4"}),g.jsx("path",{d:"M12 14c-4.42 0-8-2.69-8-6s3.58-6 8-6 8 2.69 8 6"}),g.jsx("path",{d:"M12 2a4 4 0 0 0-4 4"})]}),Al=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"m16.86 3.46 1.41-1.41a2 2 0 1 1 2.83 2.83l-1.41 1.41"}),g.jsx("path",{d:"m3.46 16.86 1.41-1.41a2 2 0 1 1 2.83 2.83l-1.41 1.41"}),g.jsx("path",{d:"M3 21v-3h3"}),g.jsx("path",{d:"M21 3v3h-3"}),g.jsx("path",{d:"M12 3v3"}),g.jsx("path",{d:"M12 21v-3"}),g.jsx("path",{d:"M3 12h3"}),g.jsx("path",{d:"M21 12h-3"}),g.jsx("path",{d:"m16.86 15.46.7-.7a2 2 0 1 0-2.83-2.83l-.7.7"}),g.jsx("path",{d:"m8.54 7.14-.7.7a2 2 0 1 0 2.83 2.83l.7-.7"})]}),Zh=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"m16.86 3.46 1.41-1.41a2 2 0 1 1 2.83 2.83l-1.41 1.41m-12.02 12.02 1.41-1.41a2 2 0 1 1 2.83 2.83l-1.41 1.41"}),g.jsx("path",{d:"m6.34 17.66 11.32-11.32"})]}),ef=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"m20.55 3.45-1.5 1.5"}),g.jsx("path",{d:"m16 6 3.19 3.19"}),g.jsx("path",{d:"M14.28 15.16 5.72 6.6a2.07 2.07 0 0 0-2.93 0L2.2 7.19a2.07 2.07 0 0 0 0 2.93l8.56 8.56"}),g.jsx("path",{d:"M18 11.45c0 3.22-2.1 5.5-5.34 5.5-1.7 0-3.32-.83-4.48-2.22"}),g.jsx("path",{d:"M18.01 19.38c.6-.57.99-1.37.99-2.25 0-1.77-1.43-3.2-3.2-3.2-1.29 0-2.4.76-2.93 1.84"})]}),aO=({className:t})=>g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),g.jsx("polyline",{points:"7 10 12 15 17 10"}),g.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),mT=[{tool:"marquee-rect",name:"Marco Rectangular",icon:$h},{tool:"lasso",name:"Lazo",icon:Yh},{tool:"magic-wand",name:"Varita Mgica",icon:ou}],gT=[{tool:"brush",name:"Rapidograph Solido",icon:yl},{tool:"simple-marker",name:"Marcador Slido",icon:qh},{tool:"advanced-marker",name:"Marcador Avanzado",icon:Xh},{tool:"natural-marker",name:"Marcador Natural",icon:Zh},{tool:"airbrush",name:"Aergrafo",icon:Qh},{tool:"fx-brush",name:"Pincel de Efectos",icon:Al},{tool:"watercolor",name:"Acuarela",icon:ef}],yT={select:$c,"marquee-rect":$h,lasso:Yh,"magic-wand":ou,brush:yl,eraser:ru,"simple-marker":qh,transform:Kh,"free-transform":Wh,"advanced-marker":Xh,watercolor:ef,"natural-marker":Zh,airbrush:Qh,"fx-brush":Al,text:Hh,crop:Jh,enhance:Gh,pan:$c,"debug-brush":yl},lO=({tool:t,setTool:e,brushSettings:n,setBrushSettings:s,eraserSettings:r,setEraserSettings:a,simpleMarkerSettings:c,setSimpleMarkerSettings:d,naturalMarkerSettings:f,setNaturalMarkerSettings:h,airbrushSettings:_,setAirbrushSettings:b,fxBrushSettings:E,setFxBrushSettings:S,advancedMarkerSettings:L,setAdvancedMarkerSettings:U,watercolorSettings:F,setWatercolorSettings:z,magicWandSettings:q,setMagicWandSettings:j,textSettings:H,setTextSettings:Y,activeGuide:K,setActiveGuide:R,isOrthogonalVisible:T,onToggleOrthogonal:N,onExportClick:I,objects:D,libraryItems:k,backgroundDataUrl:M,debugInfo:ce,strokeMode:ge,setStrokeMode:$,strokeModifier:G,setStrokeModifier:ae,brushPresets:ve,...X})=>{const[O,Q]=P.useState(null),[te,ie]=P.useState(null),[Ce,be]=P.useState(null),Fe=P.useRef(null),Ue=P.useRef(null),[Oe,tt]=P.useState(!1),[Ot,vt]=P.useState(!1),Ae=P.useRef(null),[Ne,Se]=P.useState(!1),De=P.useRef(null),[et,We]=P.useState(!1),it=P.useRef(null),[rt,St]=P.useState(!1),_t=P.useRef(null),[Gt,ct]=P.useState("marquee-rect"),[Bt,qe]=P.useState("brush");P.useEffect(()=>{const we=Xe=>{Ae.current&&!Ae.current.contains(Xe.target)&&vt(!1),De.current&&!De.current.contains(Xe.target)&&Se(!1),it.current&&!it.current.contains(Xe.target)&&We(!1),_t.current&&!_t.current.contains(Xe.target)&&St(!1),O!=="enhance"&&Fe.current&&!Fe.current.contains(Xe.target)&&te&&!te.contains(Xe.target)&&(Q(null),ie(null),be(null))};return document.addEventListener("mousedown",we),()=>document.removeEventListener("mousedown",we)},[te,O]),P.useEffect(()=>{mT.some(we=>we.tool===t)?ct(t):gT.some(we=>we.tool===t)&&qe(t)},[t]);const ot=we=>{t!==we&&(Q(null),ie(null),be(null)),e(we)},Vt=(we,Xe)=>{Q(at=>{const Me=Xe.currentTarget;return at===we&&te===Me?(ie(null),be(null),null):(ie(Me),be(null),vt(!1),Se(!1),We(!1),St(!1),we)})},Pn=(we,Xe)=>{we.stopPropagation();const at=we.currentTarget,Me=at.getBoundingClientRect(),Re=Ue.current.getBoundingClientRect();We(!1),St(!1),vt(!1),Se(!1),be({left:Me.right-Re.left+8,top:Me.top-Re.top}),ie(at),Q(Xe)},rn=we=>`p-3 rounded-lg transition-colors ${t===we?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,$t={freehand:oT,line:aT,polyline:lT,curve:uT,arc:cT}[ge],on=[{mode:"freehand",label:"A mano alzada",icon:oT},{mode:"line",label:"Lnea (2 Puntos)",icon:aT},{mode:"polyline",label:"Polilnea",icon:lT},{mode:"curve",label:"Curva (3 Puntos)",icon:uT},{mode:"arc",label:"Arco (Centro)",icon:cT}],Ln={solid:dT,dashed:hT,dotted:fT,"dash-dot":pT}[G.style],an=[{style:"solid",label:"Slido",icon:dT},{style:"dashed",label:"Segmentado",icon:hT},{style:"dotted",label:"Punteado",icon:fT},{style:"dash-dot",label:"Lnea y punto",icon:pT}],Ct=`p-3 rounded-lg transition-colors ${["brush","simple-marker","eraser","natural-marker","advanced-marker","airbrush","fx-brush","watercolor"].includes(t)?"bg-[--accent-primary] text-white hover:bg-[--accent-hover]":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,ln=`p-3 rounded-lg transition-colors ${G.style!=="solid"?"bg-[--accent-primary] text-white hover:bg-[--accent-hover]":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,Ie=["marquee-rect","lasso","magic-wand"],Pe=["brush","simple-marker","natural-marker","advanced-marker","airbrush","fx-brush","watercolor"],ht=Ie.includes(t),$e=Pe.includes(t),At=yT[ht?t:Gt],wt=yT[$e?t:Bt],Qe=we=>{if(!we)return{};const Xe=we.getBoundingClientRect();return{position:"fixed",left:`${Xe.right+8}px`,top:`${Xe.top}px`,maxHeight:`calc(100vh - ${Xe.top}px - 16px)`,overflowY:"auto"}};return g.jsx("div",{ref:Ue,className:"relative flex-shrink-0 h-full",children:g.jsxs("div",{className:"bg-[--bg-primary] text-[--text-primary] h-full flex flex-col p-2 overflow-y-auto scrollbar-thin scrollbar-thumb-[--bg-tertiary] scrollbar-track-transparent",children:[g.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[g.jsx("button",{onClick:()=>ot("select"),className:rn("select"),title:"Seleccionar",children:g.jsx($c,{className:"w-6 h-6"})}),g.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),g.jsxs("div",{className:"relative",ref:it,children:[g.jsx("button",{onClick:()=>{St(!1),vt(!1),Se(!1),We(we=>!we)},onDoubleClick:we=>Vt(ht?t:Gt,we),className:`p-3 rounded-lg transition-colors ${ht?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Herramientas de Seleccin (doble clic para opciones)",children:g.jsx(At,{className:"w-6 h-6"})}),et&&g.jsx("div",{className:"z-20 p-2 space-y-1 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-60",style:Qe(it.current),children:mT.map(({tool:we,name:Xe,icon:at})=>g.jsxs("div",{className:`flex items-center justify-between rounded-md text-sm ${t===we?"bg-[--accent-primary] text-white":"hover:bg-[--bg-tertiary]"}`,children:[g.jsxs("button",{onClick:()=>{ot(we),We(!1)},className:"flex items-center gap-3 p-2 flex-grow text-left",children:[g.jsx(at,{className:"w-5 h-5"}),g.jsx("span",{children:Xe})]}),g.jsx("button",{onClick:Me=>{Pn(Me,we)},className:"p-2 mr-1 rounded-full hover:bg-black/10 flex-shrink-0",title:"Configuracin de la herramienta",children:g.jsx(cg,{className:"w-4 h-4"})})]},we))})]}),g.jsxs("div",{className:"relative",ref:Ae,children:[g.jsx("button",{onClick:()=>{Se(!1),We(!1),St(!1),vt(we=>!we)},className:Ct,title:`Modo de Trazo: ${ge} (clic para cambiar)`,children:g.jsx($t,{className:"w-6 h-6"})}),Ot&&g.jsxs("div",{className:"z-20 p-2 space-y-1 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-60",style:Qe(Ae.current),children:[g.jsx("h4",{className:"px-2 pb-1 text-sm font-bold uppercase text-[--text-secondary]",children:"Modos de Trazo"}),on.map(({mode:we,label:Xe,icon:at})=>g.jsxs("button",{onClick:()=>{$(we),vt(!1)},className:`w-full flex items-center gap-3 p-2 rounded-md text-sm ${ge===we?"bg-[--accent-primary] text-white":"hover:bg-[--bg-tertiary]"}`,children:[g.jsx(at,{className:"w-5 h-5"}),g.jsx("span",{children:Xe})]},we))]})]}),g.jsxs("div",{className:"relative",ref:De,children:[g.jsx("button",{onClick:()=>{vt(!1),We(!1),St(!1),Se(we=>!we)},className:ln,title:`Estilo de Trazo: ${G.style} (clic para cambiar)`,children:g.jsx(Ln,{className:"w-6 h-6"})}),Ne&&g.jsxs("div",{className:"z-20 p-2 space-y-2 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-60",style:Qe(De.current),children:[g.jsx("h4",{className:"px-2 pb-1 text-sm font-bold uppercase text-[--text-secondary]",children:"Estilo de Trazo"}),g.jsx("div",{className:"space-y-1",children:an.map(({style:we,label:Xe,icon:at})=>g.jsxs("button",{onClick:()=>{ae(Me=>({...Me,style:we}))},className:`w-full flex items-center gap-3 p-2 rounded-md text-sm ${G.style===we?"bg-[--accent-primary] text-white":"hover:bg-[--bg-tertiary]"}`,children:[g.jsx(at,{className:"w-5 h-5"}),g.jsx("span",{children:Xe})]},we))}),g.jsxs("div",{className:"border-t border-[--bg-tertiary] pt-2 mt-2",children:[g.jsxs("label",{className:"px-2 text-xs font-bold text-[--text-secondary]",children:["Escala del Patrn: ",G.scale.toFixed(1)]}),g.jsx("input",{type:"range",min:"0.5",max:"10",step:"0.5",value:G.scale,onChange:we=>ae(Xe=>({...Xe,scale:parseFloat(we.target.value)})),className:"w-full mt-1",disabled:G.style==="solid"})]})]})]}),g.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),g.jsxs("div",{className:"relative",ref:_t,children:[g.jsx("button",{onClick:()=>{We(!1),vt(!1),Se(!1),St(we=>!we)},onDoubleClick:we=>Vt($e?t:Bt,we),className:`p-3 rounded-lg transition-colors ${$e?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Herramientas de Dibujo (doble clic para opciones)",children:g.jsx(wt,{className:"w-6 h-6"})}),rt&&g.jsx("div",{className:"z-20 p-2 space-y-1 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-60",style:Qe(_t.current),children:gT.map(({tool:we,name:Xe,icon:at})=>g.jsxs("div",{className:`flex items-center justify-between rounded-md text-sm ${t===we?"bg-[--accent-primary] text-white":"hover:bg-[--bg-tertiary]"}`,children:[g.jsxs("button",{onClick:()=>{ot(we),St(!1)},className:"flex items-center gap-3 p-2 flex-grow text-left",children:[g.jsx(at,{className:"w-5 h-5"}),g.jsx("span",{children:Xe})]}),g.jsx("button",{onClick:Me=>{Pn(Me,we)},className:"p-2 mr-1 rounded-full hover:bg-black/10 flex-shrink-0",title:"Configuracin de la herramienta",children:g.jsx(cg,{className:"w-4 h-4"})})]},we))})]}),g.jsx("button",{onClick:()=>ot("eraser"),onDoubleClick:we=>Vt("eraser",we),className:rn("eraser"),title:"Goma de Borrar (doble clic para opciones)",children:g.jsx(ru,{className:"w-6 h-6"})}),g.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),g.jsx("button",{onClick:()=>ot("text"),onDoubleClick:we=>Vt("text",we),className:rn("text"),title:"Texto (doble clic para opciones)",children:g.jsx(Hh,{className:"w-6 h-6"})})]}),g.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),g.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[g.jsx("button",{onClick:()=>R("ruler"),className:`p-3 rounded-lg transition-colors ${K==="ruler"?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Gua de Regla",children:g.jsx(F3,{className:"w-6 h-6"})}),g.jsx("button",{onClick:()=>R("perspective"),className:`p-3 rounded-lg transition-colors ${K==="perspective"?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Gua de Perspectiva",children:g.jsx(q3,{className:"w-6 h-6"})}),g.jsx("button",{onClick:N,className:`p-3 rounded-lg transition-colors ${T?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Gua Ortogonal",children:g.jsx(H3,{className:"w-6 h-6"})}),g.jsx("button",{onClick:()=>R("mirror"),className:`p-3 rounded-lg transition-colors ${K==="mirror"?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Gua de Espejo",children:g.jsx(G3,{className:"w-6 h-6"})})]}),g.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),g.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[g.jsx("button",{onClick:()=>ot("transform"),className:rn("transform"),title:"Transformar (Escalar/Rotar)",children:g.jsx(Kh,{className:"w-6 h-6"})}),g.jsx("button",{onClick:()=>ot("free-transform"),className:rn("free-transform"),title:"Transformacin Libre (Distorsionar)",children:g.jsx(Wh,{className:"w-6 h-6"})})]}),g.jsxs("div",{className:"mt-auto flex flex-col items-center space-y-2",children:[g.jsx("button",{onClick:()=>ot("crop"),className:rn("crop"),title:"Recortar",children:g.jsx(Jh,{className:"w-6 h-6"})}),g.jsx("button",{onClick:I,className:"p-3 rounded-lg bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]",title:"Exportar Imagen",children:g.jsx(qS,{className:"w-6 h-6"})})]})]})})},cO=({items:t,activeItemId:e,onAddItem:n,onCopyItem:s,onDeleteItem:r,onSelectItem:a,onUpdateItem:c,onMoveItem:d,onMergeItems:f,onUpdateBackground:h,onRemoveBackgroundImage:_,onExportItem:b,onOpenCanvasSizeModal:E,activeItemState:S,onMoveItemUpDown:L,onMergeItemDown:U,onMergeItemUp:F,onAddObjectAbove:z,onAddObjectBelow:q})=>{const[j,H]=P.useState(!1),Y=P.useRef(null),[K,R]=P.useState(null),T=t.find(G=>G.type==="object"&&G.isBackground),N=!!((T==null?void 0:T.type)==="object"&&T.backgroundImage);P.useEffect(()=>{const G=ae=>{Y.current&&!Y.current.contains(ae.target)&&H(!1)};return document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}},[]);const I=G=>{G.target.files&&G.target.files[0]&&(h({file:G.target.files[0]}),G.target.value="")},D=(G,ae)=>{G.stopPropagation(),G.dataTransfer.effectAllowed="copyMove",G.dataTransfer.setData("application/json",JSON.stringify({type:"outliner-item",id:ae.id}))},k=(G,ae)=>{G.preventDefault(),G.stopPropagation();const ve=G.currentTarget.getBoundingClientRect(),X=G.clientY-ve.top,O=ve.height;let Q;if(!G.dataTransfer.types.find(Ce=>Ce==="application/json"))return;if(ae.type==="group"||ae.type==="object"&&!0){const Ce=O*.25;X<Ce?Q="top":X>O-Ce?Q="bottom":Q="middle"}else Q=X<O/2?"top":"bottom";R({id:ae.id,position:Q})},M=G=>{G.stopPropagation(),R(null)},ce=(G,ae)=>{G.preventDefault(),G.stopPropagation(),R(null);try{const ve=JSON.parse(G.dataTransfer.getData("application/json"));if(ve.type!=="outliner-item"||!ve.id)return;const X=ve.id;K&&K.id===ae.id&&(K.position==="middle"&&ae.type==="object"?f(X,ae.id):d(X,ae.id,K.position))}catch{}},ge=(G,ae)=>{if(G.type==="object"&&G.isBackground)return null;const ve=G.type==="group",X=G.type==="object",O=e===G.id,Q=(K==null?void 0:K.id)===G.id,te=K==null?void 0:K.position,ie=X&&Q&&te==="middle",Ce=()=>Q&&te==="middle"&&X?"bg-red-700":O?"bg-[--accent-hover]":"bg-[--bg-secondary] hover:bg-[--bg-tertiary]";return g.jsxs("div",{draggable:!(G.type==="object"&&G.isBackground),onDragStart:be=>D(be,G),onDragOver:be=>k(be,G),onDragLeave:M,onDrop:be=>ce(be,G),onClick:()=>a(G.id),className:`group relative p-2 rounded-lg transition-colors duration-100 ${Ce()}`,style:{marginLeft:`${ae*16}px`},children:[Q&&te==="top"&&g.jsx("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-[--accent-primary] z-10"}),Q&&te==="bottom"&&g.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[--accent-primary] z-10"}),g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center flex-grow min-w-0",children:[g.jsx("span",{className:"flex-shrink-0 cursor-grab text-[--text-secondary] hover:text-[--text-primary] mr-2",children:g.jsx(cg,{className:"w-5 h-5"})}),ve&&g.jsx(Gd,{className:"w-4 h-4 mr-2 text-red-400 flex-shrink-0"}),ie&&g.jsx(tT,{className:"w-4 h-4 mr-2 text-red-400"}),g.jsx("input",{type:"text",value:G.name,onClick:be=>be.stopPropagation(),onDragStart:be=>be.stopPropagation(),onChange:be=>c(G.id,{name:be.target.value}),className:"bg-transparent text-sm w-full outline-none pointer-events-auto truncate"})]}),g.jsxs("div",{className:"flex items-center space-x-2 ml-2 flex-shrink-0",children:[g.jsx("button",{onClick:be=>{be.stopPropagation(),c(G.id,{isVisible:!G.isVisible})},className:"p-1",children:G.isVisible?g.jsx(QE,{className:"w-4 h-4"}):g.jsx(ZE,{className:"w-4 h-4 text-gray-500"})}),!(G.type==="object"&&G.isBackground)&&g.jsx("button",{onClick:be=>{be.stopPropagation(),r(G.id)},className:"p-1 text-[--text-secondary] hover:text-red-500",children:g.jsx(oa,{className:"w-4 h-4"})})]})]}),O&&G.type==="object"&&g.jsxs("div",{className:"mt-2 space-y-2",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:`opacity-${G.id}`,className:"text-xs text-[--text-secondary]",children:"Opacidad"}),g.jsx("input",{id:`opacity-${G.id}`,type:"range",min:"0",max:"100",value:G.opacity*100,onClick:be=>be.stopPropagation(),onChange:be=>c(G.id,{opacity:parseInt(be.target.value,10)/100}),className:"w-full h-1 bg-[--bg-tertiary] rounded-lg appearance-none cursor-pointer"})]}),g.jsxs("div",{className:"flex items-center flex-wrap gap-1 border-t border-[--bg-tertiary] pt-2",children:[g.jsx("button",{onClick:be=>{be.stopPropagation(),L(G.id,"up")},disabled:!S.canMoveUp,className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Mover arriba",children:g.jsx(YS,{className:"w-3.5 h-3.5"})}),g.jsx("button",{onClick:be=>{be.stopPropagation(),L(G.id,"down")},disabled:!S.canMoveDown,className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Mover abajo",children:g.jsx(Z3,{className:"w-3.5 h-3.5"})}),X&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-px h-3.5 bg-[--bg-tertiary] mx-0.5"}),g.jsx("button",{onClick:be=>{be.stopPropagation(),z(G.id)},className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover]",title:"Aadir objeto arriba",children:g.jsx(rO,{className:"w-3.5 h-3.5"})}),g.jsx("button",{onClick:be=>{be.stopPropagation(),q(G.id)},className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover]",title:"Aadir objeto abajo",children:g.jsx(oO,{className:"w-3.5 h-3.5"})}),g.jsx("div",{className:"w-px h-3.5 bg-[--bg-tertiary] mx-0.5"}),g.jsx("button",{onClick:be=>{be.stopPropagation(),F(G.id)},disabled:!S.canMergeUp,className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Combinar arriba",children:g.jsx(O3,{className:"w-3.5 h-3.5"})}),g.jsx("button",{onClick:be=>{be.stopPropagation(),U(G.id)},disabled:!S.canMergeDown,className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Combinar abajo",children:g.jsx(tT,{className:"w-3.5 h-3.5"})})]})]})]})]},G.id)},$=(G=null,ae=0)=>t.filter(ve=>ve.parentId===G&&!(ve.type==="object"&&ve.isBackground)).reverse().flatMap(ve=>[ge(ve,ae),...ve.type==="group"?$(ve.id,ae+1):[]]);return g.jsxs("div",{className:"bg-[--bg-primary] text-[--text-primary] p-4 flex flex-col h-full",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsxs("div",{className:"flex items-center",children:[g.jsx(U3,{className:"w-5 h-5 mr-2 text-[--text-secondary]"}),g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Outliner"})]}),g.jsxs("div",{className:"flex items-center space-x-1",children:[g.jsx("button",{onClick:b,disabled:!e||!!t.find(G=>G.id===e&&G.type==="object"&&G.isBackground),className:"p-2 rounded-md hover:bg-[--bg-tertiary] disabled:text-gray-600 disabled:cursor-not-allowed disabled:hover:bg-transparent",title:"Exportar objeto seleccionado",children:g.jsx(qS,{className:"w-5 h-5"})}),g.jsx("button",{onClick:()=>e&&s(e),disabled:!e||!!t.find(G=>G.id===e&&G.type==="object"&&G.isBackground),className:"p-2 rounded-md hover:bg-[--bg-tertiary] disabled:text-gray-600 disabled:cursor-not-allowed disabled:hover:bg-transparent",title:"Duplicar objeto seleccionado",children:g.jsx(GS,{className:"w-5 h-5"})}),g.jsxs("div",{className:"relative",ref:Y,children:[g.jsx("button",{onClick:()=>H(!j),className:"p-2 rounded-md hover:bg-[--bg-tertiary]",children:g.jsx(ph,{className:"w-5 h-5"})}),j&&g.jsxs("div",{className:"absolute right-0 mt-2 w-40 bg-[--bg-tertiary] rounded-md shadow-lg z-10",children:[g.jsx("button",{onClick:()=>{n("group"),H(!1)},className:"block w-full text-left px-4 py-2 text-sm text-[--text-primary] hover:bg-[--bg-hover]",children:"Nueva Carpeta"}),g.jsx("button",{onClick:()=>{n("object"),H(!1)},className:"block w-full text-left px-4 py-2 text-sm text-[--text-primary] hover:bg-[--bg-hover]",children:"Nuevo Objeto"})]})]})]})]}),g.jsx("div",{className:"flex-grow overflow-y-auto space-y-2 pr-2",children:$()}),g.jsxs("div",{className:"flex-shrink-0 border-t border-[--bg-tertiary] mt-4 pt-4",children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-3",children:"Canvas"}),g.jsx("div",{className:"space-y-2",children:g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("input",{type:"color",id:"canvas-color",value:(T==null?void 0:T.type)==="object"&&T.color||"#FFFFFF",onChange:G=>h({color:G.target.value}),className:"w-10 h-10 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer flex-shrink-0",title:"Color de fondo"}),g.jsx("button",{onDoubleClick:E,className:"h-10 px-3 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary] text-sm flex-grow",title:"Tamao del lienzo (doble clic)",children:"Personalizado"}),T&&g.jsx("button",{onClick:()=>c(T.id,{isVisible:!T.isVisible}),className:"h-10 w-10 flex-shrink-0 p-2 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary]",title:T.isVisible?"Ocultar fondo":"Mostrar fondo",children:T.isVisible?g.jsx(QE,{className:"w-5 h-5"}):g.jsx(ZE,{className:"w-5 h-5"})}),g.jsx("label",{htmlFor:"canvas-image-upload",className:"h-10 w-10 flex items-center justify-center p-2 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary] flex-shrink-0",title:"Importar imagen de fondo",children:g.jsx(Ty,{className:"w-5 h-5"})}),g.jsx("input",{id:"canvas-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:I}),N&&g.jsx("button",{onClick:_,className:"h-10 w-10 flex-shrink-0 p-2 rounded-lg bg-red-800 hover:bg-red-700 cursor-pointer text-gray-200",title:"Eliminar imagen de fondo",children:g.jsx(oa,{className:"w-5 h-5"})})]})})]})]})},el=(t,e,n)=>{const s=n.getBoundingClientRect(),r=t.clientX-s.left,a=t.clientY-s.top;return{x:(r-e.pan.x)/e.zoom,y:(a-e.pan.y)/e.zoom}},vT=(t,e,n)=>{const s=r=>`0${Math.round(r).toString(16)}`.slice(-2);return`#${s(t)}${s(e)}${s(n)}`},uO=(t,e,n)=>{const s=n.x-e.x,r=n.y-e.y;if(s===0&&r===0)return e;const a=s*s+r*r,c=((t.x-e.x)*s+(t.y-e.y)*r)/a,d=e.x+c*s,f=e.y+c*r;return{x:d,y:f}},vm=(t,e)=>{const{start:n,end:s}=t,{start:r,end:a}=e,c=(n.x-s.x)*(r.y-a.y)-(n.y-s.y)*(r.x-a.x);if(c===0)return null;const f=((n.x-r.x)*(r.y-a.y)-(n.y-r.y)*(r.x-a.x))/c;return{x:n.x+f*(s.x-n.x),y:n.y+f*(s.y-n.y)}},fi=(t,e,n)=>Math.hypot(t.x-e.x,t.y-e.y)<n,dO=(t,e,n)=>{const s=(e.x-n.x)**2+(e.y-n.y)**2;if(s===0)return Math.hypot(t.x-e.x,t.y-e.y);let r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/s;r=Math.max(0,Math.min(1,r));const a={x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)};return Math.hypot(t.x-a.x,t.y-a.y)},tf=(t,e=1)=>{const n=t.getContext("2d",{willReadFrequently:!0});if(!n)return null;try{const r=n.getImageData(0,0,t.width,t.height).data;let a=t.width,c=t.height,d=-1,f=-1;for(let h=0;h<t.height;h++)for(let _=0;_<t.width;_++)r[(h*t.width+_)*4+3]>=e&&(a=Math.min(a,_),c=Math.min(c,h),d=Math.max(d,_),f=Math.max(f,h));return d===-1?null:{x:a,y:c,width:d-a+1,height:f-c+1}}catch(s){return console.error("Could not get canvas image data, it may be tainted.",s),{x:0,y:0,width:t.width,height:t.height}}},cr=t=>{t.save(),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.restore()};function hO(t,e){const n=t.length;for(let r=0;r<n;r++){let a=r;for(let c=r+1;c<n;c++)Math.abs(t[c][r])>Math.abs(t[a][r])&&(a=c);if([t[r],t[a]]=[t[a],t[r]],[e[r],e[a]]=[e[a],e[r]],Math.abs(t[r][r])<=1e-10)return null;for(let c=r+1;c<n;c++){const d=t[c][r]/t[r][r];e[c]-=d*e[r];for(let f=r;f<n;f++)t[c][f]-=d*t[r][f]}}const s=new Array(n);for(let r=n-1;r>=0;r--){let a=0;for(let c=r+1;c<n;c++)a+=t[r][c]*s[c];s[r]=(e[r]-a)/t[r][r]}return s}function WS(t,e){if(t.length!==4||e.length!==4)return null;const n=[];for(let a=0;a<4;a++){const{x:c,y:d}=t[a],{x:f,y:h}=e[a];n.push([c,d,1,0,0,0,-f*c,-f*d]),n.push([0,0,0,c,d,1,-h*c,-h*d])}const s=[];for(const{x:a,y:c}of e)s.push(a,c);const r=hO(n,s);return r?[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],1]:null}const fO=(t,e)=>{const n="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)",s=WS(t,e);if(!s)return n;const r=[[s[0],s[1],s[2]],[s[3],s[4],s[5]],[s[6],s[7],1]];return`matrix3d(${[r[0][0],r[1][0],0,r[2][0],r[0][1],r[1][1],0,r[2][1],0,0,1,0,r[0][2],r[1][2],0,1].join(", ")})`},pO=(t,e)=>{let n=!1;for(let s=0,r=e.length-1;s<e.length;r=s++){const a=e[s].x,c=e[s].y,d=e[r].x,f=e[r].y;c>t.y!=f>t.y&&t.x<(d-a)*(t.y-c)/(f-c)+a&&(n=!n)}return n},Lc=t=>{const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d",{willReadFrequently:!0});return n&&n.drawImage(t,0,0),e},_T=t=>{const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("Failed to get 2D context for cloned canvas");return n.drawImage(t,0,0),{canvas:e,context:n}},Os=(t,e)=>{const n=document.createElement("canvas");n.width=t,n.height=e;const s=n.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("Failed to get 2D context");return{canvas:n,context:s}},mO=(t,e,n)=>new Promise((s,r)=>{const a=document.createElement("canvas"),c=a.getContext("2d");if(!c)return r(new Error("Could not create thumbnail context"));const d=t.width/t.height;let f=e,h=f/d;h>n&&(h=n,f=h*d),a.width=f,a.height=h,c.drawImage(t,0,0,t.width,t.height,0,0,f,h),a.toBlob(_=>{_?s(_):r(new Error("Canvas toBlob returned null"))},"image/png",.9)});function xT(t,e,n,s,r,a,c,d,f){if(s<128&&d<128)return!0;if(s<128||d<128)return!1;const h=(f/100*255)**2*3;return(t-r)**2+(e-a)**2+(n-c)**2<=h}function gO(t,e,n,s,r){const{width:a,height:c,data:d}=t;if(e<0||e>=a||n<0||n>=c)return null;const f=(n*a+e)*4,h=d[f],_=d[f+1],b=d[f+2],E=d[f+3],S=new Uint8Array(a*c);let L=a,U=c,F=-1,z=-1;if(r){if(E<128)return null;const j=[[e,n]];S[n*a+e]=1;let H=0;for(;H<j.length;){const[Y,K]=j[H++];L=Math.min(L,Y),U=Math.min(U,K),F=Math.max(F,Y),z=Math.max(z,K);const R=[[Y,K-1],[Y+1,K],[Y,K+1],[Y-1,K]];for(const[T,N]of R)if(T>=0&&T<a&&N>=0&&N<c){const I=N*a+T;if(S[I]===0){const D=I*4;xT(h,_,b,E,d[D],d[D+1],d[D+2],d[D+3],s)&&(S[I]=1,j.push([T,N]))}}}}else for(let j=0;j<c;j++)for(let H=0;H<a;H++){const Y=(j*a+H)*4;xT(h,_,b,E,d[Y],d[Y+1],d[Y+2],d[Y+3],s)&&(S[j*a+H]=1,L=Math.min(L,H),U=Math.min(U,j),F=Math.max(F,H),z=Math.max(z,j))}if(F===-1)return null;const q=new Path2D;for(let j=0;j<c;j++)for(let H=0;H<a;H++)if(S[j*a+H]===1){let Y=H;for(;H+1<a&&S[j*a+(H+1)]===1;)H++;q.rect(Y,j,H-Y+1,1)}return{path:q,bbox:{x:L,y:U,width:F-L+1,height:z-U+1}}}class yr{constructor(){this.points=[],this.beforeCanvas=null,this.isDrawing=!1,this.strokeSeed=0,this.smoothing=0}updateSmoothing(e){this.smoothing=e}onPointerDown(e,n){var s;this.strokeSeed=e.x*1337+e.y*31337+Date.now(),this.isDrawing=!0,this.points=[e],this.beforeCanvas=document.createElement("canvas"),this.beforeCanvas.width=n.mainCtx.canvas.width,this.beforeCanvas.height=n.mainCtx.canvas.height,(s=this.beforeCanvas.getContext("2d"))==null||s.drawImage(n.mainCtx.canvas,0,0),this.onStrokeStart&&this.onStrokeStart(e,n)}onPointerMove(e,n){if(this.isDrawing){if(this.smoothing>0&&this.points.length>0){const s=this.points[this.points.length-1],r={x:s.x+(e.x-s.x)*(1-this.smoothing),y:s.y+(e.y-s.y)*(1-this.smoothing),pressure:e.pressure!==void 0?s.pressure!==void 0?s.pressure+(e.pressure-s.pressure)*(1-this.smoothing):e.pressure:void 0};this.points.push(r)}else this.points.push(e);this.updatePreview(n)}}onPointerUp(e){if(!this.isDrawing||!this.beforeCanvas)return;this.isDrawing=!1;const n=e.mainCtx;this.drawWithMirroring(n,this.points,e),e.onDrawCommit(e.activeItemId,this.beforeCanvas),this.clearPreview(e),this.reset()}onPointerCancel(e){if(e)this.onPointerUp(e);else{if(!this.isDrawing)return;this.isDrawing=!1,this.reset()}}updatePreview(e){const{previewCtx:n,viewTransform:s}=e;if(this.drawSegment&&this.points.length>1){const r=this.points[this.points.length-2],a=this.points[this.points.length-1];this.drawWithMirroringSegment(n,r,a,e)}else this.clearPreview(e),n.save(),n.setTransform(s.zoom,0,0,s.zoom,s.pan.x,s.pan.y),this.drawWithMirroring(n,this.points,e),n.restore()}clearPreview(e){const{previewCtx:n}=e;(!this.drawSegment||!this.isDrawing)&&cr(n)}reset(){this.points=[],this.beforeCanvas=null,this.isDrawing=!1,this.strokeSeed=0}drawWithMirroring(e,n,s){e.save();try{this.drawStroke(e,n,s)}finally{e.restore()}const{activeGuide:r,mirrorGuides:a}=s;r==="mirror"&&a.length>0&&a.forEach(c=>{e.save();try{const[d,f]=[c.start,c.end],h=f.x-d.x,_=f.y-d.y,b=Math.atan2(_,h);e.translate(d.x,d.y),e.rotate(b),e.scale(1,-1),e.rotate(-b),e.translate(-d.x,-d.y),this.drawStroke(e,n,s)}finally{e.restore()}})}drawWithMirroringSegment(e,n,s,r){if(!this.drawSegment)return;e.save(),e.setTransform(r.viewTransform.zoom,0,0,r.viewTransform.zoom,r.viewTransform.pan.x,r.viewTransform.pan.y);try{this.drawSegment(e,n,s,r)}finally{e.restore()}const{activeGuide:a,mirrorGuides:c,viewTransform:d}=r;a==="mirror"&&c.length>0&&c.forEach(f=>{e.save(),e.setTransform(d.zoom,0,0,d.zoom,d.pan.x,d.pan.y);try{const[h,_]=[f.start,f.end],b=_.x-h.x,E=_.y-h.y,S=Math.atan2(E,b);e.translate(h.x,h.y),e.rotate(S),e.scale(1,-1),e.rotate(-S),e.translate(-h.x,-h.y),this.drawSegment(e,n,s,r)}finally{e.restore()}})}}class wy extends yr{constructor(e){super(),this.incrementalState={patternPos:0,patternIndex:0,isDrawingDash:!0},this.settings=e}updateSettings(e){this.settings=e}onStrokeStart(e,n){this.incrementalState={patternPos:0,patternIndex:0,isDrawingDash:!0}}drawSegment(e,n,s,r){this.setupContext(e);const{strokeModifier:a}=r,c=this.getDashPattern(a.style,a.scale);this.drawInterpolatedLine(e,n,s,this.incrementalState,c)}drawStroke(e,n,s){if(this.setupContext(e),n.length<1)return;const{strokeModifier:r}=s,a=this.getDashPattern(r.style,r.scale);if(n.length===1){a||this.drawDab(e,n[0],n[0].pressure??1);return}const c={patternPos:0,patternIndex:0,isDrawingDash:!0};for(let d=1;d<n.length;d++)this.drawInterpolatedLine(e,n[d-1],n[d],c,a)}setupContext(e){const{color:n,lineCap:s,lineJoin:r,opacity:a}=this.settings;e.lineCap=s,e.lineJoin=r,e.globalAlpha=a,e.globalCompositeOperation="source-over",e.fillStyle=n}getDashPattern(e,n){switch(e){case"dashed":return[10*n,5*n];case"dotted":return[2*n,4*n];case"dash-dot":return[10*n,4*n,2*n,4*n];default:return null}}drawDab(e,n,s){const{size:r,pressureControl:a}=this.settings,c=s&&a.size?s*r:r;c>.5&&(e.beginPath(),e.arc(n.x,n.y,c/2,0,Math.PI*2),e.fill())}drawInterpolatedLine(e,n,s,r,a){const{size:c}=this.settings,d=Math.hypot(s.x-n.x,s.y-n.y),f=Math.atan2(s.y-n.y,s.x-n.x),h=n.pressure??1,_=s.pressure??1,b=c*Math.min(h,_)*.5,E=Math.max(.25,b*.2);for(let S=0;S<d;S+=E){const L=!a||r.isDrawingDash;if(a&&(r.patternPos+=E,r.patternPos>=a[r.patternIndex]&&(r.patternPos-=a[r.patternIndex],r.patternIndex=(r.patternIndex+1)%a.length,r.isDrawingDash=!r.isDrawingDash)),L){const U=d>0?S/d:0,F=n.x+Math.cos(f)*S,z=n.y+Math.sin(f)*S,q=h+(_-h)*U;this.drawDab(e,{x:F,y:z},q)}}}}class yO extends yr{constructor(e){super(),this.settings=e}updateSettings(e){this.settings=e}updatePreview(e){const{previewCtx:n,mainCtx:s,viewTransform:r}=e;this.clearPreview(e),n.save(),n.setTransform(r.zoom,0,0,r.zoom,r.pan.x,r.pan.y),n.drawImage(s.canvas,0,0),this.drawWithMirroring(n,this.points,e),n.restore()}drawStroke(e,n,s){e.globalCompositeOperation="destination-out";const{size:r,hardness:a,tipShape:c,opacity:d}=this.settings;if(n.length===0)return;const f=_=>{if(e.beginPath(),c==="round"?e.arc(_.x,_.y,r/2,0,Math.PI*2):e.rect(_.x-r/2,_.y-r/2,r,r),a>=100)e.fillStyle=`rgba(0,0,0,${d})`;else{const b=e.createRadialGradient(_.x,_.y,r/2*(a/100),_.x,_.y,r/2);b.addColorStop(0,`rgba(0,0,0,${d})`),b.addColorStop(1,"rgba(0,0,0,0)"),e.fillStyle=b}e.fill()};if(n.length===1){f(n[0]);return}let h=n[0];for(let _=1;_<n.length;_++){const b=n[_],E=Math.hypot(b.x-h.x,b.y-h.y),S=Math.atan2(b.y-h.y,b.x-h.x),L=Math.max(1,r*.1);for(let U=0;U<E;U+=L){const F=h.x+Math.cos(S)*U,z=h.y+Math.sin(S)*U;f({x:F,y:z})}h=b}}}class vO extends yr{constructor(e){super(),this.settings=e}updateSettings(e){this.settings=e}drawStroke(e,n,s){const{color:r,tipShape:a,size:c,blendMode:d,opacity:f,pressureControl:h}=this.settings,{strokeModifier:_}=s;if(e.strokeStyle=r,e.lineCap=a==="line"?"butt":"square",e.lineJoin="miter",e.lineWidth=c,e.globalCompositeOperation=d,n.length<2)return;const E=((S,L)=>{if(S==="solid")return null;const U=F=>F*L*Math.max(1,c/5);switch(S){case"dashed":return[U(10),U(5)];case"dotted":return[U(1),U(4)];case"dash-dot":return[U(10),U(4),U(2),U(4)];default:return null}})(_.style,_.scale);if(E){e.setLineDash(E),e.globalAlpha=f,e.beginPath(),e.moveTo(n[0].x,n[0].y);for(let S=1;S<n.length;S++)e.lineTo(n[S].x,n[S].y);e.stroke(),e.setLineDash([])}else for(let S=1;S<n.length;S++){const L=n[S-1],U=n[S],F=U.pressure??1;let z=f;h.opacity&&(z*=F),e.globalAlpha=z,e.beginPath(),e.moveTo(L.x,L.y),e.lineTo(U.x,U.y),e.stroke()}}}class _O extends yr{constructor(e){super(),this.settings=e,this.pencilEquivalent=new wy({...e,lineCap:"round",lineJoin:"round",hasStrokeCaps:!0})}updateSettings(e){this.settings=e,this.pencilEquivalent.updateSettings({...e,lineCap:"round",lineJoin:"round",hasStrokeCaps:!0})}drawStroke(e,n,s){this.pencilEquivalent.drawStroke(e,n,s)}}class xO extends yr{constructor(e){super(),this.settings=e}updateSettings(e){this.settings=e}drawStroke(e,n,s){e.globalCompositeOperation="source-over";const{size:r,flow:a,color:c}=this.settings;if(n.length===0)return;const d=h=>{const _=e.createRadialGradient(h.x,h.y,0,h.x,h.y,r/2);e.strokeStyle,e.fillStyle=c;const b=parseInt(e.fillStyle.slice(1,3),16),E=parseInt(e.fillStyle.slice(3,5),16),S=parseInt(e.fillStyle.slice(5,7),16);_.addColorStop(0,`rgba(${b},${E},${S},${a})`),_.addColorStop(1,`rgba(${b},${E},${S},0)`),e.fillStyle=_,e.beginPath(),e.arc(h.x,h.y,r/2,0,Math.PI*2),e.fill()};if(n.length===1){d(n[0]);return}let f=n[0];for(let h=1;h<n.length;h++){const _=n[h],b=Math.hypot(_.x-f.x,_.y-f.y),E=Math.atan2(_.y-f.y,_.x-f.x),S=Math.max(1,r*.1);for(let L=0;L<b;L+=S){const U=f.x+Math.cos(E)*L,F=f.y+Math.sin(E)*L;d({x:U,y:F})}f=_}}}class bO extends yr{constructor(e){super(),this.settings=e,this.pencilEquivalent=new wy({...e,lineCap:"round",lineJoin:"round",hasStrokeCaps:!0,pressureControl:{size:!0}})}updateSettings(e){this.settings=e,this.pencilEquivalent.updateSettings({...e,lineCap:"round",lineJoin:"round",hasStrokeCaps:!0,pressureControl:{size:!0}})}drawStroke(e,n,s){this.pencilEquivalent.drawStroke(e,n,s)}}class EO extends yr{constructor(){super()}drawStroke(e,n,s){}}class TO extends yr{constructor(e){super(),this.settings=e}updateSettings(e){this.settings=e}drawStroke(e,n,s){const{color:r,size:a,hardness:c,flow:d,blendMode:f,pressureControl:h,spacing:_}=this.settings,{strokeModifier:b}=s;if(e.globalCompositeOperation=f,n.length<1)return;const E=R=>{const T=document.createElement("canvas").getContext("2d");if(T){T.fillStyle=R,T.fillRect(0,0,1,1);const N=T.getImageData(0,0,1,1).data;return[N[0],N[1],N[2]]}return[0,0,0]},[S,L,U]=E(r),F=(R,T)=>{const N=h.size?T*a:a;if(N<.5)return;const I=h.flow?T*(d/100):d/100;if(e.beginPath(),c>=100)e.arc(R.x,R.y,N/2,0,Math.PI*2),e.fillStyle=`rgba(${S},${L},${U},${I})`;else{const D=e.createRadialGradient(R.x,R.y,N/2*(c/100),R.x,R.y,N/2);D.addColorStop(0,`rgba(${S},${L},${U},${I})`),D.addColorStop(1,`rgba(${S},${L},${U},0)`),e.fillStyle=D,e.arc(R.x,R.y,N/2,0,Math.PI*2)}e.fill()},q=((R,T)=>{switch(R){case"dashed":return[10*T,5*T];case"dotted":return[2*T,4*T];case"dash-dot":return[10*T,4*T,2*T,4*T];default:return null}})(b.style,b.scale);if(n.length===1){q||F(n[0],n[0].pressure??1);return}let j=n[0],H=0,Y=0,K=!0;for(let R=1;R<n.length;R++){const T=n[R],N=Math.hypot(T.x-j.x,T.y-j.y),I=Math.atan2(T.y-j.y,T.x-j.x),D=j.pressure??1,k=T.pressure??1,M=Math.max(1,a*(_/100));for(let ce=0;ce<N;ce+=M){const ge=!q||K;if(q&&(H+=M,H>=q[Y]&&(H-=q[Y],Y=(Y+1)%q.length,K=!K)),ge){const $=N>0?ce/N:0,G=j.x+Math.cos(I)*ce,ae=j.y+Math.sin(I)*ce,ve=D+(k-D)*$;F({x:G,y:ae},ve)}}j=T}}}function wO(t){return function(){var e=t+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}}class CO extends yr{constructor(e){super(),this.settings=e}updateSettings(e){this.settings=e}drawStroke(e,n,s){const r=wO(this.strokeSeed),{color:a,size:c,flow:d,wetness:f,pressureControl:h}=this.settings,{strokeModifier:_}=s;if(e.globalCompositeOperation="source-over",n.length<1)return;const b=K=>{const R=document.createElement("canvas").getContext("2d");if(R){R.fillStyle=K,R.fillRect(0,0,1,1);const T=R.getImageData(0,0,1,1).data;return[T[0],T[1],T[2]]}return[0,0,0]},[E,S,L]=b(a),U=(K,R)=>{const T=h.size?R*c:c;if(T<1)return;const N=h.flow?R*(d/100):d/100,I=Math.max(1,Math.floor(N*5));for(let D=0;D<I;D++){const k=(r()-.5)*T*.4,M=(r()-.5)*T*.4,ce=K.x+k,ge=K.y+M,$=T*(.8+r()*.4),G=f/100*(.5+r()*.5),ae=e.createRadialGradient(ce,ge,0,ce,ge,$/2);ae.addColorStop(0,`rgba(${E},${S},${L},${G})`),ae.addColorStop(1,`rgba(${E},${S},${L},0)`),e.fillStyle=ae,e.beginPath(),e.arc(ce,ge,$/2,0,Math.PI*2),e.fill()}},z=((K,R)=>{switch(K){case"dashed":return[10*R,5*R];case"dotted":return[2*R,4*R];case"dash-dot":return[10*R,4*R,2*R,4*R];default:return null}})(_.style,_.scale);if(n.length===1){z||U(n[0],n[0].pressure??1);return}let q=n[0],j=0,H=0,Y=!0;for(let K=1;K<n.length;K++){const R=n[K],T=Math.hypot(R.x-q.x,R.y-q.y),N=Math.atan2(R.y-q.y,R.x-q.x),I=q.pressure??1,D=R.pressure??1,k=Math.max(1,c*.2);for(let M=0;M<T;M+=k){const ce=!z||Y;if(z&&(j+=k,j>=z[H]&&(j-=z[H],H=(H+1)%z.length,Y=!Y)),ce){const ge=T>0?M/T:0,$=q.x+Math.cos(N)*M,G=q.y+Math.sin(N)*M,ae=I+(D-I)*ge;U({x:$,y:G},ae)}}q=R}}}function SO({brushSettings:t,eraserSettings:e,simpleMarkerSettings:n,naturalMarkerSettings:s,airbrushSettings:r,fxBrushSettings:a,advancedMarkerSettings:c,watercolorSettings:d}){const f=P.useMemo(()=>({brush:new wy(t),eraser:new yO(e),"simple-marker":new vO(n),"natural-marker":new _O(s),airbrush:new xO(r),"fx-brush":new bO(a),"debug-brush":new EO,"advanced-marker":new TO(c),watercolor:new CO(d)}),[]);return f.brush.updateSettings(t),f.eraser.updateSettings(e),f["simple-marker"].updateSettings(n),f["natural-marker"].updateSettings(s),f.airbrush.updateSettings(r),f["fx-brush"].updateSettings(a),f["advanced-marker"].updateSettings(c),f.watercolor.updateSettings(d),{getBrushForTool:_=>f[_]||null}}function AO({mainCanvasRef:t,guideCanvasRef:e,uiCanvasRef:n,items:s,viewTransform:r,activeItemId:a,activeGuide:c,isOrthogonalVisible:d,rulerGuides:f,mirrorGuides:h,perspectiveGuide:_,orthogonalGuide:b,gridGuide:E,isCropping:S,cropRect:L,isTransforming:U,transformState:F,transformSourceBbox:z,livePreviewLayerId:q}){const j=P.useRef({vpGreen:null,vpRed:null,vpBlue:null}),H=P.useCallback(T=>{if(E.type==="none"||E.spacing<=0)return;const N={x:-r.pan.x/r.zoom,y:-r.pan.y/r.zoom,width:T.canvas.width/r.zoom,height:T.canvas.height/r.zoom},{spacing:I,majorLineFrequency:D,type:k,isoAngle:M,majorLineColor:ce,minorLineColor:ge}=E;T.lineWidth=.5/r.zoom;const $=ge,G=ce;if(k==="cartesian"){const ae=Math.floor(N.x/I)*I,ve=N.x+N.width,X=Math.floor(N.y/I)*I,O=N.y+N.height;let Q=Math.round(ae/I);for(let ie=ae;ie<=ve;ie+=I)T.strokeStyle=Q%D===0?G:$,T.beginPath(),T.moveTo(ie,N.y),T.lineTo(ie,O),T.stroke(),Q++;let te=Math.round(X/I);for(let ie=X;ie<=O;ie+=I)T.strokeStyle=te%D===0?G:$,T.beginPath(),T.moveTo(N.x,ie),T.lineTo(ve,ie),T.stroke(),te++}else if(k==="isometric"){const ae=Math.hypot(N.width,N.height)*1.2,ve={x:N.x+N.width/2,y:N.y+N.height/2};[90*(Math.PI/180),(90-M)*(Math.PI/180),(90+M)*(Math.PI/180)].forEach(O=>{const Q=Math.cos(O),te=Math.sin(O),ie=Math.cos(O+Math.PI/2),Ce=Math.sin(O+Math.PI/2),be=ve.x*ie+ve.y*Ce,Fe=Math.floor((be-ae/2)/I),Ue=Math.ceil((be+ae/2)/I);for(let Oe=Fe;Oe<=Ue;Oe++){const tt=Oe*I,Ot={x:tt*ie,y:tt*Ce},vt={x:Ot.x-ae*Q,y:Ot.y-ae*te},Ae={x:Ot.x+ae*Q,y:Ot.y+ae*te};T.strokeStyle=Oe%D===0?G:$,T.beginPath(),T.moveTo(vt.x,vt.y),T.lineTo(Ae.x,Ae.y),T.stroke()}})}},[E,r]),Y=P.useCallback(()=>{var D;const T=(D=t.current)==null?void 0:D.getContext("2d");if(!T)return;T.save(),T.setTransform(1,0,0,1,0,0),T.clearRect(0,0,T.canvas.width,T.canvas.height),T.restore(),T.save(),T.setTransform(r.zoom,0,0,r.zoom,r.pan.x,r.pan.y);const N=s.find(k=>k.type==="object"&&k.isBackground),I=s.filter(k=>k.type==="object"&&!k.isBackground);N&&N.canvas&&N.isVisible&&(T.globalAlpha=N.opacity,T.drawImage(N.canvas,N.offsetX||0,N.offsetY||0)),H(T),I.forEach(k=>{if(!k.isVisible)return;const M=k.id===q;U&&k.id===a||M||k.canvas&&(T.globalAlpha=k.opacity,T.drawImage(k.canvas,k.offsetX||0,k.offsetY||0))}),T.restore()},[s,r,a,U,q,H]),K=P.useCallback(()=>{var D;const T=(D=e.current)==null?void 0:D.getContext("2d");if(!T)return;T.save(),T.setTransform(1,0,0,1,0,0),T.clearRect(0,0,T.canvas.width,T.canvas.height),T.restore(),T.save(),T.translate(r.pan.x,r.pan.y),T.scale(r.zoom,r.zoom);const N=8/r.zoom,I={x:-r.pan.x/r.zoom,y:-r.pan.y/r.zoom,width:T.canvas.width/r.zoom,height:T.canvas.height/r.zoom};if(c==="ruler"&&f&&f.forEach(k=>{T.strokeStyle="cyan",T.lineWidth=1/r.zoom,T.beginPath(),T.moveTo(k.start.x,k.start.y),T.lineTo(k.end.x,k.end.y),T.stroke(),T.fillStyle="cyan";const M={x:(k.start.x+k.end.x)/2,y:(k.start.y+k.end.y)/2};[k.start,k.end,M].forEach(ce=>{T.beginPath(),T.arc(ce.x,ce.y,N,0,2*Math.PI),T.fill()})}),c==="mirror"&&h&&h.forEach(k=>{T.strokeStyle="rgba(139, 0, 255, 0.8)",T.lineWidth=1/r.zoom,T.setLineDash([5/r.zoom,5/r.zoom]),T.beginPath(),T.moveTo(k.start.x,k.start.y),T.lineTo(k.end.x,k.end.y),T.stroke(),T.setLineDash([]),T.fillStyle="rgba(139, 0, 255, 0.8)";const M={x:(k.start.x+k.end.x)/2,y:(k.start.y+k.end.y)/2};[k.start,k.end,M].forEach(ce=>{T.beginPath(),T.arc(ce.x,ce.y,N,0,2*Math.PI),T.fill()})}),d&&b){const k={x:I.x+I.width/2,y:I.y+I.height/2},M=Math.max(I.width,I.height)*1.5;T.save(),T.translate(k.x,k.y),T.rotate(b.angle*Math.PI/180),T.strokeStyle="rgba(255, 165, 0, 0.7)",T.lineWidth=1/r.zoom,T.setLineDash([5/r.zoom,5/r.zoom]),T.beginPath(),T.moveTo(-M/2,0),T.lineTo(M/2,0),T.moveTo(0,-M/2),T.lineTo(0,M/2),T.stroke(),T.restore(),T.setLineDash([])}if(c==="perspective"&&_){const{lines:k,guidePoint:M,extraGuideLines:ce}=_,ge=Math.hypot(I.width,I.height)*10,$=vm(k.green[0],k.green[1]),G=vm(k.red[0],k.red[1]),ae=vm(k.blue[0],k.blue[1]);if(j.current={vpGreen:$,vpRed:G,vpBlue:ae},$&&G){T.strokeStyle="rgba(255, 255, 0, 0.7)",T.lineWidth=1.5/r.zoom,T.setLineDash([8/r.zoom,4/r.zoom]),T.beginPath();const X=G.x-$.x,O=G.y-$.y,Q=Math.hypot(X,O)||1;T.moveTo($.x-X/Q*ge,$.y-O/Q*ge),T.lineTo(G.x+X/Q*ge,G.y+O/Q*ge),T.stroke(),T.setLineDash([])}const ve=(X,O,Q,te)=>{const ie=X.replace("0.5","0.4"),Ce=X,be=X;O&&(T.strokeStyle=ie,T.lineWidth=.8/r.zoom,T.setLineDash([4/r.zoom,4/r.zoom]),[...Q.flatMap(Oe=>[Oe.start,Oe.end]),...te,M].forEach(Oe=>{T.beginPath(),T.moveTo(O.x,O.y),T.lineTo(Oe.x,Oe.y),T.stroke()}),T.setLineDash([])),T.strokeStyle=Ce,T.lineWidth=1/r.zoom,Q.forEach(Ue=>{T.beginPath(),T.moveTo(Ue.start.x,Ue.start.y),T.lineTo(Ue.end.x,Ue.end.y),T.stroke()}),T.fillStyle=be,[...Q.flatMap(Ue=>[Ue.start,Ue.end]),...te].forEach(Ue=>{T.beginPath(),T.arc(Ue.x,Ue.y,N,0,2*Math.PI),T.fill()})};if(ve("rgba(0, 255, 0, 0.5)",$,k.green,ce.green.map(X=>X.handle)),ve("rgba(255, 0, 0, 0.5)",G,k.red,ce.red.map(X=>X.handle)),ae)ve("rgba(0, 0, 255, 0.5)",ae,k.blue,ce.blue.map(X=>X.handle));else{const X="rgba(0, 0, 255, 0.5)",O="rgba(0, 0, 255, 0.4)";if(T.strokeStyle=O,T.lineWidth=.8/r.zoom,T.setLineDash([4/r.zoom,4/r.zoom]),k.blue.length>0){const te=k.blue[0],ie=Math.atan2(te.end.y-te.start.y,te.end.x-te.start.x),Ce=Math.cos(ie),be=Math.sin(ie);[...k.blue.flatMap(Ue=>[Ue.start,Ue.end]),...ce.blue.map(Ue=>Ue.handle),M].forEach(Ue=>{T.beginPath(),T.moveTo(Ue.x-Ce*ge,Ue.y-be*ge),T.lineTo(Ue.x+Ce*ge,Ue.y+be*ge),T.stroke()})}T.setLineDash([]),T.strokeStyle=X,T.lineWidth=1/r.zoom,k.blue.forEach(te=>{T.beginPath(),T.moveTo(te.start.x,te.start.y),T.lineTo(te.end.x,te.end.y),T.stroke()}),T.fillStyle=X,[...k.blue.flatMap(te=>[te.start,te.end]),...ce.blue.map(te=>te.handle)].forEach(te=>{T.beginPath(),T.arc(te.x,te.y,N,0,2*Math.PI),T.fill()})}T.fillStyle="yellow",T.strokeStyle="black",T.lineWidth=.5/r.zoom,T.beginPath(),T.arc(M.x,M.y,N*1.5,0,2*Math.PI),T.fill(),T.stroke()}T.restore()},[r,c,f,h,d,b,_]),R=P.useCallback(()=>{var I;const T=(I=n.current)==null?void 0:I.getContext("2d");if(!T)return;T.save(),T.setTransform(1,0,0,1,0,0),T.clearRect(0,0,T.canvas.width,T.canvas.height),T.restore(),T.save(),T.setTransform(r.zoom,0,0,r.zoom,r.pan.x,r.pan.y);const N=8/r.zoom;if(S&&L){T.strokeStyle="rgba(255, 255, 255, 0.7)",T.lineWidth=1/r.zoom,T.setLineDash([4/r.zoom,2/r.zoom]),T.strokeRect(L.x,L.y,L.width,L.height),T.setLineDash([]);const{x:D,y:k,width:M,height:ce}=L,ge=[{x:D,y:k},{x:D+M,y:k},{x:D,y:k+ce},{x:D+M,y:k+ce},{x:D+M/2,y:k},{x:D+M/2,y:k+ce},{x:D,y:k+ce/2},{x:D+M,y:k+ce/2}];T.fillStyle="white",T.strokeStyle="black",T.lineWidth=1/r.zoom,ge.forEach($=>{T.beginPath(),T.rect($.x-N/2,$.y-N/2,N,N),T.fill(),T.stroke()})}if(U&&F){T.lineWidth=1/r.zoom,T.strokeStyle="#00BFFF",T.fillStyle="white";const D=(k,M=!1)=>{T.strokeStyle="black",T.lineWidth=.5/r.zoom,T.beginPath(),M?T.arc(k.x,k.y,N/2,0,2*Math.PI):T.rect(k.x-N/2,k.y-N/2,N,N),T.fill(),T.stroke()};if(F.type==="affine"){const{x:k,y:M,width:ce,height:ge,rotation:$}=F,G={x:k+ce/2,y:M+ge/2};T.save(),T.translate(G.x,G.y),T.rotate($),T.strokeStyle="#00BFFF",T.lineWidth=1/r.zoom,T.strokeRect(-ce/2,-ge/2,ce,ge),T.restore();const ae=Math.cos($),ve=Math.sin($),X=ie=>({x:G.x+(ie.x-G.x)*ae-(ie.y-G.y)*ve,y:G.y+(ie.x-G.x)*ve+(ie.y-G.y)*ae}),O={tl:X({x:k,y:M}),tr:X({x:k+ce,y:M}),bl:X({x:k,y:M+ge}),br:X({x:k+ce,y:M+ge}),t:X({x:k+ce/2,y:M}),b:X({x:k+ce/2,y:M+ge}),l:X({x:k,y:M+ge/2}),r:X({x:k+ce,y:M+ge/2})};Object.values(O).forEach(ie=>D(ie));const Q=X({x:k+ce/2,y:M-25/r.zoom}),te=X({x:k+ce/2,y:M});T.strokeStyle="#00BFFF",T.lineWidth=1/r.zoom,T.beginPath(),T.moveTo(Q.x,Q.y),T.lineTo(te.x,te.y),T.stroke(),D(Q,!0)}else if(F.type==="free"){const{tl:k,tr:M,br:ce,bl:ge}=F.corners;T.strokeStyle="#00BFFF",T.lineWidth=1/r.zoom,T.beginPath(),T.moveTo(k.x,k.y),T.lineTo(M.x,M.y),T.lineTo(ce.x,ce.y),T.lineTo(ge.x,ge.y),T.closePath(),T.stroke(),[k,M,ce,ge].forEach($=>D($))}}T.restore()},[r,S,L,U,F]);return{redrawMainCanvas:Y,redrawGuides:K,redrawUI:R,perspectiveVPs:j}}function bT(t){if(t.length<3)return t;const e=[],[n,s,r]=t;for(let a=0;a<=1;a+=.01){const c=(1-a)**2*n.x+2*(1-a)*a*s.x+a**2*r.x,d=(1-a)**2*n.y+2*(1-a)*a*s.y+a**2*r.y,f=n.pressure??1,h=s.pressure??f+((r.pressure??1)-f)/2,_=r.pressure??1,b=(1-a)**2*f+2*(1-a)*a*h+a**2*_;e.push({x:c,y:d,pressure:b})}return e}function ET(t,e){if(t.length<3)return t;const[n,s,r]=t,a=Math.hypot(s.x-n.x,s.y-n.y),c=Math.atan2(s.y-n.y,s.x-n.x);let d;if(e!==void 0)d=e;else{const _=Math.atan2(r.y-n.y,r.x-n.x),b=Math.PI*2;d=_-c,d>Math.PI&&(d-=b),d<-Math.PI&&(d+=b)}const f=[],h=Math.max(10,Math.ceil(Math.abs(d*a)/2));for(let _=0;_<=h;_++){const b=_/h,E=c+d*b,S=n.x+a*Math.cos(E),L=n.y+a*Math.sin(E),U=(s.pressure??1)*(1-b)+(r.pressure??1)*b;f.push({x:S,y:L,pressure:U})}return f}function IO({items:t,uiCanvasRef:e,previewCanvasRef:n,viewTransform:s,setViewTransform:r,activeItem:a,tool:c,isDrawingTool:d,isSelectionTool:f,onDrawCommit:h,onSelectItem:_,getBrushForTool:b,areGuidesLocked:E,activeGuide:S,isOrthogonalVisible:L,rulerGuides:U,setRulerGuides:F,mirrorGuides:z,setMirrorGuides:q,perspectiveGuide:j,setPerspectiveGuide:H,perspectiveVPs:Y,orthogonalGuide:K,guideDragState:R,setGuideDragState:T,cropRect:N,setCropRect:I,transformState:D,setTransformState:k,isAspectRatioLocked:M,isAngleSnapEnabled:ce,angleSnapValue:ge,livePreviewLayerId:$,setLivePreviewLayerId:G,isPerspectiveStrokeLockEnabled:ae,isSnapToGridEnabled:ve,gridGuide:X,strokeMode:O,strokeState:Q,setStrokeState:te,magicWandSettings:ie,selection:Ce,setSelection:be,onUpdateItem:Fe,forceRender:Ue,getMinZoom:Oe,MAX_ZOOM:tt,onAddItem:Ot,textEditState:vt,setTextEditState:Ae,onCommitText:Ne,strokeSmoothing:Se,strokeModifier:De,setDebugPointers:et}){const We=P.useRef(null),it=P.useRef({type:"none"}),rt=P.useRef(null),St=P.useRef(null),_t=P.useRef(null),Gt=P.useRef(null),ct=P.useRef(new Map),Bt=P.useRef(null),qe=P.useRef(!1),ot=P.useRef(null),Vt=P.useRef(null),Pn=P.useRef(0);P.useEffect(()=>{const Ie=()=>{e.current&&(We.current=e.current.getBoundingClientRect())};return Ie(),window.addEventListener("resize",Ie),window.addEventListener("scroll",Ie,{capture:!0,passive:!0}),()=>{window.removeEventListener("resize",Ie),window.removeEventListener("scroll",Ie,{capture:!0})}},[e]);const rn=P.useCallback((Ie,Pe)=>{var we,Xe,at,Me;if(!We.current&&e.current&&(We.current=e.current.getBoundingClientRect()),!We.current)return{x:0,y:0};const ht=We.current,$e="clientX"in Ie?Ie.clientX:((Xe=(we=Ie.changedTouches)==null?void 0:we[0])==null?void 0:Xe.clientX)??0,At="clientY"in Ie?Ie.clientY:((Me=(at=Ie.changedTouches)==null?void 0:at[0])==null?void 0:Me.clientY)??0,wt=$e-ht.left,Qe=At-ht.top;return{x:(wt-Pe.pan.x)/Pe.zoom,y:(Qe-Pe.pan.y)/Pe.zoom}},[]),$t=Ie=>{it.current=Ie,Ue()};P.useEffect(()=>{var Ie;if(!Q){const Pe=(Ie=n.current)==null?void 0:Ie.getContext("2d");Pe&&cr(Pe)}},[Q,n]),P.useEffect(()=>{Gt.current=null},[c,O]);const on=P.useCallback(Ie=>{if(!ve||X.type==="none")return Ie;const{spacing:Pe}=X;if(X.type==="cartesian")return{...Ie,x:Math.round(Ie.x/Pe)*Pe,y:Math.round(Ie.y/Pe)*Pe};if(X.type==="isometric"){const ht=Pe,{x:$e,y:At}=Ie,wt=-30*(Math.PI/180),Qe=Math.cos(wt),we=Math.sin(wt),Xe=$e*Qe-At*we,at=$e*we+At*Qe,Me=ht*2/Math.sqrt(3),Re=(Xe*(Math.sqrt(3)/3)-at/3)/(Me/Math.sqrt(3)),Be=at*2/3/(Me/Math.sqrt(3)),fe=-Re-Be;let ee=Math.round(Re),de=Math.round(Be),Te=Math.round(fe);const Le=Math.abs(ee-Re),ze=Math.abs(de-Be),Ke=Math.abs(Te-fe);Le>ze&&Le>Ke?ee=-de-Te:ze>Ke&&(de=-ee-Te);const Ye=Me*(ee+de/2),dt=Me*(de*Math.sqrt(3)/2),It=30*(Math.PI/180),jt=Math.cos(It),Kt=Math.sin(It),Xt=Ye*jt-dt*Kt,En=Ye*Kt+dt*jt;return{...Ie,x:Xt,y:En}}return Ie},[ve,X]),Ln=P.useCallback(Ie=>{var Qe,we,Xe,at;if(!e.current||(We.current=e.current.getBoundingClientRect(),Ie.button!==0&&Ie.pointerType==="mouse"&&Ie.button!==1)||Ie.pointerType==="pen"&&Ie.pressure===0)return;if(ct.current.set(Ie.pointerId,{x:Ie.clientX,y:Ie.clientY}),et(new Map(ct.current)),ct.current.size>=2){if(qe.current=!0,(Qe=rt.current)!=null&&Qe.isDrawing){rt.current.onPointerCancel(null),rt.current=null;const Me=(we=n.current)==null?void 0:we.getContext("2d");Me&&cr(Me)}if(te(null),Vt.current&&clearTimeout(Vt.current),Bt.current=null,ct.current.size===2){const Me=Array.from(ct.current.values()),Re=Me[0],Be=Me[1],fe={x:(Re.x+Be.x)/2,y:(Re.y+Be.y)/2},ee=Be.x-Re.x,de=Be.y-Re.y,Te=Math.hypot(ee,de);ot.current={distance:Te,midpoint:fe,zoom:s.zoom,pan:s.pan},$t({type:"pan",startX:fe.x,startY:fe.y,startPan:s.pan})}else $t({type:"none"});return}const Pe=rn(Ie,s);let ht=on(Pe);if(S==="ruler"&&U.length>0){const Me=U[0],Re=Me.start,Be=Me.end,fe=ht,ee={x:Be.x-Re.x,y:Be.y-Re.y},de={x:fe.x-Re.x,y:fe.y-Re.y},Te=ee.x*ee.x+ee.y*ee.y;if(Te>0){const Le=(de.x*ee.x+de.y*ee.y)/Te;ht={x:Re.x+ee.x*Le,y:Re.y+ee.y*Le}}}const At=O==="freehand"&&Ie.pointerType==="pen"?Ie.pressure:1,wt={...ht,pressure:At};if(St.current=null,_t.current=null,!E){const Me=10/s.zoom;if(S==="ruler")for(const Re of U){if(fi(Pe,Re.start,Me)){T({type:"ruler",id:Re.id,part:"start",offset:{x:0,y:0}});return}if(fi(Pe,Re.end,Me)){T({type:"ruler",id:Re.id,part:"end",offset:{x:0,y:0}});return}}if(S==="mirror")for(const Re of z){if(fi(Pe,Re.start,Me)){T({type:"mirror",id:Re.id,part:"start",offset:{x:0,y:0}});return}if(fi(Pe,Re.end,Me)){T({type:"mirror",id:Re.id,part:"end",offset:{x:0,y:0}});return}if(dO(Pe,Re.start,Re.end)<Me){T({type:"mirror",id:Re.id,part:"line",offset:{x:Re.start.x-Pe.x,y:Re.start.y-Pe.y}});return}}if(S==="perspective"&&j){const{lines:Re,guidePoint:Be,extraGuideLines:fe}=j;if(fi(Pe,Be,Me*1.5)){T({type:"perspective-point",part:"point"});return}for(const ee of["green","red","blue"]){for(const de of Re[ee]){if(fi(Pe,de.start,Me)){T({type:"perspective",color:ee,lineId:de.id,part:"start"});return}if(fi(Pe,de.end,Me)){T({type:"perspective",color:ee,lineId:de.id,part:"end"});return}}for(const de of fe[ee])if(fi(Pe,de.handle,Me)){T({type:"perspective-extra",color:ee,id:de.id});return}}}}if(c==="crop"&&N){const Re=(fe=>({tl:{x:fe.x,y:fe.y},tr:{x:fe.x+fe.width,y:fe.y},bl:{x:fe.x,y:fe.y+fe.height},br:{x:fe.x+fe.width,y:fe.y+fe.height},t:{x:fe.x+fe.width/2,y:fe.y},b:{x:fe.x+fe.width/2,y:fe.y+fe.height},l:{x:fe.x,y:fe.y+fe.height/2},r:{x:fe.x+fe.width,y:fe.y+fe.height/2}}))(N),Be=10/s.zoom;for(const[fe,ee]of Object.entries(Re))if(ee&&fi(Pe,ee,Be)){$t({type:"crop",handle:fe,startRect:N,startPoint:Pe});return}if(Pe.x>N.x&&Pe.x<N.x+N.width&&Pe.y>N.y&&Pe.y<N.y+N.height){$t({type:"crop",handle:"move",startRect:N,startPoint:Pe});return}}if((c==="transform"||c==="free-transform")&&D){const Me=10/s.zoom;if(D.type==="affine"){const{x:Re,y:Be,width:fe,height:ee,rotation:de}=D,Te={x:Re+fe/2,y:Be+ee/2},Le=Math.cos(de),ze=Math.sin(de),Ke=dt=>({x:Te.x+(dt.x-Te.x)*Le-(dt.y-Te.y)*ze,y:Te.y+(dt.x-Te.x)*ze+(dt.y-Te.y)*Le}),Ye={tl:Ke({x:Re,y:Be}),tr:Ke({x:Re+fe,y:Be}),bl:Ke({x:Re,y:Be+ee}),br:Ke({x:Re+fe,y:Be+ee}),t:Ke({x:Re+fe/2,y:Be}),b:Ke({x:Re+fe/2,y:Be+ee}),l:Ke({x:Re,y:Be+ee/2}),r:Ke({x:Re+fe,y:Be+ee/2}),rotate:Ke({x:Re+fe/2,y:Be-25/s.zoom})};for(const[dt,It]of Object.entries(Ye))if(It&&fi(Pe,It,Me)){$t({type:"transform",handle:dt,startState:D,startPoint:Pe,center:Te});return}}else if(D.type==="free"){const Re=D.corners;for(const[Be,fe]of Object.entries(Re))if(fe&&fi(Pe,fe,Me)){$t({type:"transform",handle:Be,startState:D,startPoint:Pe});return}}if(D.type==="free"&&pO(Pe,Object.values(D.corners))){$t({type:"transform",handle:"move",startState:D,startPoint:Pe});return}if(D.type==="affine"){const Re={x:Pe.x-(D.x+D.width/2),y:Pe.y-(D.y+D.height/2)},Be={x:Re.x*Math.cos(-D.rotation)-Re.y*Math.sin(-D.rotation),y:Re.x*Math.sin(-D.rotation)+Re.y*Math.cos(-D.rotation)};if(Math.abs(Be.x)<D.width/2&&Math.abs(Be.y)<D.height/2){$t({type:"transform",handle:"move",startState:D,startPoint:Pe});return}}}if(c==="text"){vt&&Ne(vt),$t({type:"text-place"});return}if(f){if(be(null),c==="marquee-rect"||c==="lasso"){$t({type:"selection",tool:c,startPoint:ht,points:[ht]});return}else if(c==="magic-wand"){if(a&&a.type==="object"&&a.canvas){const Me=a.canvas,Re=Me.getContext("2d",{willReadFrequently:!0});if(!Re)return;try{const Be=Re.getImageData(0,0,Me.width,Me.height),fe=Math.floor(ht.x),ee=Math.floor(ht.y),de=gO(Be,fe,ee,ie.tolerance,ie.contiguous);de&&be({path:de.path,boundingBox:de.bbox,sourceItemId:a.id})}catch(Be){console.error("Could not get image data for magic wand.",Be),alert("Error: Could not perform magic wand selection. The canvas may be tainted by cross-origin content.")}}return}}if(d&&O==="line"){$t({type:"draw"}),Q||te({mode:"line",points:[wt]});return}if(d&&["polyline","curve","arc"].includes(O)){if(O==="polyline"&&(Vt.current&&clearTimeout(Vt.current),Vt.current=window.setTimeout(()=>{if(a&&a.type==="object"&&Q&&Q.points.length>1){const Me=Lc(a.canvas),Re=a.context,Be=b(c);if(Be){const fe={mainCtx:Re,previewCtx:n.current.getContext("2d"),viewTransform:s,onDrawCommit:h,activeItemId:a.id,activeGuide:S,mirrorGuides:z,strokeModifier:De};Be.drawWithMirroring(Re,Q.points,fe),h(a.id,Me)}}te(null),Vt.current=null},700)),!Q)te({mode:O,points:[wt]}),O==="arc"&&(Gt.current=null);else{const Me=[...Q.points,wt];te({...Q,points:Me});let Re=!1;if(O==="curve"&&Me.length===3&&(Re=!0),O==="arc"&&Me.length===3&&(Re=!0),Re&&(a==null?void 0:a.type)==="object"){const Be=Lc(a.canvas),fe=a.context,ee=b(c);if(ee){const de={mainCtx:fe,previewCtx:n.current.getContext("2d"),viewTransform:s,onDrawCommit:h,activeItemId:a.id,activeGuide:S,mirrorGuides:z,strokeModifier:De};let Te=Me;O==="curve"&&(Te=bT(Me)),O==="arc"&&(Te=ET(Me,(Xe=Gt.current)==null?void 0:Xe.totalAngle)),ee.drawWithMirroring(fe,Te,de),h(a.id,Be)}te(null)}}return}if(c==="pan"||Ie.button===1&&Ie.pointerType==="mouse"){$t({type:"pan",startX:Ie.clientX,startY:Ie.clientY,startPan:s.pan}),Ie.currentTarget.style.cursor="grabbing";return}if(d&&a&&a.type==="object"&&O==="freehand"){c==="eraser"&&G(a.id);const Me=b(c);if(!Me)return;if(Me.updateSmoothing(Se),rt.current=Me,$t({type:"draw"}),_t.current={axis:"x",startPoint:ht},ae&&S==="perspective"&&Y.current){const{vpGreen:fe,vpRed:ee,vpBlue:de}=Y.current,Te=[fe,ee,de].filter(Boolean);let Le=null,ze=1/0;Te.forEach(Ke=>{if(Ke){const Ye=(ht.x-Ke.x)**2+(ht.y-Ke.y)**2;Ye<ze&&(ze=Ye,Le=Ke)}}),St.current={startPoint:ht,targetVP:Le}}const Re=a.context,Be=(at=n.current)==null?void 0:at.getContext("2d");if(Re&&Be){const fe={mainCtx:Re,previewCtx:Be,viewTransform:s,onDrawCommit:h,activeItemId:a.id,activeGuide:S,mirrorGuides:z,strokeModifier:De};Me.onPointerDown(wt,fe)}}},[c,s,a,d,f,ie,be,N,S,U,z,j,E,H,F,q,T,Y,D,ae,on,O,Q,te,h,Ot,Ae,vt,Ne,b,Se,De,et]),an=P.useCallback(Ie=>{var at,Me,Re,Be;if(!e.current)return;const Pe=Ie.nativeEvent,ht=Pe.getCoalescedEvents?Pe.getCoalescedEvents():[Pe];for(const fe of ht)ct.current.has(fe.pointerId)&&ct.current.set(fe.pointerId,{x:fe.clientX,y:fe.clientY});const $e=Date.now();if($e-Pn.current>16&&(et(new Map(ct.current)),Pn.current=$e),ct.current.size>=2){const fe=Array.from(ct.current.values());if(fe.length<2)return;const[ee,de]=fe,Te={x:(ee.x+de.x)/2,y:(ee.y+de.y)/2},Le=de.x-ee.x,ze=de.y-ee.y,Ke=Math.hypot(Le,ze);ot.current||(ot.current={distance:Ke,midpoint:Te,zoom:s.zoom,pan:s.pan});const Ye=ot.current,dt=Ye.distance>0?Ke/Ye.distance:1;let It=Ye.zoom*dt;const jt=Oe?Oe():.1;It<jt&&(It=jt),It>tt&&(It=tt);const Kt=Ye.zoom>0?It/Ye.zoom:1,Xt=Te.x-(Ye.midpoint.x-Ye.pan.x)*Kt,En=Te.y-(Ye.midpoint.y-Ye.pan.y)*Kt;r(un=>({...un,zoom:It,pan:{x:Xt,y:En}})),qe.current=!0;return}const At=Pe.getCoalescedEvents?Pe.getCoalescedEvents():[Pe],wt=At[At.length-1],Qe=it.current;if(Qe.type==="draw"&&rt.current){const fe=a==null?void 0:a.context,ee=(at=n.current)==null?void 0:at.getContext("2d");if(fe&&ee&&a){const de={mainCtx:fe,previewCtx:ee,viewTransform:s,onDrawCommit:h,activeItemId:a.id,activeGuide:S,mirrorGuides:z,strokeModifier:De};for(const Te of At){const Le=rn(Te,s);let ze=Le,Ke=!1;if(L&&_t.current){const{startPoint:jt}=_t.current,Kt=Math.abs(Le.x-jt.x),Xt=Math.abs(Le.y-jt.y);(Kt>5||Xt>5)&&(Kt>Xt?_t.current.axis="x":_t.current.axis="y"),_t.current.axis==="x"?ze={...Le,y:jt.y}:ze={...Le,x:jt.x},Ke=!0}else if(S==="ruler"&&U.length>0){const jt=U[0],Kt=jt.start,Xt=jt.end,En=Le,un={x:Xt.x-Kt.x,y:Xt.y-Kt.y},xs={x:En.x-Kt.x,y:En.y-Kt.y},Xn=un.x*un.x+un.y*un.y;if(Xn>0){const Hn=(xs.x*un.x+xs.y*un.y)/Xn;ze={x:Kt.x+un.x*Hn,y:Kt.y+un.y*Hn}}Ke=!0}else ae&&S==="perspective"&&((Me=St.current)!=null&&Me.targetVP)&&(ze=uO(Le,St.current.startPoint,St.current.targetVP),Ke=!0);Ke||(ze=on(Le));const dt=O==="freehand"&&Te.pointerType==="pen"?Te.pressure:1,It={...ze,pressure:dt};rt.current.onPointerMove(It,de)}}return}const we=rn(wt,s);let Xe=we;if(R){R.type==="ruler"?F(fe=>fe.map(ee=>{if(ee.id===R.id){const de={...ee};if(R.part==="start")de.start=we;else if(R.part==="end")de.end=we;else if(R.part==="line"){const Te=ee.end.x-ee.start.x,Le=ee.end.y-ee.start.y;de.start.x=we.x+R.offset.x,de.start.y=we.y+R.offset.y,de.end.x=de.start.x+Te,de.end.y=de.start.y+Le}return de}return ee})):R.type==="mirror"?q(fe=>fe.map(ee=>{if(ee.id===R.id){const de={...ee};if(R.part==="start")de.start=we;else if(R.part==="end")de.end=we;else if(R.part==="line"){const Te=ee.end.x-ee.start.x,Le=ee.end.y-ee.start.y;de.start.x=we.x+R.offset.x,de.start.y=we.y+R.offset.y,de.end.x=de.start.x+Te,de.end.y=de.start.y+Le}return de}return ee})):(R.type==="perspective"||R.type==="perspective-point"||R.type==="perspective-extra")&&H(fe=>{if(!fe)return null;const ee=JSON.parse(JSON.stringify(fe));if(R.type==="perspective-point")ee.guidePoint=we;else if(R.type==="perspective-extra"){const de=ee.extraGuideLines[R.color].find(Te=>Te.id===R.id);de&&(de.handle=we)}else if(R.type==="perspective"){const de=ee.lines[R.color].find(Te=>Te.id===R.lineId);de&&(de[R.part]=we)}return ee});return}if(Xe=on(we),Q){const fe=(Re=n.current)==null?void 0:Re.getContext("2d");if(!fe)return;const ee=wt.pointerType==="pen"?wt.pressure:1,de={...Xe,pressure:ee};cr(fe),fe.save(),fe.setTransform(s.zoom,0,0,s.zoom,s.pan.x,s.pan.y);const Te=b(c);if(Te&&a){const Le={mainCtx:a.context,previewCtx:fe,viewTransform:s,onDrawCommit:h,activeItemId:a.id,activeGuide:S,mirrorGuides:z,strokeModifier:De};let ze;if(Q.mode==="line"?ze=[Q.points[0],de]:ze=[...Q.points,de],Q.mode==="curve"&&ze.length>=2)ze.length===3&&(ze=bT(ze));else if(Q.mode==="arc"&&ze.length>=2){const[Ke,Ye]=ze,dt=Math.hypot(Ye.x-Ke.x,Ye.y-Ke.y);if(fe.strokeStyle="rgba(0,0,0,0.4)",fe.lineWidth=1/s.zoom,fe.setLineDash([4/s.zoom,2/s.zoom]),fe.beginPath(),fe.arc(Ke.x,Ke.y,dt,0,2*Math.PI),fe.stroke(),fe.setLineDash([]),ze.length===3){const It=ze[2],jt=Math.atan2(It.y-Ke.y,It.x-Ke.x);if(!Gt.current)Gt.current={lastAngle:jt,totalAngle:0};else{let Kt=jt-Gt.current.lastAngle;Kt>Math.PI&&(Kt-=2*Math.PI),Kt<-Math.PI&&(Kt+=2*Math.PI),Gt.current.totalAngle+=Kt,Gt.current.lastAngle=jt}ze=ET(ze,Gt.current.totalAngle)}else ze=[Ye,Xe]}Te.drawWithMirroring(fe,ze,Le)}fe.restore();return}if(Qe.type==="pan"&&r(fe=>({...fe,pan:{x:fe.pan.x+wt.movementX,y:fe.pan.y+wt.movementY}})),Qe.type==="selection"){let fe;if(Qe.tool==="lasso"){fe=[...Qe.points];for(const de of At){const Te=el(de,s,e.current);fe.push(on(Te))}}else fe=[...Qe.points,Xe];$t({...Qe,points:fe});const ee=(Be=n.current)==null?void 0:Be.getContext("2d");if(!ee)return;if(cr(ee),ee.save(),ee.setTransform(s.zoom,0,0,s.zoom,s.pan.x,s.pan.y),ee.lineWidth=1/s.zoom,ee.strokeStyle="black",ee.setLineDash([4/s.zoom,4/s.zoom]),ee.beginPath(),Qe.tool==="marquee-rect"){const{startPoint:de}=Qe;ee.rect(de.x,de.y,Xe.x-de.x,Xe.y-de.y)}else{ee.moveTo(fe[0].x,fe[0].y);for(let de=1;de<fe.length;de++)ee.lineTo(fe[de].x,fe[de].y)}ee.stroke(),ee.restore();return}if(Qe.type,Qe.type==="transform"&&D){const fe=we;if(Qe.startState.type==="affine"){const{startState:ee,startPoint:de,handle:Te}=Qe,Le=Qe.center;let ze=fe.x-de.x,Ke=fe.y-de.y;if(Te==="rotate"&&Le){const Ye=Math.atan2(de.y-Le.y,de.x-Le.x),dt=Math.atan2(fe.y-Le.y,fe.x-Le.x);let It=ee.rotation+(dt-Ye);if(ce){const jt=ge*Math.PI/180;It=Math.round(It/jt)*jt}k({...ee,rotation:It})}else if(Te==="move")k({...ee,x:ee.x+ze,y:ee.y+Ke});else{const{rotation:Ye}=ee,dt=Math.cos(-Ye),It=Math.sin(-Ye),jt=ze*dt-Ke*It,Kt=ze*It+Ke*dt;let Xt=ee.width,En=ee.height;if(Te.includes("r")&&(Xt+=jt),Te.includes("l")&&(Xt-=jt),Te.includes("b")&&(En+=Kt),Te.includes("t")&&(En-=Kt),M&&(Xt!==ee.width||En!==ee.height)){const ps=ee.width/ee.height;Math.abs(Xt-ee.width)>Math.abs(En-ee.height)?En=Xt/ps:Xt=En*ps}let un=ee.x,xs=ee.y;const Xn=Xt-ee.width,Hn=En-ee.height,Jn=Math.cos(Ye),fs=Math.sin(Ye);let dn=0,Ns=0;Te.includes("l")&&(dn+=Xn),Te.includes("t")&&(Ns+=Hn);const ni=(dn*Jn-Ns*fs)/2,bs=(dn*fs+Ns*Jn)/2;un-=ni,xs-=bs,k({...ee,x:un,y:xs,width:Xt,height:En})}}else if(Qe.startState.type==="free"){const{handle:ee,startState:de,startPoint:Te}=Qe;if(de.type!=="free")return;const Le=fe.x-Te.x,ze=fe.y-Te.y;if(ee==="move")k({...de,corners:{tl:{x:de.corners.tl.x+Le,y:de.corners.tl.y+ze},tr:{x:de.corners.tr.x+Le,y:de.corners.tr.y+ze},bl:{x:de.corners.bl.x+Le,y:de.corners.bl.y+ze},br:{x:de.corners.br.x+Le,y:de.corners.br.y+ze}}});else if(ee in de.corners){const Ke={...de.corners};Ke[ee]=fe,k({...de,corners:Ke})}}}},[s,r,a,c,Q,te,R,T,F,q,H,I,k,on,Oe,tt,M,ce,ge,d,S,U,L,ae,Y,h,z,De,b,et]),In=P.useCallback(Ie=>{var $e,At,wt;const Pe=ct.current.size;if(ct.current.delete(Ie.pointerId),et(new Map(ct.current)),ct.current.size===0&&(qe.current=!1),Pe>1){ct.current.size<2&&(Bt.current=null,ot.current=null,$t({type:"none"}));return}if(qe.current)return;if(Vt.current&&(clearTimeout(Vt.current),Vt.current=null),($e=rt.current)!=null&&$e.isDrawing){const Qe=a==null?void 0:a.context,we=(At=n.current)==null?void 0:At.getContext("2d");if(Qe&&we&&a){const Xe={mainCtx:Qe,previewCtx:we,viewTransform:s,onDrawCommit:h,activeItemId:a.id,activeGuide:S,mirrorGuides:z,strokeModifier:De};rt.current.onPointerUp(Xe)}rt.current=null}if(c==="eraser"&&G(null),it.current.type==="draw"&&Q&&Q.mode==="line"&&Q.points.length>0&&(a==null?void 0:a.type)==="object"){const Qe=Lc(a.canvas),we=a.context,Xe=b(c),at=on(el(Ie.nativeEvent,s,e.current)),Me=Ie.pointerType==="pen"?Ie.pressure:1,Re={...at,pressure:Me},Be=[Q.points[0],Re];if(Xe&&Be.length>1){const fe={mainCtx:we,previewCtx:n.current.getContext("2d"),viewTransform:s,onDrawCommit:h,activeItemId:a.id,activeGuide:S,mirrorGuides:z,strokeModifier:De};Xe.drawWithMirroring(we,Be,fe),h(a.id,Qe)}te(null)}if(it.current.type==="selection"&&a){const{tool:Qe,points:we,startPoint:Xe}=it.current;if(we.length>1){let at,Me;if(Qe==="marquee-rect"){const Re=we[we.length-1],Be=Math.min(Xe.x,Re.x),fe=Math.min(Xe.y,Re.y),ee=Math.abs(Xe.x-Re.x),de=Math.abs(Xe.y-Re.y);at=new Path2D,at.rect(Be,fe,ee,de),Me={x:Be,y:fe,width:ee,height:de}}else{at=new Path2D,at.moveTo(we[0].x,we[0].y);for(let de=1;de<we.length;de++)at.lineTo(we[de].x,we[de].y);at.closePath();let Re=1/0,Be=1/0,fe=-1/0,ee=-1/0;we.forEach(de=>{Re=Math.min(Re,de.x),Be=Math.min(Be,de.y),fe=Math.max(fe,de.x),ee=Math.max(ee,de.y)}),Me={x:Re,y:Be,width:fe-Re,height:ee-Be}}be({path:at,boundingBox:Me,sourceItemId:a.id})}}if(it.current.type==="text-place"){const Qe=on(el(Ie.nativeEvent,s,e.current));Ae({position:Qe,value:"",activeItemId:(a==null?void 0:a.id)||""})}(c==="pan"||Ie.button===1&&Ie.pointerType==="mouse")&&(Ie.currentTarget.style.cursor="grab");const ht=(wt=n.current)==null?void 0:wt.getContext("2d");ht&&!Q&&cr(ht),$t({type:"none"}),T(null)},[s,e,a,h,_,c,T,d,Q,te,on,be,Ae,Ne,De,z,S,G,b,et]),Ct=P.useCallback(Ie=>{In(Ie)},[In]),_s=P.useCallback(Ie=>{if(!e.current)return;const Pe=Ie.deltaY>0?1/1.1:1.1,ht=e.current.getBoundingClientRect(),$e=Ie.clientX-ht.left,At=Ie.clientY-ht.top;r(wt=>{const Qe=Oe(),we=Math.max(Qe,Math.min(wt.zoom*Pe,tt)),Xe=($e-wt.pan.x)/wt.zoom,at=(At-wt.pan.y)/wt.zoom,Me=$e-Xe*we,Re=At-at*we;return{zoom:we,pan:{x:Me,y:Re}}})},[r,Oe,tt]),ln=P.useCallback(Ie=>{if(c==="select"){const Pe=el(Ie.nativeEvent,s,e.current);let ht=!1;[...t].reverse().forEach($e=>{if(ht||$e.type!=="object"||!$e.isVisible||!$e.canvas)return;const At=$e.context;At&&At.getImageData(Math.floor(Pe.x),Math.floor(Pe.y),1,1).data[3]>0&&(_($e.id),ht=!0)}),ht||_(null)}},[d,O,Q,te,h,a,_,t,c,s,b,S,z,De]);return{dragActionRef:it,onPointerDown:Ln,onPointerMove:an,onPointerUp:In,onPointerCancel:Ct,onWheel:_s,onDoubleClick:ln}}const RO=({selection:t,viewTransform:e,onCut:n,onCopy:s,onDelete:r,onDeselect:a})=>{if(!t)return null;const{x:c,y:d,width:f}=t.boundingBox,h=d-10,b=(c+f/2)*e.zoom+e.pan.x,S={position:"absolute",top:`${h*e.zoom+e.pan.y}px`,left:`${b}px`,transform:"translate(-50%, -100%)",zIndex:20};return g.jsxs("div",{style:S,className:"bg-[--bg-primary]/80 backdrop-blur-sm rounded-lg p-1 flex items-center gap-1 shadow-lg",onPointerDown:L=>L.stopPropagation(),children:[g.jsx("button",{onClick:s,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Copiar",children:g.jsx(GS,{className:"w-5 h-5"})}),g.jsx("button",{onClick:n,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Cortar",children:g.jsx(K3,{className:"w-5 h-5"})}),g.jsx("button",{onClick:r,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Eliminar",children:g.jsx(oa,{className:"w-5 h-5"})}),g.jsx("div",{className:"h-6 w-px bg-[--bg-hover] mx-1"}),g.jsx("button",{onClick:a,className:"p-2 rounded-md bg-[--bg-tertiary] text-red-500 hover:bg-red-500 hover:text-white",title:"Deseleccionar",children:g.jsx(bo,{className:"w-5 h-5"})})]})},NO=t=>{const{items:e,activeItemId:n,tool:s,viewTransform:r,setViewTransform:a,onDrawCommit:c,onSelectItem:d,onUpdateItem:f,activeGuide:h,isOrthogonalVisible:_,rulerGuides:b,setRulerGuides:E,mirrorGuides:S,setMirrorGuides:L,perspectiveGuide:U,setPerspectiveGuide:F,orthogonalGuide:z,gridGuide:q,areGuidesLocked:j,isCropping:H,cropRect:Y,setCropRect:K,isTransforming:R,transformState:T,setTransformState:N,transformSourceBbox:I,isAspectRatioLocked:D,isAngleSnapEnabled:k,angleSnapValue:M,isPerspectiveStrokeLockEnabled:ce,setIsPerspectiveStrokeLockEnabled:ge,isSnapToGridEnabled:$,strokeMode:G,strokeState:ae,setStrokeState:ve,selection:X,setSelection:O,onCutSelection:Q,onCopySelection:te,onDeleteSelection:ie,onDeselect:Ce,getMinZoom:be,MAX_ZOOM:Fe,onAddItem:Ue,textSettings:Oe,textEditState:tt,setTextEditState:Ot,onCommitText:vt,strokeSmoothing:Ae,strokeModifier:Ne}=t,Se=P.useRef(null),De=P.useRef(null),et=P.useRef(null),We=P.useRef(null),it=P.useRef(null),rt=P.useRef(null),St=P.useRef(null),_t=P.useRef(null),[Gt,ct]=P.useReducer(ee=>ee+1,0),[Bt,qe]=P.useState(null),ot=P.useRef(!1),[Vt,Pn]=P.useState(null),[rn,$t]=P.useState(null),[on,Ln]=P.useState(null),[an,In]=P.useState(new Map),Ct=e.find(ee=>ee.id===n),_s=["brush","eraser","simple-marker","natural-marker","airbrush","fx-brush","debug-brush","advanced-marker","watercolor"].includes(s),ln=["marquee-rect","lasso","magic-wand"].includes(s),{getBrushForTool:Ie}=SO({brushSettings:t.brushSettings,eraserSettings:t.eraserSettings,simpleMarkerSettings:t.simpleMarkerSettings,naturalMarkerSettings:t.naturalMarkerSettings,airbrushSettings:t.airbrushSettings,fxBrushSettings:t.fxBrushSettings,advancedMarkerSettings:t.advancedMarkerSettings,watercolorSettings:t.watercolorSettings}),{redrawMainCanvas:Pe,redrawGuides:ht,redrawUI:$e,perspectiveVPs:At}=AO({mainCanvasRef:De,guideCanvasRef:St,uiCanvasRef:it,items:e,viewTransform:r,isTransforming:R,activeItemId:n,activeGuide:h,isOrthogonalVisible:_,rulerGuides:b,mirrorGuides:S,perspectiveGuide:U,orthogonalGuide:z,gridGuide:q,isCropping:H,cropRect:Y,transformState:T,transformSourceBbox:I,livePreviewLayerId:on}),{dragActionRef:wt,...Qe}=IO({items:e,uiCanvasRef:it,previewCanvasRef:et,viewTransform:r,setViewTransform:a,activeItem:Ct,tool:s,isDrawingTool:_s,isSelectionTool:ln,onDrawCommit:c,onSelectItem:d,onUpdateItem:f,getBrushForTool:Ie,areGuidesLocked:j,activeGuide:h,isOrthogonalVisible:_,rulerGuides:b,setRulerGuides:E,mirrorGuides:S,setMirrorGuides:L,perspectiveGuide:U,setPerspectiveGuide:F,perspectiveVPs:At,orthogonalGuide:z,guideDragState:Vt,setGuideDragState:Pn,cropRect:Y,setCropRect:K,transformState:T,setTransformState:N,isAspectRatioLocked:D,isAngleSnapEnabled:k,angleSnapValue:M,livePreviewLayerId:on,setLivePreviewLayerId:Ln,isPerspectiveStrokeLockEnabled:ce,isSnapToGridEnabled:$,gridGuide:q,strokeMode:G,strokeState:ae,setStrokeState:ve,magicWandSettings:t.magicWandSettings,selection:X,setSelection:O,forceRender:ct,getMinZoom:be,MAX_ZOOM:Fe,onAddItem:Ue,textEditState:tt,setTextEditState:Ot,onCommitText:vt,strokeSmoothing:Ae,strokeModifier:Ne,setDebugPointers:In}),we={onPointerDown:ee=>{ot.current=!0,Qe.onPointerDown(ee)},onPointerUp:ee=>{ot.current=!1,Qe.onPointerUp(ee)},onPointerCancel:ee=>{ot.current=!1,Qe.onPointerCancel(ee)},onPointerMove:Qe.onPointerMove,onDoubleClick:Qe.onDoubleClick,onWheel:Qe.onWheel};P.useEffect(()=>{if(R&&(Ct==null?void 0:Ct.type)==="object"&&(Ct!=null&&Ct.canvas)&&I){const ee=document.createElement("canvas");ee.width=I.width,ee.height=I.height;const de=ee.getContext("2d");de&&(de.drawImage(Ct.canvas,I.x,I.y,I.width,I.height,0,0,I.width,I.height),$t(ee.toDataURL()))}else $t(null)},[R,Ct,I]),P.useEffect(()=>{const ee=Le=>{if(!it.current)return;const ze={x:Le.clientX-it.current.getBoundingClientRect().left,y:Le.clientY-it.current.getBoundingClientRect().top};qe(ze)},de=()=>{qe(null),ot.current=!1},Te=Se.current;return Te==null||Te.addEventListener("pointermove",ee),Te==null||Te.addEventListener("pointerleave",de),()=>{Te==null||Te.removeEventListener("pointermove",ee),Te==null||Te.removeEventListener("pointerleave",de)}},[]),P.useEffect(()=>{var de;const ee=(de=We.current)==null?void 0:de.getContext("2d");if(ee&&(ee.clearRect(0,0,ee.canvas.width,ee.canvas.height),an.size<=1&&_s&&Bt&&(!ot.current||s==="eraser"))){let Te=0;switch(s){case"brush":Te=t.brushSettings.size;break;case"eraser":Te=t.eraserSettings.size;break;case"simple-marker":Te=t.simpleMarkerSettings.size;break;case"natural-marker":Te=t.naturalMarkerSettings.size;break;case"airbrush":Te=t.airbrushSettings.size;break;case"fx-brush":Te=t.fxBrushSettings.size;break;case"debug-brush":Te=2;break;case"advanced-marker":Te=t.advancedMarkerSettings.size;break;case"watercolor":Te=t.watercolorSettings.size;break}if(Te>0){const Le=Te*r.zoom,ze=Ye=>{ee.lineWidth=1,ee.strokeStyle="rgba(0, 0, 0, 0.7)",ee.setLineDash([]),ee.beginPath(),Ye==="circle"?ee.arc(Bt.x,Bt.y,Le/2,0,2*Math.PI):ee.rect(Bt.x-Le/2,Bt.y-Le/2,Le,Le),ee.stroke(),ee.strokeStyle="rgba(255, 255, 255, 0.7)",ee.setLineDash([2,2]),ee.beginPath(),Ye==="circle"?ee.arc(Bt.x,Bt.y,Le/2,0,2*Math.PI):ee.rect(Bt.x-Le/2,Bt.y-Le/2,Le,Le),ee.stroke(),ee.setLineDash([])},Ke=s==="eraser"&&t.eraserSettings.tipShape==="square"||s==="simple-marker"&&t.simpleMarkerSettings.tipShape!=="line"?"square":"circle";ze(Ke)}}},[_s,s,Bt,r.zoom,t.brushSettings,t.eraserSettings,t.simpleMarkerSettings,t.naturalMarkerSettings,t.airbrushSettings,t.fxBrushSettings,t.advancedMarkerSettings,t.watercolorSettings,ot.current,an]),P.useEffect(()=>{var ze;const ee=(ze=rt.current)==null?void 0:ze.getContext("2d");if(!X||!ee||X.sourceItemId!==n){ee&&cr(ee);return}let de,Te=0;const Le=()=>{Te=(Te+.5)%8,cr(ee),ee.save(),ee.setTransform(r.zoom,0,0,r.zoom,r.pan.x,r.pan.y),ee.lineWidth=1/r.zoom,ee.strokeStyle="white",ee.setLineDash([4/r.zoom,4/r.zoom]),ee.lineDashOffset=-Te,ee.stroke(X.path),ee.strokeStyle="black",ee.lineDashOffset=4-Te,ee.stroke(X.path),ee.restore(),de=requestAnimationFrame(Le)};return Le(),()=>{cancelAnimationFrame(de),ee&&cr(ee)}},[X,r,n]),P.useLayoutEffect(()=>{Pe(),ht(),$e()},[Pe,ht,$e,R,T,Ct,I,r,Gt,on]),P.useEffect(()=>{const ee=Se.current,de=[De.current,et.current,We.current,it.current,St.current,rt.current];if(!ee||de.some(Le=>!Le))return;const Te=new ResizeObserver(Le=>{const ze=Le[0],{width:Ke,height:Ye}=ze.contentRect;de.forEach(dt=>{dt&&(dt.width=Ke,dt.height=Ye)}),Pe(),ht(),$e()});return Te.observe(ee),()=>Te.disconnect()},[Pe,ht,$e]),P.useEffect(()=>{tt&&_t.current&&(_t.current.focus(),_t.current.value=tt.value)},[tt]),P.useEffect(()=>{_t.current&&(_t.current.style.height="auto",_t.current.style.height=`${_t.current.scrollHeight}px`)},[tt==null?void 0:tt.value]);let Xe={display:"none"};if(R&&T&&I&&rn){if(T.type==="affine"){const{x:ee,y:de,width:Te,height:Le,rotation:ze}=T,Ke=Te/I.width,Ye=Le/I.height,dt=`
                matrix(${r.zoom}, 0, 0, ${r.zoom}, ${r.pan.x}, ${r.pan.y})
                translate(${ee+Te/2}px, ${de+Le/2}px)
                rotate(${ze}rad)
                scale(${Ke}, ${Ye})
                translate(-${I.width/2}px, -${I.height/2}px)
             `;Xe={position:"absolute",top:0,left:0,width:`${I.width}px`,height:`${I.height}px`,willChange:"transform",imageRendering:"pixelated",transformOrigin:"top left",transform:dt}}else if(T.type==="free"){const{corners:ee}=T,{width:de,height:Te}=I,Le=[{x:0,y:0},{x:de,y:0},{x:de,y:Te},{x:0,y:Te}],ze=[ee.tl,ee.tr,ee.br,ee.bl].map(Ye=>({x:Ye.x*r.zoom+r.pan.x,y:Ye.y*r.zoom+r.pan.y})),Ke=fO(Le,ze);Xe={position:"absolute",top:0,left:0,width:`${de}px`,height:`${Te}px`,willChange:"transform",imageRendering:"pixelated",transformOrigin:"top left",transform:Ke}}}const at=()=>s==="text"?"text":_s?"none":ln?"crosshair":s==="pan"?ot.current?"grabbing":"grab":"default",Me=()=>{tt&&vt(tt)},Re=ee=>{tt&&Ot({...tt,value:ee.target.value})},Be=ee=>{ee.key==="Escape"?Ot(null):ee.key==="Enter"&&!ee.shiftKey&&(ee.preventDefault(),Me())};let fe={display:"none"};if(tt){const{position:ee}=tt,de=ee.x*r.zoom+r.pan.x,Te=ee.y*r.zoom+r.pan.y;fe={position:"absolute",left:`${de}px`,top:`${Te}px`,transform:Oe.textAlign==="center"?"translateX(-50%)":Oe.textAlign==="right"?"translateX(-100%)":"none",display:"block",background:"rgba(255, 255, 255, 0.1)",border:"1px dashed rgba(255, 255, 255, 0.8)",borderRadius:"2px",padding:"0",margin:"0",resize:"none",overflow:"hidden",outline:"none",whiteSpace:"pre-wrap",fontFamily:Oe.fontFamily,fontSize:`${Oe.fontSize*r.zoom}px`,lineHeight:1.2,color:Oe.color,textAlign:Oe.textAlign,fontWeight:Oe.fontWeight,minWidth:`${10*r.zoom}px`,minHeight:`${Oe.fontSize*1.2*r.zoom}px`,height:"auto"}}return g.jsxs("div",{ref:Se,className:"w-full h-full overflow-hidden relative bg-[--bg-tertiary]",style:{cursor:at(),touchAction:"none"},...we,onContextMenu:ee=>ee.preventDefault(),children:[g.jsx("canvas",{ref:De,className:"absolute inset-0"}),g.jsx("canvas",{ref:St,className:"absolute inset-0 pointer-events-none"}),g.jsx("canvas",{ref:et,className:"absolute inset-0 pointer-events-none"}),g.jsx("img",{src:rn||"",alt:"Transform preview",className:"pointer-events-none",style:Xe}),g.jsx("canvas",{ref:it,className:"absolute inset-0 pointer-events-none"}),g.jsx("canvas",{ref:rt,className:"absolute inset-0 pointer-events-none"}),g.jsx("canvas",{ref:We,className:"absolute inset-0 pointer-events-none"}),tt&&g.jsx("textarea",{ref:_t,style:fe,defaultValue:tt.value,onChange:Re,onBlur:Me,onKeyDown:Be,onPointerDown:ee=>ee.stopPropagation()}),X&&n===X.sourceItemId&&g.jsx(RO,{selection:X,viewTransform:r,onCut:Q,onCopy:te,onDelete:ie,onDeselect:Ce})]})},MO=({item:t,onApply:e,onCancel:n})=>{const s=P.useRef(null),r=P.useRef(null),a=P.useRef(null),c=P.useRef(null),d=P.useRef(null),f=P.useRef(null),[h,_]=P.useState("picker"),[b,E]=P.useState({zoom:1,pan:{x:0,y:0}}),[S,L]=P.useState(30),[U,F]=P.useState({size:50}),[z,q]=P.useState(5),[j,H]=P.useState("mm"),[Y,K]=P.useState("5"),[R,T]=P.useState(null),[N,I]=P.useState([]),[D,k]=P.useState(-1),M=P.useRef({isPanning:!1,isErasing:!1,lastPoint:null}),ce=P.useMemo(()=>N[D],[N,D]),ge=P.useMemo(()=>(ce==null?void 0:ce.colors)??[],[ce]),$=D>0,G=D<N.length-1,ae=P.useMemo(()=>({mm:1,cm:10,m:1e3}),[]),ve=P.useCallback(Ae=>{const Ne=N.slice(0,D+1);I([...Ne,Ae]),k(Ne.length)},[N,D]);P.useEffect(()=>{if(t){const Ae=t.scaleFactor||5,Ne=t.scaleUnit||"mm";q(Ae),H(Ne),K(String(Number((Ae*ae[Ne]).toFixed(2)))),L(t.tolerance!==void 0?t.tolerance:30);const Se=new Image;Se.crossOrigin="anonymous",Se.onload=()=>{T(Se)},Se.src=t.originalDataUrl}else T(null),I([]),k(-1),E({zoom:1,pan:{x:0,y:0}})},[t,ae]);const X=P.useCallback(()=>{if(!f.current||!r.current)return;const Ae=f.current,Ne=r.current,Se=Ne.getContext("2d");if(!Se)return;Se.clearRect(0,0,Ne.width,Ne.height),Se.save(),Se.translate(b.pan.x,b.pan.y),Se.scale(b.zoom,b.zoom),Ae.width>0&&(Se.imageSmoothingEnabled=b.zoom<3,Se.drawImage(Ae,0,0)),Se.restore(),Se.save();const De=Ne.height-30,et=20,We=100,it=1/(z*b.zoom),rt=We*it,St=[.1,.5,1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4];let _t=St[0];for(const rn of St){if(rn>rt)break;_t=rn}const Gt=_t*z*b.zoom;let ct=`${_t}mm`;_t>=1e3?ct=`${_t/1e3}m`:_t>=10&&(ct=`${_t/10}cm`),Se.font="12px sans-serif";const qe=Se.measureText(ct).width,ot=Math.max(Gt,qe)+16,Vt=et-8,Pn=De-18;Se.fillStyle="rgba(255, 255, 255, 0.7)",Se.fillRect(Vt,Pn,ot,24),Se.strokeStyle="rgba(0, 0, 0, 0.8)",Se.lineWidth=1.5,Se.beginPath(),Se.moveTo(et,De-5),Se.lineTo(et,De),Se.lineTo(et+Gt,De),Se.lineTo(et+Gt,De-5),Se.stroke(),Se.fillStyle="rgba(0, 0, 0, 0.8)",Se.textAlign="center",Se.fillText(ct,et+Gt/2,De-8),Se.restore()},[b,z]),O=P.useCallback(()=>{const Ae=a.current,Ne=c.current,Se=d.current,De=f.current;if(!Ae||!Ne||!Se||!De)return;const et=De.getContext("2d");et&&(et.clearRect(0,0,De.width,De.height),et.drawImage(Ae,0,0),et.globalCompositeOperation="destination-in",et.drawImage(Ne,0,0),et.globalCompositeOperation="destination-out",et.drawImage(Se,0,0),et.globalCompositeOperation="source-over",X())},[X]);P.useEffect(()=>{var ct,Bt,qe;if(!ce||!R)return;const Ae=(ct=a.current)==null?void 0:ct.getContext("2d",{willReadFrequently:!0}),Ne=(Bt=c.current)==null?void 0:Bt.getContext("2d"),Se=(qe=d.current)==null?void 0:qe.getContext("2d");if(!Ae||!Ne||!Se)return;const{width:De,height:et}=R,{colors:We,eraserMaskData:it}=ce;it?Se.putImageData(it,0,0):Se.clearRect(0,0,De,et);const rt=Ae.getImageData(0,0,De,et).data,St=Ne.createImageData(De,et),_t=St.data,Gt=(S/100*255)**2*3;for(let ot=0;ot<rt.length;ot+=4){let Vt=!1;if(We.length>0){const Pn=rt[ot],rn=rt[ot+1],$t=rt[ot+2];for(const on of We)if((Pn-on.r)**2+(rn-on.g)**2+($t-on.b)**2<=Gt){Vt=!0;break}}_t[ot]=255,_t[ot+1]=255,_t[ot+2]=255,_t[ot+3]=Vt?0:255}Ne.putImageData(St,0,0),O()},[ce,S,R,O]),P.useEffect(()=>{var et;if(!R||!a.current||!d.current||!f.current)return;const{width:Ae,height:Ne}=R;[a.current,d.current,f.current,c.current].forEach(We=>{We&&(We.width=Ae,We.height=Ne)}),(et=a.current.getContext("2d"))==null||et.drawImage(R,0,0);const Se=d.current.getContext("2d");if(!Se)return;Se.clearRect(0,0,Ae,Ne);const De=Se.getImageData(0,0,Ae,Ne);I([{colors:(t==null?void 0:t.transparentColors)||[],eraserMaskData:De}]),k(0)},[R,t]),P.useEffect(()=>{if(R&&s.current&&D===0){const Ae=s.current.offsetWidth,Ne=s.current.offsetHeight,Se=.9,De=Ae/R.width,et=Ne/R.height,We=Math.min(De,et)*Se,it=(Ae-R.width*We)/2,rt=(Ne-R.height*We)/2;E({zoom:We,pan:{x:it,y:rt}})}},[R,D]),P.useEffect(()=>{const Ae=new ResizeObserver(()=>{if(s.current&&r.current){const{width:Ne,height:Se}=s.current.getBoundingClientRect();r.current.width=Ne,r.current.height=Se,X()}});return s.current&&Ae.observe(s.current),()=>Ae.disconnect()},[X]),P.useEffect(X,[X]);const Q=Ae=>{if(Ae.button!==0&&Ae.button!==1||!ce)return;Ae.currentTarget.setPointerCapture(Ae.pointerId);const Ne=el(Ae.nativeEvent,b,r.current);if(M.current.lastPoint=Ne,h==="pan"||Ae.button===1)M.current.isPanning=!0;else if(h==="picker"&&a.current){const Se=a.current.getContext("2d",{willReadFrequently:!0});if(Se&&Ne.x>=0&&Ne.x<a.current.width&&Ne.y>=0&&Ne.y<a.current.height){const De=Se.getImageData(Math.floor(Ne.x),Math.floor(Ne.y),1,1).data,et={r:De[0],g:De[1],b:De[2]};ge.some(We=>We.r===et.r&&We.g===et.g&&We.b===et.b)||ve({colors:[...ge,et],eraserMaskData:ce.eraserMaskData})}}else if(h==="eraser"&&d.current){M.current.isErasing=!0;const Se=d.current.getContext("2d");Se&&(Se.fillStyle="black",Se.beginPath(),Se.arc(Ne.x,Ne.y,U.size/2,0,Math.PI*2),Se.fill(),O())}},te=Ae=>{const Ne=el(Ae.nativeEvent,b,r.current),{isPanning:Se,isErasing:De,lastPoint:et}=M.current;if(Se)E(We=>({...We,pan:{x:We.pan.x+Ae.movementX,y:We.pan.y+Ae.movementY}}));else if(De&&et&&d.current){const We=d.current.getContext("2d");We&&(We.fillStyle="black",We.strokeStyle="black",We.lineWidth=U.size,We.lineCap="round",We.lineJoin="round",We.beginPath(),We.moveTo(et.x,et.y),We.lineTo(Ne.x,Ne.y),We.stroke(),O())}M.current.lastPoint=Ne},ie=Ae=>{var Ne;if(Ae.currentTarget.releasePointerCapture(Ae.pointerId),M.current.isErasing){const Se=(Ne=d.current)==null?void 0:Ne.getContext("2d");if(Se&&ce){const De=Se.getImageData(0,0,Se.canvas.width,Se.canvas.height);ve({colors:ge,eraserMaskData:De})}}M.current={isPanning:!1,isErasing:!1,lastPoint:null}},Ce=()=>{f.current&&e(f.current.toDataURL(),ge,z,S,j)},be=()=>$&&k(Ae=>Ae-1),Fe=()=>G&&k(Ae=>Ae+1),Ue=()=>N.length>0&&k(0),Oe=()=>{if(!R||!d.current)return;const Ae=d.current.getContext("2d");if(!Ae)return;const{width:Ne,height:Se}=R;Ae.clearRect(0,0,Ne,Se);const De=Ae.getImageData(0,0,Ne,Se);I([{colors:[],eraserMaskData:De}]),k(0)},tt=Ae=>{const Ne=Ae.target.value,Se=z;H(Ne),K(String(Number((Se*ae[Ne]).toFixed(2))))},Ot=Ae=>{const Ne=Ae.target.value;K(Ne);const Se=parseFloat(Ne);!isNaN(Se)&&Se>0&&q(Se/ae[j])};if(!t)return null;const vt=Ae=>`p-2 rounded-md transition-colors ${h===Ae?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`;return g.jsx("div",{className:"fixed inset-0 bg-black/75 z-40 flex items-center justify-center p-4",children:g.jsxs("div",{className:"bg-[--bg-secondary] rounded-lg shadow-xl w-full h-full max-w-6xl max-h-[90vh] flex flex-col",children:[g.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-2 border-b border-[--bg-tertiary]",children:[g.jsxs("h2",{className:"text-lg font-bold",children:["Editar Transparencia: ",t.name]}),g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("button",{onClick:Ce,className:"px-4 py-2 rounded-md bg-green-600 hover:bg-green-500 text-white font-semibold",children:"Aplicar"}),g.jsx("button",{onClick:n,className:"p-2 rounded-full hover:bg-[--bg-tertiary]",children:g.jsx(bo,{className:"w-6 h-6"})})]})]}),g.jsxs("div",{className:"flex-grow flex min-h-0",children:[g.jsxs("div",{className:"w-64 flex-shrink-0 bg-[--bg-primary] p-4 flex flex-col gap-4 border-r border-[--bg-tertiary] overflow-y-auto",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Herramientas"}),g.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[g.jsx("button",{onClick:()=>_("picker"),className:vt("picker"),title:"Cuentagotas",children:g.jsx(zS,{className:"w-5 h-5"})}),g.jsx("button",{onClick:()=>_("eraser"),className:vt("eraser"),title:"Borrador",children:g.jsx(ru,{className:"w-5 h-5"})}),g.jsx("button",{onClick:()=>_("pan"),className:vt("pan"),title:"Mover",children:g.jsx(BS,{className:"w-5 h-5"})}),g.jsx("button",{onClick:()=>E(Ae=>({...Ae,zoom:Ae.zoom*1.2})),className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Acercar",children:g.jsx(US,{className:"w-5 h-5"})}),g.jsx("button",{onClick:()=>E(Ae=>({...Ae,zoom:Ae.zoom/1.2})),className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Alejar",children:g.jsx(OS,{className:"w-5 h-5"})})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Historial"}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("button",{onClick:be,disabled:!$,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Deshacer",children:g.jsx(jS,{className:"w-5 h-5"})}),g.jsx("button",{onClick:Fe,disabled:!G,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Rehacer",children:g.jsx(FS,{className:"w-5 h-5"})}),g.jsx("button",{onClick:Ue,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Volver al inicio de sesin",children:g.jsx(iO,{className:"w-5 h-5"})})]}),g.jsxs("button",{onClick:Oe,className:"w-full mt-2 flex items-center justify-center gap-2 px-3 py-2 bg-red-500/10 text-red-500 hover:bg-red-500/20 rounded-md transition-colors text-xs font-bold uppercase",title:"Eliminar toda transparencia y cambios",children:[g.jsx(j3,{className:"w-4 h-4"}),"Restaurar Original"]})]}),h==="eraser"&&g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Ajustes del Borrador"}),g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"eraser-size",className:"text-xs text-[--text-secondary]",children:["Tamao: ",U.size]}),g.jsx("input",{type:"range",id:"eraser-size",min:"1",max:"200",step:"1",value:U.size,onChange:Ae=>F(Ne=>({...Ne,size:parseInt(Ae.target.value,10)})),className:"w-full"})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Seleccin de Color"}),g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"tolerance",className:"text-xs text-[--text-secondary]",children:["Tolerancia: ",S]}),g.jsx("input",{type:"range",id:"tolerance",min:"0",max:"100",step:"1",value:S,onChange:Ae=>L(parseInt(Ae.target.value,10)),className:"w-full"})]})]}),g.jsxs("div",{children:[g.jsx("div",{className:"flex justify-between items-center mb-2",children:g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Colores Transparentes"})}),g.jsxs("div",{className:"max-h-60 overflow-y-auto space-y-1 pr-2",children:[ge.map((Ae,Ne)=>g.jsxs("div",{className:"flex items-center justify-between p-1 rounded bg-[--bg-tertiary]",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-6 h-6 rounded border border-white/20",style:{backgroundColor:vT(Ae.r,Ae.g,Ae.b)}}),g.jsx("span",{className:"text-xs font-mono",children:vT(Ae.r,Ae.g,Ae.b)})]}),g.jsx("button",{onClick:()=>{if(!ce)return;const Se=ge.filter((De,et)=>et!==Ne);ve({colors:Se,eraserMaskData:ce.eraserMaskData})},className:"p-1 rounded-full text-xs text-gray-400 hover:bg-red-500 hover:text-white",children:""})]},Ne)),ge.length===0&&g.jsx("p",{className:"text-xs text-center text-[--text-secondary] py-2",children:"Usa el cuentagotas para aadir colores."})]})]}),g.jsxs("div",{className:"mt-auto pt-4 border-t border-[--bg-tertiary]",children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Propiedades"}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-[--text-secondary]",children:"Factor de Escala"}),g.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[g.jsx("span",{className:"text-sm",children:"1"}),g.jsxs("select",{value:j,onChange:tt,className:"bg-[--bg-tertiary] text-sm rounded-md p-1 border border-[--bg-hover]",children:[g.jsx("option",{value:"mm",children:"mm"}),g.jsx("option",{value:"cm",children:"cm"}),g.jsx("option",{value:"m",children:"m"})]}),g.jsx("span",{className:"text-sm",children:"="}),g.jsx("input",{type:"number",value:Y,onChange:Ot,className:"w-20 bg-[--bg-secondary] text-sm rounded-md p-1 border border-[--bg-tertiary]"}),g.jsx("span",{className:"text-sm",children:"px"})]})]})]})]}),g.jsxs("div",{ref:s,className:"flex-grow bg-gray-500",onPointerDown:Q,onPointerMove:te,onPointerUp:ie,onPointerLeave:ie,style:{cursor:h==="pan"?M.current.isPanning?"grabbing":"grab":"crosshair",backgroundImage:"linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px"},children:[g.jsx("canvas",{ref:r,className:"w-full h-full"}),g.jsx("canvas",{ref:a,className:"hidden"}),g.jsx("canvas",{ref:c,className:"hidden"}),g.jsx("canvas",{ref:d,className:"hidden"}),g.jsx("canvas",{ref:f,className:"hidden"})]})]})]})})},kO=({user:t,items:e,onImportImage:n,onCreateFolder:s,onEditItem:r,onDeleteItem:a,onAddItemToScene:c,onMoveItems:d})=>{const[f,h]=P.useState(null),[_,b]=P.useState(!1),[E,S]=P.useState(""),L=P.useRef(null),[U,F]=P.useState(new Set),z=I=>{I.target.files&&I.target.files[0]&&(n(I.target.files[0],f),I.target.value="")},q=(I,D)=>{if(D.type==="folder"){I.preventDefault();return}I.stopPropagation(),I.dataTransfer.effectAllowed="copy",I.dataTransfer.setData("application/json",JSON.stringify({type:"library-item",id:D.id}))},j=()=>{E.trim()&&s(E.trim(),f),S(""),b(!1)},H=I=>{F(D=>{const k=new Set(D);return k.has(I)?k.delete(I):k.add(I),k})},Y=I=>{h(I)},K=()=>{U.size!==0&&(d(Array.from(U),f),F(new Set))},R=P.useMemo(()=>{const I=[];let D=f;for(;D;){const k=e.find(M=>M.id===D);if(k)I.unshift(k),D=k.parentId;else break}return I},[f,e]),T=P.useMemo(()=>e.filter(D=>D.parentId===f).sort((D,k)=>D.type==="folder"&&k.type!=="folder"?-1:D.type!=="folder"&&k.type==="folder"?1:D.name.localeCompare(k.name)),[e,f]),N=I=>{I.type==="folder"?Y(I.id):c(I.id)};return g.jsxs("div",{className:"p-4 flex flex-col h-full bg-[--bg-primary]",children:[g.jsxs("div",{className:"flex-shrink-0 mb-3",children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Libreria"}),U.size>0&&g.jsxs("button",{onClick:K,className:"text-sm px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-500",children:["Mover ",U.size," aqu"]})]}),g.jsxs("div",{className:"flex items-center text-sm text-[--text-secondary] flex-wrap",children:[f!==null&&g.jsx("button",{onClick:()=>Y(R.length>1?R[R.length-2].id:null),className:"p-1 rounded-md hover:bg-[--bg-tertiary] mr-1",title:"Subir un nivel",children:g.jsx(YS,{className:"w-4 h-4"})}),g.jsx("button",{onClick:()=>Y(null),className:"hover:text-[--text-primary]",children:"Raz"}),R.map(I=>g.jsxs(dg.Fragment,{children:[g.jsx(lg,{className:"w-4 h-4 mx-1"}),g.jsx("button",{onClick:()=>Y(I.id),className:"hover:text-[--text-primary]",children:I.name})]},I.id))]})]}),g.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:t?T.length===0&&!_?g.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center text-[--text-secondary] p-4",children:[g.jsx(eT,{className:"w-12 h-12 mb-4"}),g.jsx("p",{className:"text-sm font-bold",children:"La carpeta est vaca"}),g.jsx("p",{className:"text-xs",children:"Importe imgenes o cree una nueva carpeta."})]}):g.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[_&&g.jsxs("div",{className:"aspect-square bg-[--bg-secondary] rounded-md flex flex-col items-center justify-center p-2",children:[g.jsx(Gd,{className:"w-10 h-10 text-[--text-secondary] mb-1"}),g.jsx("input",{ref:L,type:"text",value:E,onChange:I=>S(I.target.value),onBlur:j,onKeyDown:I=>{I.key==="Enter"&&j(),I.key==="Escape"&&(b(!1),S(""))},placeholder:"Nombre...",className:"w-full text-center bg-[--bg-tertiary] text-[--text-primary] rounded text-xs p-1",autoFocus:!0})]}),T.map(I=>{const D=U.has(I.id);return g.jsxs("div",{draggable:I.type==="image",onDragStart:k=>q(k,I),onDoubleClick:()=>N(I),className:`group relative aspect-square bg-[--bg-secondary] rounded-md flex flex-col items-center justify-center p-1 hover:bg-[--bg-hover] ${I.type==="folder"?"cursor-pointer":"cursor-grab"} transition-all duration-150 border-2 ${D?"border-[--accent-primary]":"border-transparent"}`,title:I.name,children:[g.jsx("button",{onClick:k=>{k.stopPropagation(),H(I.id)},"aria-label":`Select ${I.name}`,className:"absolute top-1 left-1 w-5 h-5 bg-black/30 backdrop-blur-sm rounded-sm flex items-center justify-center border border-white/30 z-10 hover:bg-black/50",children:D&&g.jsx(HS,{className:"w-4 h-4 text-white"})}),I.type==="image"&&I.dataUrl?g.jsx("img",{src:I.dataUrl,alt:I.name,className:"max-w-full max-h-full object-contain pointer-events-none"}):I.type==="folder"?g.jsx(Gd,{className:"w-10 h-10 text-red-400"}):g.jsx(eT,{className:"w-8 h-8 text-gray-500 pointer-events-none"}),g.jsx("span",{className:"text-xs text-[--text-secondary] mt-1 truncate w-full text-center pointer-events-none",children:I.name}),g.jsx("button",{onClick:k=>{k.stopPropagation(),a(I)},"aria-label":`Delete ${I.name}`,className:"absolute top-1 right-1 p-1 bg-[--bg-primary]/60 rounded-full text-[--text-primary] opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-500 z-10",children:g.jsx(oa,{className:"w-4 h-4"})}),I.type==="image"&&g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:k=>{k.stopPropagation(),c(I.id)},"aria-label":`Add ${I.name} to scene`,className:"absolute bottom-1 left-1 p-1 bg-[--bg-primary]/60 rounded-full text-[--text-primary] opacity-0 group-hover:opacity-100 transition-opacity hover:bg-green-500 z-10",children:g.jsx(ph,{className:"w-4 h-4"})}),g.jsx("button",{onClick:k=>{k.stopPropagation(),r(I.id)},"aria-label":`Edit transparency for ${I.name}`,className:"absolute bottom-1 right-1 p-1 bg-[--bg-primary]/60 rounded-full text-[--text-primary] opacity-0 group-hover:opacity-100 transition-opacity hover:bg-[--accent-primary] z-10",children:g.jsx(ou,{className:"w-4 h-4"})})]})]},I.id)})]}):g.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center text-[--text-secondary] p-4",children:[g.jsx($S,{className:"w-12 h-12 mb-4"}),g.jsx("p",{className:"text-sm font-bold",children:"Se requiere iniciar sesin"}),g.jsx("p",{className:"text-xs",children:"Por favor, inicie sesin para acceder a su librera de activos en lnea."})]})}),g.jsxs("div",{className:"flex-shrink-0 mt-4 flex items-center gap-2",children:[g.jsxs("label",{htmlFor:"library-image-upload",className:"flex-grow flex items-center justify-center p-2 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary] disabled:opacity-50 disabled:cursor-not-allowed",children:[g.jsx(Ty,{className:"w-5 h-5 mr-2"}),g.jsx("span",{className:"text-sm",children:"Importar"})]}),g.jsx("input",{id:"library-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:z,disabled:!t}),g.jsxs("button",{onClick:()=>b(!0),disabled:!t||_,className:"flex-shrink-0 flex items-center justify-center p-2 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary] disabled:opacity-50 disabled:cursor-not-allowed",title:"Crear nueva carpeta",children:[g.jsx(Gd,{className:"w-5 h-5 mr-2"}),g.jsx("span",{className:"text-sm",children:"Nueva Carpeta"})]})]})]})},DO=({tool:t,setTool:e,onSetActiveGuide:n,onSetGridType:s,isSnapToGridEnabled:r,onToggleSnapToGrid:a,isOrthogonalVisible:c,onZoomExtents:d,onZoomIn:f,onZoomOut:h,onUndo:_,onRedo:b,onClearAll:E,canUndo:S,canRedo:L,isCropping:U,onApplyCrop:F,onCancelCrop:z,isTransforming:q,transformState:j,onApplyTransform:H,onCancelTransform:Y,isAspectRatioLocked:K,onSetAspectRatioLocked:R,isAngleSnapEnabled:T,onToggleAngleSnap:N,angleSnapValue:I,onSetAngleSnapValue:D,activeGuide:k,orthogonalGuide:M,onSetOrthogonalAngle:ce,gridGuide:ge,onSetGridSpacing:$,onSetGridMajorLineFrequency:G,onSetGridIsoAngle:ae,onSetGridMajorLineColor:ve,onSetGridMinorLineColor:X,areGuidesLocked:O,onSetAreGuidesLocked:Q,isPerspectiveStrokeLockEnabled:te,onSetIsPerspectiveStrokeLockEnabled:ie,scaleFactor:Ce,scaleUnit:be,onPaste:Fe,hasClipboardContent:Ue,strokeSmoothing:Oe,setStrokeSmoothing:tt})=>{const[Ot,vt]=P.useState(""),[Ae,Ne]=P.useState("50"),[Se,De]=P.useState("5"),[et,We]=P.useState(!1),it=P.useRef(null),rt=P.useRef(null),St=[{name:"Gris",value:"rgba(128, 128, 128, 0.6)"},{name:"Rojo",value:"rgba(239, 68, 68, 0.6)"},{name:"Verde",value:"rgba(34, 197, 94, 0.6)"},{name:"Azul",value:"rgba(59, 130, 246, 0.6)"},{name:"Negro",value:"rgba(0, 0, 0, 0.6)"}],_t=[{name:"Gris",value:"rgba(128, 128, 128, 0.3)"},{name:"Rojo",value:"rgba(239, 68, 68, 0.3)"},{name:"Verde",value:"rgba(34, 197, 94, 0.3)"},{name:"Azul",value:"rgba(59, 130, 246, 0.3)"},{name:"Negro",value:"rgba(0, 0, 0, 0.3)"}];P.useEffect(()=>{ge&&(Ne(String(ge.spacing)),De(String(ge.majorLineFrequency)))},[ge]),P.useEffect(()=>{const qe=ot=>{it.current&&!it.current.contains(ot.target)&&rt.current&&!rt.current.contains(ot.target)&&We(!1)};return document.addEventListener("mousedown",qe),()=>document.removeEventListener("mousedown",qe)},[]);const Gt=P.useMemo(()=>{if(!ge||!Ce)return`${Ae}px`;const qe=parseInt(Ae)/Ce;let ot;switch(be){case"cm":ot=(qe/10).toFixed(1);break;case"m":ot=(qe/1e3).toFixed(2);break;case"mm":default:ot=qe.toFixed(1);break}return`${Ae}px (${ot}${be})`},[Ae,ge,Ce,be]),ct=P.useMemo(()=>k!=="none"||c||ge&&ge.type!=="none",[k,c,ge]),Bt=qe=>`p-2 rounded-md transition-colors ${t===qe?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`;return g.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-[--bg-primary]/80 backdrop-blur-sm rounded-lg p-1 flex items-center gap-1 shadow-lg z-10",children:[(U||q)&&g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:U?z:Y,className:"p-2 rounded-md bg-red-600 text-white hover:bg-red-500 transition-colors",title:"Cancelar",children:g.jsx(bo,{className:"w-5 h-5"})}),g.jsx("button",{onClick:U?F:H,className:"p-2 rounded-md bg-green-600 text-white hover:bg-green-500 transition-colors",title:"Aplicar",children:g.jsx(HS,{className:"w-5 h-5"})}),g.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"})]}),q&&(j==null?void 0:j.type)==="affine"&&g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:()=>R(qe=>!qe),className:`p-2 rounded-md transition-colors ${K?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:K?"Desbloquear relacin de aspecto":"Bloquear relacin de aspecto",children:K?g.jsx(sT,{className:"w-5 h-5"}):g.jsx(iT,{className:"w-5 h-5"})}),g.jsx("button",{onClick:N,className:`p-2 rounded-md transition-colors ${T?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:"Activar anclaje de ngulo",children:g.jsx(ym,{className:"w-5 h-5"})}),T&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),[1,5,10,15].map(qe=>g.jsxs("button",{onClick:()=>D(qe),className:`px-2 py-1 rounded-md text-xs font-semibold transition-colors ${I===qe?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:`Anclar a ${qe}`,children:[qe,""]},qe))]})]}),!U&&!q&&g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:()=>e("pan"),className:Bt("pan"),title:"Mover (Arrastrar)",children:g.jsx(BS,{className:"w-5 h-5"})}),g.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),g.jsx("button",{onClick:h,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Alejar",children:g.jsx(OS,{className:"w-5 h-5"})}),g.jsx("button",{onClick:f,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Acercar",children:g.jsx(US,{className:"w-5 h-5"})}),g.jsx("button",{onClick:d,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Ajustar a la vista",children:g.jsx(zS,{className:"w-5 h-5"})}),g.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),g.jsx("button",{onClick:_,disabled:!S,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Deshacer",children:g.jsx(jS,{className:"w-5 h-5"})}),g.jsx("button",{onClick:b,disabled:!L,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Rehacer",children:g.jsx(FS,{className:"w-5 h-5"})}),g.jsx("button",{onClick:Fe,disabled:!Ue,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Pegar",children:g.jsx(W3,{className:"w-5 h-5"})}),g.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),g.jsx("div",{className:"flex items-center gap-2 group",title:`Suavizado: ${Math.round(Oe*100)}%`,children:g.jsx("input",{type:"range",min:"0",max:"0.95",step:"0.05",value:Oe,onChange:qe=>tt(parseFloat(qe.target.value)),className:"w-24"})}),g.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),ct&&g.jsx("button",{onClick:()=>Q(qe=>!qe),className:`p-2 rounded-md transition-colors ${O?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:O?"Desbloquear Guas":"Bloquear Guas",children:O?g.jsx(sT,{className:"w-5 h-5"}):g.jsx(iT,{className:"w-5 h-5"})}),g.jsxs("div",{className:"relative",children:[g.jsx("button",{ref:rt,onClick:()=>We(qe=>!qe),className:`p-2 rounded-md transition-colors ${ge&&ge.type!=="none"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:"Ajustes de la Retcula",children:g.jsx(nT,{className:"w-5 h-5"})}),et&&ge&&g.jsxs("div",{ref:it,className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-72 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg p-3 space-y-3 z-20",children:[g.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[g.jsx("button",{onClick:()=>s("none"),className:`text-xs p-2 rounded ${ge.type==="none"?"bg-red-500 text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Apagado"}),g.jsxs("button",{onClick:()=>s("cartesian"),className:`flex items-center justify-center gap-1 text-xs p-2 rounded ${ge.type==="cartesian"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:[g.jsx(nT,{className:"w-4 h-4"})," Cartesiana"]}),g.jsxs("button",{onClick:()=>s("isometric"),className:`flex items-center justify-center gap-1 text-xs p-2 rounded ${ge.type==="isometric"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:[g.jsx($3,{className:"w-4 h-4"})," Isomtrica"]})]}),ge.type!=="none"&&g.jsxs(g.Fragment,{children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-[--text-secondary]",children:"Color de Lnea Principal"}),g.jsx("div",{className:"flex items-center gap-2 mt-1",children:St.map(qe=>g.jsx("button",{title:qe.name,onClick:()=>ve(qe.value),className:`w-6 h-6 rounded-full border-2 transition-all ${ge.majorLineColor===qe.value?"border-[--accent-primary] ring-2 ring-offset-2 ring-offset-[--bg-primary] ring-[--accent-primary]":"border-transparent hover:border-gray-400"}`,style:{backgroundColor:qe.value.replace(/, 0.6\)$/,", 1)")}},qe.name))})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs text-[--text-secondary]",children:"Color de Lnea Fina"}),g.jsx("div",{className:"flex items-center gap-2 mt-1",children:_t.map(qe=>g.jsx("button",{title:qe.name,onClick:()=>X(qe.value),className:`w-6 h-6 rounded-full border-2 transition-all ${ge.minorLineColor===qe.value?"border-[--accent-primary] ring-2 ring-offset-2 ring-offset-[--bg-primary] ring-[--accent-primary]":"border-transparent hover:border-gray-400"}`,style:{backgroundColor:qe.value.replace(/, 0.3\)$/,", 1)")}},qe.name))})]}),g.jsx("div",{className:"border-t border-[--bg-tertiary] my-2"}),g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"grid-spacing",className:"text-xs text-[--text-secondary]",children:["Espaciado: ",Gt]}),g.jsx("input",{type:"range",id:"grid-spacing",min:"10",max:"200",step:"5",value:Ae,onChange:qe=>{Ne(qe.target.value),$(parseInt(qe.target.value))},className:"w-full"})]}),g.jsxs("div",{children:[g.jsxs("label",{htmlFor:"major-line-freq",className:"text-xs text-[--text-secondary]",children:["Lnea principal cada: ",Se]}),g.jsx("input",{type:"range",id:"major-line-freq",min:"2",max:"10",step:"1",value:Se,onChange:qe=>{De(qe.target.value),G(parseInt(qe.target.value))},className:"w-full"})]}),ge.type==="isometric"&&g.jsx("div",{children:g.jsx("label",{className:"text-xs text-[--text-secondary]",children:"ngulo: 60"})})]})]})]}),g.jsx("button",{onClick:a,disabled:!ge||ge.type==="none",className:`p-2 rounded-md transition-colors ${r?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"} disabled:opacity-50 disabled:cursor-not-allowed`,title:"Ajustar a la Retcula",children:g.jsx(ym,{className:"w-5 h-5"})}),k==="perspective"&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),g.jsx("button",{onClick:()=>ie(qe=>!qe),className:`p-2 rounded-md transition-colors ${te?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:te?"Desactivar bloqueo de trazo a perspectiva":"Activar bloqueo de trazo a perspectiva",children:g.jsx(ym,{className:"w-5 h-5"})})]}),g.jsx("button",{onClick:E,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Limpiar Lienzo",children:g.jsx(oa,{className:"w-5 h-5"})})]})]})},PO=({isOpen:t,onClose:e,drawableObjects:n,canvasSize:s})=>{const[r,a]=P.useState(!0),[c,d]=P.useState("mi-boceto.png"),[f,h]=P.useState(""),[_,b]=P.useState(!1),[E,S]=P.useState("full"),L=P.useRef(null),U=n.find(H=>H.isBackground),F=(U==null?void 0:U.isVisible)??!1,z=P.useCallback(H=>{let Y=null;return H.forEach(K=>{if(!K.canvas)return;const R=tf(K.canvas);if(R)if(!Y)Y={...R};else{const T=Math.min(Y.x,R.x),N=Math.min(Y.y,R.y),I=Math.max(Y.x+Y.width,R.x+R.width),D=Math.max(Y.y+Y.height,R.y+R.height);Y={x:T,y:N,width:I-T,height:D-N}}}),Y},[]),q=P.useCallback(async(H,Y)=>{var k;if(!L.current||s.width===0)return null;const K=L.current,R=document.createElement("canvas");R.width=s.width,R.height=s.height;const T=R.getContext("2d");if(!T)return null;T.clearRect(0,0,R.width,R.height),H&&U&&U.canvas&&U.isVisible&&T.drawImage(U.canvas,0,0);const N=n.filter(M=>!M.isBackground&&M.isVisible&&M.canvas);for(const M of[...N].reverse())T.globalAlpha=M.opacity,T.drawImage(M.canvas,0,0),T.globalAlpha=1;if(Y==="full"){K.width=s.width,K.height=s.height;const M=K.getContext("2d");return M==null||M.drawImage(R,0,0),K}const I=z(N);if(!I)return K.width=1,K.height=1,(k=K.getContext("2d"))==null||k.clearRect(0,0,1,1),K;K.width=I.width,K.height=I.height;const D=K.getContext("2d");return D?(D.drawImage(R,I.x,I.y,I.width,I.height,0,0,I.width,I.height),K):null},[s,n,U,z]);P.useEffect(()=>{t&&(a(F),S("full"))},[t,F]),P.useEffect(()=>{t&&(b(!0),q(r,E).then(H=>{H&&h(H.toDataURL("image/png")),b(!1)}))},[t,r,E,q]);const j=async()=>{b(!0);const H=await q(r,E);if(!H){alert("Error al generar la imagen."),b(!1);return}H.toBlob(Y=>{if(Y){const K=URL.createObjectURL(Y),R=document.createElement("a");R.href=K,R.download=c.endsWith(".png")?c:`${c}.png`,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(K),e()}else alert("Error al crear el archivo de imagen.");b(!1)},"image/png")};return t?g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:g.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-2xl flex flex-col space-y-4",children:[g.jsx("h2",{className:"text-xl font-bold",children:"Exportar Imagen"}),g.jsxs("div",{className:"flex-grow p-2 rounded-md flex justify-center items-center min-h-0 bg-[--bg-primary]",style:{minHeight:"20rem",backgroundImage:"linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px"},children:[_&&g.jsx("p",{children:"Generando vista previa..."}),!_&&f&&g.jsx("img",{src:f,alt:"Vista previa de la exportacin",className:"max-w-full max-h-80 object-contain"}),g.jsx("canvas",{ref:L,className:"hidden"})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"filename",className:"block text-sm text-[--text-secondary] mb-1",children:"Nombre del Archivo"}),g.jsx("input",{type:"text",id:"filename",value:c,onChange:H=>d(H.target.value),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md p-2"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-[--text-secondary] mb-2",children:"Tamao de Exportacin"}),g.jsxs("div",{className:"flex space-x-4",children:[g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"radio",name:"exportMode",value:"full",checked:E==="full",onChange:()=>S("full"),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] focus:ring-[--accent-primary]"}),g.jsx("span",{className:"ml-2 text-sm",children:"Tamao completo del lienzo"})]}),g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"radio",name:"exportMode",value:"bbox",checked:E==="bbox",onChange:()=>S("bbox"),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] focus:ring-[--accent-primary]"}),g.jsx("span",{className:"ml-2 text-sm",children:"Ajustar a contenido"})]})]})]}),g.jsxs("div",{className:"flex items-center",children:[g.jsx("input",{type:"checkbox",id:"includeBackground",checked:r,onChange:H=>a(H.target.checked),disabled:!F,className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] rounded focus:ring-[--accent-primary] disabled:opacity-50"}),g.jsx("label",{htmlFor:"includeBackground",className:`ml-2 text-sm ${F?"text-[--text-primary]":"text-[--text-secondary] opacity-50"}`,children:"Incluir fondo"})]})]}),g.jsxs("div",{className:"flex justify-end space-x-4 pt-2",children:[g.jsx("button",{onClick:e,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",disabled:_,children:"Cancelar"}),g.jsx("button",{onClick:j,className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white disabled:bg-gray-500 disabled:cursor-wait",disabled:_,children:_?"Exportando...":"Exportar como PNG"})]})]})}):null},LO=({isOpen:t,onClose:e,item:n,canvasSize:s,onSaveToLibrary:r})=>{const[a,c]=P.useState("full"),[d,f]=P.useState(""),[h,_]=P.useState(""),[b,E]=P.useState(!1),S=P.useRef(null);P.useEffect(()=>{n!=null&&n.name?f(n.name.endsWith(".png")?n.name:`${n.name}.png`):f("objeto.png")},[n]);const L=P.useCallback(async z=>{if(!n||!n.canvas||!S.current)return null;const q=n.canvas,j=S.current;if(z==="full"){j.width=s.width,j.height=s.height;const H=j.getContext("2d");if(!H)return null;H.clearRect(0,0,j.width,j.height),H.globalAlpha=n.opacity,H.drawImage(q,0,0),H.globalAlpha=1}else{const H=tf(q);if(H){j.width=H.width,j.height=H.height;const Y=j.getContext("2d");if(!Y)return null;Y.clearRect(0,0,j.width,j.height),Y.globalAlpha=n.opacity,Y.drawImage(q,H.x,H.y,H.width,H.height,0,0,H.width,H.height),Y.globalAlpha=1}else{j.width=1,j.height=1;const Y=j.getContext("2d");Y==null||Y.clearRect(0,0,1,1)}}return j},[n,s]);P.useEffect(()=>{!t||!n||(E(!0),L(a).then(z=>{z&&_(z.toDataURL("image/png")),E(!1)}))},[t,n,a,L]);const U=async()=>{E(!0);const z=await L(a);if(!z){alert("Error al generar la imagen."),E(!1);return}z.toBlob(q=>{if(q){const j=URL.createObjectURL(q),H=document.createElement("a");H.href=j,H.download=d.endsWith(".png")?d:`${d}.png`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(j),e()}else alert("Error al crear el archivo de imagen.");E(!1)},"image/png")},F=async()=>{E(!0);const z=await L(a);if(!z){alert("Error al generar la imagen."),E(!1);return}const q=z.toDataURL("image/png");r(q,d),E(!1),e()};return t?g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:g.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-2xl flex flex-col space-y-4",children:[g.jsxs("h2",{className:"text-xl font-bold",children:['Exportar Objeto: "',n==null?void 0:n.name,'"']}),g.jsxs("div",{className:"flex-grow p-2 rounded-md flex justify-center items-center min-h-0 bg-[--bg-primary]",style:{minHeight:"20rem",backgroundImage:"linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px"},children:[b&&g.jsx("p",{children:"Generando vista previa..."}),!b&&h&&g.jsx("img",{src:h,alt:"Vista previa de la exportacin",className:"max-w-full max-h-80 object-contain"}),g.jsx("canvas",{ref:S,className:"hidden"})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"filename",className:"block text-sm text-[--text-secondary] mb-1",children:"Nombre del Archivo"}),g.jsx("input",{type:"text",id:"filename",value:d,onChange:z=>f(z.target.value),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md p-2"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-[--text-secondary] mb-2",children:"Tamao de Exportacin"}),g.jsxs("div",{className:"flex space-x-4",children:[g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"radio",name:"exportMode",value:"full",checked:a==="full",onChange:()=>c("full"),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] focus:ring-[--accent-primary]"}),g.jsx("span",{className:"ml-2 text-sm",children:"Tamao completo del lienzo"})]}),g.jsxs("label",{className:"flex items-center",children:[g.jsx("input",{type:"radio",name:"exportMode",value:"bbox",checked:a==="bbox",onChange:()=>c("bbox"),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] focus:ring-[--accent-primary]"}),g.jsx("span",{className:"ml-2 text-sm",children:"Ajustar a contenido"})]})]})]})]}),g.jsxs("div",{className:"flex justify-end space-x-4 pt-2",children:[g.jsx("button",{onClick:e,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",disabled:b,children:"Cancelar"}),g.jsxs("button",{onClick:F,className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-500 text-white disabled:bg-gray-500 disabled:cursor-wait flex items-center gap-2",disabled:b,children:[g.jsx(Ty,{className:"w-4 h-4"}),b?"Guardando...":"Guardar en Librera"]}),g.jsx("button",{onClick:U,className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white disabled:bg-gray-500 disabled:cursor-wait",disabled:b,children:b?"Exportando...":"Exportar como PNG"})]})]})}):null},VO=({user:t})=>{const[e,n]=P.useState(!1),s=P.useRef(null),r=async()=>{const c=new lr;try{await gL(ag,c)}catch(d){console.error("Error during sign-in:",d),alert("Could not sign in. Please check the console for details.")}},a=async()=>{try{await WP(ag),n(!1)}catch(c){console.error("Error during sign-out:",c)}};return P.useEffect(()=>{const c=d=>{s.current&&!s.current.contains(d.target)&&n(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),t?g.jsxs("div",{className:"relative",ref:s,children:[g.jsx("button",{onClick:()=>n(c=>!c),className:"w-10 h-10 rounded-full border-2 border-[--accent-primary] overflow-hidden focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[--accent-primary] focus:ring-offset-[--bg-primary]",children:g.jsx("img",{src:t.photoURL||void 0,alt:t.displayName||"User Avatar",className:"w-full h-full object-cover"})}),e&&g.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg z-30 py-1",children:[g.jsxs("div",{className:"px-3 py-2 border-b border-[--bg-tertiary]",children:[g.jsx("p",{className:"text-sm font-semibold truncate",children:t.displayName}),g.jsx("p",{className:"text-xs text-[--text-secondary] truncate",children:t.email})]}),g.jsxs("button",{onClick:a,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left text-[--text-primary] hover:bg-[--bg-hover]",children:[g.jsx(Q3,{className:"w-4 h-4"}),g.jsx("span",{children:"Logout"})]})]})]}):g.jsxs("button",{onClick:r,className:"p-2 flex items-center gap-2 rounded-md bg-[--bg-secondary] text-[--text-primary] hover:bg-[--bg-tertiary] border border-[--bg-tertiary] transition-colors text-sm",title:"Login with Google",children:[g.jsx(X3,{className:"w-5 h-5"}),g.jsx("span",{children:"Login"})]})};function UO(t,e,n){const s=[{x:0,y:0},{x:e.width,y:0},{x:e.width,y:e.height},{x:0,y:e.height}],r=[n.tl,n.tr,n.br,n.bl],a=WS(r,s);if(!a){console.error("Could not compute homography matrix for warping."),t.drawImage(e,n.tl.x,n.tl.y);return}const c=Math.floor(Math.min(n.tl.x,n.tr.x,n.br.x,n.bl.x)),d=Math.floor(Math.min(n.tl.y,n.tr.y,n.br.y,n.bl.y)),f=Math.ceil(Math.max(n.tl.x,n.tr.x,n.br.x,n.bl.x)),h=Math.ceil(Math.max(n.tl.y,n.tr.y,n.br.y,n.bl.y)),_=f-c,b=h-d;if(_<=0||b<=0)return;const E=e.getContext("2d",{willReadFrequently:!0});if(!E)return;const S=E.getImageData(0,0,e.width,e.height),L=t.createImageData(_,b),U=S.data,F=L.data,z=S.width,q=S.height;for(let j=0;j<b;j++)for(let H=0;H<_;H++){const Y=c+H,K=d+j,R=a[6]*Y+a[7]*K+a[8],T=(a[0]*Y+a[1]*K+a[2])/R,N=(a[3]*Y+a[4]*K+a[5])/R;if(T>=0&&T<z-1&&N>=0&&N<q-1){const I=Math.floor(T),D=Math.floor(N),k=T-I,M=N-D,ce=(D*z+I)*4,ge=(D*z+(I+1))*4,$=((D+1)*z+I)*4,G=((D+1)*z+(I+1))*4,ae=(j*_+H)*4;for(let ve=0;ve<4;ve++){const X=U[ce+ve],O=U[ge+ve],Q=U[$+ve],te=U[G+ve],ie=X+(O-X)*k,Ce=Q+(te-Q)*k,be=ie+(Ce-ie)*M;F[ae+ve]=be}}}t.putImageData(L,c,d)}const XS={objects:[{id:"background",name:"Background",type:"object",isVisible:!0,opacity:1,parentId:null,isBackground:!0,color:"#F0F0F0"},{id:"object-1",name:"Objeto 1",type:"object",isVisible:!0,opacity:1,parentId:null}],canvasSize:{width:0,height:0},scaleFactor:.1,scaleUnit:"cm"};function OO(t,e){switch(e.type){case"INITIALIZE_CANVASES":{const{width:n,height:s}=e.payload,r=t.objects.map(a=>{if(!a.canvas){const{canvas:c,context:d}=Os(n,s);return a.isBackground&&(d.fillStyle=a.color||"#F0F0F0",d.fillRect(0,0,n,s)),{...a,canvas:c,context:d}}return a});return{...t,objects:r,canvasSize:{width:n,height:s}}}case"ADD_ITEM":{const{type:n,activeItemId:s,canvasSize:r,newItemId:a,imageElement:c,name:d,initialDimensions:f}=e.payload,h=s?t.objects.find(S=>S.id===s):null;let _=null;h&&(_=h.type==="group"?h.id:h.parentId);let b;if(n==="group")b={id:a??`group-${Date.now()}`,name:d??`Carpeta ${t.objects.filter(L=>L.type==="group").length+1}`,type:"group",isVisible:!0,opacity:1,parentId:_};else{const S={id:a??`object-${Date.now()}`,name:d??`Objeto ${t.objects.filter(F=>F.type==="object"&&!F.isBackground).length+1}`,type:"object",isVisible:!0,opacity:1,parentId:_},{canvas:L,context:U}=Os(r.width,r.height);if(S.canvas=L,S.context=U,c)if(f){const F=(r.width-f.width)/2,z=(r.height-f.height)/2;U.drawImage(c,F,z,f.width,f.height)}else U.drawImage(c,0,0);b=S}const E=[...t.objects];if(h&&h.type!=="group"){const S=E.findIndex(L=>L.id===s);S!==-1?E.splice(S+1,0,b):E.push(b)}else E.push(b);return{...t,objects:E}}case"ADD_ITEM_BELOW":{const{targetId:n,canvasSize:s,newItemId:r}=e.payload,a=t.objects.find(b=>b.id===n);if(!a)return t;const c={id:r,name:`Objeto ${t.objects.filter(b=>b.type==="object"&&!b.isBackground).length+1}`,type:"object",isVisible:!0,opacity:1,parentId:a.parentId},{canvas:d,context:f}=Os(s.width,s.height);c.canvas=d,c.context=f;const h=[...t.objects],_=h.findIndex(b=>b.id===n);return _!==-1?h.splice(_,0,c):h.push(c),{...t,objects:h}}case"PASTE_FROM_CLIPBOARD":{const{newItemId:n,clipboard:s,canvasSize:r,activeItemId:a}=e.payload,c=a?t.objects.find(b=>b.id===a):null,d=c?c.type==="group"?c.id:c.parentId:null,{canvas:f,context:h}=Os(r.width,r.height);h.putImageData(s.imageData,s.sourceRect.x,s.sourceRect.y);const _={id:n,name:`Pegado ${t.objects.filter(b=>b.name.startsWith("Pegado")).length+1}`,type:"object",isVisible:!0,opacity:1,parentId:d,canvas:f,context:h};return{...t,objects:[...t.objects,_]}}case"DELETE_ITEM":{const{id:n}=e.payload,s=new Set([n]),r=d=>{t.objects.forEach(f=>{f.parentId===d&&(s.add(f.id),f.type==="group"&&r(f.id))})},a=t.objects.find(d=>d.id===n);a&&a.type==="group"&&r(n);const c=t.objects.filter(d=>!s.has(d.id));return{...t,objects:c}}case"UPDATE_ITEM":{const{id:n,updates:s}=e.payload,r=t.objects.map(a=>a.id===n?{...a,...s}:a);return{...t,objects:r}}case"MOVE_ITEM":{const{draggedId:n,targetId:s,position:r}=e.payload;if(n===s)return t;const a=(S,L)=>{const U=t.objects.find(F=>F.id===L);return!U||!U.parentId?!1:U.parentId===S?!0:a(S,U.parentId)};if(a(n,s))return t;const c=t.objects.find(S=>S.id===n),d=t.objects.find(S=>S.id===s);if(!c||!d)return t;const f=t.objects.filter(S=>S.id!==n);let h,_;if(r==="middle"&&d.type==="group"){h=d.id;const S=f.filter(L=>L.parentId===d.id);if(S.length>0){const L=S[S.length-1];_=f.findIndex(U=>U.id===L.id)+1}else _=f.findIndex(L=>L.id===s)+1}else{h=d.parentId;const S=f.findIndex(L=>L.id===s);_=r==="top"?S:S+1}const b={...c,parentId:h},E=[...f];return E.splice(_,0,b),{...t,objects:E}}case"COPY_ITEM":{const{id:n}=e.payload,s=t.objects.findIndex(f=>f.id===n);if(s===-1)return t;const r=t.objects[s];if(r.type==="object"&&r.isBackground)return t;let a;const c={...r,id:`${r.type}-${Date.now()}`,name:`Copia de ${r.name}`};if(r.canvas){const{canvas:f,context:h}=Os(r.canvas.width,r.canvas.height);h.drawImage(r.canvas,0,0),c.canvas=f,c.context=h}a=c;const d=[...t.objects];return d.splice(s+1,0,a),{...t,objects:d}}case"MERGE_ITEMS":{const{sourceId:n,targetId:s}=e.payload,r=t.objects.find(z=>z.id===n),a=t.objects.find(z=>z.id===s);if(!r||!a||!r.canvas||!a.canvas)return t;const c=t.objects.findIndex(z=>z.id===n),d=t.objects.findIndex(z=>z.id===s),f=c>d?r:a,h=c>d?a:r,{canvas:_,context:b}=Os(h.canvas.width,h.canvas.height),E=z=>{const{canvas:q,context:j}=Os(z.canvas.width,z.canvas.height);j.drawImage(z.canvas,0,0);try{const H=j.getImageData(0,0,q.width,q.height),Y=H.data;for(let K=3;K<Y.length;K+=4)Y[K]=Y[K]*z.opacity;j.putImageData(H,0,0)}catch(H){console.error("Could not bake opacity, falling back to simple draw.",H),j.clearRect(0,0,q.width,q.height),j.globalAlpha=z.opacity,j.drawImage(z.canvas,0,0),j.globalAlpha=1}return q},S=E(h);b.drawImage(S,0,0);const L=E(f);b.drawImage(L,0,0);const U={...h,canvas:_,context:b,opacity:1},F=t.objects.map(z=>z.id===h.id?U:z).filter(z=>z.id!==f.id);return{...t,objects:F}}case"UPDATE_BACKGROUND":{const{color:n,image:s}=e.payload,r=t.objects.map(a=>{if(a.type==="object"&&a.isBackground&&a.context){const c={...a};return n&&(c.color=n,c.context.fillStyle=n,c.context.fillRect(0,0,a.context.canvas.width,a.context.canvas.height),c.backgroundImage&&c.context.drawImage(c.backgroundImage,0,0)),s&&(c.backgroundImage=s,c.context.clearRect(0,0,a.context.canvas.width,a.context.canvas.height),c.color&&(c.context.fillStyle=c.color,c.context.fillRect(0,0,a.context.canvas.width,a.context.canvas.height)),c.context.drawImage(s,0,0,a.context.canvas.width,a.context.canvas.height)),c}return a});return{...t,objects:r}}case"SET_CANVAS_FROM_IMAGE":{const{image:n}=e.payload,s={width:n.width,height:n.height},r=t.objects.map(a=>{const c=a.canvas,{canvas:d,context:f}=Os(s.width,s.height);return a.isBackground?(f.drawImage(n,0,0),{...a,canvas:d,context:f,color:"#FFFFFF",backgroundImage:n}):(c&&f.drawImage(c,0,0),{...a,canvas:d,context:f})});return{...t,objects:r,canvasSize:s}}case"REMOVE_BACKGROUND_IMAGE":{const n=t.objects.map(s=>{if(s.type==="object"&&s.isBackground&&s.context){s.context.fillStyle=s.color||"#FFFFFF",s.context.fillRect(0,0,s.context.canvas.width,s.context.canvas.height);const{backgroundImage:r,...a}=s;return{...a,color:s.color||"#FFFFFF"}}return s});return{...t,objects:n}}case"CLEAR_CANVAS":{const n={...XS};return t.canvasSize.width>0&&(n.objects.forEach(s=>{const{canvas:r,context:a}=Os(t.canvasSize.width,t.canvasSize.height);s.type==="object"&&(s.canvas=r,s.context=a,s.isBackground&&(a.fillStyle=s.color,a.fillRect(0,0,r.width,r.height)))}),n.canvasSize=t.canvasSize),n}case"CROP_CANVAS":{const{cropRect:n}=e.payload,s={width:Math.round(n.width),height:Math.round(n.height)},r=t.objects.map(a=>{if(a.canvas){const{canvas:c,context:d}=Os(s.width,s.height);return d.drawImage(a.canvas,n.x,n.y,n.width,n.height,0,0,s.width,s.height),{...a,canvas:c,context:d}}return a});return{...t,objects:r,canvasSize:s}}case"RESIZE_CANVAS":{const{width:n,height:s}=e.payload,r={width:Math.round(n),height:Math.round(s)},a=t.objects.map(c=>{if(c.canvas){const{canvas:d,context:f}=Os(r.width,r.height);if(c.isBackground)c.backgroundImage?(f.fillStyle=c.color||"#FFFFFF",f.fillRect(0,0,r.width,r.height),f.drawImage(c.backgroundImage,0,0,r.width,r.height)):(f.fillStyle=c.color||"#FFFFFF",f.fillRect(0,0,r.width,r.height));else{const h=(r.width-c.canvas.width)/2,_=(r.height-c.canvas.height)/2;f.drawImage(c.canvas,h,_)}return{...c,canvas:d,context:f}}return c});return{...t,objects:a,canvasSize:r}}case"APPLY_TRANSFORM":{const{id:n,transform:s,sourceBbox:r}=e.payload,a=t.objects.findIndex(S=>S.id===n);if(a===-1)return t;const c=t.objects[a];if(!c.canvas||!c.context)return t;const d=document.createElement("canvas");d.width=r.width,d.height=r.height;const f=d.getContext("2d",{willReadFrequently:!0});if(!f)return t;f.drawImage(c.canvas,r.x,r.y,r.width,r.height,0,0,r.width,r.height);const{canvas:h,context:_}=Os(c.canvas.width,c.canvas.height);if(_.drawImage(c.canvas,0,0),_.save(),_.globalCompositeOperation="destination-out",_.fillRect(r.x,r.y,r.width,r.height),_.restore(),s.type==="free"){const{corners:S}=s;UO(_,d,S)}else s.type==="affine"&&(_.save(),_.translate(s.x+s.width/2,s.y+s.height/2),_.rotate(s.rotation),_.scale(s.width/r.width,s.height/r.height),_.drawImage(d,-d.width/2,-d.height/2),_.restore());const b={...c,canvas:h,context:_},E=[...t.objects];return E[a]=b,{...t,objects:E}}case"SET_SCALE_FACTOR":return{...t,scaleFactor:e.payload};case"SET_SCALE_UNIT":return{...t,scaleUnit:e.payload};case"SNAPSHOT":case"COMMIT_DRAWING":return{...t};default:return t}}const BO={past:[],present:XS,future:[]};function zO(t,e){const{past:n,present:s,future:r}=t;if(e.type==="UNDO"){if(n.length===0)return t;const f=n[n.length-1];return{past:n.slice(0,n.length-1),present:f,future:[s,...r]}}if(e.type==="REDO"){if(r.length===0)return t;const f=r[0],h=r.slice(1);return{past:[...n,s],present:f,future:h}}if(e.type==="LOAD_PROJECT_STATE")return{past:[],present:e.payload.newState,future:[]};if(e.type==="COMMIT_DRAWING"){const{activeItemId:f,beforeCanvas:h}=e.payload,_=h.getContext("2d",{willReadFrequently:!0});if(!_)return console.error("Could not get context for beforeCanvas in COMMIT_DRAWING"),t;const b={...s,objects:s.objects.map(L=>{if(L.id===f&&L.type==="object")return{...L,canvas:h,context:_};if(L.type==="object"&&L.canvas){const{canvas:U,context:F}=_T(L.canvas);return{...L,canvas:U,context:F}}return L})},E=[...n,b].slice(-50),S={...s,objects:[...s.objects]};return{past:E,present:S,future:[]}}const a=OO(s,e);if(s===a)return t;const c={...s,objects:s.objects.map(f=>{if(f.type==="object"&&f.canvas){const{canvas:h,context:_}=_T(f.canvas);return{...f,canvas:h,context:_}}return f})};return{past:[...n,c].slice(-50),present:a,future:[]}}const jO={size:3,opacity:1,color:"#000000",lineCap:"round",lineJoin:"round",hasStrokeCaps:!0,pressureControl:{size:!0}},FO={size:50,opacity:1,hardness:100,tipShape:"round"},qO={size:10,opacity:.8,color:"#facc15",tipShape:"square",blendMode:"source-over",pressureControl:{opacity:!0}},HO={size:20,opacity:.7,color:"#34d399",pressureControl:{size:!0,opacity:!0}},GO={size:60,flow:.5,color:"#60a5fa",pressureControl:{flow:!0}},$O={presetId:null,size:50,opacity:1,color:"#c084fc"},YO={size:30,color:"#f87171",tipShape:"circle",tipAngle:0,hardness:80,flow:90,wetness:10,spacing:25,blendMode:"source-over",pressureControl:{size:!0,flow:!0}},JO={size:40,flow:50,wetness:50,color:"#3b82f6",pressureControl:{size:!0,flow:!1}},KO={tolerance:30,contiguous:!0},WO={content:"Texto",fontFamily:"Arial",fontSize:48,color:"#000000",textAlign:"left",fontWeight:"normal"},TT="sketcher-fx-presets";function XO(){const[t,e]=P.useState(jO),[n,s]=P.useState(FO),[r,a]=P.useState(qO),[c,d]=P.useState(HO),[f,h]=P.useState(GO),[_,b]=P.useState($O),[E,S]=P.useState(YO),[L,U]=P.useState(JO),[F,z]=P.useState(KO),[q,j]=P.useState(WO),[H,Y]=P.useState([]);P.useEffect(()=>{try{const D=localStorage.getItem(TT);D&&Y(JSON.parse(D))}catch(D){console.error("Failed to load FX presets from localStorage",D)}},[]);const K=P.useCallback(D=>{try{localStorage.setItem(TT,JSON.stringify(D))}catch(k){console.error("Failed to save FX presets to localStorage",k)}},[]),R=P.useCallback(D=>{const k={id:`fx-${Date.now()}`,name:D};Y(M=>{const ce=[...M,k];return K(ce),ce})},[K]),T=P.useCallback((D,k)=>{Y(M=>{const ce=M.map(ge=>ge.id===D?{...ge,...k}:ge);return K(ce),ce})},[K]),N=P.useCallback(D=>{b(k=>({...k,presetId:D}))},[]),I=P.useCallback(D=>{Y(k=>{const M=k.filter(ce=>ce.id!==D);return K(M),M})},[K]);return{brushSettings:t,setBrushSettings:e,eraserSettings:n,setEraserSettings:s,simpleMarkerSettings:r,setSimpleMarkerSettings:a,naturalMarkerSettings:c,setNaturalMarkerSettings:d,airbrushSettings:f,setAirbrushSettings:h,fxBrushSettings:_,setFxBrushSettings:b,advancedMarkerSettings:E,setAdvancedMarkerSettings:S,watercolorSettings:L,setWatercolorSettings:U,magicWandSettings:F,setMagicWandSettings:z,textSettings:q,setTextSettings:j,brushPresets:H,onSavePreset:R,onUpdatePreset:T,onLoadPreset:N,onDeletePreset:I}}const QO=t=>{try{const e=t.split(",");if(e.length<2)return null;const n=e[0].match(/:(.*?);/);if(!n)return null;const s=n[1],r=atob(e[1]);let a=r.length;const c=new Uint8Array(a);for(;a--;)c[a]=r.charCodeAt(a);return new Blob([c],{type:s})}catch(e){return console.error("Error converting data URL to blob",e),null}};function ZO(t){const[e,n]=P.useState([]),[s,r]=P.useState(null),[a,c]=P.useState(null);P.useEffect(()=>{if(t){const U=ng(Zr(Mi,`users/${t.uid}/libraryItems`),yS("createdAt","desc")),F=xS(U,async z=>{const q=z.docs.map(async H=>{const Y=H.data();if(Y.type==="folder")return{id:H.id,name:Y.name,type:"folder",parentId:Y.parentId||null};if(!Y.storagePath)return null;const K=await fh(Ni(ki,Y.storagePath));return{id:H.id,name:Y.name,type:"image",storagePath:Y.storagePath,transparentColors:Y.transparentColors||[],scaleFactor:Y.scaleFactor||5,tolerance:Y.tolerance,dataUrl:K,parentId:Y.parentId||null,scaleUnit:Y.scaleUnit||"mm"}}),j=(await Promise.all(q)).filter(Boolean);n(j)},z=>{console.error("Error fetching library items:",z)});return()=>F()}else n([])},[t]);const d=P.useCallback(async(U,F,z)=>{if(!t){alert("Please log in to save items to your library.");return}const q=`users/${t.uid}/library/${Date.now()}_${U.name}`,j=Ni(ki,q);try{await hh(j,U),await sg(Zr(Mi,`users/${t.uid}/libraryItems`),{name:U.name.split(".").slice(0,-1).join(".")||"Image",storagePath:q,createdAt:ig(),type:"image",parentId:F,scaleFactor:(z==null?void 0:z.scaleFactor)||5})}catch(H){console.error("Error uploading file to library:",H),alert("Failed to upload image.")}},[t]),f=P.useCallback(async(U,F)=>{if(!t){alert("Please log in to create folders.");return}try{await sg(Zr(Mi,`users/${t.uid}/libraryItems`),{name:U,parentId:F,type:"folder",createdAt:ig()})}catch(z){console.error("Error creating folder:",z)}},[t]),h=P.useCallback(async(U,F)=>{if(!t){alert("Please log in to manage library items.");return}const z=Zr(Mi,`users/${t.uid}/libraryItems`),q=U.map(j=>{const H=(R,T)=>{const N=e.find(I=>I.id===T);return!N||!N.parentId?!1:N.parentId===R?!0:H(R,N.parentId)},Y=e.find(R=>R.id===j);if((Y==null?void 0:Y.type)==="folder"&&(j===F||F&&H(j,F)))return console.warn(`Cannot move folder "${Y.name}" into itself or a child folder.`),Promise.resolve();const K=ll(z,j);return $E(K,{parentId:F})});try{await Promise.all(q)}catch(j){console.error("Error moving items:",j),alert("Failed to move items.")}},[t,e]),_=P.useCallback(async U=>{const F=e.find(z=>z.id===U);if(!(!F||F.type!=="image"||!F.dataUrl))try{const q=await(await fetch(F.dataUrl)).blob(),j=new FileReader;j.onloadend=()=>{const H=j.result;r({...F,originalDataUrl:H})},j.readAsDataURL(q)}catch(z){console.error("Error preparing image for editing:",z),alert("Could not load image for editing.")}},[e]),b=P.useCallback(async(U,F,z,q,j)=>{if(!s||!t)return;const H=QO(U);if(!H){alert("Error processing image data.");return}const Y=Ni(ki,s.storagePath),K=ll(Mi,`users/${t.uid}/libraryItems`,s.id);try{await hh(Y,H);const R=await fh(Y);await $E(K,{transparentColors:F,scaleFactor:z,tolerance:q,scaleUnit:j}),n(T=>T.map(N=>N.id===s.id&&N.type==="image"?{...N,dataUrl:R,transparentColors:F,scaleFactor:z,tolerance:q,scaleUnit:j}:N)),r(null)}catch(R){console.error("Error applying transparency:",R),alert("Failed to save changes.")}},[t,s]),E=U=>c(U),S=P.useCallback(async()=>{if(!a||!t)return;const U=Zr(Mi,`users/${t.uid}/libraryItems`),F=async z=>{const q=e.find(j=>j.id===z);if(q){if(q.type==="image")await og(Ni(ki,q.storagePath));else if(q.type==="folder"){const j=ng(U,v5("parentId","==",z)),Y=(await E5(j)).docs.map(K=>F(K.id));await Promise.all(Y)}await _S(ll(U,z))}};try{await F(a.id)}catch(z){console.error("Error deleting item:",z),alert("Failed to delete item.")}finally{c(null)}},[a,t,e]);return{libraryItems:e,imageToEdit:s,deletingLibraryItem:a,onImportToLibrary:d,onCreateFolder:f,onEditTransparency:_,onApplyTransparency:b,onDeleteLibraryItem:E,onConfirmDeleteLibraryItem:S,onCancelDeleteLibraryItem:()=>c(null),onCancelEditTransparency:()=>r(null),onMoveItems:h}}function e6(t){const[e,n]=P.useState("none"),[s,r]=P.useState(!1),[a,c]=P.useState([]),[d,f]=P.useState([]),[h,_]=P.useState(null),[b,E]=P.useState({angle:0}),[S,L]=P.useState({type:"cartesian",spacing:10,majorLineFrequency:10,isoAngle:60,majorLineColor:"rgba(239, 68, 68, 0.6)",minorLineColor:"rgba(128, 128, 128, 0.3)"}),[U,F]=P.useState(!1),[z,q]=P.useState(!1),[j,H]=P.useState(!1),Y=P.useCallback($=>{n(G=>{const ae=G===$?"none":$;if((ae==="none"||ae!=="perspective")&&q(!1),ae==="none"&&F(!1),ae==="ruler"&&a.length===0){const{width:ve,height:X}=t;c([{id:`ruler-${Date.now()}`,start:{x:ve*.25,y:X/2},end:{x:ve*.75,y:X/2}}])}if(ae==="perspective"&&!h){const{width:ve,height:X}=t,O=X*.4,Q=ve*.1,te=ve*.9;_({lines:{green:[{id:"g1",start:{x:0,y:0},end:{x:Q,y:O}},{id:"g2",start:{x:0,y:X},end:{x:Q,y:O}}],red:[{id:"r1",start:{x:ve,y:0},end:{x:te,y:O}},{id:"r2",start:{x:ve,y:X},end:{x:te,y:O}}],blue:[{id:"b1",start:{x:ve*.3,y:0},end:{x:ve*.3,y:X}},{id:"b2",start:{x:ve*.7,y:0},end:{x:ve*.7,y:X}}]},guidePoint:{x:ve/2,y:X*.8},extraGuideLines:{green:[],red:[],blue:[]}})}if(ae==="mirror"&&d.length===0){const{width:ve,height:X}=t;f([{id:`mirror-${Date.now()}`,start:{x:ve/2,y:0},end:{x:ve/2,y:X}}])}return ae})},[h,d,a,t]),K=P.useCallback($=>{L(G=>({...G,type:$})),$==="none"&&H(!1)},[]),R=P.useCallback(()=>H($=>!$),[]),T=P.useCallback(()=>r($=>!$),[]),N=P.useCallback($=>{E({angle:$})},[]),I=P.useCallback($=>{$>0&&L(G=>({...G,spacing:$}))},[]),D=P.useCallback($=>{L(G=>({...G,isoAngle:$}))},[]),k=P.useCallback($=>{$>0&&L(G=>({...G,majorLineFrequency:$}))},[]),M=P.useCallback($=>{L(G=>({...G,majorLineColor:$}))},[]),ce=P.useCallback($=>{L(G=>({...G,minorLineColor:$}))},[]),ge=P.useCallback($=>{n($.activeGuide),r($.isOrthogonalVisible),c($.rulerGuides),f($.mirrorGuides),_($.perspectiveGuide),E($.orthogonalGuide),$.gridGuide?L({...$.gridGuide,majorLineColor:$.gridGuide.majorLineColor||"rgba(128, 128, 128, 0.6)",minorLineColor:$.gridGuide.minorLineColor||"rgba(128, 128, 128, 0.3)"}):L(G=>({...G,type:$.isGridVisible?"cartesian":"none",majorLineColor:G.majorLineColor||"rgba(128, 128, 128, 0.6)",minorLineColor:G.minorLineColor||"rgba(128, 128, 128, 0.3)"})),F($.areGuidesLocked),q($.isPerspectiveStrokeLockEnabled),H($.isSnapToGridEnabled)},[]);return{activeGuide:e,isOrthogonalVisible:s,rulerGuides:a,setRulerGuides:c,mirrorGuides:d,setMirrorGuides:f,perspectiveGuide:h,setPerspectiveGuide:_,orthogonalGuide:b,gridGuide:S,areGuidesLocked:U,setAreGuidesLocked:F,isPerspectiveStrokeLockEnabled:z,setIsPerspectiveStrokeLockEnabled:q,isSnapToGridEnabled:j,toggleSnapToGrid:R,onSetActiveGuide:Y,setGridType:K,toggleOrthogonal:T,onSetOrthogonalAngle:N,onSetGridSpacing:I,onSetGridMajorLineFrequency:k,onSetGridIsoAngle:D,onSetGridMajorLineColor:M,onSetGridMinorLineColor:ce,loadGuideState:ge}}const QS=3;function t6(t,e){const[n,s]=P.useState({zoom:1,pan:{x:0,y:0}}),r=P.useCallback(()=>{if(!t.current||!e.width||!e.height)return .01;const d=t.current.offsetWidth,f=t.current.offsetHeight,h=.9,_=d/e.width,b=f/e.height;return Math.max(.01,Math.min(_,b)*h)},[t,e.width,e.height]);P.useEffect(()=>{const d=()=>{if(t.current){const f=t.current.offsetWidth,h=t.current.offsetHeight;s(_=>{const b=(f-e.width*_.zoom)/2,E=(h-e.height*_.zoom)/2;return{zoom:_.zoom,pan:{x:b,y:E}}})}};return window.addEventListener("resize",d),d(),()=>window.removeEventListener("resize",d)},[e.width,e.height,t]);const a=P.useCallback(()=>{if(!t.current||e.width===0)return;const d=t.current.offsetWidth,f=t.current.offsetHeight,h=r(),_=(d-e.width*h)/2,b=(f-e.height*h)/2;s({zoom:h,pan:{x:_,y:b}})},[e.width,e.height,t,r]),c=P.useCallback(d=>{if(!t.current)return;const f=t.current.offsetWidth,h=t.current.offsetHeight,_=f/2,b=h/2;s(E=>{const S=r(),L=Math.max(S,Math.min(E.zoom*d,QS)),U=(_-E.pan.x)/E.zoom,F=(b-E.pan.y)/E.zoom,z=_-U*L,q=b-F*L;return{zoom:L,pan:{x:z,y:q}}})},[t,r]);return{viewTransform:n,setViewTransform:s,onZoomExtents:a,onZoomIn:()=>c(1.2),onZoomOut:()=>c(1/1.2),getMinZoom:r}}function n6(t,e,n,s,r,a){return{onDropOnCanvas:(d,f,h)=>{if(d.type!=="library-item")return;const _=s.find(S=>S.id===d.id);if(!_||_.type!=="image"||!_.dataUrl)return;const b=`object-${Date.now()}`,E=new Image;E.crossOrigin="anonymous",E.onload=()=>{const S=_.scaleFactor||5,L=a/S,U={width:E.width*L,height:E.height*L};n({type:"ADD_ITEM",payload:{type:"object",activeItemId:f,newItemId:b,imageElement:E,canvasSize:r,name:_.name,initialDimensions:U}}),h([b]),e("transform")},E.src=_.dataUrl}}}const wT="sketcher-workspace-templates";function s6(){const[t,e]=P.useState([]);P.useEffect(()=>{try{const a=localStorage.getItem(wT);a&&e(JSON.parse(a))}catch(a){console.error("Failed to load workspace templates from localStorage",a)}},[]);const n=P.useCallback(a=>{try{localStorage.setItem(wT,JSON.stringify(a))}catch(c){console.error("Failed to save workspace templates to localStorage",c),alert("Could not save workspace template. The data may be invalid.")}},[]),s=P.useCallback((a,c)=>{const d={id:`template-${Date.now()}`,name:a,...c};return e(f=>{const h=[...f,d];return n(h),h}),d.id},[n]),r=P.useCallback(a=>{e(c=>{const d=c.filter(f=>f.id!==a);return n(d),d})},[n]);return{templates:t,saveTemplate:s,deleteTemplate:r}}const Ja={colors:["#ef4444","#22c55e","#3b82f6"],sizes:[10,40,150],tools:[{type:"tool",tool:"brush"},{type:"tool",tool:"eraser"},null]};function i6(){const[t,e]=P.useState(Ja),n=P.useCallback((f,h)=>{e(_=>{const b=[..._.colors];return b[f]=h,{..._,colors:b}})},[]),s=P.useCallback(f=>{e(h=>({...h,colors:[...h.colors,f]}))},[]),r=P.useCallback(f=>{e(h=>({...h,colors:h.colors.filter((_,b)=>b!==f)}))},[]),a=P.useCallback((f,h)=>{h>0&&h<=1e3&&e(_=>{const b=[..._.sizes];return b[f]=h,{..._,sizes:b}})},[]),c=P.useCallback((f,h)=>{e(_=>{const b=[..._.tools];return b[f]=h,{..._,tools:b}})},[]),d=P.useCallback(f=>{if(f&&Array.isArray(f.colors)&&Array.isArray(f.sizes)&&Array.isArray(f.tools)){const h={...Ja,...f};h.sizes.length!==3&&(h.sizes=Ja.sizes),h.tools.length!==3&&(h.tools=Ja.tools),h.colors.length===0&&(h.colors=Ja.colors),e(h)}else e(Ja)},[]);return{quickAccessSettings:t,updateColor:n,addColor:s,removeColor:r,updateSize:a,updateTool:c,loadState:d}}function r6(){const[t,e]=P.useState(!1),[n,s]=P.useState("object"),[r,a]=P.useState(""),[c,d]=P.useState(""),[f,h]=P.useState(""),[_,b]=P.useState(100),[E,S]=P.useState("none"),[L,U]=P.useState(!1),[F,z]=P.useState("full"),[q,j]=P.useState("#FFFFFF"),[H,Y]=P.useState(""),[K,R]=P.useState(null),[T,N]=P.useState(""),[I,D]=P.useState(!0),[k,M]=P.useState({main:null,a:null,b:null,c:null}),[ce,ge]=P.useState({description:[],style:[],negative:[]});P.useEffect(()=>{try{const ae=localStorage.getItem("sketcher-ai-prompts");ae&&ge(JSON.parse(ae))}catch(ae){console.error("Failed to load prompts from localStorage",ae)}},[]);const $=(ae,ve)=>{if(!ve.trim()||ce[ae].includes(ve.trim()))return;const X={...ce,[ae]:[...ce[ae],ve.trim()]};ge(X),localStorage.setItem("sketcher-ai-prompts",JSON.stringify(X))},G=(ae,ve)=>{const X={...ce,[ae]:ce[ae].filter(O=>O!==ve)};ge(X),localStorage.setItem("sketcher-ai-prompts",JSON.stringify(X))};return P.useEffect(()=>{L?E==="none"&&S("green"):S("none")},[L,S]),{isOpen:t,setIsOpen:e,activeAiTab:n,setActiveAiTab:s,enhancementPrompt:r,setEnhancementPrompt:a,enhancementStylePrompt:c,setEnhancementStylePrompt:d,enhancementNegativePrompt:f,setEnhancementNegativePrompt:h,enhancementCreativity:_,setEnhancementCreativity:b,enhancementChromaKey:E,setEnhancementChromaKey:S,isChromaKeyEnabled:L,setIsChromaKeyEnabled:U,enhancementInputMode:F,setEnhancementInputMode:z,enhancementPreviewBgColor:q,setEnhancementPreviewBgColor:j,compositionPrompt:H,setCompositionPrompt:Y,styleRef:K,setStyleRef:R,freeFormPrompt:T,setFreeFormPrompt:N,addEnhancedImageToLibrary:I,setAddEnhancedImageToLibrary:D,freeFormSlots:k,setFreeFormSlots:M,savedPrompts:ce,savePrompt:$,deletePrompt:G}}const o6={select:$c,brush:yl,eraser:ru,"simple-marker":qh,"natural-marker":Zh,airbrush:Qh,"fx-brush":Al,transform:Kh,"free-transform":Wh,enhance:Gh,crop:Jh,pan:()=>null,"marquee-rect":$h,lasso:Yh,"magic-wand":ou,"debug-brush":yl,text:Hh,"advanced-marker":Xh,watercolor:ef},a6=({anchorEl:t,initialColor:e,onColorChange:n,onClose:s})=>{const[r,a]=P.useState(e),c=P.useRef(null);P.useEffect(()=>{a(e)},[e]),P.useEffect(()=>{const E=S=>{c.current&&!c.current.contains(S.target)&&!t.contains(S.target)&&s()};return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[s,t]);const d=E=>{const L=`#${E.target.value.toLowerCase()}`;a(L),/^#[0-9a-f]{6}$/i.test(L)&&n(L)},f=E=>{const S=E.target.value;a(S),n(S)},h=t.getBoundingClientRect(),_={position:"fixed",top:`${h.bottom+8}px`,left:`${h.left}px`,zIndex:50},b=["#ef4444","#f97316","#eab308","#84cc16","#22c55e","#14b8a6","#06b6d4","#3b82f6","#8b5cf6","#d946ef","#f43f5e","#78716c","#ffffff","#000000"];return g.jsxs("div",{ref:c,style:_,className:"bg-[--bg-secondary] p-3 rounded-lg shadow-2xl border border-[--bg-tertiary] space-y-3",onPointerDown:E=>E.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("div",{className:"relative w-10 h-10",children:[g.jsx("input",{type:"color",value:r,onChange:f,className:"absolute inset-0 w-full h-full p-0 bg-transparent border-none rounded-md cursor-pointer opacity-0"}),g.jsx("div",{className:"w-10 h-10 rounded-md border border-[--bg-hover]",style:{backgroundColor:r}})]}),g.jsxs("div",{className:"relative",children:[g.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-[--text-secondary] font-mono",children:"#"}),g.jsx("input",{type:"text",value:r.substring(1),onChange:d,className:"w-24 bg-[--bg-tertiary] text-[--text-primary] rounded-md p-2 pl-5 font-mono text-sm",maxLength:6})]})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-xs font-bold text-[--text-secondary] mb-2",children:"Presets"}),g.jsx("div",{className:"grid grid-cols-7 gap-1",children:b.map(E=>g.jsx("button",{onClick:()=>{a(E),n(E)},className:`w-6 h-6 rounded-full border-2 transition-all ${E===r?"border-[--accent-primary]":"border-transparent hover:border-gray-400"}`,style:{backgroundColor:E}},E))})]})]})},l6=({settings:t,onUpdateColor:e,onAddColor:n,onRemoveColor:s,onUpdateSize:r,onSelectColor:a,onSelectSize:c,onSelectTool:d,onOpenToolSelector:f,activeTool:h,activeColor:_,activeSize:b})=>{const[E,S]=P.useState(null),[L,U]=P.useState(null),F=P.useRef(null),[z,q]=P.useState(null),j=P.useRef(null);P.useEffect(()=>{const I=D=>{L&&F.current&&!F.current.contains(D.target)&&U(null)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[L]);const H=(I,D)=>{q({index:I,value:String(D)}),setTimeout(()=>{var k;return(k=j.current)==null?void 0:k.select()},0)},Y=I=>{z!==null&&q({...z,value:I.target.value})},K=()=>{if(z!==null){const I=parseInt(z.value,10);isNaN(I)||r(z.index,I),q(null)}},R=I=>{I.key==="Enter"?K():I.key==="Escape"&&q(null)},T=I=>{if(!I)return g.jsx(ph,{className:"w-5 h-5 text-[--text-secondary]"});if(I.type==="tool"){const D=o6[I.tool];return D?g.jsx(D,{className:"w-5 h-5"}):null}return I.type==="fx-preset"?g.jsx(Al,{className:"w-5 h-5"}):null},N=I=>I?I.type==="tool"?I.tool:I.type==="fx-preset"?`Preset: ${I.name}`:"":"Seleccionar herramienta";return g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"absolute top-4 left-4 right-4 md:left-1/2 md:-translate-x-1/2 md:w-auto md:right-auto bg-[--bg-primary]/80 backdrop-blur-sm rounded-lg p-1 flex flex-wrap items-center justify-center gap-2 shadow-lg z-10",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[t.colors.map((I,D)=>{const k=_&&I.toLowerCase()===_.toLowerCase();return g.jsx("button",{onClick:()=>a(I),onDoubleClick:M=>{S({index:D,initialColor:I,anchorEl:M.currentTarget})},onContextMenu:M=>{M.preventDefault(),U({x:M.clientX,y:M.clientY,index:D})},className:`w-7 h-7 rounded-full border-2 transition-all hover:border-[--accent-primary] ${k?"border-[--accent-primary]":"border-[--bg-secondary]"}`,style:{backgroundColor:I},title:`Color: ${I} (clic para seleccionar, doble clic para editar, clic derecho para eliminar)`},D)}),g.jsx("button",{onClick:()=>n("#ffffff"),className:"w-7 h-7 rounded-full border-2 border-dashed border-[--bg-hover] flex items-center justify-center text-[--text-secondary] hover:bg-[--bg-tertiary] hover:border-[--accent-primary] transition-colors",title:"Agregar color",children:g.jsx(ph,{className:"w-4 h-4"})})]}),g.jsx("div",{className:"h-6 w-px bg-[--bg-hover]"}),g.jsx("div",{className:"flex items-center gap-2",children:t.sizes.map((I,D)=>{const k=I===b;return g.jsx("div",{className:"relative",children:(z==null?void 0:z.index)===D?g.jsx("input",{ref:j,type:"number",value:z.value,onChange:Y,onBlur:K,onKeyDown:R,className:"w-14 text-center bg-[--bg-hover] text-[--text-primary] p-1 rounded-md text-xs"}):g.jsxs("button",{onClick:()=>c(I),onDoubleClick:()=>H(D,I),className:`w-14 p-1 rounded-md text-xs transition-colors ${k?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,title:`Tamao: ${I}px (doble clic para cambiar)`,children:[I,"px"]})},D)})}),g.jsx("div",{className:"h-6 w-px bg-[--bg-hover]"}),g.jsx("div",{className:"flex items-center gap-2",children:t.tools.map((I,D)=>{const k=I!==null&&h!==void 0&&(I.type==="tool"&&I.tool===h||I.type==="fx-preset"&&h==="fx-brush");return g.jsx("button",{onClick:()=>I&&d(I),onContextMenu:M=>{M.preventDefault(),f(D)},className:`p-2 rounded-lg text-[--text-primary] transition-colors ${k?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,title:`${N(I)} (clic derecho para cambiar)`,children:T(I)},D)})})]}),E&&g.jsx(a6,{anchorEl:E.anchorEl,initialColor:E.initialColor,onClose:()=>S(null),onColorChange:I=>{E.index!==null&&(e(E.index,I),S(D=>D?{...D,initialColor:I}:null))}}),L&&g.jsx("div",{ref:F,className:"fixed z-50 bg-[--bg-secondary] rounded-md shadow-lg border border-[--bg-tertiary] py-1",style:{top:L.y,left:L.x},onPointerDown:I=>I.stopPropagation(),children:g.jsx("button",{onClick:()=>{t.colors.length>1?s(L.index):alert("No se puede eliminar el ltimo color."),U(null)},className:"block w-full text-left px-3 py-1 text-sm text-red-500 hover:bg-[--bg-hover]",children:"Eliminar"})})]})},c6=[{name:"select",icon:$c},{name:"marquee-rect",icon:$h},{name:"lasso",icon:Yh},{name:"magic-wand",icon:ou},{name:"text",icon:Hh},{name:"brush",icon:yl},{name:"eraser",icon:ru},{name:"simple-marker",icon:qh},{name:"advanced-marker",icon:Xh},{name:"natural-marker",icon:Zh},{name:"watercolor",icon:ef},{name:"airbrush",icon:Qh},{name:"fx-brush",icon:Al},{name:"transform",icon:Kh},{name:"free-transform",icon:Wh},{name:"enhance",icon:Gh},{name:"crop",icon:Jh}],u6=({isOpen:t,onClose:e,onSelectTool:n,fxPresets:s})=>{if(!t)return null;const r=a=>{n(a),e()};return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:g.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-lg flex flex-col space-y-4 max-h-[80vh]",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("h2",{className:"text-xl font-bold",children:"Seleccionar Herramienta de Acceso Rpido"}),g.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-[--bg-tertiary]",children:g.jsx(bo,{className:"w-6 h-6"})})]}),g.jsxs("div",{className:"flex-grow overflow-y-auto space-y-4 pr-2",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Herramientas Estndar"}),g.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-2",children:c6.map(({name:a,icon:c})=>g.jsxs("button",{onClick:()=>r({type:"tool",tool:a}),className:"flex flex-col items-center justify-center p-3 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] transition-colors",title:a,children:[g.jsx(c,{className:"w-8 h-8"}),g.jsx("span",{className:"text-xs mt-2 capitalize",children:a.replace("-"," ")})]},a))})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Presets de Pincel FX"}),s.length>0?g.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:s.map(a=>g.jsx("button",{onClick:()=>r({type:"fx-preset",id:a.id,name:a.name}),className:"p-3 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] transition-colors text-left",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Al,{className:"w-6 h-6 flex-shrink-0"}),g.jsx("span",{className:"text-sm truncate",children:a.name})]})},a.id))}):g.jsx("p",{className:"text-sm text-[--text-secondary] text-center p-4",children:"No tienes presets de Pincel FX guardados."})]})]})]})})},d6=({isOpen:t,onClose:e,templates:n,onSave:s,onLoad:r,onDelete:a,onResetPreferences:c})=>{const[d,f]=P.useState(""),h=P.useRef(null);P.useEffect(()=>{const b=E=>{h.current&&!h.current.contains(E.target)&&e()};return t&&document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[t,e]);const _=()=>{d.trim()&&(s(d.trim()),f(""))};return t?g.jsxs("div",{ref:h,className:"absolute top-full right-0 mt-2 w-72 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg z-30 py-2 flex flex-col",style:{maxHeight:"calc(100vh - 100px)"},children:[g.jsxs("div",{className:"flex justify-between items-center px-3 pb-2 border-b border-[--bg-tertiary]",children:[g.jsxs("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] flex items-center gap-2",children:[g.jsx(JS,{className:"w-4 h-4"}),g.jsx("span",{children:"Plantillas de Espacio de Trabajo"})]}),g.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-[--bg-hover]",children:g.jsx(bo,{className:"w-5 h-5"})})]}),g.jsx("div",{className:"flex-grow overflow-y-auto p-2 space-y-1",children:n.length>0?n.map(b=>g.jsxs("div",{className:"group flex items-center justify-between p-2 rounded-md hover:bg-[--bg-tertiary]",children:[g.jsx("button",{onClick:()=>r(b.id),className:"flex-grow text-left text-sm truncate",children:b.name}),g.jsx("button",{onClick:()=>a(b.id),className:"p-1 text-[--text-secondary] opacity-0 group-hover:opacity-100 hover:text-red-500",children:g.jsx(oa,{className:"w-4 h-4"})})]},b.id)):g.jsx("div",{className:"text-center text-xs text-[--text-secondary] py-4",children:"No hay plantillas guardadas."})}),g.jsx("div",{className:"px-3 pt-2 border-t border-[--bg-tertiary]",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"text",value:d,onChange:b=>f(b.target.value),onKeyDown:b=>b.key==="Enter"&&_(),placeholder:"Nombre de la nueva plantilla...",className:"flex-grow bg-[--bg-secondary] text-[--text-primary] text-sm rounded-md p-2 border border-[--bg-tertiary] focus:ring-1 focus:ring-[--accent-primary] focus:outline-none"}),g.jsx("button",{onClick:_,disabled:!d.trim(),className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Guardar"})]})}),g.jsx("div",{className:"px-3 pt-2 mt-2 border-t border-[--bg-tertiary]",children:g.jsx("button",{onClick:c,className:"w-full text-center px-4 py-2 text-sm text-red-500 hover:bg-red-500 hover:text-white rounded-md transition-colors",children:"Restablecer todas las preferencias"})})]}):null},_m=({type:t,value:e,savePrompt:n,setPromptLoader:s})=>g.jsxs("div",{className:"flex justify-end gap-2 mt-1",children:[g.jsx("button",{onClick:()=>n(t,e),className:"text-xs px-2 py-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Guardar"}),g.jsx("button",{onClick:r=>s({openFor:t,anchorEl:r.currentTarget}),className:"text-xs px-2 py-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cargar"})]}),h6=({isOpen:t,onClose:e,aiPanelState:n,onEnhance:s,isEnhancing:r,enhancementPreview:a,onGenerateEnhancementPreview:c})=>{const{activeAiTab:d,setActiveAiTab:f,enhancementPrompt:h,setEnhancementPrompt:_,enhancementStylePrompt:b,setEnhancementStylePrompt:E,enhancementNegativePrompt:S,setEnhancementNegativePrompt:L,enhancementCreativity:U,setEnhancementCreativity:F,enhancementChromaKey:z,setEnhancementChromaKey:q,isChromaKeyEnabled:j,setIsChromaKeyEnabled:H,enhancementInputMode:Y,setEnhancementInputMode:K,enhancementPreviewBgColor:R,setEnhancementPreviewBgColor:T,savedPrompts:N,savePrompt:I,deletePrompt:D}=n,[k,M]=dg.useState({openFor:null,anchorEl:null}),ce=P.useRef(null),ge=P.useRef(null);P.useEffect(()=>{const G=ae=>{ce.current&&!ce.current.contains(ae.target)&&M({openFor:null,anchorEl:null})};return document.addEventListener("mousedown",G),()=>document.removeEventListener("mousedown",G)},[]);const $=(G,ae)=>{G==="description"&&_(ae),G==="style"&&E(ae),G==="negative"&&L(ae),M({openFor:null,anchorEl:null})};return t?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:e}),g.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:g.jsxs("div",{ref:ge,className:"bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-[500px] max-h-[90vh] flex flex-col pointer-events-auto",children:[g.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-[--bg-tertiary] flex justify-between items-center",children:[g.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Mejora con IA"}),g.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-[--bg-hover]",children:g.jsx(bo,{className:"w-5 h-5"})})]}),g.jsxs("div",{className:"flex-grow overflow-y-auto p-4 space-y-4",children:[g.jsxs("div",{className:"flex border-b border-[--bg-tertiary]",children:[g.jsx("button",{onClick:()=>f("object"),className:`flex-1 p-2 text-sm font-semibold transition-colors ${d==="object"?"text-[--accent-primary] border-b-2 border-[--accent-primary]":"text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,children:"OBJETO"}),g.jsx("button",{onClick:()=>f("composition"),className:`flex-1 p-2 text-sm font-semibold transition-colors ${d==="composition"?"text-[--accent-primary] border-b-2 border-[--accent-primary]":"text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,children:"COMPOSICIN"}),g.jsx("button",{onClick:()=>f("free"),className:`flex-1 p-2 text-sm font-semibold transition-colors ${d==="free"?"text-[--accent-primary] border-b-2 border-[--accent-primary]":"text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,children:"LIBRE"})]}),d==="object"&&g.jsxs("div",{className:"space-y-4",children:[g.jsx("div",{style:{backgroundColor:R},className:"rounded-md p-2 aspect-video flex items-center justify-center",children:a?g.jsx("img",{src:Y==="bbox"&&a.croppedDataUrl?a.croppedDataUrl:a.fullDataUrl,alt:"AI Input Preview",className:"max-w-full max-h-full object-contain"}):g.jsx("div",{className:"flex flex-col items-center",children:g.jsx("span",{className:"text-xs text-[--text-secondary]",children:"Generando vista previa..."})})}),g.jsxs("div",{children:[g.jsx("label",{htmlFor:"preview-bg-color",className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Fondo"}),g.jsx("input",{type:"color",id:"preview-bg-color",value:R,onChange:G=>T(G.target.value),className:"w-full h-8 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer",disabled:r})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-2",children:"Imagen de Entrada"}),g.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[g.jsx("button",{onClick:()=>K("full"),disabled:r,className:`text-xs p-2 rounded transition-colors ${Y==="full"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Lienzo Completo"}),g.jsx("button",{onClick:()=>K("bbox"),disabled:r||!(a!=null&&a.bbox),className:`text-xs p-2 rounded transition-colors ${Y==="bbox"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed"}`,children:"Ajustar a Contenido"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Descripcin del Objeto (Necesario)"}),g.jsx("textarea",{value:h,onChange:G=>_(G.target.value),placeholder:"Ej: 'aade un castillo de fantasa en el fondo'",className:"w-full h-20 p-2 bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md resize-none",disabled:r}),g.jsx(_m,{type:"description",value:h,savePrompt:I,setPromptLoader:M})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Estilo (Necesario)"}),g.jsx("textarea",{value:b,onChange:G=>E(G.target.value),placeholder:"Ej: 'fotorrealista, colores vivos, pintura al leo'",className:"w-full h-16 p-2 bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md resize-none",disabled:r}),g.jsx(_m,{type:"style",value:b,savePrompt:I,setPromptLoader:M})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Negativo/Evitar (Opcional)"}),g.jsx("textarea",{value:S,onChange:G=>L(G.target.value),placeholder:"Ej: 'borroso, baja resolucin, texto, marcas de agua'",className:"w-full h-16 p-2 bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md resize-none",disabled:r}),g.jsx(_m,{type:"negative",value:S,savePrompt:I,setPromptLoader:M})]}),g.jsxs("div",{children:[g.jsxs("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:["Creatividad: ",U]}),g.jsx("input",{type:"range",min:"0",max:"150",value:U,onChange:G=>F(parseInt(G.target.value)),className:"w-full",disabled:r}),g.jsxs("div",{className:"flex justify-between text-xs text-[--text-secondary] mt-1",children:[g.jsx("span",{children:"Fiel"}),g.jsx("span",{children:"Equilibrado"}),g.jsx("span",{children:"Imaginativo"})]})]}),g.jsxs("div",{className:"flex items-center justify-between py-1",children:[g.jsx("label",{htmlFor:"chroma-key-toggle",className:"text-xs font-bold text-[--text-secondary]",children:"Forzar Fondo Chroma"}),g.jsx("button",{id:"chroma-key-toggle",role:"switch","aria-checked":j,onClick:()=>H(G=>!G),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[--accent-primary] focus:ring-offset-[--bg-primary] ${j?"bg-[--accent-primary]":"bg-[--bg-tertiary]"}`,disabled:r,children:g.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${j?"translate-x-6":"translate-x-1"}`})})]}),j&&g.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[g.jsx("button",{onClick:()=>q("green"),disabled:r,className:`text-xs p-2 rounded transition-colors ${z==="green"?"bg-green-600 text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Verde"}),g.jsx("button",{onClick:()=>q("blue"),disabled:r,className:`text-xs p-2 rounded transition-colors ${z==="blue"?"bg-blue-600 text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Azul"})]}),g.jsx("button",{onClick:()=>s({activeAiTab:d,enhancementPrompt:h,enhancementStylePrompt:b,enhancementNegativePrompt:S,enhancementCreativity:U,enhancementInputMode:Y,enhancementChromaKey:j?z:"none",enhancementPreviewBgColor:R}),disabled:!h.trim()||!b.trim()||r,className:"w-full bg-[--accent-primary] hover:bg-[--accent-hover] text-white font-bold py-2 px-4 rounded-md disabled:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed mt-2",children:r?"Generando...":"Generar"})]})]})]})}),k.openFor&&k.anchorEl&&g.jsx("div",{ref:ce,className:"absolute z-[60] bg-[--bg-secondary] border border-[--bg-tertiary] rounded-lg shadow-lg w-64 max-h-60 overflow-y-auto",style:{left:k.anchorEl.getBoundingClientRect().right+8,top:k.anchorEl.getBoundingClientRect().top},children:g.jsx("ul",{className:"p-1",children:N[k.openFor].length>0?N[k.openFor].map((G,ae)=>g.jsxs("li",{className:"group flex items-center justify-between text-sm text-[--text-primary] rounded-md hover:bg-[--bg-hover]",children:[g.jsx("button",{onClick:()=>$(k.openFor,G),className:"flex-grow text-left p-2 truncate",children:G}),g.jsx("button",{onClick:()=>D(k.openFor,G),className:"p-2 text-[--text-secondary] opacity-0 group-hover:opacity-100 hover:text-red-500",children:g.jsx(oa,{className:"w-4 h-4"})})]},ae)):g.jsx("li",{className:"p-2 text-center text-xs text-[--text-secondary]",children:"No hay prompts guardados."})})})]}):null},f6=({isOpen:t,onCancel:e,onConfirm:n,itemName:s,itemType:r})=>{if(!t)return null;const a=r==="group"?`Ests seguro de que quieres eliminar la carpeta "${s}"? Todos los objetos y subcarpetas dentro de ella tambin sern eliminados.`:`Ests seguro de que quieres eliminar el objeto "${s}"?`;return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:g.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-sm",children:[g.jsx("h2",{className:"text-xl font-bold mb-4",children:"Confirmar Eliminacin"}),g.jsx("p",{className:"text-[--text-secondary] mb-6",children:a}),g.jsxs("div",{className:"flex justify-end space-x-4",children:[g.jsx("button",{onClick:e,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),g.jsx("button",{onClick:n,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Eliminar"})]})]})})},CT={"720p":{width:1280,height:720},"1080p":{width:1920,height:1080},"4K":{width:3840,height:2160}},p6=({isOpen:t,onClose:e,currentSize:n,onApply:s})=>{const[r,a]=P.useState(n.width),[c,d]=P.useState(n.height),[f,h]=P.useState("horizontal");P.useEffect(()=>{t&&(a(n.width),d(n.height),h(n.width>=n.height?"horizontal":"vertical"))},[t,n]);const _=S=>{const L=CT[S].width,U=CT[S].height;f==="horizontal"?(a(L),d(U)):(a(U),d(L))},b=S=>{S!==f&&(h(S),a(c),d(r))},E=()=>{const S=Number(r),L=Number(c);!isNaN(S)&&!isNaN(L)&&S>0&&L>0&&s(S,L)};return t?g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:g.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-md flex flex-col space-y-6",children:[g.jsxs("div",{className:"flex justify-between items-center",children:[g.jsx("h2",{className:"text-xl font-bold",children:"Tamao del Lienzo"}),g.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-[--bg-tertiary]",children:g.jsx(bo,{className:"w-6 h-6"})})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Presets"}),g.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[g.jsx("button",{onClick:()=>_("720p"),className:"p-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] text-sm",children:"720p"}),g.jsx("button",{onClick:()=>_("1080p"),className:"p-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] text-sm",children:"1080p"}),g.jsx("button",{onClick:()=>_("4K"),className:"p-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] text-sm",children:"2160p (4K)"})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Orientacin"}),g.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[g.jsx("button",{onClick:()=>b("horizontal"),className:`p-2 rounded-md text-sm transition-colors ${f==="horizontal"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Horizontal"}),g.jsx("button",{onClick:()=>b("vertical"),className:`p-2 rounded-md text-sm transition-colors ${f==="vertical"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Vertical"})]})]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Personalizado"}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"canvas-width",className:"block text-xs text-[--text-secondary] mb-1",children:"Ancho"}),g.jsx("input",{type:"number",id:"canvas-width",value:r,onChange:S=>a(Number(S.target.value)),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md p-2"})]}),g.jsxs("div",{children:[g.jsx("label",{htmlFor:"canvas-height",className:"block text-xs text-[--text-secondary] mb-1",children:"Alto"}),g.jsx("input",{type:"number",id:"canvas-height",value:c,onChange:S=>d(Number(S.target.value)),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md p-2"})]})]})]}),g.jsxs("div",{className:"flex justify-end space-x-4 pt-2",children:[g.jsx("button",{onClick:e,className:"px-6 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),g.jsx("button",{onClick:E,className:"px-6 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white",children:"Aplicar"})]})]})}):null},m6=({isOpen:t,onCancel:e,onConfirm:n})=>t?g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:g.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-sm",children:[g.jsx("h2",{className:"text-xl font-bold mb-4",children:"Limpiar Lienzo"}),g.jsx("p",{className:"text-[--text-secondary] mb-6",children:"Ests seguro de que quieres borrar todo? Esta accin eliminar todas las capas y no se puede deshacer de forma convencional (aunque s con el botn Deshacer)."}),g.jsxs("div",{className:"flex justify-end space-x-4",children:[g.jsx("button",{onClick:e,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),g.jsx("button",{onClick:n,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Limpiar"})]})]})}):null,g6=({isOpen:t,onCancel:e,onConfirm:n,itemToDelete:s})=>{if(!t||!s)return null;const r=s.type==="folder",a=`Ests seguro de que quieres eliminar "${s.name}"?`;return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:g.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-sm",children:[g.jsx("h2",{className:"text-xl font-bold mb-4",children:"Confirmar Eliminacin"}),g.jsxs("p",{className:"text-[--text-secondary] mb-6",children:[a,r&&g.jsx("strong",{className:"block mt-2 text-[--text-primary]",children:"Esto tambin eliminar permanentemente todo su contenido. Esta accin no se puede deshacer."})]}),g.jsxs("div",{className:"flex justify-end space-x-4",children:[g.jsx("button",{onClick:e,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),g.jsx("button",{onClick:n,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Eliminar"})]})]})})},y6=({isOpen:t,onCancel:e,onConfirm:n})=>t?g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:g.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-sm",children:[g.jsx("h2",{className:"text-xl font-bold mb-4",children:"Restablecer Preferencias"}),g.jsxs("p",{className:"text-[--text-secondary] mb-6",children:["Ests seguro de que quieres restablecer todas las preferencias a sus valores por defecto? Esto eliminar permanentemente los preajustes de pincel personalizados y otras configuraciones.",g.jsx("strong",{className:"text-[--text-primary] block mt-2",children:"Tus plantillas de espacio de trabajo guardadas no se vern afectadas."}),"Esta accin no se puede deshacer."]}),g.jsxs("div",{className:"flex justify-end space-x-4",children:[g.jsx("button",{onClick:e,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),g.jsx("button",{onClick:n,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Restablecer"})]})]})}):null,kd=t=>t.split(",")[1];function v6(){const[t,e]=P.useState(!1),[n,s]=P.useState(!1),[r,a]=P.useState(null),[c,d]=P.useState(!1),[f,h]=P.useState(!1),[_,b]=P.useState(!1),[E,S]=P.useState(!1),[L,U]=P.useState(window.innerWidth>1024),[F,z]=P.useState(!0),[q,j]=P.useState(!0),[H,Y]=P.useState(void 0),[K,R]=P.useState(!1),[T,N]=P.useState(!0),[I,D]=P.useState(null);P.useEffect(()=>{const ie=Ce=>{Ce.preventDefault(),D(Ce)};return window.addEventListener("beforeinstallprompt",ie),()=>window.removeEventListener("beforeinstallprompt",ie)},[]);const k=async()=>{if(!I)return;I.prompt();const{outcome:ie}=await I.userChoice;ie==="accepted"&&D(null)},M=P.useRef(null),ce=P.useRef({isResizing:!1,startY:0,startHeight:0}),[ge,$]=P.useState(1);P.useEffect(()=>{const ie=localStorage.getItem("sketcher-ui-scale");if(ie){const Ce=parseFloat(ie);$(Ce),document.documentElement.style.fontSize=`${16*Ce}px`}},[]);const G=ie=>{const Ce=Math.max(.5,Math.min(1.5,ie));$(Ce),document.documentElement.style.fontSize=`${16*Ce}px`},ae=()=>{localStorage.setItem("sketcher-ui-scale",String(ge)),alert("Configuracin de tamao guardada correctamente para futuros inicios.")};P.useEffect(()=>{if(M.current&&H===void 0){const ie=M.current.offsetHeight*.75;Y(ie)}},[H]),P.useEffect(()=>{const ie=()=>{R(!!(document.fullscreenElement||document.webkitFullscreenElement))};return document.addEventListener("fullscreenchange",ie),document.addEventListener("webkitfullscreenchange",ie),document.addEventListener("mozfullscreenchange",ie),document.addEventListener("MSFullscreenChange",ie),()=>{document.removeEventListener("fullscreenchange",ie),document.removeEventListener("webkitfullscreenchange",ie),document.removeEventListener("mozfullscreenchange",ie),document.removeEventListener("MSFullscreenChange",ie)}},[]);const ve=()=>{K?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(ie=>{console.error(`Error attempting to enable full-screen mode: ${ie.message} (${ie.name})`)})},X=()=>{N(!1),K||document.documentElement.requestFullscreen().catch(ie=>{console.error(`Error attempting to enable full-screen mode: ${ie.message} (${ie.name})`)})},O=P.useCallback(ie=>{if(!ce.current.isResizing||!M.current)return;const{startY:Ce,startHeight:be}=ce.current,Fe=ie.clientY-Ce;let Ue=be+Fe;const Oe=M.current.offsetHeight;Ue=Math.max(100,Math.min(Ue,Oe-100-6)),Y(Ue)},[]),Q=P.useCallback(()=>{ce.current.isResizing=!1,document.body.style.cursor="default",window.removeEventListener("pointermove",O),window.removeEventListener("pointerup",Q)},[O]),te=P.useCallback(ie=>{if(ie.preventDefault(),!M.current)return;const Ce=M.current.children[0];ce.current={isResizing:!0,startY:ie.clientY,startHeight:Ce.offsetHeight},document.body.style.cursor="ns-resize",window.addEventListener("pointermove",O),window.addEventListener("pointerup",Q,{once:!0})},[O,Q]);return{isExportModalOpen:t,setExportModalOpen:e,isSingleExportModalOpen:n,setSingleExportModalOpen:s,deletingItemId:r,setDeletingItemId:a,showClearConfirm:c,setShowClearConfirm:d,isCanvasSizeModalOpen:f,setCanvasSizeModalOpen:h,isProjectGalleryOpen:_,setProjectGalleryOpen:b,isResetConfirmOpen:E,setIsResetConfirmOpen:S,isRightSidebarVisible:L,setIsRightSidebarVisible:U,isLeftSidebarVisible:F,setIsLeftSidebarVisible:z,isHeaderVisible:q,setIsHeaderVisible:j,rightSidebarTopHeight:H,rightSidebarRef:M,handlePointerDownResize:te,isFullscreen:K,showSplash:T,handleStart:X,handleToggleFullscreen:ve,uiScale:ge,setUiScale:G,handleSaveUiScale:ae,deferredPrompt:I,handleInstallClick:k}}function _6(t,e,n,s,r,a,c){const[d,f]=P.useState([]),[h,_]=P.useState(!0);P.useEffect(()=>{if(t){_(!0);const z=ng(Zr(Mi,`users/${t.uid}/projects`),yS("createdAt","desc")),q=xS(z,async j=>{const H=j.docs.map(async K=>{const R=K.data();try{const T=await fh(Ni(ki,R.thumbnailPath));return{id:K.id,name:R.name,projectFilePath:R.projectFilePath,thumbnailPath:R.thumbnailPath,thumbnailUrl:T}}catch(T){return console.warn(`Could not get thumbnail for project ${R.name}`,T),null}}),Y=(await Promise.all(H)).filter(Boolean);f(Y),_(!1)},j=>{console.error("Error fetching projects:",j),_(!1)});return()=>q()}else f([]),_(!1)},[t]);const b=P.useCallback(async z=>{const{currentState:q,guides:j,toolSettings:H,quickAccess:Y}=z(),K=q.objects.map(M=>{const{canvas:ce,context:ge,backgroundImage:$,...G}=M,ae={...G};return M.type==="object"&&ce&&(ae.dataUrl=ce.toDataURL()),ae}),R={fileFormatVersion:"1.0",canvasSize:q.canvasSize,objects:K,scaleFactor:q.scaleFactor,scaleUnit:q.scaleUnit,guides:j,toolSettings:H,quickAccessSettings:Y},T=JSON.stringify(R),N=new Blob([T],{type:"application/json"}),I=document.createElement("canvas");I.width=q.canvasSize.width,I.height=q.canvasSize.height;const D=I.getContext("2d");if(D){const M=q.objects,ce=M.find($=>$.type==="object"&&$.isBackground);ce!=null&&ce.canvas&&ce.isVisible&&D.drawImage(ce.canvas,0,0),[...M.filter($=>$.type==="object"&&!$.isBackground&&$.isVisible&&!!$.canvas)].reverse().forEach($=>{D.globalAlpha=$.opacity,D.drawImage($.canvas,0,0)}),D.globalAlpha=1}if(!I)throw new Error("Could not create composite for thumbnail.");const k=await mO(I,400,225);return{projectBlob:N,thumbnailBlob:k}},[]),E=P.useCallback(async z=>{try{const q=await z.text(),j=JSON.parse(q);if(!j.fileFormatVersion||!j.canvasSize||!j.objects)throw new Error("Invalid project file format.");const H=j.objects.map(R=>new Promise((T,N)=>{const{dataUrl:I,backgroundImageDataUrl:D,...k}=R;if(R.type==="object"&&I){const M=new Image;M.onload=()=>{const{canvas:ce,context:ge}=Os(j.canvasSize.width,j.canvasSize.height);ge.drawImage(M,0,0);const $={...k,canvas:ce,context:ge};T($)},M.onerror=N,M.src=I}else T(k)})),K={objects:await Promise.all(H),canvasSize:j.canvasSize,scaleFactor:j.scaleFactor||5,scaleUnit:j.scaleUnit||"mm"};if(e({type:"LOAD_PROJECT_STATE",payload:{newState:K}}),j.toolSettings){const{brushSettings:R,eraserSettings:T,solidMarkerSettings:N,simpleMarkerSettings:I,naturalMarkerSettings:D,airbrushSettings:k,fxBrushSettings:M,magicWandSettings:ce,textSettings:ge,advancedMarkerSettings:$}=j.toolSettings;r({brushSettings:R,eraserSettings:T,solidMarkerSettings:N,simpleMarkerSettings:I,naturalMarkerSettings:D,airbrushSettings:k,fxBrushSettings:M,magicWandSettings:ce,textSettings:ge,advancedMarkerSettings:$})}j.guides&&a(j.guides),j.quickAccessSettings&&c(j.quickAccessSettings),n(!1),setTimeout(s,100)}catch(q){console.error("Failed to load project from file:",q),alert(`Error loading project: ${q instanceof Error?q.message:String(q)}`)}},[e,r,a,c,n,s]),S=P.useCallback(async(z,q)=>{try{const{projectBlob:j}=await b(q),H=URL.createObjectURL(j),Y=document.createElement("a");Y.href=H,Y.download=z.endsWith(".sketcher")?z:`${z}.sketcher`,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(H)}catch(j){throw console.error("Error saving project locally:",j),alert(`Error saving project locally: ${j instanceof Error?j.message:String(j)}`),j}},[b]),L=P.useCallback(async(z,q)=>{if(!t){alert("Please log in to save projects to the cloud.");return}const{projectBlob:j,thumbnailBlob:H}=await b(q),Y=ll(Zr(Mi,"dummy")).id,K=`users/${t.uid}/projects/${Y}.sketcher`,R=`users/${t.uid}/projects/thumbnails/${Y}.png`,T=Ni(ki,K),N=Ni(ki,R);await hh(T,j),await hh(N,H),await sg(Zr(Mi,`users/${t.uid}/projects`),{name:z,projectFilePath:K,thumbnailPath:R,createdAt:ig()})},[t,b]),U=P.useCallback(async z=>{if(t)try{const q=await fh(Ni(ki,z.projectFilePath)),H=await(await fetch(q)).blob(),Y=new File([H],`${z.name}.sketcher`);await E(Y)}catch(q){console.error("Error loading project from cloud:",q),alert("Failed to load project.")}},[t,E]),F=P.useCallback(async z=>{if(t)try{const q=ll(Mi,`users/${t.uid}/projects`,z.id),j=Ni(ki,z.projectFilePath),H=Ni(ki,z.thumbnailPath);await _S(q),await Promise.all([og(j).catch(Y=>console.warn("Project file delete failed, it might not exist.",Y)),og(H).catch(Y=>console.warn("Thumbnail delete failed, it might not exist.",Y))])}catch(q){console.error("Error deleting project:",q),alert("Failed to delete project.")}},[t]);return{projects:d,projectsLoading:h,saveProject:L,loadProject:U,deleteProject:F,saveLocally:S,loadFromFile:E}}function x6(t,e,n,s,r){const[a,c]=P.useState(!1),[d,f]=P.useState(null),[h,_]=P.useState(null),[b,E]=P.useState(null),S=P.useCallback(z=>{let q=null;return z.forEach(j=>{if(!j.canvas)return;const H=tf(j.canvas);if(H)if(!q)q={...H};else{const Y=Math.min(q.x,H.x),K=Math.min(q.y,H.y),R=Math.max(q.x+q.width,H.x+H.width),T=Math.max(q.y+q.height,H.y+H.height);q={x:Y,y:K,width:R-Y,height:T-K}}}),q},[]),L=P.useCallback((z,q,j,H)=>{const Y=document.createElement("canvas");Y.width=q.width,Y.height=q.height;const K=Y.getContext("2d");if(!K)return null;const R=j();return z&&(H!=null&&H.canvas)&&H.isVisible&&K.drawImage(H.canvas,0,0),[...R.filter(N=>N.type==="object"&&!N.isBackground&&N.isVisible&&!!N.canvas)].reverse().forEach(N=>{K.globalAlpha=N.opacity,K.drawImage(N.canvas,0,0)}),K.globalAlpha=1,Y},[]),U=P.useCallback((z,q,j)=>{f(null),setTimeout(()=>{const H=L(!1,z,q,j);if(!H)return;const Y=q().filter(N=>N.type==="object"&&!N.isBackground&&N.isVisible&&!!N.canvas),K=S(Y),R=H.toDataURL("image/png");let T=null;if(K&&K.width>0&&K.height>0){const N=document.createElement("canvas");N.width=K.width,N.height=K.height;const I=N.getContext("2d");I&&(I.drawImage(H,K.x,K.y,K.width,K.height,0,0,K.width,K.height),T=N.toDataURL("image/png"))}f({fullDataUrl:R,croppedDataUrl:T,bbox:K})},10)},[L,S]),F=P.useCallback(async(z,q,j,H)=>{var N,I,D,k;E(null),c(!0);let Y="";const K=[],R=[];let T=q.width;try{const M=new Sk({apiKey:"AIzaSyCFu4hauIhWWQx-dZ9Tyx_oEH5s7KwpPgs"});switch(z.activeAiTab){case"object":{const{enhancementPrompt:X,enhancementStylePrompt:O,enhancementNegativePrompt:Q,enhancementCreativity:te,enhancementInputMode:ie,enhancementChromaKey:Ce,enhancementPreviewBgColor:be}=z;if(!X)throw new Error("Description prompt is required.");const Fe=L(!1,q,j,H);if(!Fe)throw new Error("Could not create composite canvas.");let Ue=Fe;const Oe=j().filter(De=>De.type==="object"&&!De.isBackground&&De.isVisible&&!!De.canvas),tt=S(Oe);if(tt&&tt.width>0&&tt.height>0){T=tt.width;const De=document.createElement("canvas");De.width=tt.width,De.height=tt.height,(N=De.getContext("2d"))==null||N.drawImage(Fe,tt.x,tt.y,tt.width,tt.height,0,0,tt.width,tt.height),Ue=De}let Ot=document.createElement("canvas");Ot.width=Ue.width,Ot.height=Ue.height;const vt=Ot.getContext("2d");vt?(vt.fillStyle=be||"#FFFFFF",vt.fillRect(0,0,Ot.width,Ot.height),vt.drawImage(Ue,0,0)):Ot=Ue;const Ae=Ot.toDataURL("image/jpeg");R.push({name:"Imagen de Entrada",url:Ae}),K.push({inlineData:{mimeType:"image/jpeg",data:kd(Ae)}});let Ne="";te<=40?Ne="S muy fiel a la imagen de entrada y a la descripcin proporcionada. Realiza solo los cambios solicitados.":te<=80?Ne="Mantn una fidelidad moderada a la imagen y descripcin, pero puedes hacer pequeas mejoras estticas.":te<=120?Ne="Usa la imagen y la descripcin como una fuerte inspiracin. Sintete libre de reinterpretar elementos para un mejor resultado artstico.":Ne="Usa la imagen y la descripcin solo como una vaga inspiracin. Prioriza un resultado impactante y altamente creativo sobre la fidelidad al original.";const Se=["Tu tarea es mejorar o transformar una imagen de entrada.",`Descripcin de la transformacin deseada: "${X}".`,`El estilo visual a aplicar es: "${O}".`,Ne];if(Q.trim()&&Se.push(`Asegrate de evitar estrictamente lo siguiente: "${Q}".`),Ce!=="none"){const De=Ce==="green"?"#00FF00":"#0000FF";Se.push(`Importante: La imagen resultante DEBE tener un fondo de croma slido y uniforme de color ${Ce} (${De}). El sujeto principal no debe contener este color.`)}Y=Se.join(" ");break}case"composition":{const X=L(!0,q,j,H);if(!X)throw new Error("Could not create composite canvas.");const O=X.toDataURL("image/jpeg");R.push({name:"Escena Compuesta",url:O}),K.push({inlineData:{mimeType:"image/jpeg",data:kd(O)}}),(I=z.styleRef)!=null&&I.url&&(R.push({name:"Referencia de Estilo",url:z.styleRef.url}),K.push({inlineData:{mimeType:"image/jpeg",data:kd(z.styleRef.url)}})),Y=z.compositionPrompt;break}case"free":{const X=["main","a","b","c"],O=["Objeto 1","Aadido A","Aadido B","Aadido C"];X.forEach((Q,te)=>{const ie=z.freeFormSlots[Q];ie!=null&&ie.url&&(R.push({name:O[te],url:ie.url}),K.push({inlineData:{mimeType:"image/png",data:kd(ie.url)}}))}),Y=z.freeFormPrompt;break}}E({prompt:Y,images:R});const ce={text:Y},ge="gemini-3-pro-image-preview",$={responseModalities:[cl.IMAGE,cl.TEXT]},G=K.length>0?{parts:[...K,ce]}:{parts:[ce]},ae=await M.models.generateContent({model:ge,contents:G,config:$});let ve=null;for(const X of((k=(D=ae.candidates)==null?void 0:D[0])==null?void 0:k.content.parts)||[])if(X.inlineData){ve=X.inlineData.data;break}if(ve){const X=new Image;X.onload=()=>{const O=`IA: ${Y.substring(0,20)}...`,Q=X.width*r/(T||1);if(z.activeAiTab==="object"||z.activeAiTab==="free"&&z.addEnhancedImageToLibrary){const te=`data:image/png;base64,${ve}`;fetch(te).then(ie=>ie.blob()).then(ie=>{ie&&e(new File([ie],`${O}.png`,{type:"image/png"}),null,{scaleFactor:Q})})}else if(z.activeAiTab==="composition")t({type:"UPDATE_BACKGROUND",payload:{image:X}});else{const te=`object-${Date.now()}`;t({type:"ADD_ITEM",payload:{type:"object",activeItemId:null,newItemId:te,imageElement:X,canvasSize:q,name:O}}),n(te),s("select")}},X.src=`data:image/png;base64,${ve}`}else alert(`La IA no devolvi una imagen. Dijo: "${ae.text}"`)}catch(M){console.error("Error during AI enhancement:",M),alert(`Ocurri un error: ${M instanceof Error?M.message:String(M)}`)}finally{c(!1)}},[t,e,n,s,L,S]);return{isEnhancing:a,enhancementPreview:d,backgroundDataUrl:h,setBackgroundDataUrl:_,debugInfo:b,generateEnhancementPreview:U,handleEnhance:F}}function b6(){const[t,e]=P.useReducer(zO,BO),{present:n,past:s,future:r}=t,{objects:a,canvasSize:c,scaleFactor:d,scaleUnit:f}=n,[h,_]=P.useState([]),[b,E]=P.useState("brush"),S=P.useRef(null),[L,U]=P.useState("dark"),[F,z]=P.useState(null),[q,j]=P.useState(!1),[H,Y]=P.useState(null),[K,R]=P.useState("freehand"),[T,N]=P.useState(null),[I,D]=P.useState({style:"solid",scale:1}),[k,M]=P.useState(null),[ce,ge]=P.useState(null),[$,G]=P.useState(null),[ae,ve]=P.useState(.5),X=v6(),O=XO(),Q=ZO(F),te=e6(c),{getMinZoom:ie,...Ce}=t6(S,c),be=s6(),Fe=i6(),Ue=P.useCallback(J=>{_(J?[J]:[]),(!J||k&&k.sourceItemId!==J)&&M(null)},[k]),Oe=x6(e,Q.onImportToLibrary,Ue,E,d),tt=r6(),Ot=P.useCallback(J=>{O.setBrushSettings(J.brushSettings),O.setEraserSettings(J.eraserSettings),O.setSimpleMarkerSettings(J.solidMarkerSettings||J.simpleMarkerSettings),O.setNaturalMarkerSettings(J.naturalMarkerSettings),O.setAirbrushSettings(J.airbrushSettings),O.setFxBrushSettings(J.fxBrushSettings),J.magicWandSettings&&O.setMagicWandSettings(J.magicWandSettings),J.textSettings&&O.setTextSettings(J.textSettings),J.advancedMarkerSettings&&O.setAdvancedMarkerSettings(J.advancedMarkerSettings)},[O]),vt=_6(F,e,X.setProjectGalleryOpen,Ce.onZoomExtents,Ot,te.loadGuideState,Fe.loadState),{onDropOnCanvas:Ae}=n6(b,E,e,Q.libraryItems,c,n.scaleFactor),[Ne,Se]=P.useState(!1),[De,et]=P.useState(!1),We=P.useRef(null),[it,rt]=P.useState(!1),St=P.useRef(null),[_t,Gt]=P.useState(!1),[ct,Bt]=P.useState(null),[qe,ot]=P.useState(!1),[Vt,Pn]=P.useState(null),[rn,$t]=P.useState(null),[on,Ln]=P.useState(!1),[an,In]=P.useState(!1),[Ct,_s]=P.useState(15),ln=h.length>0?h[h.length-1]:null,Ie=ln?a.find(J=>J.id===ln):null,Pe=s.length>0,ht=r.length>0,$e=a.find(J=>J.type==="object"&&!!J.isBackground),At=b==="enhance",{activeColor:wt,activeSize:Qe}=P.useMemo(()=>{let J,pe;switch(b){case"brush":J=O.brushSettings.color,pe=O.brushSettings.size;break;case"simple-marker":J=O.simpleMarkerSettings.color,pe=O.simpleMarkerSettings.size;break;case"natural-marker":J=O.naturalMarkerSettings.color,pe=O.naturalMarkerSettings.size;break;case"airbrush":J=O.airbrushSettings.color,pe=O.airbrushSettings.size;break;case"fx-brush":J=O.fxBrushSettings.color,pe=O.fxBrushSettings.size;break;case"eraser":pe=O.eraserSettings.size;break}return{activeColor:J,activeSize:pe}},[b,O]),we=P.useCallback(J=>{switch(b){case"brush":O.setBrushSettings(pe=>({...pe,color:J}));break;case"simple-marker":O.setSimpleMarkerSettings(pe=>({...pe,color:J}));break;case"natural-marker":O.setNaturalMarkerSettings(pe=>({...pe,color:J}));break;case"airbrush":O.setAirbrushSettings(pe=>({...pe,color:J}));break;case"fx-brush":O.setFxBrushSettings(pe=>({...pe,color:J}));break}},[b,O]),Xe=P.useCallback(J=>{switch(b){case"brush":O.setBrushSettings(pe=>({...pe,size:J}));break;case"eraser":O.setEraserSettings(pe=>({...pe,size:J}));break;case"simple-marker":O.setSimpleMarkerSettings(pe=>({...pe,size:J}));break;case"natural-marker":O.setNaturalMarkerSettings(pe=>({...pe,size:J}));break;case"airbrush":O.setAirbrushSettings(pe=>({...pe,size:J}));break;case"fx-brush":O.setFxBrushSettings(pe=>({...pe,size:J}));break}},[b,O]),at=P.useCallback(J=>e({type:"SET_SCALE_FACTOR",payload:J}),[e]),Me=P.useCallback(J=>e({type:"SET_SCALE_UNIT",payload:J}),[e]),Re=J=>{const pe={canvasSize:c,backgroundColor:($e==null?void 0:$e.color)||"#FFFFFF",scaleFactor:n.scaleFactor,scaleUnit:n.scaleUnit,guides:{activeGuide:te.activeGuide,isOrthogonalVisible:te.isOrthogonalVisible,rulerGuides:te.rulerGuides,mirrorGuides:te.mirrorGuides,perspectiveGuide:te.perspectiveGuide,orthogonalGuide:te.orthogonalGuide,gridGuide:te.gridGuide,areGuidesLocked:te.areGuidesLocked,isPerspectiveStrokeLockEnabled:te.isPerspectiveStrokeLockEnabled,isSnapToGridEnabled:te.isSnapToGridEnabled},toolSettings:{...O},quickAccessSettings:Fe.quickAccessSettings},He=be.saveTemplate(J,pe);localStorage.setItem("sketcher-active-workspace-id",He)},Be=P.useCallback(J=>{const pe=be.templates.find(He=>He.id===J);pe&&((pe.canvasSize.width!==c.width||pe.canvasSize.height!==c.height)&&e({type:"RESIZE_CANVAS",payload:{width:pe.canvasSize.width,height:pe.canvasSize.height}}),e({type:"UPDATE_BACKGROUND",payload:{color:pe.backgroundColor}}),e({type:"SET_SCALE_FACTOR",payload:pe.scaleFactor}),e({type:"SET_SCALE_UNIT",payload:pe.scaleUnit}),te.loadGuideState(pe.guides),Ot(pe.toolSettings),Fe.loadState(pe.quickAccessSettings),localStorage.setItem("sketcher-active-workspace-id",J),setTimeout(Ce.onZoomExtents,100))},[be.templates,c,e,te,Ot,Fe,Ce.onZoomExtents]),fe=P.useCallback(()=>{const J=new Map(a.map(He=>[He.id,He])),pe=He=>{if(!He.isVisible)return!1;if(He.parentId){const Et=J.get(He.parentId);if(Et)return pe(Et)}return!0};return a.map(He=>({...He,isVisible:pe(He)}))},[a]);P.useEffect(()=>{const J=KP(ag,pe=>z(pe));return()=>J()},[]),P.useEffect(()=>{const J=localStorage.getItem("sketcher-theme");J&&U(J)},[]),P.useEffect(()=>{document.documentElement.classList.toggle("dark",L==="dark"),localStorage.setItem("sketcher-theme",L)},[L]),P.useLayoutEffect(()=>{if(Ne||!S.current||X.showSplash)return;const J=new ResizeObserver(pe=>{const He=pe[0],{width:Et,height:mt}=He.contentRect;Et>0&&mt>0&&(e({type:"INITIALIZE_CANVASES",payload:{width:Math.floor(Et),height:Math.floor(mt)}}),Se(!0),_(["object-1"]),J.disconnect())});return J.observe(S.current),()=>J.disconnect()},[Ne,X.showSplash,e]),P.useEffect(()=>{if(!Ne)return;const J=localStorage.getItem("sketcher-active-workspace-id"),pe=J?be.templates.find(He=>He.id===J):null;pe?Be(pe.id):Ce.onZoomExtents()},[Ne]),P.useEffect(()=>{$e!=null&&$e.canvas?Oe.setBackgroundDataUrl($e.canvas.toDataURL()):Oe.setBackgroundDataUrl(null)},[$e,$e==null?void 0:$e.canvas,Oe]),P.useEffect(()=>{if(Gt(!1),Bt(null),ot(!1),Pn(null),$t(null),b==="crop")Gt(!0),Bt({x:0,y:0,width:c.width,height:c.height});else if((b==="transform"||b==="free-transform")&&(Ie==null?void 0:Ie.type)==="object"&&Ie.canvas){const J=tf(Ie.canvas);J?(ot(!0),$t(J),Pn(b==="transform"?{type:"affine",x:J.x,y:J.y,width:J.width,height:J.height,rotation:0}:{type:"free",x:J.x,y:J.y,width:J.width,height:J.height,corners:{tl:{x:J.x,y:J.y},tr:{x:J.x+J.width,y:J.y},bl:{x:J.x,y:J.y+J.height},br:{x:J.x+J.width,y:J.y+J.height}}})):E("select")}},[b,c.width,c.height,Ie,E]),P.useEffect(()=>{const J=pe=>{pe.key==="Escape"&&(N(null),M(null))};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[]),P.useEffect(()=>{N(null)},[b,K]);const ee=P.useCallback(()=>e({type:"UNDO"}),[e]),de=P.useCallback(()=>e({type:"REDO"}),[e]),Te=P.useCallback(J=>{const pe=`${J}-${Date.now()}`;return e({type:"ADD_ITEM",payload:{type:J,activeItemId:ln,canvasSize:c,newItemId:pe}}),_([pe]),pe},[ln,c,e]),Le=P.useCallback(J=>e({type:"COPY_ITEM",payload:{id:J}}),[e]),ze=P.useCallback(J=>X.setDeletingItemId(J),[X]),Ke=P.useCallback((J,pe,He)=>e({type:"MOVE_ITEM",payload:{draggedId:J,targetId:pe,position:He}}),[e]),Ye=P.useCallback((J,pe)=>e({type:"COMMIT_DRAWING",payload:{activeItemId:J,beforeCanvas:pe}}),[e]),dt=P.useCallback((J,pe)=>e({type:"UPDATE_ITEM",payload:{id:J,updates:pe}}),[e]),It=P.useCallback(J=>{if(J.file){const pe=new FileReader;pe.onload=He=>{var Et;if((Et=He.target)!=null&&Et.result){const mt=new Image;mt.onload=()=>{e({type:"SET_CANVAS_FROM_IMAGE",payload:{image:mt}}),Ce.onZoomExtents()},mt.src=He.target.result}},pe.readAsDataURL(J.file)}else J.image?e({type:"UPDATE_BACKGROUND",payload:{image:J.image}}):J.color&&e({type:"UPDATE_BACKGROUND",payload:{color:J.color}})},[Ce,e]),jt=P.useCallback(()=>e({type:"REMOVE_BACKGROUND_IMAGE"}),[e]),Kt=P.useCallback(()=>{X.deletingItemId&&(e({type:"DELETE_ITEM",payload:{id:X.deletingItemId}}),_(J=>J.filter(pe=>pe!==X.deletingItemId)),X.setDeletingItemId(null))},[X,e]),Xt=P.useCallback(async(J,pe)=>{e({type:"MERGE_ITEMS",payload:{sourceId:J,targetId:pe}}),_([pe])},[e]),En=P.useCallback(()=>{e({type:"CLEAR_CANVAS"}),X.setShowClearConfirm(!1)},[e,X]),un=P.useCallback((J,pe)=>{fetch(J).then(He=>He.blob()).then(He=>{if(He){const Et=pe.endsWith(".png")?pe:`${pe}.png`;Q.onImportToLibrary(new File([He],Et,{type:"image/png"}),null)}})},[Q]),xs=P.useCallback(J=>{if(!J.value.trim()){G(null);return}const pe=a.find(Gn=>Gn.id===J.activeItemId);if(!pe||!pe.context){G(null);return}const He=Lc(pe.canvas),Et=pe.context;Et.save();const mt=O.textSettings;Et.font=`${mt.fontWeight==="italic"?"italic ":""}${mt.fontWeight==="bold"?"bold ":""}${mt.fontSize}px ${mt.fontFamily}`,Et.fillStyle=mt.color,Et.textAlign=mt.textAlign,J.value.split(`
`).forEach((Gn,os)=>Et.fillText(Gn,J.position.x,J.position.y+os*mt.fontSize*1.2)),Et.restore(),e({type:"COMMIT_DRAWING",payload:{activeItemId:J.activeItemId,beforeCanvas:He}}),G(null)},[a,O.textSettings,e]),Xn=()=>{ct&&(e({type:"CROP_CANVAS",payload:{cropRect:ct}}),E("select"))},Hn=()=>E("select"),Jn=()=>{Vt&&rn&&Ie&&(e({type:"APPLY_TRANSFORM",payload:{id:Ie.id,transform:Vt,sourceBbox:rn}}),E("select"))},fs=()=>E("select"),dn=P.useCallback(()=>M(null),[]),Ns=P.useCallback(()=>{if(!k||!Ie||Ie.type!=="object"||!Ie.context)return;const J=Lc(Ie.canvas),pe=Ie.context;pe.save(),pe.clip(k.path),pe.globalCompositeOperation="destination-out",pe.fillRect(0,0,pe.canvas.width,pe.canvas.height),pe.restore(),Ye(Ie.id,J),M(null)},[k,Ie,Ye]),ni=P.useCallback(()=>{if(!k||!Ie||Ie.type!=="object"||!Ie.context)return;const{boundingBox:J,path:pe}=k,He=Ie.context,Et=document.createElement("canvas");Et.width=J.width,Et.height=J.height;const mt=Et.getContext("2d");if(!mt)return;mt.drawImage(He.canvas,J.x,J.y,J.width,J.height,0,0,J.width,J.height),mt.globalCompositeOperation="destination-in",mt.save(),mt.translate(-J.x,-J.y),mt.fillStyle="black",mt.fill(pe),mt.restore();const Gn=mt.getImageData(0,0,J.width,J.height);ge({imageData:Gn,sourceRect:J})},[k,Ie]),bs=P.useCallback(()=>{ni(),Ns()},[ni,Ns]),ps=P.useCallback(()=>{if(!ce)return;const J=`object-${Date.now()}`;e({type:"PASTE_FROM_CLIPBOARD",payload:{newItemId:J,clipboard:ce,canvasSize:c,activeItemId:ln}}),Ue(J),E("transform")},[ce,c,ln,Ue,e]),_n=P.useMemo(()=>{const J=(pe=null)=>a.filter(He=>He.parentId===pe&&(He.type!=="object"||!He.isBackground)).flatMap(He=>[He,...He.type==="group"?J(He.id):[]]);return J()},[a]),si=P.useMemo(()=>{if(!ln)return{canMoveUp:!1,canMoveDown:!1,canMergeDown:!1,canMergeUp:!1};const J=_n.findIndex(os=>os.id===ln);if(J===-1)return{canMoveUp:!1,canMoveDown:!1,canMergeDown:!1,canMergeUp:!1};const pe=J<_n.length-1,He=J>0;let Et=!1,mt=!1;const Gn=_n[J];if(pe){const os=_n[J+1];Gn.type==="object"&&os.type==="object"&&Gn.parentId===os.parentId&&(Et=!0)}if(He){const os=_n[J-1];Gn.type==="object"&&os.type==="object"&&Gn.parentId===os.parentId&&(mt=!0)}return{canMoveUp:pe,canMoveDown:He,canMergeDown:mt,canMergeUp:Et}},[ln,_n]),Eo=P.useCallback((J,pe)=>{const He=_n.findIndex(os=>os.id===J);if(He===-1)return;const Et=pe==="up"?He+1:He-1;if(Et<0||Et>=_n.length)return;const mt=_n[Et],Gn=pe==="up"?"bottom":"top";Ke(J,mt.id,Gn)},[_n,Ke]),da=P.useCallback(J=>{if(si.canMergeDown){const pe=_n.findIndex(He=>He.id===J);Xt(J,_n[pe-1].id)}},[si.canMergeDown,_n,Xt]),vr=P.useCallback(J=>{if(si.canMergeUp){const pe=_n.findIndex(He=>He.id===J);Xt(_n[pe+1].id,J)}},[si.canMergeUp,_n,Xt]),ms=P.useCallback(J=>{const pe=`object-${Date.now()}`;e({type:"ADD_ITEM",payload:{type:"object",activeItemId:J,canvasSize:c,newItemId:pe}}),_([pe])},[c,e]),Tn=P.useCallback(J=>{const pe=`object-${Date.now()}`;e({type:"ADD_ITEM_BELOW",payload:{targetId:J,canvasSize:c,newItemId:pe}}),_([pe])},[c,e]),Rn=P.useMemo(()=>{if(c.width>0&&d>0){const J=c.width/d,pe=c.height/d;let He,Et;switch(f){case"cm":He=(J/10).toFixed(2),Et=(pe/10).toFixed(2);break;case"m":He=(J/1e3).toFixed(3),Et=(pe/1e3).toFixed(3);break;default:He=J.toFixed(1),Et=pe.toFixed(1);break}return`${c.width} x ${c.height}px    ${He} x ${Et}${f}`}return null},[c,d,f]),ii=fe(),js=a.find(J=>J.id===X.deletingItemId);return X.showSplash?g.jsx("div",{className:"w-screen h-screen bg-[--bg-primary] text-[--text-primary] flex items-center justify-center font-sans",children:g.jsxs("div",{className:"text-center p-8",children:[g.jsx("h1",{className:"text-5xl font-bold mb-4",children:"Sketcher"}),g.jsx("p",{className:"text-lg text-[--text-secondary] mb-10",children:"Tu lienzo creativo te espera."}),g.jsx("button",{onClick:X.handleStart,className:"px-10 py-4 bg-[--accent-primary] text-white font-bold text-lg rounded-lg shadow-lg hover:bg-[--accent-hover] transform hover:scale-105 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-offset-2 focus:ring-offset-[--bg-primary] focus:ring-[--accent-primary]",children:"Comenzar a Dibujar"})]})}):g.jsxs("div",{className:"w-screen h-screen bg-[--bg-primary] text-[--text-primary] flex flex-col font-sans overflow-hidden",children:[X.isExportModalOpen&&g.jsx(PO,{isOpen:X.isExportModalOpen,onClose:()=>X.setExportModalOpen(!1),drawableObjects:ii.filter(J=>J.type==="object"),canvasSize:c}),X.isSingleExportModalOpen&&g.jsx(LO,{isOpen:X.isSingleExportModalOpen,onClose:()=>X.setSingleExportModalOpen(!1),item:Ie,canvasSize:c,onSaveToLibrary:un}),X.deletingItemId&&g.jsx(f6,{isOpen:!!X.deletingItemId,onCancel:()=>X.setDeletingItemId(null),onConfirm:Kt,itemName:(js==null?void 0:js.name)||"",itemType:(js==null?void 0:js.type)==="group"?"group":"object"}),Q.deletingLibraryItem&&g.jsx(g6,{isOpen:!!Q.deletingLibraryItem,onCancel:Q.onCancelDeleteLibraryItem,onConfirm:Q.onConfirmDeleteLibraryItem,itemToDelete:Q.deletingLibraryItem}),X.showClearConfirm&&g.jsx(m6,{isOpen:X.showClearConfirm,onCancel:()=>X.setShowClearConfirm(!1),onConfirm:En}),X.isCanvasSizeModalOpen&&g.jsx(p6,{isOpen:X.isCanvasSizeModalOpen,onClose:()=>X.setCanvasSizeModalOpen(!1),currentSize:c,onApply:(J,pe)=>{e({type:"RESIZE_CANVAS",payload:{width:J,height:pe}}),X.setCanvasSizeModalOpen(!1),setTimeout(Ce.onZoomExtents,100)}}),X.isResetConfirmOpen&&g.jsx(y6,{isOpen:X.isResetConfirmOpen,onCancel:()=>X.setIsResetConfirmOpen(!1),onConfirm:()=>{console.log("Resetting preferences..."),X.setIsResetConfirmOpen(!1)}}),Q.imageToEdit&&g.jsx(MO,{item:Q.imageToEdit,onApply:Q.onApplyTransparency,onCancel:Q.onCancelEditTransparency}),q&&H!==null&&g.jsx(u6,{isOpen:q,onClose:()=>{j(!1),Y(null)},onSelectTool:J=>Fe.updateTool(H,J),fxPresets:O.brushPresets}),g.jsx(E6,{isOpen:X.isProjectGalleryOpen,onClose:()=>X.setProjectGalleryOpen(!1),user:F,projects:vt.projects,isLoading:vt.projectsLoading,onSave:J=>vt.saveProject(J,()=>({currentState:n,guides:te,toolSettings:{...O},quickAccess:Fe.quickAccessSettings})),onLoad:vt.loadProject,onDelete:vt.deleteProject,onSaveLocally:J=>vt.saveLocally(J,()=>({currentState:n,guides:te,toolSettings:{...O},quickAccess:Fe.quickAccessSettings})),onLoadFromFile:vt.loadFromFile}),X.isHeaderVisible&&g.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-2 bg-[--bg-primary] border-b border-[--bg-tertiary] z-20",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("h1",{className:"text-xl font-bold",children:"Sketcher"}),g.jsxs("button",{onClick:()=>X.setProjectGalleryOpen(!0),className:"flex items-center gap-2 p-2 rounded-md bg-[--bg-secondary] hover:bg-[--bg-tertiary] border border-[--bg-tertiary] transition-colors text-sm",children:[g.jsx(tO,{className:"w-5 h-5"}),g.jsx("span",{children:"Galera"})]}),g.jsxs("button",{ref:We,onClick:()=>et(J=>!J),className:"flex items-center gap-2 p-2 rounded-md bg-[--bg-secondary] hover:bg-[--bg-tertiary] border border-[--bg-tertiary] transition-colors text-sm relative",children:[g.jsx(JS,{className:"w-5 h-5"}),g.jsx("span",{children:"Plantillas"}),g.jsx(d6,{isOpen:De,onClose:()=>et(!1),templates:be.templates,onSave:Re,onLoad:Be,onDelete:be.deleteTemplate,onResetPreferences:()=>X.setIsResetConfirmOpen(!0)})]})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("div",{className:"flex items-center gap-1 mr-2 px-2 py-1 bg-[--bg-secondary] rounded-md border border-[--bg-tertiary]",children:[X.deferredPrompt&&g.jsxs(g.Fragment,{children:[g.jsxs("button",{onClick:X.handleInstallClick,className:"flex items-center gap-1 p-1.5 rounded-md hover:bg-[--bg-tertiary] text-[--text-secondary]",title:"Instalar Aplicacin",children:[g.jsx(aO,{className:"w-4 h-4"}),g.jsx("span",{className:"text-xs font-bold hidden sm:inline",children:"Instalar"})]}),g.jsx("div",{className:"w-px h-4 bg-[--bg-tertiary] mx-1"})]}),g.jsx("button",{onClick:()=>X.setUiScale(X.uiScale-.1),className:"p-1.5 rounded-md hover:bg-[--bg-tertiary] text-[--text-secondary]",title:"Reducir Interfaz",children:g.jsx("span",{className:"text-xs font-bold",children:"A-"})}),g.jsxs("span",{className:"text-xs font-mono w-8 text-center",children:[Math.round(X.uiScale*100),"%"]}),g.jsx("button",{onClick:()=>X.setUiScale(X.uiScale+.1),className:"p-1.5 rounded-md hover:bg-[--bg-tertiary] text-[--text-secondary]",title:"Aumentar Interfaz",children:g.jsx("span",{className:"text-xs font-bold",children:"A+"})}),g.jsx("div",{className:"w-px h-4 bg-[--bg-tertiary] mx-1"}),g.jsx("button",{onClick:X.handleSaveUiScale,className:"p-1.5 rounded-md hover:bg-[--bg-tertiary] text-[--text-secondary]",title:"Guardar configuracin de tamao",children:g.jsx(KS,{className:"w-4 h-4"})})]}),g.jsx("button",{onClick:()=>U(L==="dark"?"light":"dark"),className:"p-2 rounded-md bg-[--bg-secondary] hover:bg-[--bg-tertiary] text-[--text-secondary]",children:L==="dark"?g.jsx(Y3,{className:"w-5 h-5"}):g.jsx(J3,{className:"w-5 h-5"})}),g.jsx(VO,{user:F})]})]}),g.jsx("button",{onClick:()=>X.setIsHeaderVisible(!X.isHeaderVisible),className:"absolute top-2 left-1/2 -translate-x-1/2 p-1 rounded-b-md bg-[--bg-secondary] border border-[--bg-tertiary] shadow-md z-30 flex items-center justify-center hover:bg-[--bg-tertiary] transition-colors",style:{top:X.isHeaderVisible?"3.6rem":"0"},title:X.isHeaderVisible?"Ocultar Encabezado":"Mostrar Encabezado",children:X.isHeaderVisible?g.jsx(z3,{className:"w-4 h-4"}):g.jsx(B3,{className:"w-4 h-4"})}),g.jsxs("div",{className:"flex flex-grow min-h-0 relative",children:[X.isLeftSidebarVisible&&g.jsx(lO,{tool:b,setTool:E,...O,brushPresets:O.brushPresets,onSavePreset:O.onSavePreset,onUpdatePreset:O.onUpdatePreset,onLoadPreset:O.onLoadPreset,onDeletePreset:O.onDeletePreset,activeGuide:te.activeGuide,setActiveGuide:te.onSetActiveGuide,isOrthogonalVisible:te.isOrthogonalVisible,onToggleOrthogonal:te.toggleOrthogonal,onExportClick:()=>X.setExportModalOpen(!0),objects:a,libraryItems:Q.libraryItems,backgroundDataUrl:Oe.backgroundDataUrl,debugInfo:Oe.debugInfo,strokeMode:K,setStrokeMode:R,strokeModifier:I,setStrokeModifier:D}),g.jsx("button",{onClick:()=>X.setIsLeftSidebarVisible(!X.isLeftSidebarVisible),className:"absolute top-1/2 -translate-y-1/2 bg-[--bg-secondary] p-2 rounded-full shadow-xl z-40 border border-[--bg-tertiary] hover:bg-[--bg-tertiary] transition-all",style:{left:X.isLeftSidebarVisible?"4.25rem":"0.25rem"},title:X.isLeftSidebarVisible?"Ocultar Herramientas":"Mostrar Herramientas",children:X.isLeftSidebarVisible?g.jsx(rT,{className:"w-5 h-5"}):g.jsx(lg,{className:"w-5 h-5"})}),g.jsx(h6,{isOpen:tt.isOpen,onClose:()=>tt.setIsOpen(!1),aiPanelState:tt,onEnhance:J=>Oe.handleEnhance(J,c,fe,$e),isEnhancing:Oe.isEnhancing,enhancementPreview:Oe.enhancementPreview,onGenerateEnhancementPreview:()=>Oe.generateEnhancementPreview(c,fe,$e)}),g.jsx("button",{onClick:()=>tt.setIsOpen(!0),className:"absolute bottom-6 right-6 p-4 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-2xl hover:scale-110 transition-transform z-40 flex items-center justify-center border-2 border-white/20",title:"Mejorar con IA",style:{right:X.isRightSidebarVisible?"21rem":"1rem"},children:g.jsx(Gh,{className:"w-8 h-8"})}),g.jsxs("main",{ref:S,className:"flex-grow relative",onDrop:J=>{J.preventDefault();try{const pe=JSON.parse(J.dataTransfer.getData("application/json"));pe.type==="library-item"&&Ae(pe,ln,_)}catch{}},onDragOver:J=>{J.preventDefault(),J.dataTransfer.dropEffect="copy"},children:[g.jsx(NO,{items:ii,activeItemId:ln,...O,tool:b,setTool:E,onDrawCommit:Ye,onUpdateItem:dt,viewTransform:Ce.viewTransform,setViewTransform:Ce.setViewTransform,onSelectItem:Ue,...te,isCropping:_t,cropRect:ct,setCropRect:Bt,isTransforming:qe,transformState:Vt,setTransformState:Pn,transformSourceBbox:rn,isAspectRatioLocked:on,strokeMode:K,strokeState:T,setStrokeState:N,strokeModifier:I,selection:k,setSelection:M,onCutSelection:bs,onCopySelection:ni,onDeleteSelection:Ns,onDeselect:dn,getMinZoom:ie,MAX_ZOOM:QS,isAngleSnapEnabled:an,angleSnapValue:Ct,onAddItem:Te,textEditState:$,setTextEditState:G,onCommitText:xs,strokeSmoothing:ae}),g.jsx("div",{className:"absolute top-2 left-2 flex items-center gap-2 z-10",children:Rn&&g.jsx("button",{ref:St,onClick:()=>rt(J=>!J),className:"bg-[--bg-primary]/80 backdrop-blur-sm text-[--text-secondary] text-xs rounded-md px-2 py-1 pointer-events-auto hover:bg-[--bg-secondary] transition-colors",title:"Ajustar escala del lienzo",children:Rn})}),g.jsx("button",{onClick:X.handleToggleFullscreen,className:"absolute top-2 right-2 p-2 rounded-md bg-[--bg-primary]/80 backdrop-blur-sm hover:bg-[--bg-secondary] text-[--text-primary] transition-colors z-10",title:X.isFullscreen?"Salir de Pantalla Completa":"Entrar en Pantalla Completa",children:X.isFullscreen?g.jsx(sO,{className:"w-5 h-5"}):g.jsx(nO,{className:"w-5 h-5"})}),g.jsx(T6,{isOpen:it,onClose:()=>rt(!1),anchorEl:St.current,scaleFactor:d,scaleUnit:f,onSetScaleFactor:at,onSetScaleUnit:Me}),g.jsx(DO,{tool:b,setTool:E,onZoomExtents:Ce.onZoomExtents,onZoomIn:Ce.onZoomIn,onZoomOut:Ce.onZoomOut,onUndo:ee,onRedo:de,onClearAll:()=>X.setShowClearConfirm(!0),canUndo:Pe,canRedo:ht,isCropping:_t,onApplyCrop:Xn,onCancelCrop:Hn,isTransforming:qe,transformState:Vt,onApplyTransform:Jn,onCancelTransform:fs,isAspectRatioLocked:on,onSetAspectRatioLocked:Ln,isAngleSnapEnabled:an,onToggleAngleSnap:()=>In(J=>!J),angleSnapValue:Ct,onSetAngleSnapValue:_s,onSetActiveGuide:te.onSetActiveGuide,onSetGridType:te.setGridType,isSnapToGridEnabled:te.isSnapToGridEnabled,onToggleSnapToGrid:te.toggleSnapToGrid,isOrthogonalVisible:te.isOrthogonalVisible,activeGuide:te.activeGuide,orthogonalGuide:te.orthogonalGuide,onSetOrthogonalAngle:te.onSetOrthogonalAngle,gridGuide:te.gridGuide,onSetGridSpacing:te.onSetGridSpacing,onSetGridMajorLineFrequency:te.onSetGridMajorLineFrequency,onSetGridIsoAngle:te.onSetGridIsoAngle,onSetGridMajorLineColor:te.onSetGridMajorLineColor,onSetGridMinorLineColor:te.onSetGridMinorLineColor,areGuidesLocked:te.areGuidesLocked,onSetAreGuidesLocked:te.setAreGuidesLocked,isPerspectiveStrokeLockEnabled:te.isPerspectiveStrokeLockEnabled,onSetIsPerspectiveStrokeLockEnabled:te.setIsPerspectiveStrokeLockEnabled,scaleFactor:n.scaleFactor,scaleUnit:n.scaleUnit,onPaste:ps,hasClipboardContent:!!ce,strokeSmoothing:ae,setStrokeSmoothing:ve}),g.jsx(l6,{settings:Fe.quickAccessSettings,onUpdateColor:Fe.updateColor,onAddColor:Fe.addColor,onRemoveColor:Fe.removeColor,onUpdateSize:Fe.updateSize,onUpdateTool:()=>{},onSelectColor:we,onSelectSize:Xe,onSelectTool:J=>{J.type==="tool"?E(J.tool):J.type==="fx-preset"&&(E("fx-brush"),O.onLoadPreset(J.id))},onOpenToolSelector:J=>{j(!0),Y(J)},activeTool:b,activeColor:wt,activeSize:Qe,onIncreaseUiScale:()=>X.setUiScale(X.uiScale+.1),onDecreaseUiScale:()=>X.setUiScale(X.uiScale-.1)})]}),X.isRightSidebarVisible&&g.jsxs("aside",{ref:X.rightSidebarRef,className:`flex-shrink-0 w-80 border-l border-[--bg-tertiary] flex flex-col ${At?"z-50":""}`,children:[g.jsx("div",{style:{height:X.rightSidebarTopHeight},className:"flex-shrink-0",children:g.jsx(cO,{items:a,activeItemId:ln,onAddItem:Te,onCopyItem:Le,onDeleteItem:ze,onSelectItem:Ue,onUpdateItem:dt,onMoveItem:Ke,onMergeItems:Xt,onUpdateBackground:It,onRemoveBackgroundImage:jt,onExportItem:()=>{Ie&&X.setSingleExportModalOpen(!0)},onOpenCanvasSizeModal:()=>X.setCanvasSizeModalOpen(!0),activeItemState:si,onMoveItemUpDown:Eo,onMergeItemDown:da,onMergeItemUp:vr,onAddObjectAbove:ms,onAddObjectBelow:Tn})}),g.jsx("div",{onPointerDown:X.handlePointerDownResize,className:"flex-shrink-0 h-1.5 bg-[--bg-secondary] hover:bg-[--accent-primary] transition-colors cursor-ns-resize"}),g.jsx("div",{className:"flex-grow min-h-0",children:g.jsx(kO,{user:F,items:Q.libraryItems,onImportImage:Q.onImportToLibrary,onCreateFolder:Q.onCreateFolder,onEditItem:Q.onEditTransparency,onDeleteItem:Q.onDeleteLibraryItem,onAddItemToScene:J=>Ae({type:"library-item",id:J},ln,_),onMoveItems:Q.onMoveItems})})]}),g.jsx("button",{onClick:()=>X.setIsRightSidebarVisible(!X.isRightSidebarVisible),className:"absolute top-1/2 -translate-y-1/2 bg-[--bg-secondary] p-2 rounded-full shadow-xl z-40 border border-[--bg-tertiary] hover:bg-[--bg-tertiary] transition-all",style:{right:X.isRightSidebarVisible?"20.25rem":"0.25rem"},title:X.isRightSidebarVisible?"Ocultar paneles":"Mostrar paneles",children:X.isRightSidebarVisible?g.jsx(lg,{className:"w-5 h-5"}):g.jsx(rT,{className:"w-5 h-5"})})]})]})}const E6=({isOpen:t,onClose:e,user:n,projects:s,isLoading:r,onSave:a,onLoad:c,onDelete:d,onSaveLocally:f,onLoadFromFile:h})=>{const[_,b]=P.useState(""),[E,S]=P.useState(!1),[L,U]=P.useState(null),F=P.useRef(null),[z,q]=P.useState(!1),[j,H]=P.useState("mi-boceto"),Y=P.useRef(null);P.useEffect(()=>{t&&(b(""),S(!1),U(null),q(!1))},[t]);const K=()=>{q(!0),setTimeout(()=>{var M,ce;(M=Y.current)==null||M.focus(),(ce=Y.current)==null||ce.select()},0)},R=async()=>{if(j.trim())try{await f(j.trim()),q(!1)}catch(M){console.error("Failed to save project locally:",M),alert(`Error al guardar el proyecto localmente: ${M instanceof Error?M.message:String(M)}`)}},T=()=>q(!1),N=async()=>{if(!_.trim()){alert("Please enter a project name.");return}S(!0);try{await a(_.trim()),b("")}catch(M){console.error("Failed to save project:",M),alert(`Error saving project: ${M instanceof Error?M.message:String(M)}`)}finally{S(!1)}},I=async()=>{L&&(await d(L),U(null))},D=()=>{var M;return(M=F.current)==null?void 0:M.click()},k=async M=>{var ce;(ce=M.target.files)!=null&&ce[0]&&await h(M.target.files[0]),M.target&&(M.target.value="")};return t?g.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:[g.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-4xl h-full max-h-[90vh] flex flex-col",children:[g.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[g.jsx("h2",{className:"text-2xl font-bold",children:"Galera de Proyectos"}),z?g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("input",{ref:Y,type:"text",value:j,onChange:M=>H(M.target.value),onKeyDown:M=>{M.key==="Enter"&&R(),M.key==="Escape"&&T()},placeholder:"Nombre del archivo...",className:"bg-[--bg-secondary] text-[--text-primary] text-sm rounded-md p-2 border border-[--bg-tertiary] focus:ring-1 focus:ring-[--accent-primary] focus:outline-none"}),g.jsx("button",{onClick:R,className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white font-semibold",children:"Guardar"}),g.jsx("button",{onClick:T,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"})]}):g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"file",ref:F,className:"hidden",accept:".sketcher,application/json",onChange:k}),g.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] font-semibold",children:[" ",g.jsx(eO,{className:"w-5 h-5"})," ",g.jsx("span",{children:"Cargar desde Archivo"})," "]}),g.jsxs("button",{onClick:K,className:"flex items-center gap-2 px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] font-semibold",children:[" ",g.jsx(KS,{className:"w-5 h-5"})," ",g.jsx("span",{children:"Guardar Local"})," "]}),g.jsxs("button",{onClick:e,className:"p-2 rounded-full hover:bg-[--bg-tertiary]",children:[" ",g.jsx(bo,{className:"w-6 h-6"})," "]})]})]}),n?g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"bg-[--bg-primary] p-4 rounded-lg mb-4 flex-shrink-0",children:[g.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Guardar Lienzo Actual"}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"text",value:_,onChange:M=>b(M.target.value),placeholder:"Nombre del nuevo proyecto...",className:"flex-grow bg-[--bg-secondary] text-[--text-primary] text-sm rounded-md p-2 border border-[--bg-tertiary] focus:ring-1 focus:ring-[--accent-primary] focus:outline-none",disabled:E}),g.jsxs("button",{onClick:N,disabled:!_.trim()||E||!n,className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",title:n?"":"Inicie sesin para guardar en la nube",children:[" ",E?"Guardando...":"Guardar en la Nube"," "]})]})]}),g.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:r?g.jsx("div",{className:"flex items-center justify-center h-full",children:g.jsx("div",{className:"w-8 h-8 border-4 border-[--accent-primary] border-t-transparent rounded-full animate-spin"})}):s.length===0?g.jsxs("div",{className:"text-center text-[--text-secondary] py-16",children:[" ",g.jsx("p",{children:"No se encontraron proyectos guardados."})," ",g.jsx("p",{className:"text-sm",children:"Guarda tu lienzo actual para empezar!"})," "]}):g.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:s.map(M=>g.jsxs("div",{className:"group relative bg-[--bg-tertiary] rounded-lg overflow-hidden shadow-md",children:[g.jsx("div",{className:"aspect-video bg-white/10 flex items-center justify-center",children:g.jsx("img",{src:M.thumbnailUrl,alt:M.name,className:"w-full h-full object-cover"})}),g.jsx("div",{className:"p-2",children:g.jsx("p",{className:"font-semibold text-sm truncate",children:M.name})}),g.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2",children:[g.jsx("button",{onClick:()=>c(M),className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-500 text-white w-3/4",children:"Cargar"}),g.jsx("button",{onClick:()=>U(M),className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white w-3/4",children:"Eliminar"})]})]},M.id))})})]}):g.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center text-center text-[--text-secondary]",children:[" ",g.jsx($S,{className:"w-16 h-16 mb-4"})," ",g.jsx("h3",{className:"text-xl font-bold",children:"Por favor, inicie sesin"})," ",g.jsx("p",{children:"Inicie sesin para guardar y cargar sus proyectos en la nube."})," "]})]}),L&&g.jsxs("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center",children:[" ",g.jsxs("div",{className:"bg-[--bg-secondary] rounded-lg p-6 shadow-xl",children:[" ",g.jsx("h3",{className:"text-lg font-bold",children:"Confirmar Eliminacin"})," ",g.jsxs("p",{className:"my-2 text-[--text-secondary]",children:['Ests seguro de que quieres eliminar "',L.name,'"? Esta accin no se puede deshacer.']})," ",g.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[" ",g.jsx("button",{onClick:()=>U(null),className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"})," ",g.jsx("button",{onClick:I,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Eliminar"})," "]})," "]})," "]})]}):null},T6=({isOpen:t,onClose:e,anchorEl:n,scaleFactor:s,scaleUnit:r,onSetScaleFactor:a,onSetScaleUnit:c})=>{const[d,f]=P.useState(""),h=P.useRef(null),_={mm:1,cm:10,m:1e3};P.useEffect(()=>{f(Number((s*_[r]).toFixed(2)).toString())},[s,r,_]),P.useEffect(()=>{const U=F=>{h.current&&!h.current.contains(F.target)&&n&&!n.contains(F.target)&&e()};return t&&document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[t,e,n]);const b=(U,F)=>{const z=parseFloat(U);!isNaN(z)&&z>0&&a(z/_[F])},E=U=>{const F=U.target.value;f(F),b(F,r)},S=U=>{c(U)};if(!t||!n)return null;const L=n.getBoundingClientRect();return g.jsxs("div",{ref:h,className:"absolute z-20 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg p-3 space-y-3",style:{top:L.bottom+8,left:L.left},children:[g.jsx("p",{className:"text-xs font-bold text-[--text-secondary]",children:"Ajustes de Escala"}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-sm",children:"1"}),g.jsxs("select",{value:r,onChange:U=>S(U.target.value),className:"bg-[--bg-tertiary] text-sm rounded-md p-1 border border-[--bg-hover]",children:[" ",g.jsx("option",{value:"mm",children:"mm"})," ",g.jsx("option",{value:"cm",children:"cm"})," ",g.jsx("option",{value:"m",children:"m"})," "]}),g.jsx("span",{className:"text-sm",children:"="}),g.jsx("input",{type:"number",value:d,onChange:E,className:"w-24 bg-[--bg-secondary] text-sm rounded-md p-1 border border-[--bg-tertiary]"}),g.jsx("span",{className:"text-sm",children:"px"})]})]})};try{const{registerSW:t}=require("virtual:pwa-register");t&&t()}catch{}const ZS=document.getElementById("root");if(!ZS)throw new Error("Could not find root element to mount to");const w6=z1.createRoot(ZS);w6.render(g.jsx(dg.StrictMode,{children:g.jsx(b6,{})}));
