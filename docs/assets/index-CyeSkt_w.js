import{getAuth as b0,GoogleAuthProvider as C0,signInWithPopup as S0,signOut as E0,onAuthStateChanged as T0}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";import{initializeApp as w0}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";import{getFirestore as N0,query as Cu,collection as fl,orderBy as wg,onSnapshot as Ng,addDoc as Su,serverTimestamp as Eu,doc as va,updateDoc as Tp,where as A0,getDocs as _0,deleteDoc as Ag}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";import{getStorage as M0,getDownloadURL as Pi,ref as yo,uploadBytes as Bi,deleteObject as Tu}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList")for(const p of u.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function s(r){const u={};return r.integrity&&(u.integrity=r.integrity),r.referrerPolicy&&(u.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?u.credentials="include":r.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(r){if(r.ep)return;r.ep=!0;const u=s(r);fetch(r.href,u)}})();function _g(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var fu={exports:{}},ga={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wp;function R0(){if(wp)return ga;wp=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function s(a,r,u){var p=null;if(u!==void 0&&(p=""+u),r.key!==void 0&&(p=""+r.key),"key"in r){u={};for(var y in r)y!=="key"&&(u[y]=r[y])}else u=r;return r=u.ref,{$$typeof:o,type:a,key:p,ref:r!==void 0?r:null,props:u}}return ga.Fragment=t,ga.jsx=s,ga.jsxs=s,ga}var Np;function I0(){return Np||(Np=1,fu.exports=R0()),fu.exports}var c=I0(),hu={exports:{}},Qe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ap;function k0(){if(Ap)return Qe;Ap=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),p=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),S=Symbol.iterator;function N(A){return A===null||typeof A!="object"?null:(A=S&&A[S]||A["@@iterator"],typeof A=="function"?A:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,G={};function k(A,O,W){this.props=A,this.context=O,this.refs=G,this.updater=W||_}k.prototype.isReactComponent={},k.prototype.setState=function(A,O){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,O,"setState")},k.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function V(){}V.prototype=k.prototype;function R(A,O,W){this.props=A,this.context=O,this.refs=G,this.updater=W||_}var B=R.prototype=new V;B.constructor=R,M(B,k.prototype),B.isPureReactComponent=!0;var U=Array.isArray;function $(){}var D={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function K(A,O,W){var ye=W.ref;return{$$typeof:o,type:A,key:O,ref:ye!==void 0?ye:null,props:W}}function I(A,O){return K(A.type,O,A.props)}function X(A){return typeof A=="object"&&A!==null&&A.$$typeof===o}function L(A){var O={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(W){return O[W]})}var H=/\/+/g;function ue(A,O){return typeof A=="object"&&A!==null&&A.key!=null?L(""+A.key):O.toString(36)}function ve(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then($,$):(A.status="pending",A.then(function(O){A.status==="pending"&&(A.status="fulfilled",A.value=O)},function(O){A.status==="pending"&&(A.status="rejected",A.reason=O)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function j(A,O,W,ye,be){var me=typeof A;(me==="undefined"||me==="boolean")&&(A=null);var Me=!1;if(A===null)Me=!0;else switch(me){case"bigint":case"string":case"number":Me=!0;break;case"object":switch(A.$$typeof){case o:case t:Me=!0;break;case v:return Me=A._init,j(Me(A._payload),O,W,ye,be)}}if(Me)return be=be(A),Me=ye===""?"."+ue(A,0):ye,U(be)?(W="",Me!=null&&(W=Me.replace(H,"$&/")+"/"),j(be,O,W,"",function(Ke){return Ke})):be!=null&&(X(be)&&(be=I(be,W+(be.key==null||A&&A.key===be.key?"":(""+be.key).replace(H,"$&/")+"/")+Me)),O.push(be)),1;Me=0;var De=ye===""?".":ye+":";if(U(A))for(var Ae=0;Ae<A.length;Ae++)ye=A[Ae],me=De+ue(ye,Ae),Me+=j(ye,O,W,me,be);else if(Ae=N(A),typeof Ae=="function")for(A=Ae.call(A),Ae=0;!(ye=A.next()).done;)ye=ye.value,me=De+ue(ye,Ae++),Me+=j(ye,O,W,me,be);else if(me==="object"){if(typeof A.then=="function")return j(ve(A),O,W,ye,be);throw O=String(A),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return Me}function z(A,O,W){if(A==null)return A;var ye=[],be=0;return j(A,ye,"","",function(me){return O.call(W,me,be++)}),ye}function oe(A){if(A._status===-1){var O=A._result;O=O(),O.then(function(W){(A._status===0||A._status===-1)&&(A._status=1,A._result=W)},function(W){(A._status===0||A._status===-1)&&(A._status=2,A._result=W)}),A._status===-1&&(A._status=0,A._result=O)}if(A._status===1)return A._result.default;throw A._result}var ge=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},Z={map:z,forEach:function(A,O,W){z(A,function(){O.apply(this,arguments)},W)},count:function(A){var O=0;return z(A,function(){O++}),O},toArray:function(A){return z(A,function(O){return O})||[]},only:function(A){if(!X(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return Qe.Activity=b,Qe.Children=Z,Qe.Component=k,Qe.Fragment=s,Qe.Profiler=r,Qe.PureComponent=R,Qe.StrictMode=a,Qe.Suspense=x,Qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Qe.__COMPILER_RUNTIME={__proto__:null,c:function(A){return D.H.useMemoCache(A)}},Qe.cache=function(A){return function(){return A.apply(null,arguments)}},Qe.cacheSignal=function(){return null},Qe.cloneElement=function(A,O,W){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var ye=M({},A.props),be=A.key;if(O!=null)for(me in O.key!==void 0&&(be=""+O.key),O)!E.call(O,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&O.ref===void 0||(ye[me]=O[me]);var me=arguments.length-2;if(me===1)ye.children=W;else if(1<me){for(var Me=Array(me),De=0;De<me;De++)Me[De]=arguments[De+2];ye.children=Me}return K(A.type,be,ye)},Qe.createContext=function(A){return A={$$typeof:p,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:u,_context:A},A},Qe.createElement=function(A,O,W){var ye,be={},me=null;if(O!=null)for(ye in O.key!==void 0&&(me=""+O.key),O)E.call(O,ye)&&ye!=="key"&&ye!=="__self"&&ye!=="__source"&&(be[ye]=O[ye]);var Me=arguments.length-2;if(Me===1)be.children=W;else if(1<Me){for(var De=Array(Me),Ae=0;Ae<Me;Ae++)De[Ae]=arguments[Ae+2];be.children=De}if(A&&A.defaultProps)for(ye in Me=A.defaultProps,Me)be[ye]===void 0&&(be[ye]=Me[ye]);return K(A,me,be)},Qe.createRef=function(){return{current:null}},Qe.forwardRef=function(A){return{$$typeof:y,render:A}},Qe.isValidElement=X,Qe.lazy=function(A){return{$$typeof:v,_payload:{_status:-1,_result:A},_init:oe}},Qe.memo=function(A,O){return{$$typeof:m,type:A,compare:O===void 0?null:O}},Qe.startTransition=function(A){var O=D.T,W={};D.T=W;try{var ye=A(),be=D.S;be!==null&&be(W,ye),typeof ye=="object"&&ye!==null&&typeof ye.then=="function"&&ye.then($,ge)}catch(me){ge(me)}finally{O!==null&&W.types!==null&&(O.types=W.types),D.T=O}},Qe.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Qe.use=function(A){return D.H.use(A)},Qe.useActionState=function(A,O,W){return D.H.useActionState(A,O,W)},Qe.useCallback=function(A,O){return D.H.useCallback(A,O)},Qe.useContext=function(A){return D.H.useContext(A)},Qe.useDebugValue=function(){},Qe.useDeferredValue=function(A,O){return D.H.useDeferredValue(A,O)},Qe.useEffect=function(A,O){return D.H.useEffect(A,O)},Qe.useEffectEvent=function(A){return D.H.useEffectEvent(A)},Qe.useId=function(){return D.H.useId()},Qe.useImperativeHandle=function(A,O,W){return D.H.useImperativeHandle(A,O,W)},Qe.useInsertionEffect=function(A,O){return D.H.useInsertionEffect(A,O)},Qe.useLayoutEffect=function(A,O){return D.H.useLayoutEffect(A,O)},Qe.useMemo=function(A,O){return D.H.useMemo(A,O)},Qe.useOptimistic=function(A,O){return D.H.useOptimistic(A,O)},Qe.useReducer=function(A,O,W){return D.H.useReducer(A,O,W)},Qe.useRef=function(A){return D.H.useRef(A)},Qe.useState=function(A){return D.H.useState(A)},Qe.useSyncExternalStore=function(A,O,W){return D.H.useSyncExternalStore(A,O,W)},Qe.useTransition=function(){return D.H.useTransition()},Qe.version="19.2.0",Qe}var _p;function Uu(){return _p||(_p=1,hu.exports=k0()),hu.exports}var T=Uu();const Mg=_g(T);var pu={exports:{}},ya={},mu={exports:{}},gu={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mp;function D0(){return Mp||(Mp=1,(function(o){function t(j,z){var oe=j.length;j.push(z);e:for(;0<oe;){var ge=oe-1>>>1,Z=j[ge];if(0<r(Z,z))j[ge]=z,j[oe]=Z,oe=ge;else break e}}function s(j){return j.length===0?null:j[0]}function a(j){if(j.length===0)return null;var z=j[0],oe=j.pop();if(oe!==z){j[0]=oe;e:for(var ge=0,Z=j.length,A=Z>>>1;ge<A;){var O=2*(ge+1)-1,W=j[O],ye=O+1,be=j[ye];if(0>r(W,oe))ye<Z&&0>r(be,W)?(j[ge]=be,j[ye]=oe,ge=ye):(j[ge]=W,j[O]=oe,ge=O);else if(ye<Z&&0>r(be,oe))j[ge]=be,j[ye]=oe,ge=ye;else break e}}return z}function r(j,z){var oe=j.sortIndex-z.sortIndex;return oe!==0?oe:j.id-z.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;o.unstable_now=function(){return u.now()}}else{var p=Date,y=p.now();o.unstable_now=function(){return p.now()-y}}var x=[],m=[],v=1,b=null,S=3,N=!1,_=!1,M=!1,G=!1,k=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function B(j){for(var z=s(m);z!==null;){if(z.callback===null)a(m);else if(z.startTime<=j)a(m),z.sortIndex=z.expirationTime,t(x,z);else break;z=s(m)}}function U(j){if(M=!1,B(j),!_)if(s(x)!==null)_=!0,$||($=!0,L());else{var z=s(m);z!==null&&ve(U,z.startTime-j)}}var $=!1,D=-1,E=5,K=-1;function I(){return G?!0:!(o.unstable_now()-K<E)}function X(){if(G=!1,$){var j=o.unstable_now();K=j;var z=!0;try{e:{_=!1,M&&(M=!1,V(D),D=-1),N=!0;var oe=S;try{t:{for(B(j),b=s(x);b!==null&&!(b.expirationTime>j&&I());){var ge=b.callback;if(typeof ge=="function"){b.callback=null,S=b.priorityLevel;var Z=ge(b.expirationTime<=j);if(j=o.unstable_now(),typeof Z=="function"){b.callback=Z,B(j),z=!0;break t}b===s(x)&&a(x),B(j)}else a(x);b=s(x)}if(b!==null)z=!0;else{var A=s(m);A!==null&&ve(U,A.startTime-j),z=!1}}break e}finally{b=null,S=oe,N=!1}z=void 0}}finally{z?L():$=!1}}}var L;if(typeof R=="function")L=function(){R(X)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,ue=H.port2;H.port1.onmessage=X,L=function(){ue.postMessage(null)}}else L=function(){k(X,0)};function ve(j,z){D=k(function(){j(o.unstable_now())},z)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return S},o.unstable_next=function(j){switch(S){case 1:case 2:case 3:var z=3;break;default:z=S}var oe=S;S=z;try{return j()}finally{S=oe}},o.unstable_requestPaint=function(){G=!0},o.unstable_runWithPriority=function(j,z){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var oe=S;S=j;try{return z()}finally{S=oe}},o.unstable_scheduleCallback=function(j,z,oe){var ge=o.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?ge+oe:ge):oe=ge,j){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=oe+Z,j={id:v++,callback:z,priorityLevel:j,startTime:oe,expirationTime:Z,sortIndex:-1},oe>ge?(j.sortIndex=oe,t(m,j),s(x)===null&&j===s(m)&&(M?(V(D),D=-1):M=!0,ve(U,oe-ge))):(j.sortIndex=Z,t(x,j),_||N||(_=!0,$||($=!0,L()))),j},o.unstable_shouldYield=I,o.unstable_wrapCallback=function(j){var z=S;return function(){var oe=S;S=z;try{return j.apply(this,arguments)}finally{S=oe}}}})(gu)),gu}var Rp;function L0(){return Rp||(Rp=1,mu.exports=D0()),mu.exports}var yu={exports:{}},Nn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ip;function j0(){if(Ip)return Nn;Ip=1;var o=Uu();function t(x){var m="https://react.dev/errors/"+x;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+x+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var a={d:{f:s,r:function(){throw Error(t(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},r=Symbol.for("react.portal");function u(x,m,v){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:b==null?null:""+b,children:x,containerInfo:m,implementation:v}}var p=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function y(x,m){if(x==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Nn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Nn.createPortal=function(x,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(t(299));return u(x,m,null,v)},Nn.flushSync=function(x){var m=p.T,v=a.p;try{if(p.T=null,a.p=2,x)return x()}finally{p.T=m,a.p=v,a.d.f()}},Nn.preconnect=function(x,m){typeof x=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(x,m))},Nn.prefetchDNS=function(x){typeof x=="string"&&a.d.D(x)},Nn.preinit=function(x,m){if(typeof x=="string"&&m&&typeof m.as=="string"){var v=m.as,b=y(v,m.crossOrigin),S=typeof m.integrity=="string"?m.integrity:void 0,N=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?a.d.S(x,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:b,integrity:S,fetchPriority:N}):v==="script"&&a.d.X(x,{crossOrigin:b,integrity:S,fetchPriority:N,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Nn.preinitModule=function(x,m){if(typeof x=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=y(m.as,m.crossOrigin);a.d.M(x,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(x)},Nn.preload=function(x,m){if(typeof x=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,b=y(v,m.crossOrigin);a.d.L(x,v,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Nn.preloadModule=function(x,m){if(typeof x=="string")if(m){var v=y(m.as,m.crossOrigin);a.d.m(x,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(x)},Nn.requestFormReset=function(x){a.d.r(x)},Nn.unstable_batchedUpdates=function(x,m){return x(m)},Nn.useFormState=function(x,m,v){return p.H.useFormState(x,m,v)},Nn.useFormStatus=function(){return p.H.useHostTransitionStatus()},Nn.version="19.2.0",Nn}var kp;function U0(){if(kp)return yu.exports;kp=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),yu.exports=j0(),yu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dp;function z0(){if(Dp)return ya;Dp=1;var o=L0(),t=Uu(),s=U0();function a(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function u(e){var n=e,l=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(l=n.return),e=n.return;while(e)}return n.tag===3?l:null}function p(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function y(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function x(e){if(u(e)!==e)throw Error(a(188))}function m(e){var n=e.alternate;if(!n){if(n=u(e),n===null)throw Error(a(188));return n!==e?null:e}for(var l=e,i=n;;){var f=l.return;if(f===null)break;var g=f.alternate;if(g===null){if(i=f.return,i!==null){l=i;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===l)return x(f),e;if(g===i)return x(f),n;g=g.sibling}throw Error(a(188))}if(l.return!==i.return)l=f,i=g;else{for(var C=!1,w=f.child;w;){if(w===l){C=!0,l=f,i=g;break}if(w===i){C=!0,i=f,l=g;break}w=w.sibling}if(!C){for(w=g.child;w;){if(w===l){C=!0,l=g,i=f;break}if(w===i){C=!0,i=g,l=f;break}w=w.sibling}if(!C)throw Error(a(189))}}if(l.alternate!==i)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?e:n}function v(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=v(e),n!==null)return n;e=e.sibling}return null}var b=Object.assign,S=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),V=Symbol.for("react.consumer"),R=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function L(e){return e===null||typeof e!="object"?null:(e=X&&e[X]||e["@@iterator"],typeof e=="function"?e:null)}var H=Symbol.for("react.client.reference");function ue(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===H?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case M:return"Fragment";case k:return"Profiler";case G:return"StrictMode";case U:return"Suspense";case $:return"SuspenseList";case K:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case _:return"Portal";case R:return e.displayName||"Context";case V:return(e._context.displayName||"Context")+".Consumer";case B:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case D:return n=e.displayName||null,n!==null?n:ue(e.type)||"Memo";case E:n=e._payload,e=e._init;try{return ue(e(n))}catch{}}return null}var ve=Array.isArray,j=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},ge=[],Z=-1;function A(e){return{current:e}}function O(e){0>Z||(e.current=ge[Z],ge[Z]=null,Z--)}function W(e,n){Z++,ge[Z]=e.current,e.current=n}var ye=A(null),be=A(null),me=A(null),Me=A(null);function De(e,n){switch(W(me,n),W(be,e),W(ye,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Jh(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Jh(n),e=Xh(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}O(ye),W(ye,e)}function Ae(){O(ye),O(be),O(me)}function Ke(e){e.memoizedState!==null&&W(Me,e);var n=ye.current,l=Xh(n,e.type);n!==l&&(W(be,e),W(ye,l))}function mt(e){be.current===e&&(O(ye),O(be)),Me.current===e&&(O(Me),fa._currentValue=oe)}var Rt,he;function Ee(e){if(Rt===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);Rt=n&&n[1]||"",he=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Rt+e+he}var Se=!1;function je(e,n){if(!e||Se)return"";Se=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(n){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(se){var ne=se}Reflect.construct(e,[],pe)}else{try{pe.call()}catch(se){ne=se}e.call(pe.prototype)}}else{try{throw Error()}catch(se){ne=se}(pe=e())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(se){if(se&&ne&&typeof se.stack=="string")return[se.stack,ne.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=i.DetermineComponentFrameRoot(),C=g[0],w=g[1];if(C&&w){var P=C.split(`
`),te=w.split(`
`);for(f=i=0;i<P.length&&!P[i].includes("DetermineComponentFrameRoot");)i++;for(;f<te.length&&!te[f].includes("DetermineComponentFrameRoot");)f++;if(i===P.length||f===te.length)for(i=P.length-1,f=te.length-1;1<=i&&0<=f&&P[i]!==te[f];)f--;for(;1<=i&&0<=f;i--,f--)if(P[i]!==te[f]){if(i!==1||f!==1)do if(i--,f--,0>f||P[i]!==te[f]){var ce=`
`+P[i].replace(" at new "," at ");return e.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",e.displayName)),ce}while(1<=i&&0<=f);break}}}finally{Se=!1,Error.prepareStackTrace=l}return(l=e?e.displayName||e.name:"")?Ee(l):""}function Ve(e,n){switch(e.tag){case 26:case 27:case 5:return Ee(e.type);case 16:return Ee("Lazy");case 13:return e.child!==n&&n!==null?Ee("Suspense Fallback"):Ee("Suspense");case 19:return Ee("SuspenseList");case 0:case 15:return je(e.type,!1);case 11:return je(e.type.render,!1);case 1:return je(e.type,!0);case 31:return Ee("Activity");default:return""}}function Fe(e){try{var n="",l=null;do n+=Ve(e,l),l=e,e=e.return;while(e);return n}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var tt=Object.prototype.hasOwnProperty,rt=o.unstable_scheduleCallback,Ht=o.unstable_cancelCallback,Ze=o.unstable_shouldYield,It=o.unstable_requestPaint,$e=o.unstable_now,bt=o.unstable_getCurrentPriorityLevel,Ue=o.unstable_ImmediatePriority,We=o.unstable_UserBlockingPriority,Ut=o.unstable_NormalPriority,mn=o.unstable_LowPriority,un=o.unstable_IdlePriority,ft=o.log,Yt=o.unstable_setDisableYieldValue,hn=null,Wt=null;function Qt(e){if(typeof ft=="function"&&Yt(e),Wt&&typeof Wt.setStrictMode=="function")try{Wt.setStrictMode(hn,e)}catch{}}var At=Math.clz32?Math.clz32:Ne,Ot=Math.log,Et=Math.LN2;function Ne(e){return e>>>=0,e===0?32:31-(Ot(e)/Et|0)|0}var _e=256,Ge=262144,it=4194304;function ct(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function gt(e,n,l){var i=e.pendingLanes;if(i===0)return 0;var f=0,g=e.suspendedLanes,C=e.pingedLanes;e=e.warmLanes;var w=i&134217727;return w!==0?(i=w&~g,i!==0?f=ct(i):(C&=w,C!==0?f=ct(C):l||(l=w&~e,l!==0&&(f=ct(l))))):(w=i&~g,w!==0?f=ct(w):C!==0?f=ct(C):l||(l=i&~e,l!==0&&(f=ct(l)))),f===0?0:n!==0&&n!==f&&(n&g)===0&&(g=f&-f,l=n&-n,g>=l||g===32&&(l&4194048)!==0)?n:f}function Oe(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function Ye(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function at(){var e=it;return it<<=1,(it&62914560)===0&&(it=4194304),e}function Ct(e){for(var n=[],l=0;31>l;l++)n.push(e);return n}function Te(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ce(e,n,l,i,f,g){var C=e.pendingLanes;e.pendingLanes=l,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=l,e.entangledLanes&=l,e.errorRecoveryDisabledLanes&=l,e.shellSuspendCounter=0;var w=e.entanglements,P=e.expirationTimes,te=e.hiddenUpdates;for(l=C&~l;0<l;){var ce=31-At(l),pe=1<<ce;w[ce]=0,P[ce]=-1;var ne=te[ce];if(ne!==null)for(te[ce]=null,ce=0;ce<ne.length;ce++){var se=ne[ce];se!==null&&(se.lane&=-536870913)}l&=~pe}i!==0&&Ie(e,i,0),g!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=g&~(C&~n))}function Ie(e,n,l){e.pendingLanes|=n,e.suspendedLanes&=~n;var i=31-At(n);e.entangledLanes|=n,e.entanglements[i]=e.entanglements[i]|1073741824|l&261930}function ae(e,n){var l=e.entangledLanes|=n;for(e=e.entanglements;l;){var i=31-At(l),f=1<<i;f&n|e[i]&n&&(e[i]|=n),l&=~f}}function Y(e,n){var l=n&-n;return l=(l&42)!==0?1:le(l),(l&(e.suspendedLanes|n))!==0?0:l}function le(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function xe(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function we(){var e=z.p;return e!==0?e:(e=window.event,e===void 0?32:yp(e.type))}function ke(e,n){var l=z.p;try{return z.p=e,n()}finally{z.p=l}}var Re=Math.random().toString(36).slice(2),Le="__reactFiber$"+Re,Je="__reactProps$"+Re,nt="__reactContainer$"+Re,St="__reactEvents$"+Re,ot="__reactListeners$"+Re,Ft="__reactHandles$"+Re,$t="__reactResources$"+Re,_t="__reactMarker$"+Re;function gn(e){delete e[Le],delete e[Je],delete e[St],delete e[ot],delete e[Ft]}function Sn(e){var n=e[Le];if(n)return n;for(var l=e.parentNode;l;){if(n=l[nt]||l[Le]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(e=tp(e);e!==null;){if(l=e[Le])return l;e=tp(e)}return n}e=l,l=e.parentNode}return null}function nn(e){if(e=e[Le]||e[nt]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function Jn(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(a(33))}function En(e){var n=e[$t];return n||(n=e[$t]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function zt(e){e[_t]=!0}var Xn=new Set,qo={};function Un(e,n){kt(e,n),kt(e+"Capture",n)}function kt(e,n){for(qo[e]=n,e=0;e<n.length;e++)Xn.add(n[e])}var zn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ml={},gl={};function Ns(e){return tt.call(gl,e)?!0:tt.call(ml,e)?!1:zn.test(e)?gl[e]=!0:(ml[e]=!0,!1)}function Go(e,n,l){if(Ns(n))if(l===null)e.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var i=n.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+l)}}function Vo(e,n,l){if(l===null)e.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+l)}}function Mn(e,n,l,i){if(i===null)e.removeAttribute(l);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(l);return}e.setAttributeNS(n,l,""+i)}}function Tn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function so(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function F(e,n,l){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var f=i.get,g=i.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return f.call(this)},set:function(C){l=""+C,g.call(this,C)}}),Object.defineProperty(e,n,{enumerable:i.enumerable}),{getValue:function(){return l},setValue:function(C){l=""+C},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function re(e){if(!e._valueTracker){var n=so(e)?"checked":"value";e._valueTracker=F(e,n,""+e[n])}}function qe(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var l=n.getValue(),i="";return e&&(i=so(e)?e.checked?"true":"false":e.value),e=i,e!==l?(n.setValue(e),!0):!1}function st(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var yt=/[\n"\\]/g;function Dt(e){return e.replace(yt,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function yn(e,n,l,i,f,g,C,w){e.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?e.type=C:e.removeAttribute("type"),n!=null?C==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+Tn(n)):e.value!==""+Tn(n)&&(e.value=""+Tn(n)):C!=="submit"&&C!=="reset"||e.removeAttribute("value"),n!=null?As(e,C,Tn(n)):l!=null?As(e,C,Tn(l)):i!=null&&e.removeAttribute("value"),f==null&&g!=null&&(e.defaultChecked=!!g),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?e.name=""+Tn(w):e.removeAttribute("name")}function wa(e,n,l,i,f,g,C,w){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(e.type=g),n!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||n!=null)){re(e);return}l=l!=null?""+Tn(l):"",n=n!=null?""+Tn(n):l,w||n===e.value||(e.value=n),e.defaultValue=n}i=i??f,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=w?e.checked:!!i,e.defaultChecked=!!i,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(e.name=C),re(e)}function As(e,n,l){n==="number"&&st(e.ownerDocument)===e||e.defaultValue===""+l||(e.defaultValue=""+l)}function fe(e,n,l,i){if(e=e.options,n){n={};for(var f=0;f<l.length;f++)n["$"+l[f]]=!0;for(l=0;l<e.length;l++)f=n.hasOwnProperty("$"+e[l].value),e[l].selected!==f&&(e[l].selected=f),f&&i&&(e[l].defaultSelected=!0)}else{for(l=""+Tn(l),n=null,f=0;f<e.length;f++){if(e[f].value===l){e[f].selected=!0,i&&(e[f].defaultSelected=!0);return}n!==null||e[f].disabled||(n=e[f])}n!==null&&(n.selected=!0)}}function q(e,n,l){if(n!=null&&(n=""+Tn(n),n!==e.value&&(e.value=n),l==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=l!=null?""+Tn(l):""}function ie(e,n,l,i){if(n==null){if(i!=null){if(l!=null)throw Error(a(92));if(ve(i)){if(1<i.length)throw Error(a(93));i=i[0]}l=i}l==null&&(l=""),n=l}l=Tn(n),e.defaultValue=l,i=e.textContent,i===l&&i!==""&&i!==null&&(e.value=i),re(e)}function xt(e,n){if(n){var l=e.firstChild;if(l&&l===e.lastChild&&l.nodeType===3){l.nodeValue=n;return}}e.textContent=n}var Gt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wn(e,n,l){var i=n.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?i?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":i?e.setProperty(n,l):typeof l!="number"||l===0||Gt.has(n)?n==="float"?e.cssFloat=l:e[n]=(""+l).trim():e[n]=l+"px"}function Kn(e,n,l){if(n!=null&&typeof n!="object")throw Error(a(62));if(e=e.style,l!=null){for(var i in l)!l.hasOwnProperty(i)||n!=null&&n.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var f in n)i=n[f],n.hasOwnProperty(f)&&l[f]!==i&&wn(e,f,i)}else for(var g in n)n.hasOwnProperty(g)&&wn(e,g,n[g])}function fo(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_s=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ul(e){return _s.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function dn(){}var cr=null;function ur(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var zl=null,Pl=null;function Fu(e){var n=nn(e);if(n&&(e=n.stateNode)){var l=e[Je]||null;e:switch(e=n.stateNode,n.type){case"input":if(yn(e,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),n=l.name,l.type==="radio"&&n!=null){for(l=e;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Dt(""+n)+'"][type="radio"]'),n=0;n<l.length;n++){var i=l[n];if(i!==e&&i.form===e.form){var f=i[Je]||null;if(!f)throw Error(a(90));yn(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(n=0;n<l.length;n++)i=l[n],i.form===e.form&&qe(i)}break e;case"textarea":q(e,l.value,l.defaultValue);break e;case"select":n=l.value,n!=null&&fe(e,!!l.multiple,n,!1)}}}var dr=!1;function Yu(e,n,l){if(dr)return e(n,l);dr=!0;try{var i=e(n);return i}finally{if(dr=!1,(zl!==null||Pl!==null)&&(fi(),zl&&(n=zl,e=Pl,Pl=zl=null,Fu(n),e)))for(n=0;n<e.length;n++)Fu(e[n])}}function Ms(e,n){var l=e.stateNode;if(l===null)return null;var i=l[Je]||null;if(i===null)return null;l=i[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(l&&typeof l!="function")throw Error(a(231,n,typeof l));return l}var Co=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fr=!1;if(Co)try{var Rs={};Object.defineProperty(Rs,"passive",{get:function(){fr=!0}}),window.addEventListener("test",Rs,Rs),window.removeEventListener("test",Rs,Rs)}catch{fr=!1}var Ho=null,hr=null,Na=null;function Ju(){if(Na)return Na;var e,n=hr,l=n.length,i,f="value"in Ho?Ho.value:Ho.textContent,g=f.length;for(e=0;e<l&&n[e]===f[e];e++);var C=l-e;for(i=1;i<=C&&n[l-i]===f[g-i];i++);return Na=f.slice(e,1<i?1-i:void 0)}function Aa(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function _a(){return!0}function Xu(){return!1}function Rn(e){function n(l,i,f,g,C){this._reactName=l,this._targetInst=f,this.type=i,this.nativeEvent=g,this.target=C,this.currentTarget=null;for(var w in e)e.hasOwnProperty(w)&&(l=e[w],this[w]=l?l(g):g[w]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?_a:Xu,this.isPropagationStopped=Xu,this}return b(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=_a)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=_a)},persist:function(){},isPersistent:_a}),n}var yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ma=Rn(yl),Is=b({},yl,{view:0,detail:0}),xy=Rn(Is),pr,mr,ks,Ra=b({},Is,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yr,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ks&&(ks&&e.type==="mousemove"?(pr=e.screenX-ks.screenX,mr=e.screenY-ks.screenY):mr=pr=0,ks=e),pr)},movementY:function(e){return"movementY"in e?e.movementY:mr}}),Ku=Rn(Ra),vy=b({},Ra,{dataTransfer:0}),by=Rn(vy),Cy=b({},Is,{relatedTarget:0}),gr=Rn(Cy),Sy=b({},yl,{animationName:0,elapsedTime:0,pseudoElement:0}),Ey=Rn(Sy),Ty=b({},yl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wy=Rn(Ty),Ny=b({},yl,{data:0}),$u=Rn(Ny),Ay={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_y={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},My={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ry(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=My[e])?!!n[e]:!1}function yr(){return Ry}var Iy=b({},Is,{key:function(e){if(e.key){var n=Ay[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Aa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_y[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yr,charCode:function(e){return e.type==="keypress"?Aa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Aa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ky=Rn(Iy),Dy=b({},Ra,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zu=Rn(Dy),Ly=b({},Is,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yr}),jy=Rn(Ly),Uy=b({},yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),zy=Rn(Uy),Py=b({},Ra,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),By=Rn(Py),qy=b({},yl,{newState:0,oldState:0}),Gy=Rn(qy),Vy=[9,13,27,32],xr=Co&&"CompositionEvent"in window,Ds=null;Co&&"documentMode"in document&&(Ds=document.documentMode);var Hy=Co&&"TextEvent"in window&&!Ds,Wu=Co&&(!xr||Ds&&8<Ds&&11>=Ds),Qu=" ",ed=!1;function td(e,n){switch(e){case"keyup":return Vy.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Bl=!1;function Oy(e,n){switch(e){case"compositionend":return nd(n);case"keypress":return n.which!==32?null:(ed=!0,Qu);case"textInput":return e=n.data,e===Qu&&ed?null:e;default:return null}}function Fy(e,n){if(Bl)return e==="compositionend"||!xr&&td(e,n)?(e=Ju(),Na=hr=Ho=null,Bl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Wu&&n.locale!=="ko"?null:n.data;default:return null}}var Yy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function od(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Yy[e.type]:n==="textarea"}function ld(e,n,l,i){zl?Pl?Pl.push(i):Pl=[i]:zl=i,n=vi(n,"onChange"),0<n.length&&(l=new Ma("onChange","change",null,l,i),e.push({event:l,listeners:n}))}var Ls=null,js=null;function Jy(e){Gh(e,0)}function Ia(e){var n=Jn(e);if(qe(n))return e}function sd(e,n){if(e==="change")return n}var ad=!1;if(Co){var vr;if(Co){var br="oninput"in document;if(!br){var id=document.createElement("div");id.setAttribute("oninput","return;"),br=typeof id.oninput=="function"}vr=br}else vr=!1;ad=vr&&(!document.documentMode||9<document.documentMode)}function rd(){Ls&&(Ls.detachEvent("onpropertychange",cd),js=Ls=null)}function cd(e){if(e.propertyName==="value"&&Ia(js)){var n=[];ld(n,js,e,ur(e)),Yu(Jy,n)}}function Xy(e,n,l){e==="focusin"?(rd(),Ls=n,js=l,Ls.attachEvent("onpropertychange",cd)):e==="focusout"&&rd()}function Ky(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ia(js)}function $y(e,n){if(e==="click")return Ia(n)}function Zy(e,n){if(e==="input"||e==="change")return Ia(n)}function Wy(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Pn=typeof Object.is=="function"?Object.is:Wy;function Us(e,n){if(Pn(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var l=Object.keys(e),i=Object.keys(n);if(l.length!==i.length)return!1;for(i=0;i<l.length;i++){var f=l[i];if(!tt.call(n,f)||!Pn(e[f],n[f]))return!1}return!0}function ud(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dd(e,n){var l=ud(e);e=0;for(var i;l;){if(l.nodeType===3){if(i=e+l.textContent.length,e<=n&&i>=n)return{node:l,offset:n-e};e=i}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=ud(l)}}function fd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?fd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function hd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=st(e.document);n instanceof e.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)e=n.contentWindow;else break;n=st(e.document)}return n}function Cr(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var Qy=Co&&"documentMode"in document&&11>=document.documentMode,ql=null,Sr=null,zs=null,Er=!1;function pd(e,n,l){var i=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Er||ql==null||ql!==st(i)||(i=ql,"selectionStart"in i&&Cr(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),zs&&Us(zs,i)||(zs=i,i=vi(Sr,"onSelect"),0<i.length&&(n=new Ma("onSelect","select",null,n,l),e.push({event:n,listeners:i}),n.target=ql)))}function xl(e,n){var l={};return l[e.toLowerCase()]=n.toLowerCase(),l["Webkit"+e]="webkit"+n,l["Moz"+e]="moz"+n,l}var Gl={animationend:xl("Animation","AnimationEnd"),animationiteration:xl("Animation","AnimationIteration"),animationstart:xl("Animation","AnimationStart"),transitionrun:xl("Transition","TransitionRun"),transitionstart:xl("Transition","TransitionStart"),transitioncancel:xl("Transition","TransitionCancel"),transitionend:xl("Transition","TransitionEnd")},Tr={},md={};Co&&(md=document.createElement("div").style,"AnimationEvent"in window||(delete Gl.animationend.animation,delete Gl.animationiteration.animation,delete Gl.animationstart.animation),"TransitionEvent"in window||delete Gl.transitionend.transition);function vl(e){if(Tr[e])return Tr[e];if(!Gl[e])return e;var n=Gl[e],l;for(l in n)if(n.hasOwnProperty(l)&&l in md)return Tr[e]=n[l];return e}var gd=vl("animationend"),yd=vl("animationiteration"),xd=vl("animationstart"),ex=vl("transitionrun"),tx=vl("transitionstart"),nx=vl("transitioncancel"),vd=vl("transitionend"),bd=new Map,wr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wr.push("scrollEnd");function ao(e,n){bd.set(e,n),Un(n,[e])}var ka=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},$n=[],Vl=0,Nr=0;function Da(){for(var e=Vl,n=Nr=Vl=0;n<e;){var l=$n[n];$n[n++]=null;var i=$n[n];$n[n++]=null;var f=$n[n];$n[n++]=null;var g=$n[n];if($n[n++]=null,i!==null&&f!==null){var C=i.pending;C===null?f.next=f:(f.next=C.next,C.next=f),i.pending=f}g!==0&&Cd(l,f,g)}}function La(e,n,l,i){$n[Vl++]=e,$n[Vl++]=n,$n[Vl++]=l,$n[Vl++]=i,Nr|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function Ar(e,n,l,i){return La(e,n,l,i),ja(e)}function bl(e,n){return La(e,null,null,n),ja(e)}function Cd(e,n,l){e.lanes|=l;var i=e.alternate;i!==null&&(i.lanes|=l);for(var f=!1,g=e.return;g!==null;)g.childLanes|=l,i=g.alternate,i!==null&&(i.childLanes|=l),g.tag===22&&(e=g.stateNode,e===null||e._visibility&1||(f=!0)),e=g,g=g.return;return e.tag===3?(g=e.stateNode,f&&n!==null&&(f=31-At(l),e=g.hiddenUpdates,i=e[f],i===null?e[f]=[n]:i.push(n),n.lane=l|536870912),g):null}function ja(e){if(50<sa)throw sa=0,Uc=null,Error(a(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Hl={};function ox(e,n,l,i){this.tag=e,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(e,n,l,i){return new ox(e,n,l,i)}function _r(e){return e=e.prototype,!(!e||!e.isReactComponent)}function So(e,n){var l=e.alternate;return l===null?(l=Bn(e.tag,n,e.key,e.mode),l.elementType=e.elementType,l.type=e.type,l.stateNode=e.stateNode,l.alternate=e,e.alternate=l):(l.pendingProps=n,l.type=e.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=e.flags&65011712,l.childLanes=e.childLanes,l.lanes=e.lanes,l.child=e.child,l.memoizedProps=e.memoizedProps,l.memoizedState=e.memoizedState,l.updateQueue=e.updateQueue,n=e.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=e.sibling,l.index=e.index,l.ref=e.ref,l.refCleanup=e.refCleanup,l}function Sd(e,n){e.flags&=65011714;var l=e.alternate;return l===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=l.childLanes,e.lanes=l.lanes,e.child=l.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=l.memoizedProps,e.memoizedState=l.memoizedState,e.updateQueue=l.updateQueue,e.type=l.type,n=l.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Ua(e,n,l,i,f,g){var C=0;if(i=e,typeof e=="function")_r(e)&&(C=1);else if(typeof e=="string")C=r0(e,l,ye.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case K:return e=Bn(31,l,n,f),e.elementType=K,e.lanes=g,e;case M:return Cl(l.children,f,g,n);case G:C=8,f|=24;break;case k:return e=Bn(12,l,n,f|2),e.elementType=k,e.lanes=g,e;case U:return e=Bn(13,l,n,f),e.elementType=U,e.lanes=g,e;case $:return e=Bn(19,l,n,f),e.elementType=$,e.lanes=g,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case R:C=10;break e;case V:C=9;break e;case B:C=11;break e;case D:C=14;break e;case E:C=16,i=null;break e}C=29,l=Error(a(130,e===null?"null":typeof e,"")),i=null}return n=Bn(C,l,n,f),n.elementType=e,n.type=i,n.lanes=g,n}function Cl(e,n,l,i){return e=Bn(7,e,i,n),e.lanes=l,e}function Mr(e,n,l){return e=Bn(6,e,null,n),e.lanes=l,e}function Ed(e){var n=Bn(18,null,null,0);return n.stateNode=e,n}function Rr(e,n,l){return n=Bn(4,e.children!==null?e.children:[],e.key,n),n.lanes=l,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var Td=new WeakMap;function Zn(e,n){if(typeof e=="object"&&e!==null){var l=Td.get(e);return l!==void 0?l:(n={value:e,source:n,stack:Fe(n)},Td.set(e,n),n)}return{value:e,source:n,stack:Fe(n)}}var Ol=[],Fl=0,za=null,Ps=0,Wn=[],Qn=0,Oo=null,ho=1,po="";function Eo(e,n){Ol[Fl++]=Ps,Ol[Fl++]=za,za=e,Ps=n}function wd(e,n,l){Wn[Qn++]=ho,Wn[Qn++]=po,Wn[Qn++]=Oo,Oo=e;var i=ho;e=po;var f=32-At(i)-1;i&=~(1<<f),l+=1;var g=32-At(n)+f;if(30<g){var C=f-f%5;g=(i&(1<<C)-1).toString(32),i>>=C,f-=C,ho=1<<32-At(n)+f|l<<f|i,po=g+e}else ho=1<<g|l<<f|i,po=e}function Ir(e){e.return!==null&&(Eo(e,1),wd(e,1,0))}function kr(e){for(;e===za;)za=Ol[--Fl],Ol[Fl]=null,Ps=Ol[--Fl],Ol[Fl]=null;for(;e===Oo;)Oo=Wn[--Qn],Wn[Qn]=null,po=Wn[--Qn],Wn[Qn]=null,ho=Wn[--Qn],Wn[Qn]=null}function Nd(e,n){Wn[Qn++]=ho,Wn[Qn++]=po,Wn[Qn++]=Oo,ho=n.id,po=n.overflow,Oo=e}var xn=null,Jt=null,vt=!1,Fo=null,eo=!1,Dr=Error(a(519));function Yo(e){var n=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Bs(Zn(n,e)),Dr}function Ad(e){var n=e.stateNode,l=e.type,i=e.memoizedProps;switch(n[Le]=e,n[Je]=i,l){case"dialog":dt("cancel",n),dt("close",n);break;case"iframe":case"object":case"embed":dt("load",n);break;case"video":case"audio":for(l=0;l<ia.length;l++)dt(ia[l],n);break;case"source":dt("error",n);break;case"img":case"image":case"link":dt("error",n),dt("load",n);break;case"details":dt("toggle",n);break;case"input":dt("invalid",n),wa(n,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":dt("invalid",n);break;case"textarea":dt("invalid",n),ie(n,i.value,i.defaultValue,i.children)}l=i.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||n.textContent===""+l||i.suppressHydrationWarning===!0||Fh(n.textContent,l)?(i.popover!=null&&(dt("beforetoggle",n),dt("toggle",n)),i.onScroll!=null&&dt("scroll",n),i.onScrollEnd!=null&&dt("scrollend",n),i.onClick!=null&&(n.onclick=dn),n=!0):n=!1,n||Yo(e,!0)}function _d(e){for(xn=e.return;xn;)switch(xn.tag){case 5:case 31:case 13:eo=!1;return;case 27:case 3:eo=!0;return;default:xn=xn.return}}function Yl(e){if(e!==xn)return!1;if(!vt)return _d(e),vt=!0,!1;var n=e.tag,l;if((l=n!==3&&n!==27)&&((l=n===5)&&(l=e.type,l=!(l!=="form"&&l!=="button")||Zc(e.type,e.memoizedProps)),l=!l),l&&Jt&&Yo(e),_d(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));Jt=ep(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));Jt=ep(e)}else n===27?(n=Jt,al(e.type)?(e=nu,nu=null,Jt=e):Jt=n):Jt=xn?no(e.stateNode.nextSibling):null;return!0}function Sl(){Jt=xn=null,vt=!1}function Lr(){var e=Fo;return e!==null&&(Ln===null?Ln=e:Ln.push.apply(Ln,e),Fo=null),e}function Bs(e){Fo===null?Fo=[e]:Fo.push(e)}var jr=A(null),El=null,To=null;function Jo(e,n,l){W(jr,n._currentValue),n._currentValue=l}function wo(e){e._currentValue=jr.current,O(jr)}function Ur(e,n,l){for(;e!==null;){var i=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,i!==null&&(i.childLanes|=n)):i!==null&&(i.childLanes&n)!==n&&(i.childLanes|=n),e===l)break;e=e.return}}function zr(e,n,l,i){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var g=f.dependencies;if(g!==null){var C=f.child;g=g.firstContext;e:for(;g!==null;){var w=g;g=f;for(var P=0;P<n.length;P++)if(w.context===n[P]){g.lanes|=l,w=g.alternate,w!==null&&(w.lanes|=l),Ur(g.return,l,e),i||(C=null);break e}g=w.next}}else if(f.tag===18){if(C=f.return,C===null)throw Error(a(341));C.lanes|=l,g=C.alternate,g!==null&&(g.lanes|=l),Ur(C,l,e),C=null}else C=f.child;if(C!==null)C.return=f;else for(C=f;C!==null;){if(C===e){C=null;break}if(f=C.sibling,f!==null){f.return=C.return,C=f;break}C=C.return}f=C}}function Jl(e,n,l,i){e=null;for(var f=n,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var C=f.alternate;if(C===null)throw Error(a(387));if(C=C.memoizedProps,C!==null){var w=f.type;Pn(f.pendingProps.value,C.value)||(e!==null?e.push(w):e=[w])}}else if(f===Me.current){if(C=f.alternate,C===null)throw Error(a(387));C.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(fa):e=[fa])}f=f.return}e!==null&&zr(n,e,l,i),n.flags|=262144}function Pa(e){for(e=e.firstContext;e!==null;){if(!Pn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Tl(e){El=e,To=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function vn(e){return Md(El,e)}function Ba(e,n){return El===null&&Tl(e),Md(e,n)}function Md(e,n){var l=n._currentValue;if(n={context:n,memoizedValue:l,next:null},To===null){if(e===null)throw Error(a(308));To=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else To=To.next=n;return l}var lx=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(l,i){e.push(i)}};this.abort=function(){n.aborted=!0,e.forEach(function(l){return l()})}},sx=o.unstable_scheduleCallback,ax=o.unstable_NormalPriority,sn={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pr(){return{controller:new lx,data:new Map,refCount:0}}function qs(e){e.refCount--,e.refCount===0&&sx(ax,function(){e.controller.abort()})}var Gs=null,Br=0,Xl=0,Kl=null;function ix(e,n){if(Gs===null){var l=Gs=[];Br=0,Xl=Vc(),Kl={status:"pending",value:void 0,then:function(i){l.push(i)}}}return Br++,n.then(Rd,Rd),n}function Rd(){if(--Br===0&&Gs!==null){Kl!==null&&(Kl.status="fulfilled");var e=Gs;Gs=null,Xl=0,Kl=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function rx(e,n){var l=[],i={status:"pending",value:null,reason:null,then:function(f){l.push(f)}};return e.then(function(){i.status="fulfilled",i.value=n;for(var f=0;f<l.length;f++)(0,l[f])(n)},function(f){for(i.status="rejected",i.reason=f,f=0;f<l.length;f++)(0,l[f])(void 0)}),i}var Id=j.S;j.S=function(e,n){mh=$e(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&ix(e,n),Id!==null&&Id(e,n)};var wl=A(null);function qr(){var e=wl.current;return e!==null?e:Vt.pooledCache}function qa(e,n){n===null?W(wl,wl.current):W(wl,n.pool)}function kd(){var e=qr();return e===null?null:{parent:sn._currentValue,pool:e}}var $l=Error(a(460)),Gr=Error(a(474)),Ga=Error(a(542)),Va={then:function(){}};function Dd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ld(e,n,l){switch(l=e[l],l===void 0?e.push(n):l!==n&&(n.then(dn,dn),n=l),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Ud(e),e;default:if(typeof n.status=="string")n.then(dn,dn);else{if(e=Vt,e!==null&&100<e.shellSuspendCounter)throw Error(a(482));e=n,e.status="pending",e.then(function(i){if(n.status==="pending"){var f=n;f.status="fulfilled",f.value=i}},function(i){if(n.status==="pending"){var f=n;f.status="rejected",f.reason=i}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Ud(e),e}throw Al=n,$l}}function Nl(e){try{var n=e._init;return n(e._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Al=l,$l):l}}var Al=null;function jd(){if(Al===null)throw Error(a(459));var e=Al;return Al=null,e}function Ud(e){if(e===$l||e===Ga)throw Error(a(483))}var Zl=null,Vs=0;function Ha(e){var n=Vs;return Vs+=1,Zl===null&&(Zl=[]),Ld(Zl,e,n)}function Hs(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function Oa(e,n){throw n.$$typeof===S?Error(a(525)):(e=Object.prototype.toString.call(n),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function zd(e){function n(Q,J){if(e){var ee=Q.deletions;ee===null?(Q.deletions=[J],Q.flags|=16):ee.push(J)}}function l(Q,J){if(!e)return null;for(;J!==null;)n(Q,J),J=J.sibling;return null}function i(Q){for(var J=new Map;Q!==null;)Q.key!==null?J.set(Q.key,Q):J.set(Q.index,Q),Q=Q.sibling;return J}function f(Q,J){return Q=So(Q,J),Q.index=0,Q.sibling=null,Q}function g(Q,J,ee){return Q.index=ee,e?(ee=Q.alternate,ee!==null?(ee=ee.index,ee<J?(Q.flags|=67108866,J):ee):(Q.flags|=67108866,J)):(Q.flags|=1048576,J)}function C(Q){return e&&Q.alternate===null&&(Q.flags|=67108866),Q}function w(Q,J,ee,de){return J===null||J.tag!==6?(J=Mr(ee,Q.mode,de),J.return=Q,J):(J=f(J,ee),J.return=Q,J)}function P(Q,J,ee,de){var He=ee.type;return He===M?ce(Q,J,ee.props.children,de,ee.key):J!==null&&(J.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===E&&Nl(He)===J.type)?(J=f(J,ee.props),Hs(J,ee),J.return=Q,J):(J=Ua(ee.type,ee.key,ee.props,null,Q.mode,de),Hs(J,ee),J.return=Q,J)}function te(Q,J,ee,de){return J===null||J.tag!==4||J.stateNode.containerInfo!==ee.containerInfo||J.stateNode.implementation!==ee.implementation?(J=Rr(ee,Q.mode,de),J.return=Q,J):(J=f(J,ee.children||[]),J.return=Q,J)}function ce(Q,J,ee,de,He){return J===null||J.tag!==7?(J=Cl(ee,Q.mode,de,He),J.return=Q,J):(J=f(J,ee),J.return=Q,J)}function pe(Q,J,ee){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=Mr(""+J,Q.mode,ee),J.return=Q,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case N:return ee=Ua(J.type,J.key,J.props,null,Q.mode,ee),Hs(ee,J),ee.return=Q,ee;case _:return J=Rr(J,Q.mode,ee),J.return=Q,J;case E:return J=Nl(J),pe(Q,J,ee)}if(ve(J)||L(J))return J=Cl(J,Q.mode,ee,null),J.return=Q,J;if(typeof J.then=="function")return pe(Q,Ha(J),ee);if(J.$$typeof===R)return pe(Q,Ba(Q,J),ee);Oa(Q,J)}return null}function ne(Q,J,ee,de){var He=J!==null?J.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return He!==null?null:w(Q,J,""+ee,de);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case N:return ee.key===He?P(Q,J,ee,de):null;case _:return ee.key===He?te(Q,J,ee,de):null;case E:return ee=Nl(ee),ne(Q,J,ee,de)}if(ve(ee)||L(ee))return He!==null?null:ce(Q,J,ee,de,null);if(typeof ee.then=="function")return ne(Q,J,Ha(ee),de);if(ee.$$typeof===R)return ne(Q,J,Ba(Q,ee),de);Oa(Q,ee)}return null}function se(Q,J,ee,de,He){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return Q=Q.get(ee)||null,w(J,Q,""+de,He);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case N:return Q=Q.get(de.key===null?ee:de.key)||null,P(J,Q,de,He);case _:return Q=Q.get(de.key===null?ee:de.key)||null,te(J,Q,de,He);case E:return de=Nl(de),se(Q,J,ee,de,He)}if(ve(de)||L(de))return Q=Q.get(ee)||null,ce(J,Q,de,He,null);if(typeof de.then=="function")return se(Q,J,ee,Ha(de),He);if(de.$$typeof===R)return se(Q,J,ee,Ba(J,de),He);Oa(J,de)}return null}function ze(Q,J,ee,de){for(var He=null,Tt=null,Be=J,lt=J=0,pt=null;Be!==null&&lt<ee.length;lt++){Be.index>lt?(pt=Be,Be=null):pt=Be.sibling;var wt=ne(Q,Be,ee[lt],de);if(wt===null){Be===null&&(Be=pt);break}e&&Be&&wt.alternate===null&&n(Q,Be),J=g(wt,J,lt),Tt===null?He=wt:Tt.sibling=wt,Tt=wt,Be=pt}if(lt===ee.length)return l(Q,Be),vt&&Eo(Q,lt),He;if(Be===null){for(;lt<ee.length;lt++)Be=pe(Q,ee[lt],de),Be!==null&&(J=g(Be,J,lt),Tt===null?He=Be:Tt.sibling=Be,Tt=Be);return vt&&Eo(Q,lt),He}for(Be=i(Be);lt<ee.length;lt++)pt=se(Be,Q,lt,ee[lt],de),pt!==null&&(e&&pt.alternate!==null&&Be.delete(pt.key===null?lt:pt.key),J=g(pt,J,lt),Tt===null?He=pt:Tt.sibling=pt,Tt=pt);return e&&Be.forEach(function(dl){return n(Q,dl)}),vt&&Eo(Q,lt),He}function Xe(Q,J,ee,de){if(ee==null)throw Error(a(151));for(var He=null,Tt=null,Be=J,lt=J=0,pt=null,wt=ee.next();Be!==null&&!wt.done;lt++,wt=ee.next()){Be.index>lt?(pt=Be,Be=null):pt=Be.sibling;var dl=ne(Q,Be,wt.value,de);if(dl===null){Be===null&&(Be=pt);break}e&&Be&&dl.alternate===null&&n(Q,Be),J=g(dl,J,lt),Tt===null?He=dl:Tt.sibling=dl,Tt=dl,Be=pt}if(wt.done)return l(Q,Be),vt&&Eo(Q,lt),He;if(Be===null){for(;!wt.done;lt++,wt=ee.next())wt=pe(Q,wt.value,de),wt!==null&&(J=g(wt,J,lt),Tt===null?He=wt:Tt.sibling=wt,Tt=wt);return vt&&Eo(Q,lt),He}for(Be=i(Be);!wt.done;lt++,wt=ee.next())wt=se(Be,Q,lt,wt.value,de),wt!==null&&(e&&wt.alternate!==null&&Be.delete(wt.key===null?lt:wt.key),J=g(wt,J,lt),Tt===null?He=wt:Tt.sibling=wt,Tt=wt);return e&&Be.forEach(function(v0){return n(Q,v0)}),vt&&Eo(Q,lt),He}function qt(Q,J,ee,de){if(typeof ee=="object"&&ee!==null&&ee.type===M&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case N:e:{for(var He=ee.key;J!==null;){if(J.key===He){if(He=ee.type,He===M){if(J.tag===7){l(Q,J.sibling),de=f(J,ee.props.children),de.return=Q,Q=de;break e}}else if(J.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===E&&Nl(He)===J.type){l(Q,J.sibling),de=f(J,ee.props),Hs(de,ee),de.return=Q,Q=de;break e}l(Q,J);break}else n(Q,J);J=J.sibling}ee.type===M?(de=Cl(ee.props.children,Q.mode,de,ee.key),de.return=Q,Q=de):(de=Ua(ee.type,ee.key,ee.props,null,Q.mode,de),Hs(de,ee),de.return=Q,Q=de)}return C(Q);case _:e:{for(He=ee.key;J!==null;){if(J.key===He)if(J.tag===4&&J.stateNode.containerInfo===ee.containerInfo&&J.stateNode.implementation===ee.implementation){l(Q,J.sibling),de=f(J,ee.children||[]),de.return=Q,Q=de;break e}else{l(Q,J);break}else n(Q,J);J=J.sibling}de=Rr(ee,Q.mode,de),de.return=Q,Q=de}return C(Q);case E:return ee=Nl(ee),qt(Q,J,ee,de)}if(ve(ee))return ze(Q,J,ee,de);if(L(ee)){if(He=L(ee),typeof He!="function")throw Error(a(150));return ee=He.call(ee),Xe(Q,J,ee,de)}if(typeof ee.then=="function")return qt(Q,J,Ha(ee),de);if(ee.$$typeof===R)return qt(Q,J,Ba(Q,ee),de);Oa(Q,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,J!==null&&J.tag===6?(l(Q,J.sibling),de=f(J,ee),de.return=Q,Q=de):(l(Q,J),de=Mr(ee,Q.mode,de),de.return=Q,Q=de),C(Q)):l(Q,J)}return function(Q,J,ee,de){try{Vs=0;var He=qt(Q,J,ee,de);return Zl=null,He}catch(Be){if(Be===$l||Be===Ga)throw Be;var Tt=Bn(29,Be,null,Q.mode);return Tt.lanes=de,Tt.return=Q,Tt}finally{}}}var _l=zd(!0),Pd=zd(!1),Xo=!1;function Vr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hr(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ko(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function $o(e,n,l){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(Mt&2)!==0){var f=i.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),i.pending=n,n=ja(e),Cd(e,null,l),n}return La(e,i,n,l),ja(e)}function Os(e,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194048)!==0)){var i=n.lanes;i&=e.pendingLanes,l|=i,n.lanes=l,ae(e,l)}}function Or(e,n){var l=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,l===i)){var f=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var C={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?f=g=C:g=g.next=C,l=l.next}while(l!==null);g===null?f=g=n:g=g.next=n}else f=g=n;l={baseState:i.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:i.shared,callbacks:i.callbacks},e.updateQueue=l;return}e=l.lastBaseUpdate,e===null?l.firstBaseUpdate=n:e.next=n,l.lastBaseUpdate=n}var Fr=!1;function Fs(){if(Fr){var e=Kl;if(e!==null)throw e}}function Ys(e,n,l,i){Fr=!1;var f=e.updateQueue;Xo=!1;var g=f.firstBaseUpdate,C=f.lastBaseUpdate,w=f.shared.pending;if(w!==null){f.shared.pending=null;var P=w,te=P.next;P.next=null,C===null?g=te:C.next=te,C=P;var ce=e.alternate;ce!==null&&(ce=ce.updateQueue,w=ce.lastBaseUpdate,w!==C&&(w===null?ce.firstBaseUpdate=te:w.next=te,ce.lastBaseUpdate=P))}if(g!==null){var pe=f.baseState;C=0,ce=te=P=null,w=g;do{var ne=w.lane&-536870913,se=ne!==w.lane;if(se?(ht&ne)===ne:(i&ne)===ne){ne!==0&&ne===Xl&&(Fr=!0),ce!==null&&(ce=ce.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var ze=e,Xe=w;ne=n;var qt=l;switch(Xe.tag){case 1:if(ze=Xe.payload,typeof ze=="function"){pe=ze.call(qt,pe,ne);break e}pe=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Xe.payload,ne=typeof ze=="function"?ze.call(qt,pe,ne):ze,ne==null)break e;pe=b({},pe,ne);break e;case 2:Xo=!0}}ne=w.callback,ne!==null&&(e.flags|=64,se&&(e.flags|=8192),se=f.callbacks,se===null?f.callbacks=[ne]:se.push(ne))}else se={lane:ne,tag:w.tag,payload:w.payload,callback:w.callback,next:null},ce===null?(te=ce=se,P=pe):ce=ce.next=se,C|=ne;if(w=w.next,w===null){if(w=f.shared.pending,w===null)break;se=w,w=se.next,se.next=null,f.lastBaseUpdate=se,f.shared.pending=null}}while(!0);ce===null&&(P=pe),f.baseState=P,f.firstBaseUpdate=te,f.lastBaseUpdate=ce,g===null&&(f.shared.lanes=0),tl|=C,e.lanes=C,e.memoizedState=pe}}function Bd(e,n){if(typeof e!="function")throw Error(a(191,e));e.call(n)}function qd(e,n){var l=e.callbacks;if(l!==null)for(e.callbacks=null,e=0;e<l.length;e++)Bd(l[e],n)}var Wl=A(null),Fa=A(0);function Gd(e,n){e=Lo,W(Fa,e),W(Wl,n),Lo=e|n.baseLanes}function Yr(){W(Fa,Lo),W(Wl,Wl.current)}function Jr(){Lo=Fa.current,O(Wl),O(Fa)}var qn=A(null),to=null;function Zo(e){var n=e.alternate;W(on,on.current&1),W(qn,e),to===null&&(n===null||Wl.current!==null||n.memoizedState!==null)&&(to=e)}function Xr(e){W(on,on.current),W(qn,e),to===null&&(to=e)}function Vd(e){e.tag===22?(W(on,on.current),W(qn,e),to===null&&(to=e)):Wo()}function Wo(){W(on,on.current),W(qn,qn.current)}function Gn(e){O(qn),to===e&&(to=null),O(on)}var on=A(0);function Ya(e){for(var n=e;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||eu(l)||tu(l)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var No=0,et=null,Pt=null,an=null,Ja=!1,Ql=!1,Ml=!1,Xa=0,Js=0,es=null,cx=0;function en(){throw Error(a(321))}function Kr(e,n){if(n===null)return!1;for(var l=0;l<n.length&&l<e.length;l++)if(!Pn(e[l],n[l]))return!1;return!0}function $r(e,n,l,i,f,g){return No=g,et=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,j.H=e===null||e.memoizedState===null?Nf:dc,Ml=!1,g=l(i,f),Ml=!1,Ql&&(g=Od(n,l,i,f)),Hd(e),g}function Hd(e){j.H=$s;var n=Pt!==null&&Pt.next!==null;if(No=0,an=Pt=et=null,Ja=!1,Js=0,es=null,n)throw Error(a(300));e===null||rn||(e=e.dependencies,e!==null&&Pa(e)&&(rn=!0))}function Od(e,n,l,i){et=e;var f=0;do{if(Ql&&(es=null),Js=0,Ql=!1,25<=f)throw Error(a(301));if(f+=1,an=Pt=null,e.updateQueue!=null){var g=e.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}j.H=Af,g=n(l,i)}while(Ql);return g}function ux(){var e=j.H,n=e.useState()[0];return n=typeof n.then=="function"?Xs(n):n,e=e.useState()[0],(Pt!==null?Pt.memoizedState:null)!==e&&(et.flags|=1024),n}function Zr(){var e=Xa!==0;return Xa=0,e}function Wr(e,n,l){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~l}function Qr(e){if(Ja){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}Ja=!1}No=0,an=Pt=et=null,Ql=!1,Js=Xa=0,es=null}function _n(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?et.memoizedState=an=e:an=an.next=e,an}function ln(){if(Pt===null){var e=et.alternate;e=e!==null?e.memoizedState:null}else e=Pt.next;var n=an===null?et.memoizedState:an.next;if(n!==null)an=n,Pt=e;else{if(e===null)throw et.alternate===null?Error(a(467)):Error(a(310));Pt=e,e={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},an===null?et.memoizedState=an=e:an=an.next=e}return an}function Ka(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xs(e){var n=Js;return Js+=1,es===null&&(es=[]),e=Ld(es,e,n),n=et,(an===null?n.memoizedState:an.next)===null&&(n=n.alternate,j.H=n===null||n.memoizedState===null?Nf:dc),e}function $a(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Xs(e);if(e.$$typeof===R)return vn(e)}throw Error(a(438,String(e)))}function ec(e){var n=null,l=et.updateQueue;if(l!==null&&(n=l.memoCache),n==null){var i=et.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(n={data:i.data.map(function(f){return f.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),l===null&&(l=Ka(),et.updateQueue=l),l.memoCache=n,l=n.data[n.index],l===void 0)for(l=n.data[n.index]=Array(e),i=0;i<e;i++)l[i]=I;return n.index++,l}function Ao(e,n){return typeof n=="function"?n(e):n}function Za(e){var n=ln();return tc(n,Pt,e)}function tc(e,n,l){var i=e.queue;if(i===null)throw Error(a(311));i.lastRenderedReducer=l;var f=e.baseQueue,g=i.pending;if(g!==null){if(f!==null){var C=f.next;f.next=g.next,g.next=C}n.baseQueue=f=g,i.pending=null}if(g=e.baseState,f===null)e.memoizedState=g;else{n=f.next;var w=C=null,P=null,te=n,ce=!1;do{var pe=te.lane&-536870913;if(pe!==te.lane?(ht&pe)===pe:(No&pe)===pe){var ne=te.revertLane;if(ne===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),pe===Xl&&(ce=!0);else if((No&ne)===ne){te=te.next,ne===Xl&&(ce=!0);continue}else pe={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},P===null?(w=P=pe,C=g):P=P.next=pe,et.lanes|=ne,tl|=ne;pe=te.action,Ml&&l(g,pe),g=te.hasEagerState?te.eagerState:l(g,pe)}else ne={lane:pe,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},P===null?(w=P=ne,C=g):P=P.next=ne,et.lanes|=pe,tl|=pe;te=te.next}while(te!==null&&te!==n);if(P===null?C=g:P.next=w,!Pn(g,e.memoizedState)&&(rn=!0,ce&&(l=Kl,l!==null)))throw l;e.memoizedState=g,e.baseState=C,e.baseQueue=P,i.lastRenderedState=g}return f===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function nc(e){var n=ln(),l=n.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=e;var i=l.dispatch,f=l.pending,g=n.memoizedState;if(f!==null){l.pending=null;var C=f=f.next;do g=e(g,C.action),C=C.next;while(C!==f);Pn(g,n.memoizedState)||(rn=!0),n.memoizedState=g,n.baseQueue===null&&(n.baseState=g),l.lastRenderedState=g}return[g,i]}function Fd(e,n,l){var i=et,f=ln(),g=vt;if(g){if(l===void 0)throw Error(a(407));l=l()}else l=n();var C=!Pn((Pt||f).memoizedState,l);if(C&&(f.memoizedState=l,rn=!0),f=f.queue,sc(Xd.bind(null,i,f,e),[e]),f.getSnapshot!==n||C||an!==null&&an.memoizedState.tag&1){if(i.flags|=2048,ts(9,{destroy:void 0},Jd.bind(null,i,f,l,n),null),Vt===null)throw Error(a(349));g||(No&127)!==0||Yd(i,n,l)}return l}function Yd(e,n,l){e.flags|=16384,e={getSnapshot:n,value:l},n=et.updateQueue,n===null?(n=Ka(),et.updateQueue=n,n.stores=[e]):(l=n.stores,l===null?n.stores=[e]:l.push(e))}function Jd(e,n,l,i){n.value=l,n.getSnapshot=i,Kd(n)&&$d(e)}function Xd(e,n,l){return l(function(){Kd(n)&&$d(e)})}function Kd(e){var n=e.getSnapshot;e=e.value;try{var l=n();return!Pn(e,l)}catch{return!0}}function $d(e){var n=bl(e,2);n!==null&&jn(n,e,2)}function oc(e){var n=_n();if(typeof e=="function"){var l=e;if(e=l(),Ml){Qt(!0);try{l()}finally{Qt(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:e},n}function Zd(e,n,l,i){return e.baseState=l,tc(e,Pt,typeof i=="function"?i:Ao)}function dx(e,n,l,i,f){if(ei(e))throw Error(a(485));if(e=n.action,e!==null){var g={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){g.listeners.push(C)}};j.T!==null?l(!0):g.isTransition=!1,i(g),l=n.pending,l===null?(g.next=n.pending=g,Wd(n,g)):(g.next=l.next,n.pending=l.next=g)}}function Wd(e,n){var l=n.action,i=n.payload,f=e.state;if(n.isTransition){var g=j.T,C={};j.T=C;try{var w=l(f,i),P=j.S;P!==null&&P(C,w),Qd(e,n,w)}catch(te){lc(e,n,te)}finally{g!==null&&C.types!==null&&(g.types=C.types),j.T=g}}else try{g=l(f,i),Qd(e,n,g)}catch(te){lc(e,n,te)}}function Qd(e,n,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(i){ef(e,n,i)},function(i){return lc(e,n,i)}):ef(e,n,l)}function ef(e,n,l){n.status="fulfilled",n.value=l,tf(n),e.state=l,n=e.pending,n!==null&&(l=n.next,l===n?e.pending=null:(l=l.next,n.next=l,Wd(e,l)))}function lc(e,n,l){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do n.status="rejected",n.reason=l,tf(n),n=n.next;while(n!==i)}e.action=null}function tf(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function nf(e,n){return n}function of(e,n){if(vt){var l=Vt.formState;if(l!==null){e:{var i=et;if(vt){if(Jt){t:{for(var f=Jt,g=eo;f.nodeType!==8;){if(!g){f=null;break t}if(f=no(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){Jt=no(f.nextSibling),i=f.data==="F!";break e}}Yo(i)}i=!1}i&&(n=l[0])}}return l=_n(),l.memoizedState=l.baseState=n,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nf,lastRenderedState:n},l.queue=i,l=Ef.bind(null,et,i),i.dispatch=l,i=oc(!1),g=uc.bind(null,et,!1,i.queue),i=_n(),f={state:n,dispatch:null,action:e,pending:null},i.queue=f,l=dx.bind(null,et,f,g,l),f.dispatch=l,i.memoizedState=e,[n,l,!1]}function lf(e){var n=ln();return sf(n,Pt,e)}function sf(e,n,l){if(n=tc(e,n,nf)[0],e=Za(Ao)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var i=Xs(n)}catch(C){throw C===$l?Ga:C}else i=n;n=ln();var f=n.queue,g=f.dispatch;return l!==n.memoizedState&&(et.flags|=2048,ts(9,{destroy:void 0},fx.bind(null,f,l),null)),[i,g,e]}function fx(e,n){e.action=n}function af(e){var n=ln(),l=Pt;if(l!==null)return sf(n,l,e);ln(),n=n.memoizedState,l=ln();var i=l.queue.dispatch;return l.memoizedState=e,[n,i,!1]}function ts(e,n,l,i){return e={tag:e,create:l,deps:i,inst:n,next:null},n=et.updateQueue,n===null&&(n=Ka(),et.updateQueue=n),l=n.lastEffect,l===null?n.lastEffect=e.next=e:(i=l.next,l.next=e,e.next=i,n.lastEffect=e),e}function rf(){return ln().memoizedState}function Wa(e,n,l,i){var f=_n();et.flags|=e,f.memoizedState=ts(1|n,{destroy:void 0},l,i===void 0?null:i)}function Qa(e,n,l,i){var f=ln();i=i===void 0?null:i;var g=f.memoizedState.inst;Pt!==null&&i!==null&&Kr(i,Pt.memoizedState.deps)?f.memoizedState=ts(n,g,l,i):(et.flags|=e,f.memoizedState=ts(1|n,g,l,i))}function cf(e,n){Wa(8390656,8,e,n)}function sc(e,n){Qa(2048,8,e,n)}function hx(e){et.flags|=4;var n=et.updateQueue;if(n===null)n=Ka(),et.updateQueue=n,n.events=[e];else{var l=n.events;l===null?n.events=[e]:l.push(e)}}function uf(e){var n=ln().memoizedState;return hx({ref:n,nextImpl:e}),function(){if((Mt&2)!==0)throw Error(a(440));return n.impl.apply(void 0,arguments)}}function df(e,n){return Qa(4,2,e,n)}function ff(e,n){return Qa(4,4,e,n)}function hf(e,n){if(typeof n=="function"){e=e();var l=n(e);return function(){typeof l=="function"?l():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function pf(e,n,l){l=l!=null?l.concat([e]):null,Qa(4,4,hf.bind(null,n,e),l)}function ac(){}function mf(e,n){var l=ln();n=n===void 0?null:n;var i=l.memoizedState;return n!==null&&Kr(n,i[1])?i[0]:(l.memoizedState=[e,n],e)}function gf(e,n){var l=ln();n=n===void 0?null:n;var i=l.memoizedState;if(n!==null&&Kr(n,i[1]))return i[0];if(i=e(),Ml){Qt(!0);try{e()}finally{Qt(!1)}}return l.memoizedState=[i,n],i}function ic(e,n,l){return l===void 0||(No&1073741824)!==0&&(ht&261930)===0?e.memoizedState=n:(e.memoizedState=l,e=yh(),et.lanes|=e,tl|=e,l)}function yf(e,n,l,i){return Pn(l,n)?l:Wl.current!==null?(e=ic(e,l,i),Pn(e,n)||(rn=!0),e):(No&42)===0||(No&1073741824)!==0&&(ht&261930)===0?(rn=!0,e.memoizedState=l):(e=yh(),et.lanes|=e,tl|=e,n)}function xf(e,n,l,i,f){var g=z.p;z.p=g!==0&&8>g?g:8;var C=j.T,w={};j.T=w,uc(e,!1,n,l);try{var P=f(),te=j.S;if(te!==null&&te(w,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ce=rx(P,i);Ks(e,n,ce,On(e))}else Ks(e,n,i,On(e))}catch(pe){Ks(e,n,{then:function(){},status:"rejected",reason:pe},On())}finally{z.p=g,C!==null&&w.types!==null&&(C.types=w.types),j.T=C}}function px(){}function rc(e,n,l,i){if(e.tag!==5)throw Error(a(476));var f=vf(e).queue;xf(e,f,n,oe,l===null?px:function(){return bf(e),l(i)})}function vf(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:oe},next:null};var l={};return n.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:l},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function bf(e){var n=vf(e);n.next===null&&(n=e.alternate.memoizedState),Ks(e,n.next.queue,{},On())}function cc(){return vn(fa)}function Cf(){return ln().memoizedState}function Sf(){return ln().memoizedState}function mx(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var l=On();e=Ko(l);var i=$o(n,e,l);i!==null&&(jn(i,n,l),Os(i,n,l)),n={cache:Pr()},e.payload=n;return}n=n.return}}function gx(e,n,l){var i=On();l={lane:i,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},ei(e)?Tf(n,l):(l=Ar(e,n,l,i),l!==null&&(jn(l,e,i),wf(l,n,i)))}function Ef(e,n,l){var i=On();Ks(e,n,l,i)}function Ks(e,n,l,i){var f={lane:i,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(ei(e))Tf(n,f);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=n.lastRenderedReducer,g!==null))try{var C=n.lastRenderedState,w=g(C,l);if(f.hasEagerState=!0,f.eagerState=w,Pn(w,C))return La(e,n,f,0),Vt===null&&Da(),!1}catch{}finally{}if(l=Ar(e,n,f,i),l!==null)return jn(l,e,i),wf(l,n,i),!0}return!1}function uc(e,n,l,i){if(i={lane:2,revertLane:Vc(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},ei(e)){if(n)throw Error(a(479))}else n=Ar(e,l,i,2),n!==null&&jn(n,e,2)}function ei(e){var n=e.alternate;return e===et||n!==null&&n===et}function Tf(e,n){Ql=Ja=!0;var l=e.pending;l===null?n.next=n:(n.next=l.next,l.next=n),e.pending=n}function wf(e,n,l){if((l&4194048)!==0){var i=n.lanes;i&=e.pendingLanes,l|=i,n.lanes=l,ae(e,l)}}var $s={readContext:vn,use:$a,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useLayoutEffect:en,useInsertionEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useSyncExternalStore:en,useId:en,useHostTransitionStatus:en,useFormState:en,useActionState:en,useOptimistic:en,useMemoCache:en,useCacheRefresh:en};$s.useEffectEvent=en;var Nf={readContext:vn,use:$a,useCallback:function(e,n){return _n().memoizedState=[e,n===void 0?null:n],e},useContext:vn,useEffect:cf,useImperativeHandle:function(e,n,l){l=l!=null?l.concat([e]):null,Wa(4194308,4,hf.bind(null,n,e),l)},useLayoutEffect:function(e,n){return Wa(4194308,4,e,n)},useInsertionEffect:function(e,n){Wa(4,2,e,n)},useMemo:function(e,n){var l=_n();n=n===void 0?null:n;var i=e();if(Ml){Qt(!0);try{e()}finally{Qt(!1)}}return l.memoizedState=[i,n],i},useReducer:function(e,n,l){var i=_n();if(l!==void 0){var f=l(n);if(Ml){Qt(!0);try{l(n)}finally{Qt(!1)}}}else f=n;return i.memoizedState=i.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},i.queue=e,e=e.dispatch=gx.bind(null,et,e),[i.memoizedState,e]},useRef:function(e){var n=_n();return e={current:e},n.memoizedState=e},useState:function(e){e=oc(e);var n=e.queue,l=Ef.bind(null,et,n);return n.dispatch=l,[e.memoizedState,l]},useDebugValue:ac,useDeferredValue:function(e,n){var l=_n();return ic(l,e,n)},useTransition:function(){var e=oc(!1);return e=xf.bind(null,et,e.queue,!0,!1),_n().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,l){var i=et,f=_n();if(vt){if(l===void 0)throw Error(a(407));l=l()}else{if(l=n(),Vt===null)throw Error(a(349));(ht&127)!==0||Yd(i,n,l)}f.memoizedState=l;var g={value:l,getSnapshot:n};return f.queue=g,cf(Xd.bind(null,i,g,e),[e]),i.flags|=2048,ts(9,{destroy:void 0},Jd.bind(null,i,g,l,n),null),l},useId:function(){var e=_n(),n=Vt.identifierPrefix;if(vt){var l=po,i=ho;l=(i&~(1<<32-At(i)-1)).toString(32)+l,n="_"+n+"R_"+l,l=Xa++,0<l&&(n+="H"+l.toString(32)),n+="_"}else l=cx++,n="_"+n+"r_"+l.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:cc,useFormState:of,useActionState:of,useOptimistic:function(e){var n=_n();n.memoizedState=n.baseState=e;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=l,n=uc.bind(null,et,!0,l),l.dispatch=n,[e,n]},useMemoCache:ec,useCacheRefresh:function(){return _n().memoizedState=mx.bind(null,et)},useEffectEvent:function(e){var n=_n(),l={impl:e};return n.memoizedState=l,function(){if((Mt&2)!==0)throw Error(a(440));return l.impl.apply(void 0,arguments)}}},dc={readContext:vn,use:$a,useCallback:mf,useContext:vn,useEffect:sc,useImperativeHandle:pf,useInsertionEffect:df,useLayoutEffect:ff,useMemo:gf,useReducer:Za,useRef:rf,useState:function(){return Za(Ao)},useDebugValue:ac,useDeferredValue:function(e,n){var l=ln();return yf(l,Pt.memoizedState,e,n)},useTransition:function(){var e=Za(Ao)[0],n=ln().memoizedState;return[typeof e=="boolean"?e:Xs(e),n]},useSyncExternalStore:Fd,useId:Cf,useHostTransitionStatus:cc,useFormState:lf,useActionState:lf,useOptimistic:function(e,n){var l=ln();return Zd(l,Pt,e,n)},useMemoCache:ec,useCacheRefresh:Sf};dc.useEffectEvent=uf;var Af={readContext:vn,use:$a,useCallback:mf,useContext:vn,useEffect:sc,useImperativeHandle:pf,useInsertionEffect:df,useLayoutEffect:ff,useMemo:gf,useReducer:nc,useRef:rf,useState:function(){return nc(Ao)},useDebugValue:ac,useDeferredValue:function(e,n){var l=ln();return Pt===null?ic(l,e,n):yf(l,Pt.memoizedState,e,n)},useTransition:function(){var e=nc(Ao)[0],n=ln().memoizedState;return[typeof e=="boolean"?e:Xs(e),n]},useSyncExternalStore:Fd,useId:Cf,useHostTransitionStatus:cc,useFormState:af,useActionState:af,useOptimistic:function(e,n){var l=ln();return Pt!==null?Zd(l,Pt,e,n):(l.baseState=e,[e,l.queue.dispatch])},useMemoCache:ec,useCacheRefresh:Sf};Af.useEffectEvent=uf;function fc(e,n,l,i){n=e.memoizedState,l=l(i,n),l=l==null?n:b({},n,l),e.memoizedState=l,e.lanes===0&&(e.updateQueue.baseState=l)}var hc={enqueueSetState:function(e,n,l){e=e._reactInternals;var i=On(),f=Ko(i);f.payload=n,l!=null&&(f.callback=l),n=$o(e,f,i),n!==null&&(jn(n,e,i),Os(n,e,i))},enqueueReplaceState:function(e,n,l){e=e._reactInternals;var i=On(),f=Ko(i);f.tag=1,f.payload=n,l!=null&&(f.callback=l),n=$o(e,f,i),n!==null&&(jn(n,e,i),Os(n,e,i))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var l=On(),i=Ko(l);i.tag=2,n!=null&&(i.callback=n),n=$o(e,i,l),n!==null&&(jn(n,e,l),Os(n,e,l))}};function _f(e,n,l,i,f,g,C){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,g,C):n.prototype&&n.prototype.isPureReactComponent?!Us(l,i)||!Us(f,g):!0}function Mf(e,n,l,i){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,i),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,i),n.state!==e&&hc.enqueueReplaceState(n,n.state,null)}function Rl(e,n){var l=n;if("ref"in n){l={};for(var i in n)i!=="ref"&&(l[i]=n[i])}if(e=e.defaultProps){l===n&&(l=b({},l));for(var f in e)l[f]===void 0&&(l[f]=e[f])}return l}function Rf(e){ka(e)}function If(e){console.error(e)}function kf(e){ka(e)}function ti(e,n){try{var l=e.onUncaughtError;l(n.value,{componentStack:n.stack})}catch(i){setTimeout(function(){throw i})}}function Df(e,n,l){try{var i=e.onCaughtError;i(l.value,{componentStack:l.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function pc(e,n,l){return l=Ko(l),l.tag=3,l.payload={element:null},l.callback=function(){ti(e,n)},l}function Lf(e){return e=Ko(e),e.tag=3,e}function jf(e,n,l,i){var f=l.type.getDerivedStateFromError;if(typeof f=="function"){var g=i.value;e.payload=function(){return f(g)},e.callback=function(){Df(n,l,i)}}var C=l.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(e.callback=function(){Df(n,l,i),typeof f!="function"&&(nl===null?nl=new Set([this]):nl.add(this));var w=i.stack;this.componentDidCatch(i.value,{componentStack:w!==null?w:""})})}function yx(e,n,l,i,f){if(l.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(n=l.alternate,n!==null&&Jl(n,l,f,!0),l=qn.current,l!==null){switch(l.tag){case 31:case 13:return to===null?hi():l.alternate===null&&tn===0&&(tn=3),l.flags&=-257,l.flags|=65536,l.lanes=f,i===Va?l.flags|=16384:(n=l.updateQueue,n===null?l.updateQueue=new Set([i]):n.add(i),Bc(e,i,f)),!1;case 22:return l.flags|=65536,i===Va?l.flags|=16384:(n=l.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([i])},l.updateQueue=n):(l=n.retryQueue,l===null?n.retryQueue=new Set([i]):l.add(i)),Bc(e,i,f)),!1}throw Error(a(435,l.tag))}return Bc(e,i,f),hi(),!1}if(vt)return n=qn.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=f,i!==Dr&&(e=Error(a(422),{cause:i}),Bs(Zn(e,l)))):(i!==Dr&&(n=Error(a(423),{cause:i}),Bs(Zn(n,l))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,i=Zn(i,l),f=pc(e.stateNode,i,f),Or(e,f),tn!==4&&(tn=2)),!1;var g=Error(a(520),{cause:i});if(g=Zn(g,l),la===null?la=[g]:la.push(g),tn!==4&&(tn=2),n===null)return!0;i=Zn(i,l),l=n;do{switch(l.tag){case 3:return l.flags|=65536,e=f&-f,l.lanes|=e,e=pc(l.stateNode,i,e),Or(l,e),!1;case 1:if(n=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(nl===null||!nl.has(g))))return l.flags|=65536,f&=-f,l.lanes|=f,f=Lf(f),jf(f,e,l,i),Or(l,f),!1}l=l.return}while(l!==null);return!1}var mc=Error(a(461)),rn=!1;function bn(e,n,l,i){n.child=e===null?Pd(n,null,l,i):_l(n,e.child,l,i)}function Uf(e,n,l,i,f){l=l.render;var g=n.ref;if("ref"in i){var C={};for(var w in i)w!=="ref"&&(C[w]=i[w])}else C=i;return Tl(n),i=$r(e,n,l,C,g,f),w=Zr(),e!==null&&!rn?(Wr(e,n,f),_o(e,n,f)):(vt&&w&&Ir(n),n.flags|=1,bn(e,n,i,f),n.child)}function zf(e,n,l,i,f){if(e===null){var g=l.type;return typeof g=="function"&&!_r(g)&&g.defaultProps===void 0&&l.compare===null?(n.tag=15,n.type=g,Pf(e,n,g,i,f)):(e=Ua(l.type,null,i,n,n.mode,f),e.ref=n.ref,e.return=n,n.child=e)}if(g=e.child,!Ec(e,f)){var C=g.memoizedProps;if(l=l.compare,l=l!==null?l:Us,l(C,i)&&e.ref===n.ref)return _o(e,n,f)}return n.flags|=1,e=So(g,i),e.ref=n.ref,e.return=n,n.child=e}function Pf(e,n,l,i,f){if(e!==null){var g=e.memoizedProps;if(Us(g,i)&&e.ref===n.ref)if(rn=!1,n.pendingProps=i=g,Ec(e,f))(e.flags&131072)!==0&&(rn=!0);else return n.lanes=e.lanes,_o(e,n,f)}return gc(e,n,l,i,f)}function Bf(e,n,l,i){var f=i.children,g=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((n.flags&128)!==0){if(g=g!==null?g.baseLanes|l:l,e!==null){for(i=n.child=e.child,f=0;i!==null;)f=f|i.lanes|i.childLanes,i=i.sibling;i=f&~g}else i=0,n.child=null;return qf(e,n,g,l,i)}if((l&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&qa(n,g!==null?g.cachePool:null),g!==null?Gd(n,g):Yr(),Vd(n);else return i=n.lanes=536870912,qf(e,n,g!==null?g.baseLanes|l:l,l,i)}else g!==null?(qa(n,g.cachePool),Gd(n,g),Wo(),n.memoizedState=null):(e!==null&&qa(n,null),Yr(),Wo());return bn(e,n,f,l),n.child}function Zs(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function qf(e,n,l,i,f){var g=qr();return g=g===null?null:{parent:sn._currentValue,pool:g},n.memoizedState={baseLanes:l,cachePool:g},e!==null&&qa(n,null),Yr(),Vd(n),e!==null&&Jl(e,n,i,!0),n.childLanes=f,null}function ni(e,n){return n=li({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function Gf(e,n,l){return _l(n,e.child,null,l),e=ni(n,n.pendingProps),e.flags|=2,Gn(n),n.memoizedState=null,e}function xx(e,n,l){var i=n.pendingProps,f=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(vt){if(i.mode==="hidden")return e=ni(n,i),n.lanes=536870912,Zs(null,e);if(Xr(n),(e=Jt)?(e=Qh(e,eo),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Oo!==null?{id:ho,overflow:po}:null,retryLane:536870912,hydrationErrors:null},l=Ed(e),l.return=n,n.child=l,xn=n,Jt=null)):e=null,e===null)throw Yo(n);return n.lanes=536870912,null}return ni(n,i)}var g=e.memoizedState;if(g!==null){var C=g.dehydrated;if(Xr(n),f)if(n.flags&256)n.flags&=-257,n=Gf(e,n,l);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(a(558));else if(rn||Jl(e,n,l,!1),f=(l&e.childLanes)!==0,rn||f){if(i=Vt,i!==null&&(C=Y(i,l),C!==0&&C!==g.retryLane))throw g.retryLane=C,bl(e,C),jn(i,e,C),mc;hi(),n=Gf(e,n,l)}else e=g.treeContext,Jt=no(C.nextSibling),xn=n,vt=!0,Fo=null,eo=!1,e!==null&&Nd(n,e),n=ni(n,i),n.flags|=4096;return n}return e=So(e.child,{mode:i.mode,children:i.children}),e.ref=n.ref,n.child=e,e.return=n,e}function oi(e,n){var l=n.ref;if(l===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(e===null||e.ref!==l)&&(n.flags|=4194816)}}function gc(e,n,l,i,f){return Tl(n),l=$r(e,n,l,i,void 0,f),i=Zr(),e!==null&&!rn?(Wr(e,n,f),_o(e,n,f)):(vt&&i&&Ir(n),n.flags|=1,bn(e,n,l,f),n.child)}function Vf(e,n,l,i,f,g){return Tl(n),n.updateQueue=null,l=Od(n,i,l,f),Hd(e),i=Zr(),e!==null&&!rn?(Wr(e,n,g),_o(e,n,g)):(vt&&i&&Ir(n),n.flags|=1,bn(e,n,l,g),n.child)}function Hf(e,n,l,i,f){if(Tl(n),n.stateNode===null){var g=Hl,C=l.contextType;typeof C=="object"&&C!==null&&(g=vn(C)),g=new l(i,g),n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=hc,n.stateNode=g,g._reactInternals=n,g=n.stateNode,g.props=i,g.state=n.memoizedState,g.refs={},Vr(n),C=l.contextType,g.context=typeof C=="object"&&C!==null?vn(C):Hl,g.state=n.memoizedState,C=l.getDerivedStateFromProps,typeof C=="function"&&(fc(n,l,C,i),g.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(C=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),C!==g.state&&hc.enqueueReplaceState(g,g.state,null),Ys(n,i,g,f),Fs(),g.state=n.memoizedState),typeof g.componentDidMount=="function"&&(n.flags|=4194308),i=!0}else if(e===null){g=n.stateNode;var w=n.memoizedProps,P=Rl(l,w);g.props=P;var te=g.context,ce=l.contextType;C=Hl,typeof ce=="object"&&ce!==null&&(C=vn(ce));var pe=l.getDerivedStateFromProps;ce=typeof pe=="function"||typeof g.getSnapshotBeforeUpdate=="function",w=n.pendingProps!==w,ce||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w||te!==C)&&Mf(n,g,i,C),Xo=!1;var ne=n.memoizedState;g.state=ne,Ys(n,i,g,f),Fs(),te=n.memoizedState,w||ne!==te||Xo?(typeof pe=="function"&&(fc(n,l,pe,i),te=n.memoizedState),(P=Xo||_f(n,l,P,i,ne,te,C))?(ce||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(n.flags|=4194308)):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=i,n.memoizedState=te),g.props=i,g.state=te,g.context=C,i=P):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),i=!1)}else{g=n.stateNode,Hr(e,n),C=n.memoizedProps,ce=Rl(l,C),g.props=ce,pe=n.pendingProps,ne=g.context,te=l.contextType,P=Hl,typeof te=="object"&&te!==null&&(P=vn(te)),w=l.getDerivedStateFromProps,(te=typeof w=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(C!==pe||ne!==P)&&Mf(n,g,i,P),Xo=!1,ne=n.memoizedState,g.state=ne,Ys(n,i,g,f),Fs();var se=n.memoizedState;C!==pe||ne!==se||Xo||e!==null&&e.dependencies!==null&&Pa(e.dependencies)?(typeof w=="function"&&(fc(n,l,w,i),se=n.memoizedState),(ce=Xo||_f(n,l,ce,i,ne,se,P)||e!==null&&e.dependencies!==null&&Pa(e.dependencies))?(te||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(i,se,P),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(i,se,P)),typeof g.componentDidUpdate=="function"&&(n.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof g.componentDidUpdate!="function"||C===e.memoizedProps&&ne===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||C===e.memoizedProps&&ne===e.memoizedState||(n.flags|=1024),n.memoizedProps=i,n.memoizedState=se),g.props=i,g.state=se,g.context=P,i=ce):(typeof g.componentDidUpdate!="function"||C===e.memoizedProps&&ne===e.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||C===e.memoizedProps&&ne===e.memoizedState||(n.flags|=1024),i=!1)}return g=i,oi(e,n),i=(n.flags&128)!==0,g||i?(g=n.stateNode,l=i&&typeof l.getDerivedStateFromError!="function"?null:g.render(),n.flags|=1,e!==null&&i?(n.child=_l(n,e.child,null,f),n.child=_l(n,null,l,f)):bn(e,n,l,f),n.memoizedState=g.state,e=n.child):e=_o(e,n,f),e}function Of(e,n,l,i){return Sl(),n.flags|=256,bn(e,n,l,i),n.child}var yc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xc(e){return{baseLanes:e,cachePool:kd()}}function vc(e,n,l){return e=e!==null?e.childLanes&~l:0,n&&(e|=Hn),e}function Ff(e,n,l){var i=n.pendingProps,f=!1,g=(n.flags&128)!==0,C;if((C=g)||(C=e!==null&&e.memoizedState===null?!1:(on.current&2)!==0),C&&(f=!0,n.flags&=-129),C=(n.flags&32)!==0,n.flags&=-33,e===null){if(vt){if(f?Zo(n):Wo(),(e=Jt)?(e=Qh(e,eo),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:Oo!==null?{id:ho,overflow:po}:null,retryLane:536870912,hydrationErrors:null},l=Ed(e),l.return=n,n.child=l,xn=n,Jt=null)):e=null,e===null)throw Yo(n);return tu(e)?n.lanes=32:n.lanes=536870912,null}var w=i.children;return i=i.fallback,f?(Wo(),f=n.mode,w=li({mode:"hidden",children:w},f),i=Cl(i,f,l,null),w.return=n,i.return=n,w.sibling=i,n.child=w,i=n.child,i.memoizedState=xc(l),i.childLanes=vc(e,C,l),n.memoizedState=yc,Zs(null,i)):(Zo(n),bc(n,w))}var P=e.memoizedState;if(P!==null&&(w=P.dehydrated,w!==null)){if(g)n.flags&256?(Zo(n),n.flags&=-257,n=Cc(e,n,l)):n.memoizedState!==null?(Wo(),n.child=e.child,n.flags|=128,n=null):(Wo(),w=i.fallback,f=n.mode,i=li({mode:"visible",children:i.children},f),w=Cl(w,f,l,null),w.flags|=2,i.return=n,w.return=n,i.sibling=w,n.child=i,_l(n,e.child,null,l),i=n.child,i.memoizedState=xc(l),i.childLanes=vc(e,C,l),n.memoizedState=yc,n=Zs(null,i));else if(Zo(n),tu(w)){if(C=w.nextSibling&&w.nextSibling.dataset,C)var te=C.dgst;C=te,i=Error(a(419)),i.stack="",i.digest=C,Bs({value:i,source:null,stack:null}),n=Cc(e,n,l)}else if(rn||Jl(e,n,l,!1),C=(l&e.childLanes)!==0,rn||C){if(C=Vt,C!==null&&(i=Y(C,l),i!==0&&i!==P.retryLane))throw P.retryLane=i,bl(e,i),jn(C,e,i),mc;eu(w)||hi(),n=Cc(e,n,l)}else eu(w)?(n.flags|=192,n.child=e.child,n=null):(e=P.treeContext,Jt=no(w.nextSibling),xn=n,vt=!0,Fo=null,eo=!1,e!==null&&Nd(n,e),n=bc(n,i.children),n.flags|=4096);return n}return f?(Wo(),w=i.fallback,f=n.mode,P=e.child,te=P.sibling,i=So(P,{mode:"hidden",children:i.children}),i.subtreeFlags=P.subtreeFlags&65011712,te!==null?w=So(te,w):(w=Cl(w,f,l,null),w.flags|=2),w.return=n,i.return=n,i.sibling=w,n.child=i,Zs(null,i),i=n.child,w=e.child.memoizedState,w===null?w=xc(l):(f=w.cachePool,f!==null?(P=sn._currentValue,f=f.parent!==P?{parent:P,pool:P}:f):f=kd(),w={baseLanes:w.baseLanes|l,cachePool:f}),i.memoizedState=w,i.childLanes=vc(e,C,l),n.memoizedState=yc,Zs(e.child,i)):(Zo(n),l=e.child,e=l.sibling,l=So(l,{mode:"visible",children:i.children}),l.return=n,l.sibling=null,e!==null&&(C=n.deletions,C===null?(n.deletions=[e],n.flags|=16):C.push(e)),n.child=l,n.memoizedState=null,l)}function bc(e,n){return n=li({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function li(e,n){return e=Bn(22,e,null,n),e.lanes=0,e}function Cc(e,n,l){return _l(n,e.child,null,l),e=bc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Yf(e,n,l){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n),Ur(e.return,n,l)}function Sc(e,n,l,i,f,g){var C=e.memoizedState;C===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:i,tail:l,tailMode:f,treeForkCount:g}:(C.isBackwards=n,C.rendering=null,C.renderingStartTime=0,C.last=i,C.tail=l,C.tailMode=f,C.treeForkCount=g)}function Jf(e,n,l){var i=n.pendingProps,f=i.revealOrder,g=i.tail;i=i.children;var C=on.current,w=(C&2)!==0;if(w?(C=C&1|2,n.flags|=128):C&=1,W(on,C),bn(e,n,i,l),i=vt?Ps:0,!w&&e!==null&&(e.flags&128)!==0)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Yf(e,l,n);else if(e.tag===19)Yf(e,l,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(f){case"forwards":for(l=n.child,f=null;l!==null;)e=l.alternate,e!==null&&Ya(e)===null&&(f=l),l=l.sibling;l=f,l===null?(f=n.child,n.child=null):(f=l.sibling,l.sibling=null),Sc(n,!1,f,l,g,i);break;case"backwards":case"unstable_legacy-backwards":for(l=null,f=n.child,n.child=null;f!==null;){if(e=f.alternate,e!==null&&Ya(e)===null){n.child=f;break}e=f.sibling,f.sibling=l,l=f,f=e}Sc(n,!0,l,null,g,i);break;case"together":Sc(n,!1,null,null,void 0,i);break;default:n.memoizedState=null}return n.child}function _o(e,n,l){if(e!==null&&(n.dependencies=e.dependencies),tl|=n.lanes,(l&n.childLanes)===0)if(e!==null){if(Jl(e,n,l,!1),(l&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(a(153));if(n.child!==null){for(e=n.child,l=So(e,e.pendingProps),n.child=l,l.return=n;e.sibling!==null;)e=e.sibling,l=l.sibling=So(e,e.pendingProps),l.return=n;l.sibling=null}return n.child}function Ec(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&Pa(e)))}function vx(e,n,l){switch(n.tag){case 3:De(n,n.stateNode.containerInfo),Jo(n,sn,e.memoizedState.cache),Sl();break;case 27:case 5:Ke(n);break;case 4:De(n,n.stateNode.containerInfo);break;case 10:Jo(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Xr(n),null;break;case 13:var i=n.memoizedState;if(i!==null)return i.dehydrated!==null?(Zo(n),n.flags|=128,null):(l&n.child.childLanes)!==0?Ff(e,n,l):(Zo(n),e=_o(e,n,l),e!==null?e.sibling:null);Zo(n);break;case 19:var f=(e.flags&128)!==0;if(i=(l&n.childLanes)!==0,i||(Jl(e,n,l,!1),i=(l&n.childLanes)!==0),f){if(i)return Jf(e,n,l);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),W(on,on.current),i)break;return null;case 22:return n.lanes=0,Bf(e,n,l,n.pendingProps);case 24:Jo(n,sn,e.memoizedState.cache)}return _o(e,n,l)}function Xf(e,n,l){if(e!==null)if(e.memoizedProps!==n.pendingProps)rn=!0;else{if(!Ec(e,l)&&(n.flags&128)===0)return rn=!1,vx(e,n,l);rn=(e.flags&131072)!==0}else rn=!1,vt&&(n.flags&1048576)!==0&&wd(n,Ps,n.index);switch(n.lanes=0,n.tag){case 16:e:{var i=n.pendingProps;if(e=Nl(n.elementType),n.type=e,typeof e=="function")_r(e)?(i=Rl(e,i),n.tag=1,n=Hf(null,n,e,i,l)):(n.tag=0,n=gc(null,n,e,i,l));else{if(e!=null){var f=e.$$typeof;if(f===B){n.tag=11,n=Uf(null,n,e,i,l);break e}else if(f===D){n.tag=14,n=zf(null,n,e,i,l);break e}}throw n=ue(e)||e,Error(a(306,n,""))}}return n;case 0:return gc(e,n,n.type,n.pendingProps,l);case 1:return i=n.type,f=Rl(i,n.pendingProps),Hf(e,n,i,f,l);case 3:e:{if(De(n,n.stateNode.containerInfo),e===null)throw Error(a(387));i=n.pendingProps;var g=n.memoizedState;f=g.element,Hr(e,n),Ys(n,i,null,l);var C=n.memoizedState;if(i=C.cache,Jo(n,sn,i),i!==g.cache&&zr(n,[sn],l,!0),Fs(),i=C.element,g.isDehydrated)if(g={element:i,isDehydrated:!1,cache:C.cache},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){n=Of(e,n,i,l);break e}else if(i!==f){f=Zn(Error(a(424)),n),Bs(f),n=Of(e,n,i,l);break e}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Jt=no(e.firstChild),xn=n,vt=!0,Fo=null,eo=!0,l=Pd(n,null,i,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Sl(),i===f){n=_o(e,n,l);break e}bn(e,n,i,l)}n=n.child}return n;case 26:return oi(e,n),e===null?(l=sp(n.type,null,n.pendingProps,null))?n.memoizedState=l:vt||(l=n.type,e=n.pendingProps,i=bi(me.current).createElement(l),i[Le]=n,i[Je]=e,Cn(i,l,e),zt(i),n.stateNode=i):n.memoizedState=sp(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return Ke(n),e===null&&vt&&(i=n.stateNode=np(n.type,n.pendingProps,me.current),xn=n,eo=!0,f=Jt,al(n.type)?(nu=f,Jt=no(i.firstChild)):Jt=f),bn(e,n,n.pendingProps.children,l),oi(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&vt&&((f=i=Jt)&&(i=Kx(i,n.type,n.pendingProps,eo),i!==null?(n.stateNode=i,xn=n,Jt=no(i.firstChild),eo=!1,f=!0):f=!1),f||Yo(n)),Ke(n),f=n.type,g=n.pendingProps,C=e!==null?e.memoizedProps:null,i=g.children,Zc(f,g)?i=null:C!==null&&Zc(f,C)&&(n.flags|=32),n.memoizedState!==null&&(f=$r(e,n,ux,null,null,l),fa._currentValue=f),oi(e,n),bn(e,n,i,l),n.child;case 6:return e===null&&vt&&((e=l=Jt)&&(l=$x(l,n.pendingProps,eo),l!==null?(n.stateNode=l,xn=n,Jt=null,e=!0):e=!1),e||Yo(n)),null;case 13:return Ff(e,n,l);case 4:return De(n,n.stateNode.containerInfo),i=n.pendingProps,e===null?n.child=_l(n,null,i,l):bn(e,n,i,l),n.child;case 11:return Uf(e,n,n.type,n.pendingProps,l);case 7:return bn(e,n,n.pendingProps,l),n.child;case 8:return bn(e,n,n.pendingProps.children,l),n.child;case 12:return bn(e,n,n.pendingProps.children,l),n.child;case 10:return i=n.pendingProps,Jo(n,n.type,i.value),bn(e,n,i.children,l),n.child;case 9:return f=n.type._context,i=n.pendingProps.children,Tl(n),f=vn(f),i=i(f),n.flags|=1,bn(e,n,i,l),n.child;case 14:return zf(e,n,n.type,n.pendingProps,l);case 15:return Pf(e,n,n.type,n.pendingProps,l);case 19:return Jf(e,n,l);case 31:return xx(e,n,l);case 22:return Bf(e,n,l,n.pendingProps);case 24:return Tl(n),i=vn(sn),e===null?(f=qr(),f===null&&(f=Vt,g=Pr(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=l),f=g),n.memoizedState={parent:i,cache:f},Vr(n),Jo(n,sn,f)):((e.lanes&l)!==0&&(Hr(e,n),Ys(n,null,null,l),Fs()),f=e.memoizedState,g=n.memoizedState,f.parent!==i?(f={parent:i,cache:i},n.memoizedState=f,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=f),Jo(n,sn,i)):(i=g.cache,Jo(n,sn,i),i!==f.cache&&zr(n,[sn],l,!0))),bn(e,n,n.pendingProps.children,l),n.child;case 29:throw n.pendingProps}throw Error(a(156,n.tag))}function Mo(e){e.flags|=4}function Tc(e,n,l,i,f){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(f&335544128)===f)if(e.stateNode.complete)e.flags|=8192;else if(Ch())e.flags|=8192;else throw Al=Va,Gr}else e.flags&=-16777217}function Kf(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!up(n))if(Ch())e.flags|=8192;else throw Al=Va,Gr}function si(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?at():536870912,e.lanes|=n,ss|=n)}function Ws(e,n){if(!vt)switch(e.tailMode){case"hidden":n=e.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?e.tail=null:l.sibling=null;break;case"collapsed":l=e.tail;for(var i=null;l!==null;)l.alternate!==null&&(i=l),l=l.sibling;i===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Xt(e){var n=e.alternate!==null&&e.alternate.child===e.child,l=0,i=0;if(n)for(var f=e.child;f!==null;)l|=f.lanes|f.childLanes,i|=f.subtreeFlags&65011712,i|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)l|=f.lanes|f.childLanes,i|=f.subtreeFlags,i|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=i,e.childLanes=l,n}function bx(e,n,l){var i=n.pendingProps;switch(kr(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(n),null;case 1:return Xt(n),null;case 3:return l=n.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),n.memoizedState.cache!==i&&(n.flags|=2048),wo(sn),Ae(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(Yl(n)?Mo(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Lr())),Xt(n),null;case 26:var f=n.type,g=n.memoizedState;return e===null?(Mo(n),g!==null?(Xt(n),Kf(n,g)):(Xt(n),Tc(n,f,null,i,l))):g?g!==e.memoizedState?(Mo(n),Xt(n),Kf(n,g)):(Xt(n),n.flags&=-16777217):(e=e.memoizedProps,e!==i&&Mo(n),Xt(n),Tc(n,f,e,i,l)),null;case 27:if(mt(n),l=me.current,f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==i&&Mo(n);else{if(!i){if(n.stateNode===null)throw Error(a(166));return Xt(n),null}e=ye.current,Yl(n)?Ad(n):(e=np(f,i,l),n.stateNode=e,Mo(n))}return Xt(n),null;case 5:if(mt(n),f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==i&&Mo(n);else{if(!i){if(n.stateNode===null)throw Error(a(166));return Xt(n),null}if(g=ye.current,Yl(n))Ad(n);else{var C=bi(me.current);switch(g){case 1:g=C.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:g=C.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":g=C.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":g=C.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":g=C.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof i.is=="string"?C.createElement("select",{is:i.is}):C.createElement("select"),i.multiple?g.multiple=!0:i.size&&(g.size=i.size);break;default:g=typeof i.is=="string"?C.createElement(f,{is:i.is}):C.createElement(f)}}g[Le]=n,g[Je]=i;e:for(C=n.child;C!==null;){if(C.tag===5||C.tag===6)g.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===n)break e;for(;C.sibling===null;){if(C.return===null||C.return===n)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}n.stateNode=g;e:switch(Cn(g,f,i),f){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Mo(n)}}return Xt(n),Tc(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,l),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==i&&Mo(n);else{if(typeof i!="string"&&n.stateNode===null)throw Error(a(166));if(e=me.current,Yl(n)){if(e=n.stateNode,l=n.memoizedProps,i=null,f=xn,f!==null)switch(f.tag){case 27:case 5:i=f.memoizedProps}e[Le]=n,e=!!(e.nodeValue===l||i!==null&&i.suppressHydrationWarning===!0||Fh(e.nodeValue,l)),e||Yo(n,!0)}else e=bi(e).createTextNode(i),e[Le]=n,n.stateNode=e}return Xt(n),null;case 31:if(l=n.memoizedState,e===null||e.memoizedState!==null){if(i=Yl(n),l!==null){if(e===null){if(!i)throw Error(a(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(557));e[Le]=n}else Sl(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Xt(n),e=!1}else l=Lr(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=l),e=!0;if(!e)return n.flags&256?(Gn(n),n):(Gn(n),null);if((n.flags&128)!==0)throw Error(a(558))}return Xt(n),null;case 13:if(i=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=Yl(n),i!==null&&i.dehydrated!==null){if(e===null){if(!f)throw Error(a(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[Le]=n}else Sl(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Xt(n),f=!1}else f=Lr(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return n.flags&256?(Gn(n),n):(Gn(n),null)}return Gn(n),(n.flags&128)!==0?(n.lanes=l,n):(l=i!==null,e=e!==null&&e.memoizedState!==null,l&&(i=n.child,f=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(f=i.alternate.memoizedState.cachePool.pool),g=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(g=i.memoizedState.cachePool.pool),g!==f&&(i.flags|=2048)),l!==e&&l&&(n.child.flags|=8192),si(n,n.updateQueue),Xt(n),null);case 4:return Ae(),e===null&&Yc(n.stateNode.containerInfo),Xt(n),null;case 10:return wo(n.type),Xt(n),null;case 19:if(O(on),i=n.memoizedState,i===null)return Xt(n),null;if(f=(n.flags&128)!==0,g=i.rendering,g===null)if(f)Ws(i,!1);else{if(tn!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(g=Ya(e),g!==null){for(n.flags|=128,Ws(i,!1),e=g.updateQueue,n.updateQueue=e,si(n,e),n.subtreeFlags=0,e=l,l=n.child;l!==null;)Sd(l,e),l=l.sibling;return W(on,on.current&1|2),vt&&Eo(n,i.treeForkCount),n.child}e=e.sibling}i.tail!==null&&$e()>ui&&(n.flags|=128,f=!0,Ws(i,!1),n.lanes=4194304)}else{if(!f)if(e=Ya(g),e!==null){if(n.flags|=128,f=!0,e=e.updateQueue,n.updateQueue=e,si(n,e),Ws(i,!0),i.tail===null&&i.tailMode==="hidden"&&!g.alternate&&!vt)return Xt(n),null}else 2*$e()-i.renderingStartTime>ui&&l!==536870912&&(n.flags|=128,f=!0,Ws(i,!1),n.lanes=4194304);i.isBackwards?(g.sibling=n.child,n.child=g):(e=i.last,e!==null?e.sibling=g:n.child=g,i.last=g)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=$e(),e.sibling=null,l=on.current,W(on,f?l&1|2:l&1),vt&&Eo(n,i.treeForkCount),e):(Xt(n),null);case 22:case 23:return Gn(n),Jr(),i=n.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(n.flags|=8192):i&&(n.flags|=8192),i?(l&536870912)!==0&&(n.flags&128)===0&&(Xt(n),n.subtreeFlags&6&&(n.flags|=8192)):Xt(n),l=n.updateQueue,l!==null&&si(n,l.retryQueue),l=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),i=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),i!==l&&(n.flags|=2048),e!==null&&O(wl),null;case 24:return l=null,e!==null&&(l=e.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),wo(sn),Xt(n),null;case 25:return null;case 30:return null}throw Error(a(156,n.tag))}function Cx(e,n){switch(kr(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return wo(sn),Ae(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return mt(n),null;case 31:if(n.memoizedState!==null){if(Gn(n),n.alternate===null)throw Error(a(340));Sl()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(Gn(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(a(340));Sl()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return O(on),null;case 4:return Ae(),null;case 10:return wo(n.type),null;case 22:case 23:return Gn(n),Jr(),e!==null&&O(wl),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return wo(sn),null;case 25:return null;default:return null}}function $f(e,n){switch(kr(n),n.tag){case 3:wo(sn),Ae();break;case 26:case 27:case 5:mt(n);break;case 4:Ae();break;case 31:n.memoizedState!==null&&Gn(n);break;case 13:Gn(n);break;case 19:O(on);break;case 10:wo(n.type);break;case 22:case 23:Gn(n),Jr(),e!==null&&O(wl);break;case 24:wo(sn)}}function Qs(e,n){try{var l=n.updateQueue,i=l!==null?l.lastEffect:null;if(i!==null){var f=i.next;l=f;do{if((l.tag&e)===e){i=void 0;var g=l.create,C=l.inst;i=g(),C.destroy=i}l=l.next}while(l!==f)}}catch(w){jt(n,n.return,w)}}function Qo(e,n,l){try{var i=n.updateQueue,f=i!==null?i.lastEffect:null;if(f!==null){var g=f.next;i=g;do{if((i.tag&e)===e){var C=i.inst,w=C.destroy;if(w!==void 0){C.destroy=void 0,f=n;var P=l,te=w;try{te()}catch(ce){jt(f,P,ce)}}}i=i.next}while(i!==g)}}catch(ce){jt(n,n.return,ce)}}function Zf(e){var n=e.updateQueue;if(n!==null){var l=e.stateNode;try{qd(n,l)}catch(i){jt(e,e.return,i)}}}function Wf(e,n,l){l.props=Rl(e.type,e.memoizedProps),l.state=e.memoizedState;try{l.componentWillUnmount()}catch(i){jt(e,n,i)}}function ea(e,n){try{var l=e.ref;if(l!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof l=="function"?e.refCleanup=l(i):l.current=i}}catch(f){jt(e,n,f)}}function mo(e,n){var l=e.ref,i=e.refCleanup;if(l!==null)if(typeof i=="function")try{i()}catch(f){jt(e,n,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(f){jt(e,n,f)}else l.current=null}function Qf(e){var n=e.type,l=e.memoizedProps,i=e.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break e;case"img":l.src?i.src=l.src:l.srcSet&&(i.srcset=l.srcSet)}}catch(f){jt(e,e.return,f)}}function wc(e,n,l){try{var i=e.stateNode;Hx(i,e.type,l,n),i[Je]=n}catch(f){jt(e,e.return,f)}}function eh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&al(e.type)||e.tag===4}function Nc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||eh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&al(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ac(e,n,l){var i=e.tag;if(i===5||i===6)e=e.stateNode,n?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(e,n):(n=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,n.appendChild(e),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=dn));else if(i!==4&&(i===27&&al(e.type)&&(l=e.stateNode,n=null),e=e.child,e!==null))for(Ac(e,n,l),e=e.sibling;e!==null;)Ac(e,n,l),e=e.sibling}function ai(e,n,l){var i=e.tag;if(i===5||i===6)e=e.stateNode,n?l.insertBefore(e,n):l.appendChild(e);else if(i!==4&&(i===27&&al(e.type)&&(l=e.stateNode),e=e.child,e!==null))for(ai(e,n,l),e=e.sibling;e!==null;)ai(e,n,l),e=e.sibling}function th(e){var n=e.stateNode,l=e.memoizedProps;try{for(var i=e.type,f=n.attributes;f.length;)n.removeAttributeNode(f[0]);Cn(n,i,l),n[Le]=e,n[Je]=l}catch(g){jt(e,e.return,g)}}var Ro=!1,cn=!1,_c=!1,nh=typeof WeakSet=="function"?WeakSet:Set,pn=null;function Sx(e,n){if(e=e.containerInfo,Kc=Ai,e=hd(e),Cr(e)){if("selectionStart"in e)var l={start:e.selectionStart,end:e.selectionEnd};else e:{l=(l=e.ownerDocument)&&l.defaultView||window;var i=l.getSelection&&l.getSelection();if(i&&i.rangeCount!==0){l=i.anchorNode;var f=i.anchorOffset,g=i.focusNode;i=i.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var C=0,w=-1,P=-1,te=0,ce=0,pe=e,ne=null;t:for(;;){for(var se;pe!==l||f!==0&&pe.nodeType!==3||(w=C+f),pe!==g||i!==0&&pe.nodeType!==3||(P=C+i),pe.nodeType===3&&(C+=pe.nodeValue.length),(se=pe.firstChild)!==null;)ne=pe,pe=se;for(;;){if(pe===e)break t;if(ne===l&&++te===f&&(w=C),ne===g&&++ce===i&&(P=C),(se=pe.nextSibling)!==null)break;pe=ne,ne=pe.parentNode}pe=se}l=w===-1||P===-1?null:{start:w,end:P}}else l=null}l=l||{start:0,end:0}}else l=null;for($c={focusedElem:e,selectionRange:l},Ai=!1,pn=n;pn!==null;)if(n=pn,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,pn=e;else for(;pn!==null;){switch(n=pn,g=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(l=0;l<e.length;l++)f=e[l],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&g!==null){e=void 0,l=n,f=g.memoizedProps,g=g.memoizedState,i=l.stateNode;try{var ze=Rl(l.type,f);e=i.getSnapshotBeforeUpdate(ze,g),i.__reactInternalSnapshotBeforeUpdate=e}catch(Xe){jt(l,l.return,Xe)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,l=e.nodeType,l===9)Qc(e);else if(l===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Qc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(a(163))}if(e=n.sibling,e!==null){e.return=n.return,pn=e;break}pn=n.return}}function oh(e,n,l){var i=l.flags;switch(l.tag){case 0:case 11:case 15:ko(e,l),i&4&&Qs(5,l);break;case 1:if(ko(e,l),i&4)if(e=l.stateNode,n===null)try{e.componentDidMount()}catch(C){jt(l,l.return,C)}else{var f=Rl(l.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(f,n,e.__reactInternalSnapshotBeforeUpdate)}catch(C){jt(l,l.return,C)}}i&64&&Zf(l),i&512&&ea(l,l.return);break;case 3:if(ko(e,l),i&64&&(e=l.updateQueue,e!==null)){if(n=null,l.child!==null)switch(l.child.tag){case 27:case 5:n=l.child.stateNode;break;case 1:n=l.child.stateNode}try{qd(e,n)}catch(C){jt(l,l.return,C)}}break;case 27:n===null&&i&4&&th(l);case 26:case 5:ko(e,l),n===null&&i&4&&Qf(l),i&512&&ea(l,l.return);break;case 12:ko(e,l);break;case 31:ko(e,l),i&4&&ah(e,l);break;case 13:ko(e,l),i&4&&ih(e,l),i&64&&(e=l.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(l=Ix.bind(null,l),Zx(e,l))));break;case 22:if(i=l.memoizedState!==null||Ro,!i){n=n!==null&&n.memoizedState!==null||cn,f=Ro;var g=cn;Ro=i,(cn=n)&&!g?Do(e,l,(l.subtreeFlags&8772)!==0):ko(e,l),Ro=f,cn=g}break;case 30:break;default:ko(e,l)}}function lh(e){var n=e.alternate;n!==null&&(e.alternate=null,lh(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&gn(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Zt=null,In=!1;function Io(e,n,l){for(l=l.child;l!==null;)sh(e,n,l),l=l.sibling}function sh(e,n,l){if(Wt&&typeof Wt.onCommitFiberUnmount=="function")try{Wt.onCommitFiberUnmount(hn,l)}catch{}switch(l.tag){case 26:cn||mo(l,n),Io(e,n,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:cn||mo(l,n);var i=Zt,f=In;al(l.type)&&(Zt=l.stateNode,In=!1),Io(e,n,l),ca(l.stateNode),Zt=i,In=f;break;case 5:cn||mo(l,n);case 6:if(i=Zt,f=In,Zt=null,Io(e,n,l),Zt=i,In=f,Zt!==null)if(In)try{(Zt.nodeType===9?Zt.body:Zt.nodeName==="HTML"?Zt.ownerDocument.body:Zt).removeChild(l.stateNode)}catch(g){jt(l,n,g)}else try{Zt.removeChild(l.stateNode)}catch(g){jt(l,n,g)}break;case 18:Zt!==null&&(In?(e=Zt,Zh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,l.stateNode),hs(e)):Zh(Zt,l.stateNode));break;case 4:i=Zt,f=In,Zt=l.stateNode.containerInfo,In=!0,Io(e,n,l),Zt=i,In=f;break;case 0:case 11:case 14:case 15:Qo(2,l,n),cn||Qo(4,l,n),Io(e,n,l);break;case 1:cn||(mo(l,n),i=l.stateNode,typeof i.componentWillUnmount=="function"&&Wf(l,n,i)),Io(e,n,l);break;case 21:Io(e,n,l);break;case 22:cn=(i=cn)||l.memoizedState!==null,Io(e,n,l),cn=i;break;default:Io(e,n,l)}}function ah(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{hs(e)}catch(l){jt(n,n.return,l)}}}function ih(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{hs(e)}catch(l){jt(n,n.return,l)}}function Ex(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new nh),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new nh),n;default:throw Error(a(435,e.tag))}}function ii(e,n){var l=Ex(e);n.forEach(function(i){if(!l.has(i)){l.add(i);var f=kx.bind(null,e,i);i.then(f,f)}})}function kn(e,n){var l=n.deletions;if(l!==null)for(var i=0;i<l.length;i++){var f=l[i],g=e,C=n,w=C;e:for(;w!==null;){switch(w.tag){case 27:if(al(w.type)){Zt=w.stateNode,In=!1;break e}break;case 5:Zt=w.stateNode,In=!1;break e;case 3:case 4:Zt=w.stateNode.containerInfo,In=!0;break e}w=w.return}if(Zt===null)throw Error(a(160));sh(g,C,f),Zt=null,In=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)rh(n,e),n=n.sibling}var io=null;function rh(e,n){var l=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:kn(n,e),Dn(e),i&4&&(Qo(3,e,e.return),Qs(3,e),Qo(5,e,e.return));break;case 1:kn(n,e),Dn(e),i&512&&(cn||l===null||mo(l,l.return)),i&64&&Ro&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(l=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=l===null?i:l.concat(i))));break;case 26:var f=io;if(kn(n,e),Dn(e),i&512&&(cn||l===null||mo(l,l.return)),i&4){var g=l!==null?l.memoizedState:null;if(i=e.memoizedState,l===null)if(i===null)if(e.stateNode===null){e:{i=e.type,l=e.memoizedProps,f=f.ownerDocument||f;t:switch(i){case"title":g=f.getElementsByTagName("title")[0],(!g||g[_t]||g[Le]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(i),f.head.insertBefore(g,f.querySelector("head > title"))),Cn(g,i,l),g[Le]=e,zt(g),i=g;break e;case"link":var C=rp("link","href",f).get(i+(l.href||""));if(C){for(var w=0;w<C.length;w++)if(g=C[w],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){C.splice(w,1);break t}}g=f.createElement(i),Cn(g,i,l),f.head.appendChild(g);break;case"meta":if(C=rp("meta","content",f).get(i+(l.content||""))){for(w=0;w<C.length;w++)if(g=C[w],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){C.splice(w,1);break t}}g=f.createElement(i),Cn(g,i,l),f.head.appendChild(g);break;default:throw Error(a(468,i))}g[Le]=e,zt(g),i=g}e.stateNode=i}else cp(f,e.type,e.stateNode);else e.stateNode=ip(f,i,e.memoizedProps);else g!==i?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,i===null?cp(f,e.type,e.stateNode):ip(f,i,e.memoizedProps)):i===null&&e.stateNode!==null&&wc(e,e.memoizedProps,l.memoizedProps)}break;case 27:kn(n,e),Dn(e),i&512&&(cn||l===null||mo(l,l.return)),l!==null&&i&4&&wc(e,e.memoizedProps,l.memoizedProps);break;case 5:if(kn(n,e),Dn(e),i&512&&(cn||l===null||mo(l,l.return)),e.flags&32){f=e.stateNode;try{xt(f,"")}catch(ze){jt(e,e.return,ze)}}i&4&&e.stateNode!=null&&(f=e.memoizedProps,wc(e,f,l!==null?l.memoizedProps:f)),i&1024&&(_c=!0);break;case 6:if(kn(n,e),Dn(e),i&4){if(e.stateNode===null)throw Error(a(162));i=e.memoizedProps,l=e.stateNode;try{l.nodeValue=i}catch(ze){jt(e,e.return,ze)}}break;case 3:if(Ei=null,f=io,io=Ci(n.containerInfo),kn(n,e),io=f,Dn(e),i&4&&l!==null&&l.memoizedState.isDehydrated)try{hs(n.containerInfo)}catch(ze){jt(e,e.return,ze)}_c&&(_c=!1,ch(e));break;case 4:i=io,io=Ci(e.stateNode.containerInfo),kn(n,e),Dn(e),io=i;break;case 12:kn(n,e),Dn(e);break;case 31:kn(n,e),Dn(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,ii(e,i)));break;case 13:kn(n,e),Dn(e),e.child.flags&8192&&e.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(ci=$e()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,ii(e,i)));break;case 22:f=e.memoizedState!==null;var P=l!==null&&l.memoizedState!==null,te=Ro,ce=cn;if(Ro=te||f,cn=ce||P,kn(n,e),cn=ce,Ro=te,Dn(e),i&8192)e:for(n=e.stateNode,n._visibility=f?n._visibility&-2:n._visibility|1,f&&(l===null||P||Ro||cn||Il(e)),l=null,n=e;;){if(n.tag===5||n.tag===26){if(l===null){P=l=n;try{if(g=P.stateNode,f)C=g.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{w=P.stateNode;var pe=P.memoizedProps.style,ne=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;w.style.display=ne==null||typeof ne=="boolean"?"":(""+ne).trim()}}catch(ze){jt(P,P.return,ze)}}}else if(n.tag===6){if(l===null){P=n;try{P.stateNode.nodeValue=f?"":P.memoizedProps}catch(ze){jt(P,P.return,ze)}}}else if(n.tag===18){if(l===null){P=n;try{var se=P.stateNode;f?Wh(se,!0):Wh(P.stateNode,!1)}catch(ze){jt(P,P.return,ze)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;l===n&&(l=null),n=n.return}l===n&&(l=null),n.sibling.return=n.return,n=n.sibling}i&4&&(i=e.updateQueue,i!==null&&(l=i.retryQueue,l!==null&&(i.retryQueue=null,ii(e,l))));break;case 19:kn(n,e),Dn(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,ii(e,i)));break;case 30:break;case 21:break;default:kn(n,e),Dn(e)}}function Dn(e){var n=e.flags;if(n&2){try{for(var l,i=e.return;i!==null;){if(eh(i)){l=i;break}i=i.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var f=l.stateNode,g=Nc(e);ai(e,g,f);break;case 5:var C=l.stateNode;l.flags&32&&(xt(C,""),l.flags&=-33);var w=Nc(e);ai(e,w,C);break;case 3:case 4:var P=l.stateNode.containerInfo,te=Nc(e);Ac(e,te,P);break;default:throw Error(a(161))}}catch(ce){jt(e,e.return,ce)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function ch(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;ch(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function ko(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)oh(e,n.alternate,n),n=n.sibling}function Il(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Qo(4,n,n.return),Il(n);break;case 1:mo(n,n.return);var l=n.stateNode;typeof l.componentWillUnmount=="function"&&Wf(n,n.return,l),Il(n);break;case 27:ca(n.stateNode);case 26:case 5:mo(n,n.return),Il(n);break;case 22:n.memoizedState===null&&Il(n);break;case 30:Il(n);break;default:Il(n)}e=e.sibling}}function Do(e,n,l){for(l=l&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var i=n.alternate,f=e,g=n,C=g.flags;switch(g.tag){case 0:case 11:case 15:Do(f,g,l),Qs(4,g);break;case 1:if(Do(f,g,l),i=g,f=i.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(te){jt(i,i.return,te)}if(i=g,f=i.updateQueue,f!==null){var w=i.stateNode;try{var P=f.shared.hiddenCallbacks;if(P!==null)for(f.shared.hiddenCallbacks=null,f=0;f<P.length;f++)Bd(P[f],w)}catch(te){jt(i,i.return,te)}}l&&C&64&&Zf(g),ea(g,g.return);break;case 27:th(g);case 26:case 5:Do(f,g,l),l&&i===null&&C&4&&Qf(g),ea(g,g.return);break;case 12:Do(f,g,l);break;case 31:Do(f,g,l),l&&C&4&&ah(f,g);break;case 13:Do(f,g,l),l&&C&4&&ih(f,g);break;case 22:g.memoizedState===null&&Do(f,g,l),ea(g,g.return);break;case 30:break;default:Do(f,g,l)}n=n.sibling}}function Mc(e,n){var l=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(l=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==l&&(e!=null&&e.refCount++,l!=null&&qs(l))}function Rc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&qs(e))}function ro(e,n,l,i){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)uh(e,n,l,i),n=n.sibling}function uh(e,n,l,i){var f=n.flags;switch(n.tag){case 0:case 11:case 15:ro(e,n,l,i),f&2048&&Qs(9,n);break;case 1:ro(e,n,l,i);break;case 3:ro(e,n,l,i),f&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&qs(e)));break;case 12:if(f&2048){ro(e,n,l,i),e=n.stateNode;try{var g=n.memoizedProps,C=g.id,w=g.onPostCommit;typeof w=="function"&&w(C,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(P){jt(n,n.return,P)}}else ro(e,n,l,i);break;case 31:ro(e,n,l,i);break;case 13:ro(e,n,l,i);break;case 23:break;case 22:g=n.stateNode,C=n.alternate,n.memoizedState!==null?g._visibility&2?ro(e,n,l,i):ta(e,n):g._visibility&2?ro(e,n,l,i):(g._visibility|=2,ns(e,n,l,i,(n.subtreeFlags&10256)!==0||!1)),f&2048&&Mc(C,n);break;case 24:ro(e,n,l,i),f&2048&&Rc(n.alternate,n);break;default:ro(e,n,l,i)}}function ns(e,n,l,i,f){for(f=f&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var g=e,C=n,w=l,P=i,te=C.flags;switch(C.tag){case 0:case 11:case 15:ns(g,C,w,P,f),Qs(8,C);break;case 23:break;case 22:var ce=C.stateNode;C.memoizedState!==null?ce._visibility&2?ns(g,C,w,P,f):ta(g,C):(ce._visibility|=2,ns(g,C,w,P,f)),f&&te&2048&&Mc(C.alternate,C);break;case 24:ns(g,C,w,P,f),f&&te&2048&&Rc(C.alternate,C);break;default:ns(g,C,w,P,f)}n=n.sibling}}function ta(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var l=e,i=n,f=i.flags;switch(i.tag){case 22:ta(l,i),f&2048&&Mc(i.alternate,i);break;case 24:ta(l,i),f&2048&&Rc(i.alternate,i);break;default:ta(l,i)}n=n.sibling}}var na=8192;function os(e,n,l){if(e.subtreeFlags&na)for(e=e.child;e!==null;)dh(e,n,l),e=e.sibling}function dh(e,n,l){switch(e.tag){case 26:os(e,n,l),e.flags&na&&e.memoizedState!==null&&c0(l,io,e.memoizedState,e.memoizedProps);break;case 5:os(e,n,l);break;case 3:case 4:var i=io;io=Ci(e.stateNode.containerInfo),os(e,n,l),io=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=na,na=16777216,os(e,n,l),na=i):os(e,n,l));break;default:os(e,n,l)}}function fh(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function oa(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var i=n[l];pn=i,ph(i,e)}fh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)hh(e),e=e.sibling}function hh(e){switch(e.tag){case 0:case 11:case 15:oa(e),e.flags&2048&&Qo(9,e,e.return);break;case 3:oa(e);break;case 12:oa(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,ri(e)):oa(e);break;default:oa(e)}}function ri(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var i=n[l];pn=i,ph(i,e)}fh(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Qo(8,n,n.return),ri(n);break;case 22:l=n.stateNode,l._visibility&2&&(l._visibility&=-3,ri(n));break;default:ri(n)}e=e.sibling}}function ph(e,n){for(;pn!==null;){var l=pn;switch(l.tag){case 0:case 11:case 15:Qo(8,l,n);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var i=l.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:qs(l.memoizedState.cache)}if(i=l.child,i!==null)i.return=l,pn=i;else e:for(l=e;pn!==null;){i=pn;var f=i.sibling,g=i.return;if(lh(i),i===l){pn=null;break e}if(f!==null){f.return=g,pn=f;break e}pn=g}}}var Tx={getCacheForType:function(e){var n=vn(sn),l=n.data.get(e);return l===void 0&&(l=e(),n.data.set(e,l)),l},cacheSignal:function(){return vn(sn).controller.signal}},wx=typeof WeakMap=="function"?WeakMap:Map,Mt=0,Vt=null,ut=null,ht=0,Lt=0,Vn=null,el=!1,ls=!1,Ic=!1,Lo=0,tn=0,tl=0,kl=0,kc=0,Hn=0,ss=0,la=null,Ln=null,Dc=!1,ci=0,mh=0,ui=1/0,di=null,nl=null,fn=0,ol=null,as=null,jo=0,Lc=0,jc=null,gh=null,sa=0,Uc=null;function On(){return(Mt&2)!==0&&ht!==0?ht&-ht:j.T!==null?Vc():we()}function yh(){if(Hn===0)if((ht&536870912)===0||vt){var e=Ge;Ge<<=1,(Ge&3932160)===0&&(Ge=262144),Hn=e}else Hn=536870912;return e=qn.current,e!==null&&(e.flags|=32),Hn}function jn(e,n,l){(e===Vt&&(Lt===2||Lt===9)||e.cancelPendingCommit!==null)&&(is(e,0),ll(e,ht,Hn,!1)),Te(e,l),((Mt&2)===0||e!==Vt)&&(e===Vt&&((Mt&2)===0&&(kl|=l),tn===4&&ll(e,ht,Hn,!1)),go(e))}function xh(e,n,l){if((Mt&6)!==0)throw Error(a(327));var i=!l&&(n&127)===0&&(n&e.expiredLanes)===0||Oe(e,n),f=i?_x(e,n):Pc(e,n,!0),g=i;do{if(f===0){ls&&!i&&ll(e,n,0,!1);break}else{if(l=e.current.alternate,g&&!Nx(l)){f=Pc(e,n,!1),g=!1;continue}if(f===2){if(g=n,e.errorRecoveryDisabledLanes&g)var C=0;else C=e.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){n=C;e:{var w=e;f=la;var P=w.current.memoizedState.isDehydrated;if(P&&(is(w,C).flags|=256),C=Pc(w,C,!1),C!==2){if(Ic&&!P){w.errorRecoveryDisabledLanes|=g,kl|=g,f=4;break e}g=Ln,Ln=f,g!==null&&(Ln===null?Ln=g:Ln.push.apply(Ln,g))}f=C}if(g=!1,f!==2)continue}}if(f===1){is(e,0),ll(e,n,0,!0);break}e:{switch(i=e,g=f,g){case 0:case 1:throw Error(a(345));case 4:if((n&4194048)!==n)break;case 6:ll(i,n,Hn,!el);break e;case 2:Ln=null;break;case 3:case 5:break;default:throw Error(a(329))}if((n&62914560)===n&&(f=ci+300-$e(),10<f)){if(ll(i,n,Hn,!el),gt(i,0,!0)!==0)break e;jo=n,i.timeoutHandle=Kh(vh.bind(null,i,l,Ln,di,Dc,n,Hn,kl,ss,el,g,"Throttled",-0,0),f);break e}vh(i,l,Ln,di,Dc,n,Hn,kl,ss,el,g,null,-0,0)}}break}while(!0);go(e)}function vh(e,n,l,i,f,g,C,w,P,te,ce,pe,ne,se){if(e.timeoutHandle=-1,pe=n.subtreeFlags,pe&8192||(pe&16785408)===16785408){pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:dn},dh(n,g,pe);var ze=(g&62914560)===g?ci-$e():(g&4194048)===g?mh-$e():0;if(ze=u0(pe,ze),ze!==null){jo=g,e.cancelPendingCommit=ze(Ah.bind(null,e,n,g,l,i,f,C,w,P,ce,pe,null,ne,se)),ll(e,g,C,!te);return}}Ah(e,n,g,l,i,f,C,w,P)}function Nx(e){for(var n=e;;){var l=n.tag;if((l===0||l===11||l===15)&&n.flags&16384&&(l=n.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var i=0;i<l.length;i++){var f=l[i],g=f.getSnapshot;f=f.value;try{if(!Pn(g(),f))return!1}catch{return!1}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function ll(e,n,l,i){n&=~kc,n&=~kl,e.suspendedLanes|=n,e.pingedLanes&=~n,i&&(e.warmLanes|=n),i=e.expirationTimes;for(var f=n;0<f;){var g=31-At(f),C=1<<g;i[g]=-1,f&=~C}l!==0&&Ie(e,l,n)}function fi(){return(Mt&6)===0?(aa(0),!1):!0}function zc(){if(ut!==null){if(Lt===0)var e=ut.return;else e=ut,To=El=null,Qr(e),Zl=null,Vs=0,e=ut;for(;e!==null;)$f(e.alternate,e),e=e.return;ut=null}}function is(e,n){var l=e.timeoutHandle;l!==-1&&(e.timeoutHandle=-1,Yx(l)),l=e.cancelPendingCommit,l!==null&&(e.cancelPendingCommit=null,l()),jo=0,zc(),Vt=e,ut=l=So(e.current,null),ht=n,Lt=0,Vn=null,el=!1,ls=Oe(e,n),Ic=!1,ss=Hn=kc=kl=tl=tn=0,Ln=la=null,Dc=!1,(n&8)!==0&&(n|=n&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=n;0<i;){var f=31-At(i),g=1<<f;n|=e[f],i&=~g}return Lo=n,Da(),l}function bh(e,n){et=null,j.H=$s,n===$l||n===Ga?(n=jd(),Lt=3):n===Gr?(n=jd(),Lt=4):Lt=n===mc?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Vn=n,ut===null&&(tn=1,ti(e,Zn(n,e.current)))}function Ch(){var e=qn.current;return e===null?!0:(ht&4194048)===ht?to===null:(ht&62914560)===ht||(ht&536870912)!==0?e===to:!1}function Sh(){var e=j.H;return j.H=$s,e===null?$s:e}function Eh(){var e=j.A;return j.A=Tx,e}function hi(){tn=4,el||(ht&4194048)!==ht&&qn.current!==null||(ls=!0),(tl&134217727)===0&&(kl&134217727)===0||Vt===null||ll(Vt,ht,Hn,!1)}function Pc(e,n,l){var i=Mt;Mt|=2;var f=Sh(),g=Eh();(Vt!==e||ht!==n)&&(di=null,is(e,n)),n=!1;var C=tn;e:do try{if(Lt!==0&&ut!==null){var w=ut,P=Vn;switch(Lt){case 8:zc(),C=6;break e;case 3:case 2:case 9:case 6:qn.current===null&&(n=!0);var te=Lt;if(Lt=0,Vn=null,rs(e,w,P,te),l&&ls){C=0;break e}break;default:te=Lt,Lt=0,Vn=null,rs(e,w,P,te)}}Ax(),C=tn;break}catch(ce){bh(e,ce)}while(!0);return n&&e.shellSuspendCounter++,To=El=null,Mt=i,j.H=f,j.A=g,ut===null&&(Vt=null,ht=0,Da()),C}function Ax(){for(;ut!==null;)Th(ut)}function _x(e,n){var l=Mt;Mt|=2;var i=Sh(),f=Eh();Vt!==e||ht!==n?(di=null,ui=$e()+500,is(e,n)):ls=Oe(e,n);e:do try{if(Lt!==0&&ut!==null){n=ut;var g=Vn;t:switch(Lt){case 1:Lt=0,Vn=null,rs(e,n,g,1);break;case 2:case 9:if(Dd(g)){Lt=0,Vn=null,wh(n);break}n=function(){Lt!==2&&Lt!==9||Vt!==e||(Lt=7),go(e)},g.then(n,n);break e;case 3:Lt=7;break e;case 4:Lt=5;break e;case 7:Dd(g)?(Lt=0,Vn=null,wh(n)):(Lt=0,Vn=null,rs(e,n,g,7));break;case 5:var C=null;switch(ut.tag){case 26:C=ut.memoizedState;case 5:case 27:var w=ut;if(C?up(C):w.stateNode.complete){Lt=0,Vn=null;var P=w.sibling;if(P!==null)ut=P;else{var te=w.return;te!==null?(ut=te,pi(te)):ut=null}break t}}Lt=0,Vn=null,rs(e,n,g,5);break;case 6:Lt=0,Vn=null,rs(e,n,g,6);break;case 8:zc(),tn=6;break e;default:throw Error(a(462))}}Mx();break}catch(ce){bh(e,ce)}while(!0);return To=El=null,j.H=i,j.A=f,Mt=l,ut!==null?0:(Vt=null,ht=0,Da(),tn)}function Mx(){for(;ut!==null&&!Ze();)Th(ut)}function Th(e){var n=Xf(e.alternate,e,Lo);e.memoizedProps=e.pendingProps,n===null?pi(e):ut=n}function wh(e){var n=e,l=n.alternate;switch(n.tag){case 15:case 0:n=Vf(l,n,n.pendingProps,n.type,void 0,ht);break;case 11:n=Vf(l,n,n.pendingProps,n.type.render,n.ref,ht);break;case 5:Qr(n);default:$f(l,n),n=ut=Sd(n,Lo),n=Xf(l,n,Lo)}e.memoizedProps=e.pendingProps,n===null?pi(e):ut=n}function rs(e,n,l,i){To=El=null,Qr(n),Zl=null,Vs=0;var f=n.return;try{if(yx(e,f,n,l,ht)){tn=1,ti(e,Zn(l,e.current)),ut=null;return}}catch(g){if(f!==null)throw ut=f,g;tn=1,ti(e,Zn(l,e.current)),ut=null;return}n.flags&32768?(vt||i===1?e=!0:ls||(ht&536870912)!==0?e=!1:(el=e=!0,(i===2||i===9||i===3||i===6)&&(i=qn.current,i!==null&&i.tag===13&&(i.flags|=16384))),Nh(n,e)):pi(n)}function pi(e){var n=e;do{if((n.flags&32768)!==0){Nh(n,el);return}e=n.return;var l=bx(n.alternate,n,Lo);if(l!==null){ut=l;return}if(n=n.sibling,n!==null){ut=n;return}ut=n=e}while(n!==null);tn===0&&(tn=5)}function Nh(e,n){do{var l=Cx(e.alternate,e);if(l!==null){l.flags&=32767,ut=l;return}if(l=e.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!n&&(e=e.sibling,e!==null)){ut=e;return}ut=e=l}while(e!==null);tn=6,ut=null}function Ah(e,n,l,i,f,g,C,w,P){e.cancelPendingCommit=null;do mi();while(fn!==0);if((Mt&6)!==0)throw Error(a(327));if(n!==null){if(n===e.current)throw Error(a(177));if(g=n.lanes|n.childLanes,g|=Nr,Ce(e,l,g,C,w,P),e===Vt&&(ut=Vt=null,ht=0),as=n,ol=e,jo=l,Lc=g,jc=f,gh=i,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Dx(Ut,function(){return kh(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||i){i=j.T,j.T=null,f=z.p,z.p=2,C=Mt,Mt|=4;try{Sx(e,n,l)}finally{Mt=C,z.p=f,j.T=i}}fn=1,_h(),Mh(),Rh()}}function _h(){if(fn===1){fn=0;var e=ol,n=as,l=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||l){l=j.T,j.T=null;var i=z.p;z.p=2;var f=Mt;Mt|=4;try{rh(n,e);var g=$c,C=hd(e.containerInfo),w=g.focusedElem,P=g.selectionRange;if(C!==w&&w&&w.ownerDocument&&fd(w.ownerDocument.documentElement,w)){if(P!==null&&Cr(w)){var te=P.start,ce=P.end;if(ce===void 0&&(ce=te),"selectionStart"in w)w.selectionStart=te,w.selectionEnd=Math.min(ce,w.value.length);else{var pe=w.ownerDocument||document,ne=pe&&pe.defaultView||window;if(ne.getSelection){var se=ne.getSelection(),ze=w.textContent.length,Xe=Math.min(P.start,ze),qt=P.end===void 0?Xe:Math.min(P.end,ze);!se.extend&&Xe>qt&&(C=qt,qt=Xe,Xe=C);var Q=dd(w,Xe),J=dd(w,qt);if(Q&&J&&(se.rangeCount!==1||se.anchorNode!==Q.node||se.anchorOffset!==Q.offset||se.focusNode!==J.node||se.focusOffset!==J.offset)){var ee=pe.createRange();ee.setStart(Q.node,Q.offset),se.removeAllRanges(),Xe>qt?(se.addRange(ee),se.extend(J.node,J.offset)):(ee.setEnd(J.node,J.offset),se.addRange(ee))}}}}for(pe=[],se=w;se=se.parentNode;)se.nodeType===1&&pe.push({element:se,left:se.scrollLeft,top:se.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<pe.length;w++){var de=pe[w];de.element.scrollLeft=de.left,de.element.scrollTop=de.top}}Ai=!!Kc,$c=Kc=null}finally{Mt=f,z.p=i,j.T=l}}e.current=n,fn=2}}function Mh(){if(fn===2){fn=0;var e=ol,n=as,l=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||l){l=j.T,j.T=null;var i=z.p;z.p=2;var f=Mt;Mt|=4;try{oh(e,n.alternate,n)}finally{Mt=f,z.p=i,j.T=l}}fn=3}}function Rh(){if(fn===4||fn===3){fn=0,It();var e=ol,n=as,l=jo,i=gh;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?fn=5:(fn=0,as=ol=null,Ih(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(nl=null),xe(l),n=n.stateNode,Wt&&typeof Wt.onCommitFiberRoot=="function")try{Wt.onCommitFiberRoot(hn,n,void 0,(n.current.flags&128)===128)}catch{}if(i!==null){n=j.T,f=z.p,z.p=2,j.T=null;try{for(var g=e.onRecoverableError,C=0;C<i.length;C++){var w=i[C];g(w.value,{componentStack:w.stack})}}finally{j.T=n,z.p=f}}(jo&3)!==0&&mi(),go(e),f=e.pendingLanes,(l&261930)!==0&&(f&42)!==0?e===Uc?sa++:(sa=0,Uc=e):sa=0,aa(0)}}function Ih(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,qs(n)))}function mi(){return _h(),Mh(),Rh(),kh()}function kh(){if(fn!==5)return!1;var e=ol,n=Lc;Lc=0;var l=xe(jo),i=j.T,f=z.p;try{z.p=32>l?32:l,j.T=null,l=jc,jc=null;var g=ol,C=jo;if(fn=0,as=ol=null,jo=0,(Mt&6)!==0)throw Error(a(331));var w=Mt;if(Mt|=4,hh(g.current),uh(g,g.current,C,l),Mt=w,aa(0,!1),Wt&&typeof Wt.onPostCommitFiberRoot=="function")try{Wt.onPostCommitFiberRoot(hn,g)}catch{}return!0}finally{z.p=f,j.T=i,Ih(e,n)}}function Dh(e,n,l){n=Zn(l,n),n=pc(e.stateNode,n,2),e=$o(e,n,2),e!==null&&(Te(e,2),go(e))}function jt(e,n,l){if(e.tag===3)Dh(e,e,l);else for(;n!==null;){if(n.tag===3){Dh(n,e,l);break}else if(n.tag===1){var i=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(nl===null||!nl.has(i))){e=Zn(l,e),l=Lf(2),i=$o(n,l,2),i!==null&&(jf(l,i,n,e),Te(i,2),go(i));break}}n=n.return}}function Bc(e,n,l){var i=e.pingCache;if(i===null){i=e.pingCache=new wx;var f=new Set;i.set(n,f)}else f=i.get(n),f===void 0&&(f=new Set,i.set(n,f));f.has(l)||(Ic=!0,f.add(l),e=Rx.bind(null,e,n,l),n.then(e,e))}function Rx(e,n,l){var i=e.pingCache;i!==null&&i.delete(n),e.pingedLanes|=e.suspendedLanes&l,e.warmLanes&=~l,Vt===e&&(ht&l)===l&&(tn===4||tn===3&&(ht&62914560)===ht&&300>$e()-ci?(Mt&2)===0&&is(e,0):kc|=l,ss===ht&&(ss=0)),go(e)}function Lh(e,n){n===0&&(n=at()),e=bl(e,n),e!==null&&(Te(e,n),go(e))}function Ix(e){var n=e.memoizedState,l=0;n!==null&&(l=n.retryLane),Lh(e,l)}function kx(e,n){var l=0;switch(e.tag){case 31:case 13:var i=e.stateNode,f=e.memoizedState;f!==null&&(l=f.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(a(314))}i!==null&&i.delete(n),Lh(e,l)}function Dx(e,n){return rt(e,n)}var gi=null,cs=null,qc=!1,yi=!1,Gc=!1,sl=0;function go(e){e!==cs&&e.next===null&&(cs===null?gi=cs=e:cs=cs.next=e),yi=!0,qc||(qc=!0,jx())}function aa(e,n){if(!Gc&&yi){Gc=!0;do for(var l=!1,i=gi;i!==null;){if(e!==0){var f=i.pendingLanes;if(f===0)var g=0;else{var C=i.suspendedLanes,w=i.pingedLanes;g=(1<<31-At(42|e)+1)-1,g&=f&~(C&~w),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,Ph(i,g))}else g=ht,g=gt(i,i===Vt?g:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(g&3)===0||Oe(i,g)||(l=!0,Ph(i,g));i=i.next}while(l);Gc=!1}}function Lx(){jh()}function jh(){yi=qc=!1;var e=0;sl!==0&&Fx()&&(e=sl);for(var n=$e(),l=null,i=gi;i!==null;){var f=i.next,g=Uh(i,n);g===0?(i.next=null,l===null?gi=f:l.next=f,f===null&&(cs=l)):(l=i,(e!==0||(g&3)!==0)&&(yi=!0)),i=f}fn!==0&&fn!==5||aa(e),sl!==0&&(sl=0)}function Uh(e,n){for(var l=e.suspendedLanes,i=e.pingedLanes,f=e.expirationTimes,g=e.pendingLanes&-62914561;0<g;){var C=31-At(g),w=1<<C,P=f[C];P===-1?((w&l)===0||(w&i)!==0)&&(f[C]=Ye(w,n)):P<=n&&(e.expiredLanes|=w),g&=~w}if(n=Vt,l=ht,l=gt(e,e===n?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,l===0||e===n&&(Lt===2||Lt===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&Ht(i),e.callbackNode=null,e.callbackPriority=0;if((l&3)===0||Oe(e,l)){if(n=l&-l,n===e.callbackPriority)return n;switch(i!==null&&Ht(i),xe(l)){case 2:case 8:l=We;break;case 32:l=Ut;break;case 268435456:l=un;break;default:l=Ut}return i=zh.bind(null,e),l=rt(l,i),e.callbackPriority=n,e.callbackNode=l,n}return i!==null&&i!==null&&Ht(i),e.callbackPriority=2,e.callbackNode=null,2}function zh(e,n){if(fn!==0&&fn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var l=e.callbackNode;if(mi()&&e.callbackNode!==l)return null;var i=ht;return i=gt(e,e===Vt?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(xh(e,i,n),Uh(e,$e()),e.callbackNode!=null&&e.callbackNode===l?zh.bind(null,e):null)}function Ph(e,n){if(mi())return null;xh(e,n,!0)}function jx(){Jx(function(){(Mt&6)!==0?rt(Ue,Lx):jh()})}function Vc(){if(sl===0){var e=Xl;e===0&&(e=_e,_e<<=1,(_e&261888)===0&&(_e=256)),sl=e}return sl}function Bh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ul(""+e)}function qh(e,n){var l=n.ownerDocument.createElement("input");return l.name=n.name,l.value=n.value,e.id&&l.setAttribute("form",e.id),n.parentNode.insertBefore(l,n),e=new FormData(e),l.parentNode.removeChild(l),e}function Ux(e,n,l,i,f){if(n==="submit"&&l&&l.stateNode===f){var g=Bh((f[Je]||null).action),C=i.submitter;C&&(n=(n=C[Je]||null)?Bh(n.formAction):C.getAttribute("formAction"),n!==null&&(g=n,C=null));var w=new Ma("action","action",null,i,f);e.push({event:w,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(sl!==0){var P=C?qh(f,C):new FormData(f);rc(l,{pending:!0,data:P,method:f.method,action:g},null,P)}}else typeof g=="function"&&(w.preventDefault(),P=C?qh(f,C):new FormData(f),rc(l,{pending:!0,data:P,method:f.method,action:g},g,P))},currentTarget:f}]})}}for(var Hc=0;Hc<wr.length;Hc++){var Oc=wr[Hc],zx=Oc.toLowerCase(),Px=Oc[0].toUpperCase()+Oc.slice(1);ao(zx,"on"+Px)}ao(gd,"onAnimationEnd"),ao(yd,"onAnimationIteration"),ao(xd,"onAnimationStart"),ao("dblclick","onDoubleClick"),ao("focusin","onFocus"),ao("focusout","onBlur"),ao(ex,"onTransitionRun"),ao(tx,"onTransitionStart"),ao(nx,"onTransitionCancel"),ao(vd,"onTransitionEnd"),kt("onMouseEnter",["mouseout","mouseover"]),kt("onMouseLeave",["mouseout","mouseover"]),kt("onPointerEnter",["pointerout","pointerover"]),kt("onPointerLeave",["pointerout","pointerover"]),Un("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Un("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Un("onBeforeInput",["compositionend","keypress","textInput","paste"]),Un("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Un("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Un("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ia="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ia));function Gh(e,n){n=(n&4)!==0;for(var l=0;l<e.length;l++){var i=e[l],f=i.event;i=i.listeners;e:{var g=void 0;if(n)for(var C=i.length-1;0<=C;C--){var w=i[C],P=w.instance,te=w.currentTarget;if(w=w.listener,P!==g&&f.isPropagationStopped())break e;g=w,f.currentTarget=te;try{g(f)}catch(ce){ka(ce)}f.currentTarget=null,g=P}else for(C=0;C<i.length;C++){if(w=i[C],P=w.instance,te=w.currentTarget,w=w.listener,P!==g&&f.isPropagationStopped())break e;g=w,f.currentTarget=te;try{g(f)}catch(ce){ka(ce)}f.currentTarget=null,g=P}}}}function dt(e,n){var l=n[St];l===void 0&&(l=n[St]=new Set);var i=e+"__bubble";l.has(i)||(Vh(n,e,2,!1),l.add(i))}function Fc(e,n,l){var i=0;n&&(i|=4),Vh(l,e,i,n)}var xi="_reactListening"+Math.random().toString(36).slice(2);function Yc(e){if(!e[xi]){e[xi]=!0,Xn.forEach(function(l){l!=="selectionchange"&&(Bx.has(l)||Fc(l,!1,e),Fc(l,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[xi]||(n[xi]=!0,Fc("selectionchange",!1,n))}}function Vh(e,n,l,i){switch(yp(n)){case 2:var f=h0;break;case 8:f=p0;break;default:f=iu}l=f.bind(null,n,l,e),f=void 0,!fr||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),i?f!==void 0?e.addEventListener(n,l,{capture:!0,passive:f}):e.addEventListener(n,l,!0):f!==void 0?e.addEventListener(n,l,{passive:f}):e.addEventListener(n,l,!1)}function Jc(e,n,l,i,f){var g=i;if((n&1)===0&&(n&2)===0&&i!==null)e:for(;;){if(i===null)return;var C=i.tag;if(C===3||C===4){var w=i.stateNode.containerInfo;if(w===f)break;if(C===4)for(C=i.return;C!==null;){var P=C.tag;if((P===3||P===4)&&C.stateNode.containerInfo===f)return;C=C.return}for(;w!==null;){if(C=Sn(w),C===null)return;if(P=C.tag,P===5||P===6||P===26||P===27){i=g=C;continue e}w=w.parentNode}}i=i.return}Yu(function(){var te=g,ce=ur(l),pe=[];e:{var ne=bd.get(e);if(ne!==void 0){var se=Ma,ze=e;switch(e){case"keypress":if(Aa(l)===0)break e;case"keydown":case"keyup":se=ky;break;case"focusin":ze="focus",se=gr;break;case"focusout":ze="blur",se=gr;break;case"beforeblur":case"afterblur":se=gr;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=by;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=jy;break;case gd:case yd:case xd:se=Ey;break;case vd:se=zy;break;case"scroll":case"scrollend":se=xy;break;case"wheel":se=By;break;case"copy":case"cut":case"paste":se=wy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=Zu;break;case"toggle":case"beforetoggle":se=Gy}var Xe=(n&4)!==0,qt=!Xe&&(e==="scroll"||e==="scrollend"),Q=Xe?ne!==null?ne+"Capture":null:ne;Xe=[];for(var J=te,ee;J!==null;){var de=J;if(ee=de.stateNode,de=de.tag,de!==5&&de!==26&&de!==27||ee===null||Q===null||(de=Ms(J,Q),de!=null&&Xe.push(ra(J,de,ee))),qt)break;J=J.return}0<Xe.length&&(ne=new se(ne,ze,null,l,ce),pe.push({event:ne,listeners:Xe}))}}if((n&7)===0){e:{if(ne=e==="mouseover"||e==="pointerover",se=e==="mouseout"||e==="pointerout",ne&&l!==cr&&(ze=l.relatedTarget||l.fromElement)&&(Sn(ze)||ze[nt]))break e;if((se||ne)&&(ne=ce.window===ce?ce:(ne=ce.ownerDocument)?ne.defaultView||ne.parentWindow:window,se?(ze=l.relatedTarget||l.toElement,se=te,ze=ze?Sn(ze):null,ze!==null&&(qt=u(ze),Xe=ze.tag,ze!==qt||Xe!==5&&Xe!==27&&Xe!==6)&&(ze=null)):(se=null,ze=te),se!==ze)){if(Xe=Ku,de="onMouseLeave",Q="onMouseEnter",J="mouse",(e==="pointerout"||e==="pointerover")&&(Xe=Zu,de="onPointerLeave",Q="onPointerEnter",J="pointer"),qt=se==null?ne:Jn(se),ee=ze==null?ne:Jn(ze),ne=new Xe(de,J+"leave",se,l,ce),ne.target=qt,ne.relatedTarget=ee,de=null,Sn(ce)===te&&(Xe=new Xe(Q,J+"enter",ze,l,ce),Xe.target=ee,Xe.relatedTarget=qt,de=Xe),qt=de,se&&ze)t:{for(Xe=qx,Q=se,J=ze,ee=0,de=Q;de;de=Xe(de))ee++;de=0;for(var He=J;He;He=Xe(He))de++;for(;0<ee-de;)Q=Xe(Q),ee--;for(;0<de-ee;)J=Xe(J),de--;for(;ee--;){if(Q===J||J!==null&&Q===J.alternate){Xe=Q;break t}Q=Xe(Q),J=Xe(J)}Xe=null}else Xe=null;se!==null&&Hh(pe,ne,se,Xe,!1),ze!==null&&qt!==null&&Hh(pe,qt,ze,Xe,!0)}}e:{if(ne=te?Jn(te):window,se=ne.nodeName&&ne.nodeName.toLowerCase(),se==="select"||se==="input"&&ne.type==="file")var Tt=sd;else if(od(ne))if(ad)Tt=Zy;else{Tt=Ky;var Be=Xy}else se=ne.nodeName,!se||se.toLowerCase()!=="input"||ne.type!=="checkbox"&&ne.type!=="radio"?te&&fo(te.elementType)&&(Tt=sd):Tt=$y;if(Tt&&(Tt=Tt(e,te))){ld(pe,Tt,l,ce);break e}Be&&Be(e,ne,te),e==="focusout"&&te&&ne.type==="number"&&te.memoizedProps.value!=null&&As(ne,"number",ne.value)}switch(Be=te?Jn(te):window,e){case"focusin":(od(Be)||Be.contentEditable==="true")&&(ql=Be,Sr=te,zs=null);break;case"focusout":zs=Sr=ql=null;break;case"mousedown":Er=!0;break;case"contextmenu":case"mouseup":case"dragend":Er=!1,pd(pe,l,ce);break;case"selectionchange":if(Qy)break;case"keydown":case"keyup":pd(pe,l,ce)}var lt;if(xr)e:{switch(e){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else Bl?td(e,l)&&(pt="onCompositionEnd"):e==="keydown"&&l.keyCode===229&&(pt="onCompositionStart");pt&&(Wu&&l.locale!=="ko"&&(Bl||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&Bl&&(lt=Ju()):(Ho=ce,hr="value"in Ho?Ho.value:Ho.textContent,Bl=!0)),Be=vi(te,pt),0<Be.length&&(pt=new $u(pt,e,null,l,ce),pe.push({event:pt,listeners:Be}),lt?pt.data=lt:(lt=nd(l),lt!==null&&(pt.data=lt)))),(lt=Hy?Oy(e,l):Fy(e,l))&&(pt=vi(te,"onBeforeInput"),0<pt.length&&(Be=new $u("onBeforeInput","beforeinput",null,l,ce),pe.push({event:Be,listeners:pt}),Be.data=lt)),Ux(pe,e,te,l,ce)}Gh(pe,n)})}function ra(e,n,l){return{instance:e,listener:n,currentTarget:l}}function vi(e,n){for(var l=n+"Capture",i=[];e!==null;){var f=e,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=Ms(e,l),f!=null&&i.unshift(ra(e,f,g)),f=Ms(e,n),f!=null&&i.push(ra(e,f,g))),e.tag===3)return i;e=e.return}return[]}function qx(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Hh(e,n,l,i,f){for(var g=n._reactName,C=[];l!==null&&l!==i;){var w=l,P=w.alternate,te=w.stateNode;if(w=w.tag,P!==null&&P===i)break;w!==5&&w!==26&&w!==27||te===null||(P=te,f?(te=Ms(l,g),te!=null&&C.unshift(ra(l,te,P))):f||(te=Ms(l,g),te!=null&&C.push(ra(l,te,P)))),l=l.return}C.length!==0&&e.push({event:n,listeners:C})}var Gx=/\r\n?/g,Vx=/\u0000|\uFFFD/g;function Oh(e){return(typeof e=="string"?e:""+e).replace(Gx,`
`).replace(Vx,"")}function Fh(e,n){return n=Oh(n),Oh(e)===n}function Bt(e,n,l,i,f,g){switch(l){case"children":typeof i=="string"?n==="body"||n==="textarea"&&i===""||xt(e,i):(typeof i=="number"||typeof i=="bigint")&&n!=="body"&&xt(e,""+i);break;case"className":Vo(e,"class",i);break;case"tabIndex":Vo(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":Vo(e,l,i);break;case"style":Kn(e,i,g);break;case"data":if(n!=="object"){Vo(e,"data",i);break}case"src":case"href":if(i===""&&(n!=="a"||l!=="href")){e.removeAttribute(l);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(l);break}i=Ul(""+i),e.setAttribute(l,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(n!=="input"&&Bt(e,n,"name",f.name,f,null),Bt(e,n,"formEncType",f.formEncType,f,null),Bt(e,n,"formMethod",f.formMethod,f,null),Bt(e,n,"formTarget",f.formTarget,f,null)):(Bt(e,n,"encType",f.encType,f,null),Bt(e,n,"method",f.method,f,null),Bt(e,n,"target",f.target,f,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(l);break}i=Ul(""+i),e.setAttribute(l,i);break;case"onClick":i!=null&&(e.onclick=dn);break;case"onScroll":i!=null&&dt("scroll",e);break;case"onScrollEnd":i!=null&&dt("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(a(61));if(l=i.__html,l!=null){if(f.children!=null)throw Error(a(60));e.innerHTML=l}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}l=Ul(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(l,""+i):e.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(l,""):e.removeAttribute(l);break;case"capture":case"download":i===!0?e.setAttribute(l,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(l,i):e.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(l,i):e.removeAttribute(l);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(l):e.setAttribute(l,i);break;case"popover":dt("beforetoggle",e),dt("toggle",e),Go(e,"popover",i);break;case"xlinkActuate":Mn(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Mn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Mn(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Mn(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Mn(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Mn(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Mn(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Mn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Mn(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Go(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=rr.get(l)||l,Go(e,l,i))}}function Xc(e,n,l,i,f,g){switch(l){case"style":Kn(e,i,g);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(a(61));if(l=i.__html,l!=null){if(f.children!=null)throw Error(a(60));e.innerHTML=l}}break;case"children":typeof i=="string"?xt(e,i):(typeof i=="number"||typeof i=="bigint")&&xt(e,""+i);break;case"onScroll":i!=null&&dt("scroll",e);break;case"onScrollEnd":i!=null&&dt("scrollend",e);break;case"onClick":i!=null&&(e.onclick=dn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qo.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(f=l.endsWith("Capture"),n=l.slice(2,f?l.length-7:void 0),g=e[Je]||null,g=g!=null?g[l]:null,typeof g=="function"&&e.removeEventListener(n,g,f),typeof i=="function")){typeof g!="function"&&g!==null&&(l in e?e[l]=null:e.hasAttribute(l)&&e.removeAttribute(l)),e.addEventListener(n,i,f);break e}l in e?e[l]=i:i===!0?e.setAttribute(l,""):Go(e,l,i)}}}function Cn(e,n,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":dt("error",e),dt("load",e);var i=!1,f=!1,g;for(g in l)if(l.hasOwnProperty(g)){var C=l[g];if(C!=null)switch(g){case"src":i=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,n));default:Bt(e,n,g,C,l,null)}}f&&Bt(e,n,"srcSet",l.srcSet,l,null),i&&Bt(e,n,"src",l.src,l,null);return;case"input":dt("invalid",e);var w=g=C=f=null,P=null,te=null;for(i in l)if(l.hasOwnProperty(i)){var ce=l[i];if(ce!=null)switch(i){case"name":f=ce;break;case"type":C=ce;break;case"checked":P=ce;break;case"defaultChecked":te=ce;break;case"value":g=ce;break;case"defaultValue":w=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(a(137,n));break;default:Bt(e,n,i,ce,l,null)}}wa(e,g,w,P,te,C,f,!1);return;case"select":dt("invalid",e),i=C=g=null;for(f in l)if(l.hasOwnProperty(f)&&(w=l[f],w!=null))switch(f){case"value":g=w;break;case"defaultValue":C=w;break;case"multiple":i=w;default:Bt(e,n,f,w,l,null)}n=g,l=C,e.multiple=!!i,n!=null?fe(e,!!i,n,!1):l!=null&&fe(e,!!i,l,!0);return;case"textarea":dt("invalid",e),g=f=i=null;for(C in l)if(l.hasOwnProperty(C)&&(w=l[C],w!=null))switch(C){case"value":i=w;break;case"defaultValue":f=w;break;case"children":g=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(a(91));break;default:Bt(e,n,C,w,l,null)}ie(e,i,f,g);return;case"option":for(P in l)if(l.hasOwnProperty(P)&&(i=l[P],i!=null))switch(P){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Bt(e,n,P,i,l,null)}return;case"dialog":dt("beforetoggle",e),dt("toggle",e),dt("cancel",e),dt("close",e);break;case"iframe":case"object":dt("load",e);break;case"video":case"audio":for(i=0;i<ia.length;i++)dt(ia[i],e);break;case"image":dt("error",e),dt("load",e);break;case"details":dt("toggle",e);break;case"embed":case"source":case"link":dt("error",e),dt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in l)if(l.hasOwnProperty(te)&&(i=l[te],i!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,n));default:Bt(e,n,te,i,l,null)}return;default:if(fo(n)){for(ce in l)l.hasOwnProperty(ce)&&(i=l[ce],i!==void 0&&Xc(e,n,ce,i,l,void 0));return}}for(w in l)l.hasOwnProperty(w)&&(i=l[w],i!=null&&Bt(e,n,w,i,l,null))}function Hx(e,n,l,i){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,C=null,w=null,P=null,te=null,ce=null;for(se in l){var pe=l[se];if(l.hasOwnProperty(se)&&pe!=null)switch(se){case"checked":break;case"value":break;case"defaultValue":P=pe;default:i.hasOwnProperty(se)||Bt(e,n,se,null,i,pe)}}for(var ne in i){var se=i[ne];if(pe=l[ne],i.hasOwnProperty(ne)&&(se!=null||pe!=null))switch(ne){case"type":g=se;break;case"name":f=se;break;case"checked":te=se;break;case"defaultChecked":ce=se;break;case"value":C=se;break;case"defaultValue":w=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(a(137,n));break;default:se!==pe&&Bt(e,n,ne,se,i,pe)}}yn(e,C,w,P,te,ce,g,f);return;case"select":se=C=w=ne=null;for(g in l)if(P=l[g],l.hasOwnProperty(g)&&P!=null)switch(g){case"value":break;case"multiple":se=P;default:i.hasOwnProperty(g)||Bt(e,n,g,null,i,P)}for(f in i)if(g=i[f],P=l[f],i.hasOwnProperty(f)&&(g!=null||P!=null))switch(f){case"value":ne=g;break;case"defaultValue":w=g;break;case"multiple":C=g;default:g!==P&&Bt(e,n,f,g,i,P)}n=w,l=C,i=se,ne!=null?fe(e,!!l,ne,!1):!!i!=!!l&&(n!=null?fe(e,!!l,n,!0):fe(e,!!l,l?[]:"",!1));return;case"textarea":se=ne=null;for(w in l)if(f=l[w],l.hasOwnProperty(w)&&f!=null&&!i.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:Bt(e,n,w,null,i,f)}for(C in i)if(f=i[C],g=l[C],i.hasOwnProperty(C)&&(f!=null||g!=null))switch(C){case"value":ne=f;break;case"defaultValue":se=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==g&&Bt(e,n,C,f,i,g)}q(e,ne,se);return;case"option":for(var ze in l)if(ne=l[ze],l.hasOwnProperty(ze)&&ne!=null&&!i.hasOwnProperty(ze))switch(ze){case"selected":e.selected=!1;break;default:Bt(e,n,ze,null,i,ne)}for(P in i)if(ne=i[P],se=l[P],i.hasOwnProperty(P)&&ne!==se&&(ne!=null||se!=null))switch(P){case"selected":e.selected=ne&&typeof ne!="function"&&typeof ne!="symbol";break;default:Bt(e,n,P,ne,i,se)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in l)ne=l[Xe],l.hasOwnProperty(Xe)&&ne!=null&&!i.hasOwnProperty(Xe)&&Bt(e,n,Xe,null,i,ne);for(te in i)if(ne=i[te],se=l[te],i.hasOwnProperty(te)&&ne!==se&&(ne!=null||se!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(a(137,n));break;default:Bt(e,n,te,ne,i,se)}return;default:if(fo(n)){for(var qt in l)ne=l[qt],l.hasOwnProperty(qt)&&ne!==void 0&&!i.hasOwnProperty(qt)&&Xc(e,n,qt,void 0,i,ne);for(ce in i)ne=i[ce],se=l[ce],!i.hasOwnProperty(ce)||ne===se||ne===void 0&&se===void 0||Xc(e,n,ce,ne,i,se);return}}for(var Q in l)ne=l[Q],l.hasOwnProperty(Q)&&ne!=null&&!i.hasOwnProperty(Q)&&Bt(e,n,Q,null,i,ne);for(pe in i)ne=i[pe],se=l[pe],!i.hasOwnProperty(pe)||ne===se||ne==null&&se==null||Bt(e,n,pe,ne,i,se)}function Yh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Ox(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,l=performance.getEntriesByType("resource"),i=0;i<l.length;i++){var f=l[i],g=f.transferSize,C=f.initiatorType,w=f.duration;if(g&&w&&Yh(C)){for(C=0,w=f.responseEnd,i+=1;i<l.length;i++){var P=l[i],te=P.startTime;if(te>w)break;var ce=P.transferSize,pe=P.initiatorType;ce&&Yh(pe)&&(P=P.responseEnd,C+=ce*(P<w?1:(w-te)/(P-te)))}if(--i,n+=8*(g+C)/(f.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Kc=null,$c=null;function bi(e){return e.nodeType===9?e:e.ownerDocument}function Jh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xh(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function Zc(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Wc=null;function Fx(){var e=window.event;return e&&e.type==="popstate"?e===Wc?!1:(Wc=e,!0):(Wc=null,!1)}var Kh=typeof setTimeout=="function"?setTimeout:void 0,Yx=typeof clearTimeout=="function"?clearTimeout:void 0,$h=typeof Promise=="function"?Promise:void 0,Jx=typeof queueMicrotask=="function"?queueMicrotask:typeof $h<"u"?function(e){return $h.resolve(null).then(e).catch(Xx)}:Kh;function Xx(e){setTimeout(function(){throw e})}function al(e){return e==="head"}function Zh(e,n){var l=n,i=0;do{var f=l.nextSibling;if(e.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"||l==="/&"){if(i===0){e.removeChild(f),hs(n);return}i--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")i++;else if(l==="html")ca(e.ownerDocument.documentElement);else if(l==="head"){l=e.ownerDocument.head,ca(l);for(var g=l.firstChild;g;){var C=g.nextSibling,w=g.nodeName;g[_t]||w==="SCRIPT"||w==="STYLE"||w==="LINK"&&g.rel.toLowerCase()==="stylesheet"||l.removeChild(g),g=C}}else l==="body"&&ca(e.ownerDocument.body);l=f}while(l);hs(n)}function Wh(e,n){var l=e;e=0;do{var i=l.nextSibling;if(l.nodeType===1?n?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(n?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),i&&i.nodeType===8)if(l=i.data,l==="/$"){if(e===0)break;e--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||e++;l=i}while(l)}function Qc(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var l=n;switch(n=n.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Qc(l),gn(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}e.removeChild(l)}}function Kx(e,n,l,i){for(;e.nodeType===1;){var f=l;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[_t])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(g=e.getAttribute("rel"),g==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(g!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(g=e.getAttribute("src"),(g!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===g)return e}else return e;if(e=no(e.nextSibling),e===null)break}return null}function $x(e,n,l){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!l||(e=no(e.nextSibling),e===null))return null;return e}function Qh(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=no(e.nextSibling),e===null))return null;return e}function eu(e){return e.data==="$?"||e.data==="$~"}function tu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Zx(e,n){var l=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||l.readyState!=="loading")n();else{var i=function(){n(),l.removeEventListener("DOMContentLoaded",i)};l.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function no(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var nu=null;function ep(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var l=e.data;if(l==="/$"||l==="/&"){if(n===0)return no(e.nextSibling);n--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||n++}e=e.nextSibling}return null}function tp(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var l=e.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(n===0)return e;n--}else l!=="/$"&&l!=="/&"||n++}e=e.previousSibling}return null}function np(e,n,l){switch(n=bi(l),e){case"html":if(e=n.documentElement,!e)throw Error(a(452));return e;case"head":if(e=n.head,!e)throw Error(a(453));return e;case"body":if(e=n.body,!e)throw Error(a(454));return e;default:throw Error(a(451))}}function ca(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);gn(e)}var oo=new Map,op=new Set;function Ci(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Uo=z.d;z.d={f:Wx,r:Qx,D:e0,C:t0,L:n0,m:o0,X:s0,S:l0,M:a0};function Wx(){var e=Uo.f(),n=fi();return e||n}function Qx(e){var n=nn(e);n!==null&&n.tag===5&&n.type==="form"?bf(n):Uo.r(e)}var us=typeof document>"u"?null:document;function lp(e,n,l){var i=us;if(i&&typeof n=="string"&&n){var f=Dt(n);f='link[rel="'+e+'"][href="'+f+'"]',typeof l=="string"&&(f+='[crossorigin="'+l+'"]'),op.has(f)||(op.add(f),e={rel:e,crossOrigin:l,href:n},i.querySelector(f)===null&&(n=i.createElement("link"),Cn(n,"link",e),zt(n),i.head.appendChild(n)))}}function e0(e){Uo.D(e),lp("dns-prefetch",e,null)}function t0(e,n){Uo.C(e,n),lp("preconnect",e,n)}function n0(e,n,l){Uo.L(e,n,l);var i=us;if(i&&e&&n){var f='link[rel="preload"][as="'+Dt(n)+'"]';n==="image"&&l&&l.imageSrcSet?(f+='[imagesrcset="'+Dt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(f+='[imagesizes="'+Dt(l.imageSizes)+'"]')):f+='[href="'+Dt(e)+'"]';var g=f;switch(n){case"style":g=ds(e);break;case"script":g=fs(e)}oo.has(g)||(e=b({rel:"preload",href:n==="image"&&l&&l.imageSrcSet?void 0:e,as:n},l),oo.set(g,e),i.querySelector(f)!==null||n==="style"&&i.querySelector(ua(g))||n==="script"&&i.querySelector(da(g))||(n=i.createElement("link"),Cn(n,"link",e),zt(n),i.head.appendChild(n)))}}function o0(e,n){Uo.m(e,n);var l=us;if(l&&e){var i=n&&typeof n.as=="string"?n.as:"script",f='link[rel="modulepreload"][as="'+Dt(i)+'"][href="'+Dt(e)+'"]',g=f;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=fs(e)}if(!oo.has(g)&&(e=b({rel:"modulepreload",href:e},n),oo.set(g,e),l.querySelector(f)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(da(g)))return}i=l.createElement("link"),Cn(i,"link",e),zt(i),l.head.appendChild(i)}}}function l0(e,n,l){Uo.S(e,n,l);var i=us;if(i&&e){var f=En(i).hoistableStyles,g=ds(e);n=n||"default";var C=f.get(g);if(!C){var w={loading:0,preload:null};if(C=i.querySelector(ua(g)))w.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":n},l),(l=oo.get(g))&&ou(e,l);var P=C=i.createElement("link");zt(P),Cn(P,"link",e),P._p=new Promise(function(te,ce){P.onload=te,P.onerror=ce}),P.addEventListener("load",function(){w.loading|=1}),P.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Si(C,n,i)}C={type:"stylesheet",instance:C,count:1,state:w},f.set(g,C)}}}function s0(e,n){Uo.X(e,n);var l=us;if(l&&e){var i=En(l).hoistableScripts,f=fs(e),g=i.get(f);g||(g=l.querySelector(da(f)),g||(e=b({src:e,async:!0},n),(n=oo.get(f))&&lu(e,n),g=l.createElement("script"),zt(g),Cn(g,"link",e),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},i.set(f,g))}}function a0(e,n){Uo.M(e,n);var l=us;if(l&&e){var i=En(l).hoistableScripts,f=fs(e),g=i.get(f);g||(g=l.querySelector(da(f)),g||(e=b({src:e,async:!0,type:"module"},n),(n=oo.get(f))&&lu(e,n),g=l.createElement("script"),zt(g),Cn(g,"link",e),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},i.set(f,g))}}function sp(e,n,l,i){var f=(f=me.current)?Ci(f):null;if(!f)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(n=ds(l.href),l=En(f).hoistableStyles,i=l.get(n),i||(i={type:"style",instance:null,count:0,state:null},l.set(n,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){e=ds(l.href);var g=En(f).hoistableStyles,C=g.get(e);if(C||(f=f.ownerDocument||f,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(e,C),(g=f.querySelector(ua(e)))&&!g._p&&(C.instance=g,C.state.loading=5),oo.has(e)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},oo.set(e,l),g||i0(f,e,l,C.state))),n&&i===null)throw Error(a(528,""));return C}if(n&&i!==null)throw Error(a(529,""));return null;case"script":return n=l.async,l=l.src,typeof l=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=fs(l),l=En(f).hoistableScripts,i=l.get(n),i||(i={type:"script",instance:null,count:0,state:null},l.set(n,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function ds(e){return'href="'+Dt(e)+'"'}function ua(e){return'link[rel="stylesheet"]['+e+"]"}function ap(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function i0(e,n,l,i){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?i.loading=1:(n=e.createElement("link"),i.preload=n,n.addEventListener("load",function(){return i.loading|=1}),n.addEventListener("error",function(){return i.loading|=2}),Cn(n,"link",l),zt(n),e.head.appendChild(n))}function fs(e){return'[src="'+Dt(e)+'"]'}function da(e){return"script[async]"+e}function ip(e,n,l){if(n.count++,n.instance===null)switch(n.type){case"style":var i=e.querySelector('style[data-href~="'+Dt(l.href)+'"]');if(i)return n.instance=i,zt(i),i;var f=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),zt(i),Cn(i,"style",f),Si(i,l.precedence,e),n.instance=i;case"stylesheet":f=ds(l.href);var g=e.querySelector(ua(f));if(g)return n.state.loading|=4,n.instance=g,zt(g),g;i=ap(l),(f=oo.get(f))&&ou(i,f),g=(e.ownerDocument||e).createElement("link"),zt(g);var C=g;return C._p=new Promise(function(w,P){C.onload=w,C.onerror=P}),Cn(g,"link",i),n.state.loading|=4,Si(g,l.precedence,e),n.instance=g;case"script":return g=fs(l.src),(f=e.querySelector(da(g)))?(n.instance=f,zt(f),f):(i=l,(f=oo.get(g))&&(i=b({},l),lu(i,f)),e=e.ownerDocument||e,f=e.createElement("script"),zt(f),Cn(f,"link",i),e.head.appendChild(f),n.instance=f);case"void":return null;default:throw Error(a(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(i=n.instance,n.state.loading|=4,Si(i,l.precedence,e));return n.instance}function Si(e,n,l){for(var i=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=i.length?i[i.length-1]:null,g=f,C=0;C<i.length;C++){var w=i[C];if(w.dataset.precedence===n)g=w;else if(g!==f)break}g?g.parentNode.insertBefore(e,g.nextSibling):(n=l.nodeType===9?l.head:l,n.insertBefore(e,n.firstChild))}function ou(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function lu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Ei=null;function rp(e,n,l){if(Ei===null){var i=new Map,f=Ei=new Map;f.set(l,i)}else f=Ei,i=f.get(l),i||(i=new Map,f.set(l,i));if(i.has(e))return i;for(i.set(e,null),l=l.getElementsByTagName(e),f=0;f<l.length;f++){var g=l[f];if(!(g[_t]||g[Le]||e==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var C=g.getAttribute(n)||"";C=e+C;var w=i.get(C);w?w.push(g):i.set(C,[g])}}return i}function cp(e,n,l){e=e.ownerDocument||e,e.head.insertBefore(l,n==="title"?e.querySelector("head > title"):null)}function r0(e,n,l){if(l===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function up(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function c0(e,n,l,i){if(l.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var f=ds(i.href),g=n.querySelector(ua(f));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=Ti.bind(e),n.then(e,e)),l.state.loading|=4,l.instance=g,zt(g);return}g=n.ownerDocument||n,i=ap(i),(f=oo.get(f))&&ou(i,f),g=g.createElement("link"),zt(g);var C=g;C._p=new Promise(function(w,P){C.onload=w,C.onerror=P}),Cn(g,"link",i),l.instance=g}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(l,n),(n=l.state.preload)&&(l.state.loading&3)===0&&(e.count++,l=Ti.bind(e),n.addEventListener("load",l),n.addEventListener("error",l))}}var su=0;function u0(e,n){return e.stylesheets&&e.count===0&&Ni(e,e.stylesheets),0<e.count||0<e.imgCount?function(l){var i=setTimeout(function(){if(e.stylesheets&&Ni(e,e.stylesheets),e.unsuspend){var g=e.unsuspend;e.unsuspend=null,g()}},6e4+n);0<e.imgBytes&&su===0&&(su=62500*Ox());var f=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Ni(e,e.stylesheets),e.unsuspend)){var g=e.unsuspend;e.unsuspend=null,g()}},(e.imgBytes>su?50:800)+n);return e.unsuspend=l,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(f)}}:null}function Ti(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ni(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var wi=null;function Ni(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,wi=new Map,n.forEach(d0,e),wi=null,Ti.call(e))}function d0(e,n){if(!(n.state.loading&4)){var l=wi.get(e);if(l)var i=l.get(null);else{l=new Map,wi.set(e,l);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var C=f[g];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(l.set(C.dataset.precedence,C),i=C)}i&&l.set(null,i)}f=n.instance,C=f.getAttribute("data-precedence"),g=l.get(C)||i,g===i&&l.set(null,f),l.set(C,f),this.count++,i=Ti.bind(this),f.addEventListener("load",i),f.addEventListener("error",i),g?g.parentNode.insertBefore(f,g.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),n.state.loading|=4}}var fa={$$typeof:R,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function f0(e,n,l,i,f,g,C,w,P){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ct(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ct(0),this.hiddenUpdates=Ct(null),this.identifierPrefix=i,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function dp(e,n,l,i,f,g,C,w,P,te,ce,pe){return e=new f0(e,n,l,C,P,te,ce,pe,w),n=1,g===!0&&(n|=24),g=Bn(3,null,null,n),e.current=g,g.stateNode=e,n=Pr(),n.refCount++,e.pooledCache=n,n.refCount++,g.memoizedState={element:i,isDehydrated:l,cache:n},Vr(g),e}function fp(e){return e?(e=Hl,e):Hl}function hp(e,n,l,i,f,g){f=fp(f),i.context===null?i.context=f:i.pendingContext=f,i=Ko(n),i.payload={element:l},g=g===void 0?null:g,g!==null&&(i.callback=g),l=$o(e,i,n),l!==null&&(jn(l,e,n),Os(l,e,n))}function pp(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var l=e.retryLane;e.retryLane=l!==0&&l<n?l:n}}function au(e,n){pp(e,n),(e=e.alternate)&&pp(e,n)}function mp(e){if(e.tag===13||e.tag===31){var n=bl(e,67108864);n!==null&&jn(n,e,67108864),au(e,67108864)}}function gp(e){if(e.tag===13||e.tag===31){var n=On();n=le(n);var l=bl(e,n);l!==null&&jn(l,e,n),au(e,n)}}var Ai=!0;function h0(e,n,l,i){var f=j.T;j.T=null;var g=z.p;try{z.p=2,iu(e,n,l,i)}finally{z.p=g,j.T=f}}function p0(e,n,l,i){var f=j.T;j.T=null;var g=z.p;try{z.p=8,iu(e,n,l,i)}finally{z.p=g,j.T=f}}function iu(e,n,l,i){if(Ai){var f=ru(i);if(f===null)Jc(e,n,i,_i,l),xp(e,i);else if(g0(f,e,n,l,i))i.stopPropagation();else if(xp(e,i),n&4&&-1<m0.indexOf(e)){for(;f!==null;){var g=nn(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var C=ct(g.pendingLanes);if(C!==0){var w=g;for(w.pendingLanes|=2,w.entangledLanes|=2;C;){var P=1<<31-At(C);w.entanglements[1]|=P,C&=~P}go(g),(Mt&6)===0&&(ui=$e()+500,aa(0))}}break;case 31:case 13:w=bl(g,2),w!==null&&jn(w,g,2),fi(),au(g,2)}if(g=ru(i),g===null&&Jc(e,n,i,_i,l),g===f)break;f=g}f!==null&&i.stopPropagation()}else Jc(e,n,i,null,l)}}function ru(e){return e=ur(e),cu(e)}var _i=null;function cu(e){if(_i=null,e=Sn(e),e!==null){var n=u(e);if(n===null)e=null;else{var l=n.tag;if(l===13){if(e=p(n),e!==null)return e;e=null}else if(l===31){if(e=y(n),e!==null)return e;e=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return _i=e,null}function yp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bt()){case Ue:return 2;case We:return 8;case Ut:case mn:return 32;case un:return 268435456;default:return 32}default:return 32}}var uu=!1,il=null,rl=null,cl=null,ha=new Map,pa=new Map,ul=[],m0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xp(e,n){switch(e){case"focusin":case"focusout":il=null;break;case"dragenter":case"dragleave":rl=null;break;case"mouseover":case"mouseout":cl=null;break;case"pointerover":case"pointerout":ha.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":pa.delete(n.pointerId)}}function ma(e,n,l,i,f,g){return e===null||e.nativeEvent!==g?(e={blockedOn:n,domEventName:l,eventSystemFlags:i,nativeEvent:g,targetContainers:[f]},n!==null&&(n=nn(n),n!==null&&mp(n)),e):(e.eventSystemFlags|=i,n=e.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),e)}function g0(e,n,l,i,f){switch(n){case"focusin":return il=ma(il,e,n,l,i,f),!0;case"dragenter":return rl=ma(rl,e,n,l,i,f),!0;case"mouseover":return cl=ma(cl,e,n,l,i,f),!0;case"pointerover":var g=f.pointerId;return ha.set(g,ma(ha.get(g)||null,e,n,l,i,f)),!0;case"gotpointercapture":return g=f.pointerId,pa.set(g,ma(pa.get(g)||null,e,n,l,i,f)),!0}return!1}function vp(e){var n=Sn(e.target);if(n!==null){var l=u(n);if(l!==null){if(n=l.tag,n===13){if(n=p(l),n!==null){e.blockedOn=n,ke(e.priority,function(){gp(l)});return}}else if(n===31){if(n=y(l),n!==null){e.blockedOn=n,ke(e.priority,function(){gp(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){e.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Mi(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var l=ru(e.nativeEvent);if(l===null){l=e.nativeEvent;var i=new l.constructor(l.type,l);cr=i,l.target.dispatchEvent(i),cr=null}else return n=nn(l),n!==null&&mp(n),e.blockedOn=l,!1;n.shift()}return!0}function bp(e,n,l){Mi(e)&&l.delete(n)}function y0(){uu=!1,il!==null&&Mi(il)&&(il=null),rl!==null&&Mi(rl)&&(rl=null),cl!==null&&Mi(cl)&&(cl=null),ha.forEach(bp),pa.forEach(bp)}function Ri(e,n){e.blockedOn===n&&(e.blockedOn=null,uu||(uu=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,y0)))}var Ii=null;function Cp(e){Ii!==e&&(Ii=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){Ii===e&&(Ii=null);for(var n=0;n<e.length;n+=3){var l=e[n],i=e[n+1],f=e[n+2];if(typeof i!="function"){if(cu(i||l)===null)continue;break}var g=nn(l);g!==null&&(e.splice(n,3),n-=3,rc(g,{pending:!0,data:f,method:l.method,action:i},i,f))}}))}function hs(e){function n(P){return Ri(P,e)}il!==null&&Ri(il,e),rl!==null&&Ri(rl,e),cl!==null&&Ri(cl,e),ha.forEach(n),pa.forEach(n);for(var l=0;l<ul.length;l++){var i=ul[l];i.blockedOn===e&&(i.blockedOn=null)}for(;0<ul.length&&(l=ul[0],l.blockedOn===null);)vp(l),l.blockedOn===null&&ul.shift();if(l=(e.ownerDocument||e).$$reactFormReplay,l!=null)for(i=0;i<l.length;i+=3){var f=l[i],g=l[i+1],C=f[Je]||null;if(typeof g=="function")C||Cp(l);else if(C){var w=null;if(g&&g.hasAttribute("formAction")){if(f=g,C=g[Je]||null)w=C.formAction;else if(cu(f)!==null)continue}else w=C.action;typeof w=="function"?l[i+1]=w:(l.splice(i,3),i-=3),Cp(l)}}}function Sp(){function e(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(C){return f=C})},focusReset:"manual",scroll:"manual"})}function n(){f!==null&&(f(),f=null),i||setTimeout(l,20)}function l(){if(!i&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,f=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(l,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),f!==null&&(f(),f=null)}}}function du(e){this._internalRoot=e}ki.prototype.render=du.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(a(409));var l=n.current,i=On();hp(l,i,e,n,null,null)},ki.prototype.unmount=du.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;hp(e.current,2,null,e,null,null),fi(),n[nt]=null}};function ki(e){this._internalRoot=e}ki.prototype.unstable_scheduleHydration=function(e){if(e){var n=we();e={blockedOn:null,target:e,priority:n};for(var l=0;l<ul.length&&n!==0&&n<ul[l].priority;l++);ul.splice(l,0,e),l===0&&vp(e)}};var Ep=t.version;if(Ep!=="19.2.0")throw Error(a(527,Ep,"19.2.0"));z.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=m(n),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var x0={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Di=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Di.isDisabled&&Di.supportsFiber)try{hn=Di.inject(x0),Wt=Di}catch{}}return ya.createRoot=function(e,n){if(!r(e))throw Error(a(299));var l=!1,i="",f=Rf,g=If,C=kf;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(g=n.onCaughtError),n.onRecoverableError!==void 0&&(C=n.onRecoverableError)),n=dp(e,1,!1,null,null,l,i,null,f,g,C,Sp),e[nt]=n.current,Yc(e),new du(n)},ya.hydrateRoot=function(e,n,l){if(!r(e))throw Error(a(299));var i=!1,f="",g=Rf,C=If,w=kf,P=null;return l!=null&&(l.unstable_strictMode===!0&&(i=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(C=l.onCaughtError),l.onRecoverableError!==void 0&&(w=l.onRecoverableError),l.formState!==void 0&&(P=l.formState)),n=dp(e,1,!0,n,l??null,i,f,P,g,C,w,Sp),n.context=fp(null),l=n.current,i=On(),i=le(i),f=Ko(i),f.callback=null,$o(l,f,i),l=i,n.current.lanes=l,Te(n,l),go(n),e[nt]=n.current,Yc(e),new ki(n)},ya.version="19.2.0",ya}var Lp;function P0(){if(Lp)return pu.exports;Lp=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),pu.exports=z0(),pu.exports}var B0=P0();const q0=_g(B0);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let G0,V0;function H0(){return{geminiUrl:G0,vertexUrl:V0}}function O0(o,t,s,a){var r,u;if(!(o!=null&&o.baseUrl)){const p=H0();return t?(r=p.vertexUrl)!==null&&r!==void 0?r:s:(u=p.geminiUrl)!==null&&u!==void 0?u:a}return o.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jl{}function Pe(o,t){const s=/\{([^}]+)\}/g;return o.replace(s,(a,r)=>{if(Object.prototype.hasOwnProperty.call(t,r)){const u=t[r];return u!=null?String(u):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function h(o,t,s){for(let u=0;u<t.length-1;u++){const p=t[u];if(p.endsWith("[]")){const y=p.slice(0,-2);if(!(y in o))if(Array.isArray(s))o[y]=Array.from({length:s.length},()=>({}));else throw new Error(`Value must be a list given an array path ${p}`);if(Array.isArray(o[y])){const x=o[y];if(Array.isArray(s))for(let m=0;m<x.length;m++){const v=x[m];h(v,t.slice(u+1),s[m])}else for(const m of x)h(m,t.slice(u+1),s)}return}else if(p.endsWith("[0]")){const y=p.slice(0,-3);y in o||(o[y]=[{}]);const x=o[y];h(x[0],t.slice(u+1),s);return}(!o[p]||typeof o[p]!="object")&&(o[p]={}),o=o[p]}const a=t[t.length-1],r=o[a];if(r!==void 0){if(!s||typeof s=="object"&&Object.keys(s).length===0||s===r)return;if(typeof r=="object"&&typeof s=="object"&&r!==null&&s!==null)Object.assign(r,s);else throw new Error(`Cannot set value for an existing key. Key: ${a}`)}else a==="_self"&&typeof s=="object"&&s!==null&&!Array.isArray(s)?Object.assign(o,s):o[a]=s}function d(o,t,s=void 0){try{if(t.length===1&&t[0]==="_self")return o;for(let a=0;a<t.length;a++){if(typeof o!="object"||o===null)return s;const r=t[a];if(r.endsWith("[]")){const u=r.slice(0,-2);if(u in o){const p=o[u];return Array.isArray(p)?p.map(y=>d(y,t.slice(a+1),s)):s}else return s}else o=o[r]}return o}catch(a){if(a instanceof TypeError)return s;throw a}}function F0(o,t){for(const[s,a]of Object.entries(t)){const r=s.split("."),u=a.split("."),p=new Set;let y=-1;for(let x=0;x<r.length;x++)if(r[x]==="*"){y=x;break}if(y!==-1&&u.length>y)for(let x=y;x<u.length;x++){const m=u[x];m!=="*"&&!m.endsWith("[]")&&!m.endsWith("[0]")&&p.add(m)}wu(o,r,u,0,p)}}function wu(o,t,s,a,r){if(a>=t.length||typeof o!="object"||o===null)return;const u=t[a];if(u.endsWith("[]")){const p=u.slice(0,-2),y=o;if(p in y&&Array.isArray(y[p]))for(const x of y[p])wu(x,t,s,a+1,r)}else if(u==="*"){if(typeof o=="object"&&o!==null&&!Array.isArray(o)){const p=o,y=Object.keys(p).filter(m=>!m.startsWith("_")&&!r.has(m)),x={};for(const m of y)x[m]=p[m];for(const[m,v]of Object.entries(x)){const b=[];for(const S of s.slice(a))S==="*"?b.push(m):b.push(S);h(p,b,v)}for(const m of y)delete p[m]}}else{const p=o;u in p&&wu(p[u],t,s,a+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zu(o){if(typeof o!="string")throw new Error("fromImageBytes must be a string");return o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Y0(o){const t={},s=d(o,["operationName"]);s!=null&&h(t,["operationName"],s);const a=d(o,["resourceName"]);return a!=null&&h(t,["_url","resourceName"],a),t}function J0(o){const t={},s=d(o,["name"]);s!=null&&h(t,["name"],s);const a=d(o,["metadata"]);a!=null&&h(t,["metadata"],a);const r=d(o,["done"]);r!=null&&h(t,["done"],r);const u=d(o,["error"]);u!=null&&h(t,["error"],u);const p=d(o,["response","generateVideoResponse"]);return p!=null&&h(t,["response"],K0(p)),t}function X0(o){const t={},s=d(o,["name"]);s!=null&&h(t,["name"],s);const a=d(o,["metadata"]);a!=null&&h(t,["metadata"],a);const r=d(o,["done"]);r!=null&&h(t,["done"],r);const u=d(o,["error"]);u!=null&&h(t,["error"],u);const p=d(o,["response"]);return p!=null&&h(t,["response"],$0(p)),t}function K0(o){const t={},s=d(o,["generatedSamples"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(p=>Z0(p))),h(t,["generatedVideos"],u)}const a=d(o,["raiMediaFilteredCount"]);a!=null&&h(t,["raiMediaFilteredCount"],a);const r=d(o,["raiMediaFilteredReasons"]);return r!=null&&h(t,["raiMediaFilteredReasons"],r),t}function $0(o){const t={},s=d(o,["videos"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(p=>W0(p))),h(t,["generatedVideos"],u)}const a=d(o,["raiMediaFilteredCount"]);a!=null&&h(t,["raiMediaFilteredCount"],a);const r=d(o,["raiMediaFilteredReasons"]);return r!=null&&h(t,["raiMediaFilteredReasons"],r),t}function Z0(o){const t={},s=d(o,["video"]);return s!=null&&h(t,["video"],tv(s)),t}function W0(o){const t={},s=d(o,["_self"]);return s!=null&&h(t,["video"],nv(s)),t}function Q0(o){const t={},s=d(o,["operationName"]);return s!=null&&h(t,["_url","operationName"],s),t}function ev(o){const t={},s=d(o,["operationName"]);return s!=null&&h(t,["_url","operationName"],s),t}function tv(o){const t={},s=d(o,["uri"]);s!=null&&h(t,["uri"],s);const a=d(o,["encodedVideo"]);a!=null&&h(t,["videoBytes"],zu(a));const r=d(o,["encoding"]);return r!=null&&h(t,["mimeType"],r),t}function nv(o){const t={},s=d(o,["gcsUri"]);s!=null&&h(t,["uri"],s);const a=d(o,["bytesBase64Encoded"]);a!=null&&h(t,["videoBytes"],zu(a));const r=d(o,["mimeType"]);return r!=null&&h(t,["mimeType"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var jp;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(jp||(jp={}));var Up;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(Up||(Up={}));var zp;(function(o){o.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",o.SILENT="SILENT",o.WHEN_IDLE="WHEN_IDLE",o.INTERRUPT="INTERRUPT"})(zp||(zp={}));var hl;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT",o.NULL="NULL"})(hl||(hl={}));var Pp;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",o.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",o.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",o.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",o.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Pp||(Pp={}));var Bp;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(Bp||(Bp={}));var qp;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(qp||(qp={}));var Gp;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Gp||(Gp={}));var Vp;(function(o){o.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",o.NO_AUTH="NO_AUTH",o.API_KEY_AUTH="API_KEY_AUTH",o.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",o.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",o.OAUTH="OAUTH",o.OIDC_AUTH="OIDC_AUTH"})(Vp||(Vp={}));var Hp;(function(o){o.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",o.SIMPLE_SEARCH="SIMPLE_SEARCH",o.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Hp||(Hp={}));var Op;(function(o){o.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",o.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",o.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",o.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",o.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Op||(Op={}));var Fp;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.LANGUAGE="LANGUAGE",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY",o.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",o.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",o.NO_IMAGE="NO_IMAGE"})(Fp||(Fp={}));var Yp;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(Yp||(Yp={}));var Jp;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Jp||(Jp={}));var Xp;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.IMAGE_SAFETY="IMAGE_SAFETY",o.MODEL_ARMOR="MODEL_ARMOR",o.JAILBREAK="JAILBREAK"})(Xp||(Xp={}));var Kp;(function(o){o.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",o.ON_DEMAND="ON_DEMAND",o.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Kp||(Kp={}));var bs;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(bs||(bs={}));var $p;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})($p||($p={}));var Nu;(function(o){o.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",o.JOB_STATE_QUEUED="JOB_STATE_QUEUED",o.JOB_STATE_PENDING="JOB_STATE_PENDING",o.JOB_STATE_RUNNING="JOB_STATE_RUNNING",o.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",o.JOB_STATE_FAILED="JOB_STATE_FAILED",o.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",o.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",o.JOB_STATE_PAUSED="JOB_STATE_PAUSED",o.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",o.JOB_STATE_UPDATING="JOB_STATE_UPDATING",o.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Nu||(Nu={}));var Zp;(function(o){o.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",o.TUNING_MODE_FULL="TUNING_MODE_FULL",o.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Zp||(Zp={}));var Wp;(function(o){o.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",o.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",o.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",o.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",o.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",o.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",o.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Wp||(Wp={}));var Qp;(function(o){o.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",o.TUNING_TASK_I2V="TUNING_TASK_I2V",o.TUNING_TASK_T2V="TUNING_TASK_T2V"})(Qp||(Qp={}));var em;(function(o){o.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",o.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",o.BALANCED="BALANCED",o.PRIORITIZE_COST="PRIORITIZE_COST"})(em||(em={}));var tm;(function(o){o.UNSPECIFIED="UNSPECIFIED",o.BLOCKING="BLOCKING",o.NON_BLOCKING="NON_BLOCKING"})(tm||(tm={}));var nm;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(nm||(nm={}));var om;(function(o){o.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",o.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(om||(om={}));var lm;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE",o.VALIDATED="VALIDATED"})(lm||(lm={}));var sm;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(sm||(sm={}));var am;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(am||(am={}));var im;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi",o.zh="zh",o.pt="pt",o.es="es"})(im||(im={}));var rm;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(rm||(rm={}));var cm;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(cm||(cm={}));var um;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(um||(um={}));var dm;(function(o){o.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",o.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",o.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",o.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",o.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",o.EDIT_MODE_STYLE="EDIT_MODE_STYLE",o.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",o.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(dm||(dm={}));var fm;(function(o){o.FOREGROUND="FOREGROUND",o.BACKGROUND="BACKGROUND",o.PROMPT="PROMPT",o.SEMANTIC="SEMANTIC",o.INTERACTIVE="INTERACTIVE"})(fm||(fm={}));var hm;(function(o){o.ASSET="ASSET",o.STYLE="STYLE"})(hm||(hm={}));var pm;(function(o){o.INSERT="INSERT",o.REMOVE="REMOVE",o.REMOVE_STATIC="REMOVE_STATIC",o.OUTPAINT="OUTPAINT"})(pm||(pm={}));var mm;(function(o){o.OPTIMIZED="OPTIMIZED",o.LOSSLESS="LOSSLESS"})(mm||(mm={}));var gm;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(gm||(gm={}));var ym;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(ym||(ym={}));var xm;(function(o){o.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.RESPONSE_REJECTED="RESPONSE_REJECTED",o.NEED_MORE_INPUT="NEED_MORE_INPUT"})(xm||(xm={}));var vm;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(vm||(vm={}));var bm;(function(o){o.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",o.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",o.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(bm||(bm={}));var Cm;(function(o){o.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",o.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",o.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Cm||(Cm={}));var Sm;(function(o){o.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",o.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",o.NO_INTERRUPTION="NO_INTERRUPTION"})(Sm||(Sm={}));var Em;(function(o){o.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",o.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",o.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Em||(Em={}));var Tm;(function(o){o.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",o.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",o.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",o.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",o.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",o.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",o.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",o.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",o.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",o.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",o.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",o.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",o.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Tm||(Tm={}));var wm;(function(o){o.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",o.QUALITY="QUALITY",o.DIVERSITY="DIVERSITY",o.VOCALIZATION="VOCALIZATION"})(wm||(wm={}));var ms;(function(o){o.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",o.PLAY="PLAY",o.PAUSE="PAUSE",o.STOP="STOP",o.RESET_CONTEXT="RESET_CONTEXT"})(ms||(ms={}));class Au{constructor(t){const s={};for(const a of t.headers.entries())s[a[0]]=a[1];this.headers=s,this.responseInternal=t}json(){return this.responseInternal.json()}}class xa{get text(){var t,s,a,r,u,p,y,x;if(((r=(a=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let m="",v=!1;const b=[];for(const S of(x=(y=(p=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||p===void 0?void 0:p.content)===null||y===void 0?void 0:y.parts)!==null&&x!==void 0?x:[]){for(const[N,_]of Object.entries(S))N!=="text"&&N!=="thought"&&(_!==null||_!==void 0)&&b.push(N);if(typeof S.text=="string"){if(typeof S.thought=="boolean"&&S.thought)continue;v=!0,m+=S.text}}return b.length>0&&console.warn(`there are non-text parts ${b} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),v?m:void 0}get data(){var t,s,a,r,u,p,y,x;if(((r=(a=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let m="";const v=[];for(const b of(x=(y=(p=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||p===void 0?void 0:p.content)===null||y===void 0?void 0:y.parts)!==null&&x!==void 0?x:[]){for(const[S,N]of Object.entries(b))S!=="inlineData"&&(N!==null||N!==void 0)&&v.push(S);b.inlineData&&typeof b.inlineData.data=="string"&&(m+=atob(b.inlineData.data))}return v.length>0&&console.warn(`there are non-data parts ${v} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),m.length>0?btoa(m):void 0}get functionCalls(){var t,s,a,r,u,p,y,x;if(((r=(a=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const m=(x=(y=(p=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||p===void 0?void 0:p.content)===null||y===void 0?void 0:y.parts)===null||x===void 0?void 0:x.filter(v=>v.functionCall).map(v=>v.functionCall).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return m}get executableCode(){var t,s,a,r,u,p,y,x,m;if(((r=(a=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const v=(x=(y=(p=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||p===void 0?void 0:p.content)===null||y===void 0?void 0:y.parts)===null||x===void 0?void 0:x.filter(b=>b.executableCode).map(b=>b.executableCode).filter(b=>b!==void 0);if((v==null?void 0:v.length)!==0)return(m=v==null?void 0:v[0])===null||m===void 0?void 0:m.code}get codeExecutionResult(){var t,s,a,r,u,p,y,x,m;if(((r=(a=(s=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const v=(x=(y=(p=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||p===void 0?void 0:p.content)===null||y===void 0?void 0:y.parts)===null||x===void 0?void 0:x.filter(b=>b.codeExecutionResult).map(b=>b.codeExecutionResult).filter(b=>b!==void 0);if((v==null?void 0:v.length)!==0)return(m=v==null?void 0:v[0])===null||m===void 0?void 0:m.output}}class Nm{}class Am{}class ov{}class lv{}class sv{}class av{}class _m{}class Mm{}class Rm{}class iv{}class qi{_fromAPIResponse({apiResponse:t,isVertexAI:s}){const a=new qi;let r;const u=t;return s?r=X0(u):r=J0(u),Object.assign(a,r),a}}class Im{}class km{}class Dm{}class rv{}class cv{}class uv{}class Lm{}class dv{get text(){var t,s,a;let r="",u=!1;const p=[];for(const y of(a=(s=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&a!==void 0?a:[]){for(const[x,m]of Object.entries(y))x!=="text"&&x!=="thought"&&m!==null&&p.push(x);if(typeof y.text=="string"){if(typeof y.thought=="boolean"&&y.thought)continue;u=!0,r+=y.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?r:void 0}get data(){var t,s,a;let r="";const u=[];for(const p of(a=(s=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&a!==void 0?a:[]){for(const[y,x]of Object.entries(p))y!=="inlineData"&&x!==null&&u.push(y);p.inlineData&&typeof p.inlineData.data=="string"&&(r+=atob(p.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class fv{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nt(o,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const s=t.split("/",2);return`publishers/${s[0]}/models/${s[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function Rg(o,t){const s=Nt(o,t);return s?s.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${s}`:s.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${s}`:s:""}function Ig(o){return Array.isArray(o)?o.map(t=>Gi(t)):[Gi(o)]}function Gi(o){if(typeof o=="object"&&o!==null)return o;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof o}`)}function kg(o){const t=Gi(o);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Dg(o){const t=Gi(o);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function jm(o){if(o==null)throw new Error("PartUnion is required");if(typeof o=="object")return o;if(typeof o=="string")return{text:o};throw new Error(`Unsupported part type: ${typeof o}`)}function Lg(o){if(o==null||Array.isArray(o)&&o.length===0)throw new Error("PartListUnion is required");return Array.isArray(o)?o.map(t=>jm(t)):[jm(o)]}function _u(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function Um(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function zm(o){return o!=null&&typeof o=="object"&&"functionResponse"in o}function An(o){if(o==null)throw new Error("ContentUnion is required");return _u(o)?o:{role:"user",parts:Lg(o)}}function Pu(o,t){if(!t)return[];if(o.isVertexAI()&&Array.isArray(t))return t.flatMap(s=>{const a=An(s);return a.parts&&a.parts.length>0&&a.parts[0].text!==void 0?[a.parts[0].text]:[]});if(o.isVertexAI()){const s=An(t);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]}return Array.isArray(t)?t.map(s=>An(s)):[An(t)]}function lo(o){if(o==null||Array.isArray(o)&&o.length===0)throw new Error("contents are required");if(!Array.isArray(o)){if(Um(o)||zm(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[An(o)]}const t=[],s=[],a=_u(o[0]);for(const r of o){const u=_u(r);if(u!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(u)t.push(r);else{if(Um(r)||zm(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");s.push(r)}}return a||t.push({role:"user",parts:Lg(s)}),t}function hv(o,t){o.includes("null")&&(t.nullable=!0);const s=o.filter(a=>a!=="null");if(s.length===1)t.type=Object.values(hl).includes(s[0].toUpperCase())?s[0].toUpperCase():hl.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const a of s)t.anyOf.push({type:Object.values(hl).includes(a.toUpperCase())?a.toUpperCase():hl.TYPE_UNSPECIFIED})}}function ys(o){const t={},s=["items"],a=["anyOf"],r=["properties"];if(o.type&&o.anyOf)throw new Error("type and anyOf cannot be both populated.");const u=o.anyOf;u!=null&&u.length==2&&(u[0].type==="null"?(t.nullable=!0,o=u[1]):u[1].type==="null"&&(t.nullable=!0,o=u[0])),o.type instanceof Array&&hv(o.type,t);for(const[p,y]of Object.entries(o))if(y!=null)if(p=="type"){if(y==="null")throw new Error("type: null can not be the only possible type for the field.");if(y instanceof Array)continue;t.type=Object.values(hl).includes(y.toUpperCase())?y.toUpperCase():hl.TYPE_UNSPECIFIED}else if(s.includes(p))t[p]=ys(y);else if(a.includes(p)){const x=[];for(const m of y){if(m.type=="null"){t.nullable=!0;continue}x.push(ys(m))}t[p]=x}else if(r.includes(p)){const x={};for(const[m,v]of Object.entries(y))x[m]=ys(v);t[p]=x}else{if(p==="additionalProperties")continue;t[p]=y}return t}function Bu(o){return ys(o)}function qu(o){if(typeof o=="object")return o;if(typeof o=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:o}}};throw new Error(`Unsupported speechConfig type: ${typeof o}`)}function Gu(o){if("multiSpeakerVoiceConfig"in o)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return o}function Ss(o){if(o.functionDeclarations)for(const t of o.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=ys(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=ys(t.response));return o}function Es(o){if(o==null)throw new Error("tools is required");if(!Array.isArray(o))throw new Error("tools is required and must be an array of Tools");const t=[];for(const s of o)t.push(s);return t}function pv(o,t,s,a=1){const r=!t.startsWith(`${s}/`)&&t.split("/").length===a;return o.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${o.getProject()}/${t}`:t.startsWith(`${s}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}`:r?`projects/${o.getProject()}/locations/${o.getLocation()}/${s}/${t}`:t:r?`${s}/${t}`:t}function Po(o,t){if(typeof t!="string")throw new Error("name must be a string");return pv(o,t,"cachedContents")}function jg(o){switch(o){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return o}}function pl(o){return zu(o)}function mv(o){return o!=null&&typeof o=="object"&&"name"in o}function gv(o){return o!=null&&typeof o=="object"&&"video"in o}function yv(o){return o!=null&&typeof o=="object"&&"uri"in o}function Ug(o){var t;let s;if(mv(o)&&(s=o.name),!(yv(o)&&(s=o.uri,s===void 0))&&!(gv(o)&&(s=(t=o.video)===null||t===void 0?void 0:t.uri,s===void 0))){if(typeof o=="string"&&(s=o),s===void 0)throw new Error("Could not extract file name from the provided input.");if(s.startsWith("https://")){const r=s.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${s}`);s=r[0]}else s.startsWith("files/")&&(s=s.split("files/")[1]);return s}}function zg(o,t){let s;return o.isVertexAI()?s=t?"publishers/google/models":"models":s=t?"models":"tunedModels",s}function Pg(o){for(const t of["models","tunedModels","publisherModels"])if(xv(o,t))return o[t];return[]}function xv(o,t){return o!==null&&typeof o=="object"&&t in o}function vv(o,t={}){const s=o,a={name:s.name,description:s.description,parametersJsonSchema:s.inputSchema};return s.outputSchema&&(a.responseJsonSchema=s.outputSchema),t.behavior&&(a.behavior=t.behavior),{functionDeclarations:[a]}}function bv(o,t={}){const s=[],a=new Set;for(const r of o){const u=r.name;if(a.has(u))throw new Error(`Duplicate function name ${u} found in MCP tools. Please ensure function names are unique.`);a.add(u);const p=vv(r,t);p.functionDeclarations&&s.push(...p.functionDeclarations)}return{functionDeclarations:s}}function Bg(o,t){let s;if(typeof t=="string")if(o.isVertexAI())if(t.startsWith("gs://"))s={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))s={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))s={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(o.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");s={inlinedRequests:t}}else s=t;const a=[s.gcsUri,s.bigqueryUri].filter(Boolean).length,r=[s.inlinedRequests,s.fileName].filter(Boolean).length;if(o.isVertexAI()){if(r>0||a!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(a>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return s}function Cv(o){if(typeof o!="string")return o;const t=o;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function qg(o){if(typeof o!="object"||o===null)return{};const t=o,s=t.inlinedResponses;if(typeof s!="object"||s===null)return o;const r=s.inlinedResponses;if(!Array.isArray(r)||r.length===0)return o;let u=!1;for(const p of r){if(typeof p!="object"||p===null)continue;const x=p.response;if(typeof x!="object"||x===null)continue;if(x.embedding!==void 0){u=!0;break}}return u&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),o}function Ts(o,t){const s=t;if(!o.isVertexAI()){if(/batches\/[^/]+$/.test(s))return s.split("/").pop();throw new Error(`Invalid batch job name: ${s}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(s))return s.split("/").pop();if(/^\d+$/.test(s))return s;throw new Error(`Invalid batch job name: ${s}.`)}function Gg(o){const t=o;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Sv(o){const t={},s=d(o,["responsesFile"]);s!=null&&h(t,["fileName"],s);const a=d(o,["inlinedResponses","inlinedResponses"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(p=>Qv(p))),h(t,["inlinedResponses"],u)}const r=d(o,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>p)),h(t,["inlinedEmbedContentResponses"],u)}return t}function Ev(o){const t={},s=d(o,["predictionsFormat"]);s!=null&&h(t,["format"],s);const a=d(o,["gcsDestination","outputUriPrefix"]);a!=null&&h(t,["gcsUri"],a);const r=d(o,["bigqueryDestination","outputUri"]);return r!=null&&h(t,["bigqueryUri"],r),t}function Tv(o){const t={},s=d(o,["format"]);s!=null&&h(t,["predictionsFormat"],s);const a=d(o,["gcsUri"]);a!=null&&h(t,["gcsDestination","outputUriPrefix"],a);const r=d(o,["bigqueryUri"]);if(r!=null&&h(t,["bigqueryDestination","outputUri"],r),d(o,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(o,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(o,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function ji(o){const t={},s=d(o,["name"]);s!=null&&h(t,["name"],s);const a=d(o,["metadata","displayName"]);a!=null&&h(t,["displayName"],a);const r=d(o,["metadata","state"]);r!=null&&h(t,["state"],Gg(r));const u=d(o,["metadata","createTime"]);u!=null&&h(t,["createTime"],u);const p=d(o,["metadata","endTime"]);p!=null&&h(t,["endTime"],p);const y=d(o,["metadata","updateTime"]);y!=null&&h(t,["updateTime"],y);const x=d(o,["metadata","model"]);x!=null&&h(t,["model"],x);const m=d(o,["metadata","output"]);return m!=null&&h(t,["dest"],Sv(qg(m))),t}function Mu(o){const t={},s=d(o,["name"]);s!=null&&h(t,["name"],s);const a=d(o,["displayName"]);a!=null&&h(t,["displayName"],a);const r=d(o,["state"]);r!=null&&h(t,["state"],Gg(r));const u=d(o,["error"]);u!=null&&h(t,["error"],u);const p=d(o,["createTime"]);p!=null&&h(t,["createTime"],p);const y=d(o,["startTime"]);y!=null&&h(t,["startTime"],y);const x=d(o,["endTime"]);x!=null&&h(t,["endTime"],x);const m=d(o,["updateTime"]);m!=null&&h(t,["updateTime"],m);const v=d(o,["model"]);v!=null&&h(t,["model"],v);const b=d(o,["inputConfig"]);b!=null&&h(t,["src"],wv(b));const S=d(o,["outputConfig"]);return S!=null&&h(t,["dest"],Ev(qg(S))),t}function wv(o){const t={},s=d(o,["instancesFormat"]);s!=null&&h(t,["format"],s);const a=d(o,["gcsSource","uris"]);a!=null&&h(t,["gcsUri"],a);const r=d(o,["bigquerySource","inputUri"]);return r!=null&&h(t,["bigqueryUri"],r),t}function Nv(o,t){const s={};if(d(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const a=d(t,["fileName"]);a!=null&&h(s,["fileName"],a);const r=d(t,["inlinedRequests"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>Wv(o,p))),h(s,["requests","requests"],u)}return s}function Av(o){const t={},s=d(o,["format"]);s!=null&&h(t,["instancesFormat"],s);const a=d(o,["gcsUri"]);a!=null&&h(t,["gcsSource","uris"],a);const r=d(o,["bigqueryUri"]);if(r!=null&&h(t,["bigquerySource","inputUri"],r),d(o,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(o,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function _v(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["data"]);s!=null&&h(t,["data"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function Mv(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Ts(o,a)),s}function Rv(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Ts(o,a)),s}function Iv(o){const t={},s=d(o,["content"]);s!=null&&h(t,["content"],s);const a=d(o,["citationMetadata"]);a!=null&&h(t,["citationMetadata"],kv(a));const r=d(o,["tokenCount"]);r!=null&&h(t,["tokenCount"],r);const u=d(o,["finishReason"]);u!=null&&h(t,["finishReason"],u);const p=d(o,["urlContextMetadata"]);p!=null&&h(t,["urlContextMetadata"],p);const y=d(o,["avgLogprobs"]);y!=null&&h(t,["avgLogprobs"],y);const x=d(o,["groundingMetadata"]);x!=null&&h(t,["groundingMetadata"],x);const m=d(o,["index"]);m!=null&&h(t,["index"],m);const v=d(o,["logprobsResult"]);v!=null&&h(t,["logprobsResult"],v);const b=d(o,["safetyRatings"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(N=>N)),h(t,["safetyRatings"],S)}return t}function kv(o){const t={},s=d(o,["citationSources"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(r=>r)),h(t,["citations"],a)}return t}function Vg(o){const t={},s=d(o,["parts"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(u=>ab(u))),h(t,["parts"],r)}const a=d(o,["role"]);return a!=null&&h(t,["role"],a),t}function Dv(o,t){const s={},a=d(o,["displayName"]);if(t!==void 0&&a!=null&&h(t,["batch","displayName"],a),d(o,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return s}function Lv(o,t){const s={},a=d(o,["displayName"]);t!==void 0&&a!=null&&h(t,["displayName"],a);const r=d(o,["dest"]);return t!==void 0&&r!=null&&h(t,["outputConfig"],Tv(Cv(r))),s}function Pm(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["src"]);r!=null&&h(s,["batch","inputConfig"],Nv(o,Bg(o,r)));const u=d(t,["config"]);return u!=null&&Dv(u,s),s}function jv(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["model"],Nt(o,a));const r=d(t,["src"]);r!=null&&h(s,["inputConfig"],Av(Bg(o,r)));const u=d(t,["config"]);return u!=null&&Lv(u,s),s}function Uv(o,t){const s={},a=d(o,["displayName"]);return t!==void 0&&a!=null&&h(t,["batch","displayName"],a),s}function zv(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["src"]);r!=null&&h(s,["batch","inputConfig"],Ov(o,r));const u=d(t,["config"]);return u!=null&&Uv(u,s),s}function Pv(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Ts(o,a)),s}function Bv(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Ts(o,a)),s}function qv(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["name"]);a!=null&&h(t,["name"],a);const r=d(o,["done"]);r!=null&&h(t,["done"],r);const u=d(o,["error"]);return u!=null&&h(t,["error"],u),t}function Gv(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["name"]);a!=null&&h(t,["name"],a);const r=d(o,["done"]);r!=null&&h(t,["done"],r);const u=d(o,["error"]);return u!=null&&h(t,["error"],u),t}function Vv(o,t){const s={},a=d(t,["contents"]);if(a!=null){let u=Pu(o,a);Array.isArray(u)&&(u=u.map(p=>p)),h(s,["requests[]","request","content"],u)}const r=d(t,["config"]);return r!=null&&(h(s,["_self"],Hv(r,s)),F0(s,{"requests[].*":"requests[].request.*"})),s}function Hv(o,t){const s={},a=d(o,["taskType"]);t!==void 0&&a!=null&&h(t,["requests[]","taskType"],a);const r=d(o,["title"]);t!==void 0&&r!=null&&h(t,["requests[]","title"],r);const u=d(o,["outputDimensionality"]);if(t!==void 0&&u!=null&&h(t,["requests[]","outputDimensionality"],u),d(o,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(o,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return s}function Ov(o,t){const s={},a=d(t,["fileName"]);a!=null&&h(s,["file_name"],a);const r=d(t,["inlinedRequests"]);return r!=null&&h(s,["requests"],Vv(o,r)),s}function Fv(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["fileUri"]);s!=null&&h(t,["fileUri"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function Yv(o,t,s){const a={},r=d(t,["systemInstruction"]);s!==void 0&&r!=null&&h(s,["systemInstruction"],Vg(An(r)));const u=d(t,["temperature"]);u!=null&&h(a,["temperature"],u);const p=d(t,["topP"]);p!=null&&h(a,["topP"],p);const y=d(t,["topK"]);y!=null&&h(a,["topK"],y);const x=d(t,["candidateCount"]);x!=null&&h(a,["candidateCount"],x);const m=d(t,["maxOutputTokens"]);m!=null&&h(a,["maxOutputTokens"],m);const v=d(t,["stopSequences"]);v!=null&&h(a,["stopSequences"],v);const b=d(t,["responseLogprobs"]);b!=null&&h(a,["responseLogprobs"],b);const S=d(t,["logprobs"]);S!=null&&h(a,["logprobs"],S);const N=d(t,["presencePenalty"]);N!=null&&h(a,["presencePenalty"],N);const _=d(t,["frequencyPenalty"]);_!=null&&h(a,["frequencyPenalty"],_);const M=d(t,["seed"]);M!=null&&h(a,["seed"],M);const G=d(t,["responseMimeType"]);G!=null&&h(a,["responseMimeType"],G);const k=d(t,["responseSchema"]);k!=null&&h(a,["responseSchema"],Bu(k));const V=d(t,["responseJsonSchema"]);if(V!=null&&h(a,["responseJsonSchema"],V),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=d(t,["safetySettings"]);if(s!==void 0&&R!=null){let L=R;Array.isArray(L)&&(L=L.map(H=>ib(H))),h(s,["safetySettings"],L)}const B=d(t,["tools"]);if(s!==void 0&&B!=null){let L=Es(B);Array.isArray(L)&&(L=L.map(H=>rb(Ss(H)))),h(s,["tools"],L)}const U=d(t,["toolConfig"]);if(s!==void 0&&U!=null&&h(s,["toolConfig"],U),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const $=d(t,["cachedContent"]);s!==void 0&&$!=null&&h(s,["cachedContent"],Po(o,$));const D=d(t,["responseModalities"]);D!=null&&h(a,["responseModalities"],D);const E=d(t,["mediaResolution"]);E!=null&&h(a,["mediaResolution"],E);const K=d(t,["speechConfig"]);if(K!=null&&h(a,["speechConfig"],qu(K)),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const I=d(t,["thinkingConfig"]);I!=null&&h(a,["thinkingConfig"],I);const X=d(t,["imageConfig"]);return X!=null&&h(a,["imageConfig"],X),a}function Jv(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["candidates"]);if(a!=null){let x=a;Array.isArray(x)&&(x=x.map(m=>Iv(m))),h(t,["candidates"],x)}const r=d(o,["modelVersion"]);r!=null&&h(t,["modelVersion"],r);const u=d(o,["promptFeedback"]);u!=null&&h(t,["promptFeedback"],u);const p=d(o,["responseId"]);p!=null&&h(t,["responseId"],p);const y=d(o,["usageMetadata"]);return y!=null&&h(t,["usageMetadata"],y),t}function Xv(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Ts(o,a)),s}function Kv(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Ts(o,a)),s}function $v(o){const t={};if(d(o,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=d(o,["enableWidget"]);return s!=null&&h(t,["enableWidget"],s),t}function Zv(o){const t={},s=d(o,["timeRangeFilter"]);if(s!=null&&h(t,["timeRangeFilter"],s),d(o,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return t}function Wv(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["request","model"],Nt(o,a));const r=d(t,["contents"]);if(r!=null){let y=lo(r);Array.isArray(y)&&(y=y.map(x=>Vg(x))),h(s,["request","contents"],y)}const u=d(t,["metadata"]);u!=null&&h(s,["metadata"],u);const p=d(t,["config"]);return p!=null&&h(s,["request","generationConfig"],Yv(o,p,d(s,["request"],{}))),s}function Qv(o){const t={},s=d(o,["response"]);s!=null&&h(t,["response"],Jv(s));const a=d(o,["error"]);return a!=null&&h(t,["error"],a),t}function eb(o,t){const s={},a=d(o,["pageSize"]);t!==void 0&&a!=null&&h(t,["_query","pageSize"],a);const r=d(o,["pageToken"]);if(t!==void 0&&r!=null&&h(t,["_query","pageToken"],r),d(o,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return s}function tb(o,t){const s={},a=d(o,["pageSize"]);t!==void 0&&a!=null&&h(t,["_query","pageSize"],a);const r=d(o,["pageToken"]);t!==void 0&&r!=null&&h(t,["_query","pageToken"],r);const u=d(o,["filter"]);return t!==void 0&&u!=null&&h(t,["_query","filter"],u),s}function nb(o){const t={},s=d(o,["config"]);return s!=null&&eb(s,t),t}function ob(o){const t={},s=d(o,["config"]);return s!=null&&tb(s,t),t}function lb(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["nextPageToken"]);a!=null&&h(t,["nextPageToken"],a);const r=d(o,["operations"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>ji(p))),h(t,["batchJobs"],u)}return t}function sb(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["nextPageToken"]);a!=null&&h(t,["nextPageToken"],a);const r=d(o,["batchPredictionJobs"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>Mu(p))),h(t,["batchJobs"],u)}return t}function ab(o){const t={},s=d(o,["videoMetadata"]);s!=null&&h(t,["videoMetadata"],s);const a=d(o,["thought"]);a!=null&&h(t,["thought"],a);const r=d(o,["inlineData"]);r!=null&&h(t,["inlineData"],_v(r));const u=d(o,["fileData"]);u!=null&&h(t,["fileData"],Fv(u));const p=d(o,["thoughtSignature"]);p!=null&&h(t,["thoughtSignature"],p);const y=d(o,["functionCall"]);y!=null&&h(t,["functionCall"],y);const x=d(o,["codeExecutionResult"]);x!=null&&h(t,["codeExecutionResult"],x);const m=d(o,["executableCode"]);m!=null&&h(t,["executableCode"],m);const v=d(o,["functionResponse"]);v!=null&&h(t,["functionResponse"],v);const b=d(o,["text"]);return b!=null&&h(t,["text"],b),t}function ib(o){const t={};if(d(o,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=d(o,["category"]);s!=null&&h(t,["category"],s);const a=d(o,["threshold"]);return a!=null&&h(t,["threshold"],a),t}function rb(o){const t={},s=d(o,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),h(t,["functionDeclarations"],m)}if(d(o,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=d(o,["googleSearch"]);a!=null&&h(t,["googleSearch"],Zv(a));const r=d(o,["googleSearchRetrieval"]);if(r!=null&&h(t,["googleSearchRetrieval"],r),d(o,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=d(o,["googleMaps"]);u!=null&&h(t,["googleMaps"],$v(u));const p=d(o,["urlContext"]);p!=null&&h(t,["urlContext"],p);const y=d(o,["computerUse"]);y!=null&&h(t,["computerUse"],y);const x=d(o,["codeExecution"]);return x!=null&&h(t,["codeExecution"],x),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Dl;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Dl||(Dl={}));class Sa{constructor(t,s,a,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=s,this.init(t,a,r)}init(t,s,a){var r,u;this.nameInternal=t,this.pageInternal=s[this.nameInternal]||[],this.sdkHttpResponseInternal=s==null?void 0:s.sdkHttpResponse,this.idxInternal=0;let p={config:{}};!a||Object.keys(a).length===0?p={config:{}}:typeof a=="object"?p=Object.assign({},a):p=a,p.config&&(p.config.pageToken=s.nextPageToken),this.paramsInternal=p,this.pageInternalSize=(u=(r=p.config)===null||r===void 0?void 0:r.pageSize)!==null&&u!==void 0?u:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cb extends jl{constructor(t){super(),this.apiClient=t,this.create=async s=>(this.apiClient.isVertexAI()&&(s.config=this.formatDestination(s.src,s.config)),this.createInternal(s)),this.createEmbeddings=async s=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(s)},this.list=async(s={})=>new Sa(Dl.PAGED_ITEM_BATCH_JOBS,a=>this.listInternal(a),await this.listInternal(s),s)}createInlinedGenerateContentRequest(t){const s=Pm(this.apiClient,t),a=s._url,r=Pe("{model}:batchGenerateContent",a),y=s.batch.inputConfig.requests,x=y.requests,m=[];for(const v of x){const b=Object.assign({},v);if(b.systemInstruction){const S=b.systemInstruction;delete b.systemInstruction;const N=b.request;N.systemInstruction=S,b.request=N}m.push(b)}return y.requests=m,delete s.config,delete s._url,delete s._query,{path:r,body:s}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,s){const a=s?Object.assign({},s):{},r=Date.now().toString();if(a.displayName||(a.displayName=`genaiBatchJob_${r}`),a.dest===void 0){const u=this.getGcsUri(t),p=this.getBigqueryUri(t);if(u)u.endsWith(".jsonl")?a.dest=`${u.slice(0,-6)}/dest`:a.dest=`${u}_dest_${r}`;else if(p)a.dest=`${p}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return a}async createInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=jv(this.apiClient,t);return y=Pe("batchPredictionJobs",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json()),p.then(v=>Mu(v))}else{const m=Pm(this.apiClient,t);return y=Pe("{model}:batchGenerateContent",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json()),p.then(v=>ji(v))}}async createEmbeddingsInternal(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=zv(this.apiClient,t);return u=Pe("{model}:asyncBatchEmbedContent",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json()),r.then(x=>ji(x))}}async get(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=Kv(this.apiClient,t);return y=Pe("batchPredictionJobs/{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json()),p.then(v=>Mu(v))}else{const m=Xv(this.apiClient,t);return y=Pe("batches/{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json()),p.then(v=>ji(v))}}async cancel(t){var s,a,r,u;let p="",y={};if(this.apiClient.isVertexAI()){const x=Rv(this.apiClient,t);p=Pe("batchPredictionJobs/{name}:cancel",x._url),y=x._query,delete x._url,delete x._query,await this.apiClient.request({path:p,queryParams:y,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal})}else{const x=Mv(this.apiClient,t);p=Pe("batches/{name}:cancel",x._url),y=x._query,delete x._url,delete x._query,await this.apiClient.request({path:p,queryParams:y,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal})}}async listInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=ob(t);return y=Pe("batchPredictionJobs",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=sb(v),S=new Lm;return Object.assign(S,b),S})}else{const m=nb(t);return y=Pe("batches",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=lb(v),S=new Lm;return Object.assign(S,b),S})}}async delete(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=Bv(this.apiClient,t);return y=Pe("batchPredictionJobs/{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>Gv(v))}else{const m=Pv(this.apiClient,t);return y=Pe("batches/{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>qv(v))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ub(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["data"]);s!=null&&h(t,["data"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function Bm(o){const t={},s=d(o,["parts"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(u=>Ib(u))),h(t,["parts"],r)}const a=d(o,["role"]);return a!=null&&h(t,["role"],a),t}function db(o,t){const s={},a=d(o,["ttl"]);t!==void 0&&a!=null&&h(t,["ttl"],a);const r=d(o,["expireTime"]);t!==void 0&&r!=null&&h(t,["expireTime"],r);const u=d(o,["displayName"]);t!==void 0&&u!=null&&h(t,["displayName"],u);const p=d(o,["contents"]);if(t!==void 0&&p!=null){let v=lo(p);Array.isArray(v)&&(v=v.map(b=>Bm(b))),h(t,["contents"],v)}const y=d(o,["systemInstruction"]);t!==void 0&&y!=null&&h(t,["systemInstruction"],Bm(An(y)));const x=d(o,["tools"]);if(t!==void 0&&x!=null){let v=x;Array.isArray(v)&&(v=v.map(b=>kb(b))),h(t,["tools"],v)}const m=d(o,["toolConfig"]);if(t!==void 0&&m!=null&&h(t,["toolConfig"],m),d(o,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return s}function fb(o,t){const s={},a=d(o,["ttl"]);t!==void 0&&a!=null&&h(t,["ttl"],a);const r=d(o,["expireTime"]);t!==void 0&&r!=null&&h(t,["expireTime"],r);const u=d(o,["displayName"]);t!==void 0&&u!=null&&h(t,["displayName"],u);const p=d(o,["contents"]);if(t!==void 0&&p!=null){let b=lo(p);Array.isArray(b)&&(b=b.map(S=>S)),h(t,["contents"],b)}const y=d(o,["systemInstruction"]);t!==void 0&&y!=null&&h(t,["systemInstruction"],An(y));const x=d(o,["tools"]);if(t!==void 0&&x!=null){let b=x;Array.isArray(b)&&(b=b.map(S=>Db(S))),h(t,["tools"],b)}const m=d(o,["toolConfig"]);t!==void 0&&m!=null&&h(t,["toolConfig"],m);const v=d(o,["kmsKeyName"]);return t!==void 0&&v!=null&&h(t,["encryption_spec","kmsKeyName"],v),s}function hb(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["model"],Rg(o,a));const r=d(t,["config"]);return r!=null&&db(r,s),s}function pb(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["model"],Rg(o,a));const r=d(t,["config"]);return r!=null&&fb(r,s),s}function mb(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Po(o,a)),s}function gb(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Po(o,a)),s}function yb(o){const t={},s=d(o,["sdkHttpResponse"]);return s!=null&&h(t,["sdkHttpResponse"],s),t}function xb(o){const t={},s=d(o,["sdkHttpResponse"]);return s!=null&&h(t,["sdkHttpResponse"],s),t}function vb(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["fileUri"]);s!=null&&h(t,["fileUri"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function bb(o){const t={};if(d(o,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const s=d(o,["description"]);s!=null&&h(t,["description"],s);const a=d(o,["name"]);a!=null&&h(t,["name"],a);const r=d(o,["parameters"]);r!=null&&h(t,["parameters"],r);const u=d(o,["parametersJsonSchema"]);u!=null&&h(t,["parametersJsonSchema"],u);const p=d(o,["response"]);p!=null&&h(t,["response"],p);const y=d(o,["responseJsonSchema"]);return y!=null&&h(t,["responseJsonSchema"],y),t}function Cb(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Po(o,a)),s}function Sb(o,t){const s={},a=d(t,["name"]);return a!=null&&h(s,["_url","name"],Po(o,a)),s}function Eb(o){const t={};if(d(o,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=d(o,["enableWidget"]);return s!=null&&h(t,["enableWidget"],s),t}function Tb(o){const t={},s=d(o,["timeRangeFilter"]);if(s!=null&&h(t,["timeRangeFilter"],s),d(o,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return t}function wb(o,t){const s={},a=d(o,["pageSize"]);t!==void 0&&a!=null&&h(t,["_query","pageSize"],a);const r=d(o,["pageToken"]);return t!==void 0&&r!=null&&h(t,["_query","pageToken"],r),s}function Nb(o,t){const s={},a=d(o,["pageSize"]);t!==void 0&&a!=null&&h(t,["_query","pageSize"],a);const r=d(o,["pageToken"]);return t!==void 0&&r!=null&&h(t,["_query","pageToken"],r),s}function Ab(o){const t={},s=d(o,["config"]);return s!=null&&wb(s,t),t}function _b(o){const t={},s=d(o,["config"]);return s!=null&&Nb(s,t),t}function Mb(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["nextPageToken"]);a!=null&&h(t,["nextPageToken"],a);const r=d(o,["cachedContents"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>p)),h(t,["cachedContents"],u)}return t}function Rb(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["nextPageToken"]);a!=null&&h(t,["nextPageToken"],a);const r=d(o,["cachedContents"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>p)),h(t,["cachedContents"],u)}return t}function Ib(o){const t={},s=d(o,["videoMetadata"]);s!=null&&h(t,["videoMetadata"],s);const a=d(o,["thought"]);a!=null&&h(t,["thought"],a);const r=d(o,["inlineData"]);r!=null&&h(t,["inlineData"],ub(r));const u=d(o,["fileData"]);u!=null&&h(t,["fileData"],vb(u));const p=d(o,["thoughtSignature"]);p!=null&&h(t,["thoughtSignature"],p);const y=d(o,["functionCall"]);y!=null&&h(t,["functionCall"],y);const x=d(o,["codeExecutionResult"]);x!=null&&h(t,["codeExecutionResult"],x);const m=d(o,["executableCode"]);m!=null&&h(t,["executableCode"],m);const v=d(o,["functionResponse"]);v!=null&&h(t,["functionResponse"],v);const b=d(o,["text"]);return b!=null&&h(t,["text"],b),t}function kb(o){const t={},s=d(o,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),h(t,["functionDeclarations"],m)}if(d(o,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=d(o,["googleSearch"]);a!=null&&h(t,["googleSearch"],Tb(a));const r=d(o,["googleSearchRetrieval"]);if(r!=null&&h(t,["googleSearchRetrieval"],r),d(o,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=d(o,["googleMaps"]);u!=null&&h(t,["googleMaps"],Eb(u));const p=d(o,["urlContext"]);p!=null&&h(t,["urlContext"],p);const y=d(o,["computerUse"]);y!=null&&h(t,["computerUse"],y);const x=d(o,["codeExecution"]);return x!=null&&h(t,["codeExecution"],x),t}function Db(o){const t={},s=d(o,["functionDeclarations"]);if(s!=null){let b=s;Array.isArray(b)&&(b=b.map(S=>bb(S))),h(t,["functionDeclarations"],b)}const a=d(o,["retrieval"]);a!=null&&h(t,["retrieval"],a);const r=d(o,["googleSearch"]);r!=null&&h(t,["googleSearch"],r);const u=d(o,["googleSearchRetrieval"]);u!=null&&h(t,["googleSearchRetrieval"],u);const p=d(o,["enterpriseWebSearch"]);p!=null&&h(t,["enterpriseWebSearch"],p);const y=d(o,["googleMaps"]);y!=null&&h(t,["googleMaps"],y);const x=d(o,["urlContext"]);x!=null&&h(t,["urlContext"],x);const m=d(o,["computerUse"]);m!=null&&h(t,["computerUse"],m);const v=d(o,["codeExecution"]);return v!=null&&h(t,["codeExecution"],v),t}function Lb(o,t){const s={},a=d(o,["ttl"]);t!==void 0&&a!=null&&h(t,["ttl"],a);const r=d(o,["expireTime"]);return t!==void 0&&r!=null&&h(t,["expireTime"],r),s}function jb(o,t){const s={},a=d(o,["ttl"]);t!==void 0&&a!=null&&h(t,["ttl"],a);const r=d(o,["expireTime"]);return t!==void 0&&r!=null&&h(t,["expireTime"],r),s}function Ub(o,t){const s={},a=d(t,["name"]);a!=null&&h(s,["_url","name"],Po(o,a));const r=d(t,["config"]);return r!=null&&Lb(r,s),s}function zb(o,t){const s={},a=d(t,["name"]);a!=null&&h(s,["_url","name"],Po(o,a));const r=d(t,["config"]);return r!=null&&jb(r,s),s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pb extends jl{constructor(t){super(),this.apiClient=t,this.list=async(s={})=>new Sa(Dl.PAGED_ITEM_CACHED_CONTENTS,a=>this.listInternal(a),await this.listInternal(s),s)}async create(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=pb(this.apiClient,t);return y=Pe("cachedContents",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json()),p.then(v=>v)}else{const m=hb(this.apiClient,t);return y=Pe("cachedContents",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json()),p.then(v=>v)}}async get(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=Sb(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json()),p.then(v=>v)}else{const m=Cb(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json()),p.then(v=>v)}}async delete(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=gb(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=xb(v),S=new km;return Object.assign(S,b),S})}else{const m=mb(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=yb(v),S=new km;return Object.assign(S,b),S})}}async update(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=zb(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json()),p.then(v=>v)}else{const m=Ub(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json()),p.then(v=>v)}}async listInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=_b(t);return y=Pe("cachedContents",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=Rb(v),S=new Dm;return Object.assign(S,b),S})}else{const m=Ab(t);return y=Pe("cachedContents",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=Mb(v),S=new Dm;return Object.assign(S,b),S})}}}function qm(o){var t=typeof Symbol=="function"&&Symbol.iterator,s=t&&o[t],a=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&a>=o.length&&(o=void 0),{value:o&&o[a++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kt(o){return this instanceof Kt?(this.v=o,this):new Kt(o)}function xs(o,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=s.apply(o,t||[]),r,u=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),y("next"),y("throw"),y("return",p),r[Symbol.asyncIterator]=function(){return this},r;function p(N){return function(_){return Promise.resolve(_).then(N,b)}}function y(N,_){a[N]&&(r[N]=function(M){return new Promise(function(G,k){u.push([N,M,G,k])>1||x(N,M)})},_&&(r[N]=_(r[N])))}function x(N,_){try{m(a[N](_))}catch(M){S(u[0][3],M)}}function m(N){N.value instanceof Kt?Promise.resolve(N.value.v).then(v,b):S(u[0][2],N)}function v(N){x("next",N)}function b(N){x("throw",N)}function S(N,_){N(_),u.shift(),u.length&&x(u[0][0],u[0][1])}}function ba(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],s;return t?t.call(o):(o=typeof qm=="function"?qm(o):o[Symbol.iterator](),s={},a("next"),a("throw"),a("return"),s[Symbol.asyncIterator]=function(){return this},s);function a(u){s[u]=o[u]&&function(p){return new Promise(function(y,x){p=o[u](p),r(y,x,p.done,p.value)})}}function r(u,p,y,x){Promise.resolve(x).then(function(m){u({value:m,done:y})},p)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bb(o){var t;if(o.candidates==null||o.candidates.length===0)return!1;const s=(t=o.candidates[0])===null||t===void 0?void 0:t.content;return s===void 0?!1:Hg(s)}function Hg(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const t of o.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function qb(o){if(o.length!==0){for(const t of o)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function Gm(o){if(o===void 0||o.length===0)return[];const t=[],s=o.length;let a=0;for(;a<s;)if(o[a].role==="user")t.push(o[a]),a++;else{const r=[];let u=!0;for(;a<s&&o[a].role==="model";)r.push(o[a]),u&&!Hg(o[a])&&(u=!1),a++;u?t.push(...r):t.pop()}return t}class Gb{constructor(t,s){this.modelsModule=t,this.apiClient=s}create(t){return new Vb(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class Vb{constructor(t,s,a,r={},u=[]){this.apiClient=t,this.modelsModule=s,this.model=a,this.config=r,this.history=u,this.sendPromise=Promise.resolve(),qb(u)}async sendMessage(t){var s;await this.sendPromise;const a=An(t.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(a),config:(s=t.config)!==null&&s!==void 0?s:this.config});return this.sendPromise=(async()=>{var u,p,y;const x=await r,m=(p=(u=x.candidates)===null||u===void 0?void 0:u[0])===null||p===void 0?void 0:p.content,v=x.automaticFunctionCallingHistory,b=this.getHistory(!0).length;let S=[];v!=null&&(S=(y=v.slice(b))!==null&&y!==void 0?y:[]);const N=m?[m]:[];this.recordHistory(a,N,S)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(t){var s;await this.sendPromise;const a=An(t.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(a),config:(s=t.config)!==null&&s!==void 0?s:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const u=await r;return this.processStreamResponse(u,a)}getHistory(t=!1){const s=t?Gm(this.history):this.history;return structuredClone(s)}processStreamResponse(t,s){var a,r;return xs(this,arguments,function*(){var p,y,x,m;const v=[];try{for(var b=!0,S=ba(t),N;N=yield Kt(S.next()),p=N.done,!p;b=!0){m=N.value,b=!1;const _=m;if(Bb(_)){const M=(r=(a=_.candidates)===null||a===void 0?void 0:a[0])===null||r===void 0?void 0:r.content;M!==void 0&&v.push(M)}yield yield Kt(_)}}catch(_){y={error:_}}finally{try{!b&&!p&&(x=S.return)&&(yield Kt(x.call(S)))}finally{if(y)throw y.error}}this.recordHistory(s,v)})}recordHistory(t,s,a){let r=[];s.length>0&&s.every(u=>u.role!==void 0)?r=s:r.push({role:"model",parts:[]}),a&&a.length>0?this.history.push(...Gm(a)):this.history.push(t),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hi extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Hi.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hb(o){const t={},s=d(o,["file"]);return s!=null&&h(t,["file"],s),t}function Ob(o){const t={},s=d(o,["sdkHttpResponse"]);return s!=null&&h(t,["sdkHttpResponse"],s),t}function Fb(o){const t={},s=d(o,["name"]);return s!=null&&h(t,["_url","file"],Ug(s)),t}function Yb(o){const t={},s=d(o,["sdkHttpResponse"]);return s!=null&&h(t,["sdkHttpResponse"],s),t}function Jb(o){const t={},s=d(o,["name"]);return s!=null&&h(t,["_url","file"],Ug(s)),t}function Xb(o,t){const s={},a=d(o,["pageSize"]);t!==void 0&&a!=null&&h(t,["_query","pageSize"],a);const r=d(o,["pageToken"]);return t!==void 0&&r!=null&&h(t,["_query","pageToken"],r),s}function Kb(o){const t={},s=d(o,["config"]);return s!=null&&Xb(s,t),t}function $b(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["nextPageToken"]);a!=null&&h(t,["nextPageToken"],a);const r=d(o,["files"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>p)),h(t,["files"],u)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zb extends jl{constructor(t){super(),this.apiClient=t,this.list=async(s={})=>new Sa(Dl.PAGED_ITEM_FILES,a=>this.listInternal(a),await this.listInternal(s),s)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(s=>s)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=Kb(t);return u=Pe("files",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:x.headers},v})),r.then(x=>{const m=$b(x),v=new rv;return Object.assign(v,m),v})}}async createInternal(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=Hb(t);return u=Pe("upload/v1beta/files",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json()),r.then(x=>{const m=Ob(x),v=new cv;return Object.assign(v,m),v})}}async get(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=Jb(t);return u=Pe("files/{file}",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json()),r.then(x=>x)}}async delete(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=Fb(t);return u=Pe("files/{file}",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"DELETE",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:x.headers},v})),r.then(x=>{const m=Yb(x),v=new uv;return Object.assign(v,m),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ui(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["data"]);s!=null&&h(t,["data"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function Wb(o){const t={},s=d(o,["parts"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(u=>hC(u))),h(t,["parts"],r)}const a=d(o,["role"]);return a!=null&&h(t,["role"],a),t}function Qb(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["fileUri"]);s!=null&&h(t,["fileUri"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function eC(o){const t={};if(d(o,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const s=d(o,["description"]);s!=null&&h(t,["description"],s);const a=d(o,["name"]);a!=null&&h(t,["name"],a);const r=d(o,["parameters"]);r!=null&&h(t,["parameters"],r);const u=d(o,["parametersJsonSchema"]);u!=null&&h(t,["parametersJsonSchema"],u);const p=d(o,["response"]);p!=null&&h(t,["response"],p);const y=d(o,["responseJsonSchema"]);return y!=null&&h(t,["responseJsonSchema"],y),t}function tC(o){const t={},s=d(o,["modelSelectionConfig"]);s!=null&&h(t,["modelConfig"],s);const a=d(o,["audioTimestamp"]);a!=null&&h(t,["audioTimestamp"],a);const r=d(o,["candidateCount"]);r!=null&&h(t,["candidateCount"],r);const u=d(o,["enableAffectiveDialog"]);u!=null&&h(t,["enableAffectiveDialog"],u);const p=d(o,["frequencyPenalty"]);p!=null&&h(t,["frequencyPenalty"],p);const y=d(o,["logprobs"]);y!=null&&h(t,["logprobs"],y);const x=d(o,["maxOutputTokens"]);x!=null&&h(t,["maxOutputTokens"],x);const m=d(o,["mediaResolution"]);m!=null&&h(t,["mediaResolution"],m);const v=d(o,["presencePenalty"]);v!=null&&h(t,["presencePenalty"],v);const b=d(o,["responseJsonSchema"]);b!=null&&h(t,["responseJsonSchema"],b);const S=d(o,["responseLogprobs"]);S!=null&&h(t,["responseLogprobs"],S);const N=d(o,["responseMimeType"]);N!=null&&h(t,["responseMimeType"],N);const _=d(o,["responseModalities"]);_!=null&&h(t,["responseModalities"],_);const M=d(o,["responseSchema"]);M!=null&&h(t,["responseSchema"],M);const G=d(o,["routingConfig"]);G!=null&&h(t,["routingConfig"],G);const k=d(o,["seed"]);k!=null&&h(t,["seed"],k);const V=d(o,["speechConfig"]);V!=null&&h(t,["speechConfig"],Og(V));const R=d(o,["stopSequences"]);R!=null&&h(t,["stopSequences"],R);const B=d(o,["temperature"]);B!=null&&h(t,["temperature"],B);const U=d(o,["thinkingConfig"]);U!=null&&h(t,["thinkingConfig"],U);const $=d(o,["topK"]);$!=null&&h(t,["topK"],$);const D=d(o,["topP"]);if(D!=null&&h(t,["topP"],D),d(o,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function nC(o){const t={};if(d(o,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=d(o,["enableWidget"]);return s!=null&&h(t,["enableWidget"],s),t}function oC(o){const t={},s=d(o,["timeRangeFilter"]);if(s!=null&&h(t,["timeRangeFilter"],s),d(o,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return t}function lC(o,t){const s={},a=d(o,["generationConfig"]);t!==void 0&&a!=null&&h(t,["setup","generationConfig"],a);const r=d(o,["responseModalities"]);t!==void 0&&r!=null&&h(t,["setup","generationConfig","responseModalities"],r);const u=d(o,["temperature"]);t!==void 0&&u!=null&&h(t,["setup","generationConfig","temperature"],u);const p=d(o,["topP"]);t!==void 0&&p!=null&&h(t,["setup","generationConfig","topP"],p);const y=d(o,["topK"]);t!==void 0&&y!=null&&h(t,["setup","generationConfig","topK"],y);const x=d(o,["maxOutputTokens"]);t!==void 0&&x!=null&&h(t,["setup","generationConfig","maxOutputTokens"],x);const m=d(o,["mediaResolution"]);t!==void 0&&m!=null&&h(t,["setup","generationConfig","mediaResolution"],m);const v=d(o,["seed"]);t!==void 0&&v!=null&&h(t,["setup","generationConfig","seed"],v);const b=d(o,["speechConfig"]);t!==void 0&&b!=null&&h(t,["setup","generationConfig","speechConfig"],Gu(b));const S=d(o,["thinkingConfig"]);t!==void 0&&S!=null&&h(t,["setup","generationConfig","thinkingConfig"],S);const N=d(o,["enableAffectiveDialog"]);t!==void 0&&N!=null&&h(t,["setup","generationConfig","enableAffectiveDialog"],N);const _=d(o,["systemInstruction"]);t!==void 0&&_!=null&&h(t,["setup","systemInstruction"],Wb(An(_)));const M=d(o,["tools"]);if(t!==void 0&&M!=null){let $=Es(M);Array.isArray($)&&($=$.map(D=>mC(Ss(D)))),h(t,["setup","tools"],$)}const G=d(o,["sessionResumption"]);t!==void 0&&G!=null&&h(t,["setup","sessionResumption"],pC(G));const k=d(o,["inputAudioTranscription"]);t!==void 0&&k!=null&&h(t,["setup","inputAudioTranscription"],k);const V=d(o,["outputAudioTranscription"]);t!==void 0&&V!=null&&h(t,["setup","outputAudioTranscription"],V);const R=d(o,["realtimeInputConfig"]);t!==void 0&&R!=null&&h(t,["setup","realtimeInputConfig"],R);const B=d(o,["contextWindowCompression"]);t!==void 0&&B!=null&&h(t,["setup","contextWindowCompression"],B);const U=d(o,["proactivity"]);return t!==void 0&&U!=null&&h(t,["setup","proactivity"],U),s}function sC(o,t){const s={},a=d(o,["generationConfig"]);t!==void 0&&a!=null&&h(t,["setup","generationConfig"],tC(a));const r=d(o,["responseModalities"]);t!==void 0&&r!=null&&h(t,["setup","generationConfig","responseModalities"],r);const u=d(o,["temperature"]);t!==void 0&&u!=null&&h(t,["setup","generationConfig","temperature"],u);const p=d(o,["topP"]);t!==void 0&&p!=null&&h(t,["setup","generationConfig","topP"],p);const y=d(o,["topK"]);t!==void 0&&y!=null&&h(t,["setup","generationConfig","topK"],y);const x=d(o,["maxOutputTokens"]);t!==void 0&&x!=null&&h(t,["setup","generationConfig","maxOutputTokens"],x);const m=d(o,["mediaResolution"]);t!==void 0&&m!=null&&h(t,["setup","generationConfig","mediaResolution"],m);const v=d(o,["seed"]);t!==void 0&&v!=null&&h(t,["setup","generationConfig","seed"],v);const b=d(o,["speechConfig"]);t!==void 0&&b!=null&&h(t,["setup","generationConfig","speechConfig"],Og(Gu(b)));const S=d(o,["thinkingConfig"]);t!==void 0&&S!=null&&h(t,["setup","generationConfig","thinkingConfig"],S);const N=d(o,["enableAffectiveDialog"]);t!==void 0&&N!=null&&h(t,["setup","generationConfig","enableAffectiveDialog"],N);const _=d(o,["systemInstruction"]);t!==void 0&&_!=null&&h(t,["setup","systemInstruction"],An(_));const M=d(o,["tools"]);if(t!==void 0&&M!=null){let $=Es(M);Array.isArray($)&&($=$.map(D=>gC(Ss(D)))),h(t,["setup","tools"],$)}const G=d(o,["sessionResumption"]);t!==void 0&&G!=null&&h(t,["setup","sessionResumption"],G);const k=d(o,["inputAudioTranscription"]);t!==void 0&&k!=null&&h(t,["setup","inputAudioTranscription"],k);const V=d(o,["outputAudioTranscription"]);t!==void 0&&V!=null&&h(t,["setup","outputAudioTranscription"],V);const R=d(o,["realtimeInputConfig"]);t!==void 0&&R!=null&&h(t,["setup","realtimeInputConfig"],R);const B=d(o,["contextWindowCompression"]);t!==void 0&&B!=null&&h(t,["setup","contextWindowCompression"],B);const U=d(o,["proactivity"]);return t!==void 0&&U!=null&&h(t,["setup","proactivity"],U),s}function aC(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["setup","model"],Nt(o,a));const r=d(t,["config"]);return r!=null&&h(s,["config"],lC(r,s)),s}function iC(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["setup","model"],Nt(o,a));const r=d(t,["config"]);return r!=null&&h(s,["config"],sC(r,s)),s}function rC(o){const t={},s=d(o,["musicGenerationConfig"]);return s!=null&&h(t,["musicGenerationConfig"],s),t}function cC(o){const t={},s=d(o,["weightedPrompts"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(r=>r)),h(t,["weightedPrompts"],a)}return t}function uC(o){const t={},s=d(o,["media"]);if(s!=null){let m=Ig(s);Array.isArray(m)&&(m=m.map(v=>Ui(v))),h(t,["mediaChunks"],m)}const a=d(o,["audio"]);a!=null&&h(t,["audio"],Ui(Dg(a)));const r=d(o,["audioStreamEnd"]);r!=null&&h(t,["audioStreamEnd"],r);const u=d(o,["video"]);u!=null&&h(t,["video"],Ui(kg(u)));const p=d(o,["text"]);p!=null&&h(t,["text"],p);const y=d(o,["activityStart"]);y!=null&&h(t,["activityStart"],y);const x=d(o,["activityEnd"]);return x!=null&&h(t,["activityEnd"],x),t}function dC(o){const t={},s=d(o,["media"]);if(s!=null){let m=Ig(s);Array.isArray(m)&&(m=m.map(v=>v)),h(t,["mediaChunks"],m)}const a=d(o,["audio"]);a!=null&&h(t,["audio"],Dg(a));const r=d(o,["audioStreamEnd"]);r!=null&&h(t,["audioStreamEnd"],r);const u=d(o,["video"]);u!=null&&h(t,["video"],kg(u));const p=d(o,["text"]);p!=null&&h(t,["text"],p);const y=d(o,["activityStart"]);y!=null&&h(t,["activityStart"],y);const x=d(o,["activityEnd"]);return x!=null&&h(t,["activityEnd"],x),t}function fC(o){const t={},s=d(o,["setupComplete"]);s!=null&&h(t,["setupComplete"],s);const a=d(o,["serverContent"]);a!=null&&h(t,["serverContent"],a);const r=d(o,["toolCall"]);r!=null&&h(t,["toolCall"],r);const u=d(o,["toolCallCancellation"]);u!=null&&h(t,["toolCallCancellation"],u);const p=d(o,["usageMetadata"]);p!=null&&h(t,["usageMetadata"],yC(p));const y=d(o,["goAway"]);y!=null&&h(t,["goAway"],y);const x=d(o,["sessionResumptionUpdate"]);return x!=null&&h(t,["sessionResumptionUpdate"],x),t}function hC(o){const t={},s=d(o,["videoMetadata"]);s!=null&&h(t,["videoMetadata"],s);const a=d(o,["thought"]);a!=null&&h(t,["thought"],a);const r=d(o,["inlineData"]);r!=null&&h(t,["inlineData"],Ui(r));const u=d(o,["fileData"]);u!=null&&h(t,["fileData"],Qb(u));const p=d(o,["thoughtSignature"]);p!=null&&h(t,["thoughtSignature"],p);const y=d(o,["functionCall"]);y!=null&&h(t,["functionCall"],y);const x=d(o,["codeExecutionResult"]);x!=null&&h(t,["codeExecutionResult"],x);const m=d(o,["executableCode"]);m!=null&&h(t,["executableCode"],m);const v=d(o,["functionResponse"]);v!=null&&h(t,["functionResponse"],v);const b=d(o,["text"]);return b!=null&&h(t,["text"],b),t}function pC(o){const t={},s=d(o,["handle"]);if(s!=null&&h(t,["handle"],s),d(o,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Og(o){const t={},s=d(o,["voiceConfig"]);if(s!=null&&h(t,["voiceConfig"],s),d(o,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const a=d(o,["languageCode"]);return a!=null&&h(t,["languageCode"],a),t}function mC(o){const t={},s=d(o,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),h(t,["functionDeclarations"],m)}if(d(o,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=d(o,["googleSearch"]);a!=null&&h(t,["googleSearch"],oC(a));const r=d(o,["googleSearchRetrieval"]);if(r!=null&&h(t,["googleSearchRetrieval"],r),d(o,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=d(o,["googleMaps"]);u!=null&&h(t,["googleMaps"],nC(u));const p=d(o,["urlContext"]);p!=null&&h(t,["urlContext"],p);const y=d(o,["computerUse"]);y!=null&&h(t,["computerUse"],y);const x=d(o,["codeExecution"]);return x!=null&&h(t,["codeExecution"],x),t}function gC(o){const t={},s=d(o,["functionDeclarations"]);if(s!=null){let b=s;Array.isArray(b)&&(b=b.map(S=>eC(S))),h(t,["functionDeclarations"],b)}const a=d(o,["retrieval"]);a!=null&&h(t,["retrieval"],a);const r=d(o,["googleSearch"]);r!=null&&h(t,["googleSearch"],r);const u=d(o,["googleSearchRetrieval"]);u!=null&&h(t,["googleSearchRetrieval"],u);const p=d(o,["enterpriseWebSearch"]);p!=null&&h(t,["enterpriseWebSearch"],p);const y=d(o,["googleMaps"]);y!=null&&h(t,["googleMaps"],y);const x=d(o,["urlContext"]);x!=null&&h(t,["urlContext"],x);const m=d(o,["computerUse"]);m!=null&&h(t,["computerUse"],m);const v=d(o,["codeExecution"]);return v!=null&&h(t,["codeExecution"],v),t}function yC(o){const t={},s=d(o,["promptTokenCount"]);s!=null&&h(t,["promptTokenCount"],s);const a=d(o,["cachedContentTokenCount"]);a!=null&&h(t,["cachedContentTokenCount"],a);const r=d(o,["candidatesTokenCount"]);r!=null&&h(t,["responseTokenCount"],r);const u=d(o,["toolUsePromptTokenCount"]);u!=null&&h(t,["toolUsePromptTokenCount"],u);const p=d(o,["thoughtsTokenCount"]);p!=null&&h(t,["thoughtsTokenCount"],p);const y=d(o,["totalTokenCount"]);y!=null&&h(t,["totalTokenCount"],y);const x=d(o,["promptTokensDetails"]);if(x!=null){let N=x;Array.isArray(N)&&(N=N.map(_=>_)),h(t,["promptTokensDetails"],N)}const m=d(o,["cacheTokensDetails"]);if(m!=null){let N=m;Array.isArray(N)&&(N=N.map(_=>_)),h(t,["cacheTokensDetails"],N)}const v=d(o,["candidatesTokensDetails"]);if(v!=null){let N=v;Array.isArray(N)&&(N=N.map(_=>_)),h(t,["responseTokensDetails"],N)}const b=d(o,["toolUsePromptTokensDetails"]);if(b!=null){let N=b;Array.isArray(N)&&(N=N.map(_=>_)),h(t,["toolUsePromptTokensDetails"],N)}const S=d(o,["trafficType"]);return S!=null&&h(t,["trafficType"],S),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xC(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["data"]);s!=null&&h(t,["data"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function vC(o){const t={},s=d(o,["content"]);s!=null&&h(t,["content"],s);const a=d(o,["citationMetadata"]);a!=null&&h(t,["citationMetadata"],bC(a));const r=d(o,["tokenCount"]);r!=null&&h(t,["tokenCount"],r);const u=d(o,["finishReason"]);u!=null&&h(t,["finishReason"],u);const p=d(o,["urlContextMetadata"]);p!=null&&h(t,["urlContextMetadata"],p);const y=d(o,["avgLogprobs"]);y!=null&&h(t,["avgLogprobs"],y);const x=d(o,["groundingMetadata"]);x!=null&&h(t,["groundingMetadata"],x);const m=d(o,["index"]);m!=null&&h(t,["index"],m);const v=d(o,["logprobsResult"]);v!=null&&h(t,["logprobsResult"],v);const b=d(o,["safetyRatings"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(N=>N)),h(t,["safetyRatings"],S)}return t}function bC(o){const t={},s=d(o,["citationSources"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(r=>r)),h(t,["citations"],a)}return t}function CC(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["contents"]);if(r!=null){let u=lo(r);Array.isArray(u)&&(u=u.map(p=>p)),h(s,["contents"],u)}return s}function SC(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["tokensInfo"]);if(a!=null){let r=a;Array.isArray(r)&&(r=r.map(u=>u)),h(t,["tokensInfo"],r)}return t}function EC(o){const t={},s=d(o,["values"]);s!=null&&h(t,["values"],s);const a=d(o,["statistics"]);return a!=null&&h(t,["statistics"],TC(a)),t}function TC(o){const t={},s=d(o,["truncated"]);s!=null&&h(t,["truncated"],s);const a=d(o,["token_count"]);return a!=null&&h(t,["tokenCount"],a),t}function Oi(o){const t={},s=d(o,["parts"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(u=>M1(u))),h(t,["parts"],r)}const a=d(o,["role"]);return a!=null&&h(t,["role"],a),t}function wC(o){const t={},s=d(o,["controlType"]);s!=null&&h(t,["controlType"],s);const a=d(o,["enableControlImageComputation"]);return a!=null&&h(t,["computeControl"],a),t}function NC(o){const t={};if(d(o,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(o,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(o,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function AC(o,t){const s={},a=d(o,["systemInstruction"]);t!==void 0&&a!=null&&h(t,["systemInstruction"],An(a));const r=d(o,["tools"]);if(t!==void 0&&r!=null){let p=r;Array.isArray(p)&&(p=p.map(y=>Kg(y))),h(t,["tools"],p)}const u=d(o,["generationConfig"]);return t!==void 0&&u!=null&&h(t,["generationConfig"],g1(u)),s}function _C(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["contents"]);if(r!=null){let p=lo(r);Array.isArray(p)&&(p=p.map(y=>Oi(y))),h(s,["contents"],p)}const u=d(t,["config"]);return u!=null&&NC(u),s}function MC(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["contents"]);if(r!=null){let p=lo(r);Array.isArray(p)&&(p=p.map(y=>y)),h(s,["contents"],p)}const u=d(t,["config"]);return u!=null&&AC(u,s),s}function RC(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["totalTokens"]);a!=null&&h(t,["totalTokens"],a);const r=d(o,["cachedContentTokenCount"]);return r!=null&&h(t,["cachedContentTokenCount"],r),t}function IC(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["totalTokens"]);return a!=null&&h(t,["totalTokens"],a),t}function kC(o,t){const s={},a=d(t,["model"]);return a!=null&&h(s,["_url","name"],Nt(o,a)),s}function DC(o,t){const s={},a=d(t,["model"]);return a!=null&&h(s,["_url","name"],Nt(o,a)),s}function LC(o){const t={},s=d(o,["sdkHttpResponse"]);return s!=null&&h(t,["sdkHttpResponse"],s),t}function jC(o){const t={},s=d(o,["sdkHttpResponse"]);return s!=null&&h(t,["sdkHttpResponse"],s),t}function UC(o,t){const s={},a=d(o,["outputGcsUri"]);t!==void 0&&a!=null&&h(t,["parameters","storageUri"],a);const r=d(o,["negativePrompt"]);t!==void 0&&r!=null&&h(t,["parameters","negativePrompt"],r);const u=d(o,["numberOfImages"]);t!==void 0&&u!=null&&h(t,["parameters","sampleCount"],u);const p=d(o,["aspectRatio"]);t!==void 0&&p!=null&&h(t,["parameters","aspectRatio"],p);const y=d(o,["guidanceScale"]);t!==void 0&&y!=null&&h(t,["parameters","guidanceScale"],y);const x=d(o,["seed"]);t!==void 0&&x!=null&&h(t,["parameters","seed"],x);const m=d(o,["safetyFilterLevel"]);t!==void 0&&m!=null&&h(t,["parameters","safetySetting"],m);const v=d(o,["personGeneration"]);t!==void 0&&v!=null&&h(t,["parameters","personGeneration"],v);const b=d(o,["includeSafetyAttributes"]);t!==void 0&&b!=null&&h(t,["parameters","includeSafetyAttributes"],b);const S=d(o,["includeRaiReason"]);t!==void 0&&S!=null&&h(t,["parameters","includeRaiReason"],S);const N=d(o,["language"]);t!==void 0&&N!=null&&h(t,["parameters","language"],N);const _=d(o,["outputMimeType"]);t!==void 0&&_!=null&&h(t,["parameters","outputOptions","mimeType"],_);const M=d(o,["outputCompressionQuality"]);t!==void 0&&M!=null&&h(t,["parameters","outputOptions","compressionQuality"],M);const G=d(o,["addWatermark"]);t!==void 0&&G!=null&&h(t,["parameters","addWatermark"],G);const k=d(o,["labels"]);t!==void 0&&k!=null&&h(t,["labels"],k);const V=d(o,["editMode"]);t!==void 0&&V!=null&&h(t,["parameters","editMode"],V);const R=d(o,["baseSteps"]);return t!==void 0&&R!=null&&h(t,["parameters","editConfig","baseSteps"],R),s}function zC(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["prompt"]);r!=null&&h(s,["instances[0]","prompt"],r);const u=d(t,["referenceImages"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(x=>j1(x))),h(s,["instances[0]","referenceImages"],y)}const p=d(t,["config"]);return p!=null&&UC(p,s),s}function PC(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["predictions"]);if(a!=null){let r=a;Array.isArray(r)&&(r=r.map(u=>Fi(u))),h(t,["generatedImages"],r)}return t}function BC(o,t){const s={},a=d(o,["taskType"]);t!==void 0&&a!=null&&h(t,["requests[]","taskType"],a);const r=d(o,["title"]);t!==void 0&&r!=null&&h(t,["requests[]","title"],r);const u=d(o,["outputDimensionality"]);if(t!==void 0&&u!=null&&h(t,["requests[]","outputDimensionality"],u),d(o,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(o,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return s}function qC(o,t){const s={},a=d(o,["taskType"]);t!==void 0&&a!=null&&h(t,["instances[]","task_type"],a);const r=d(o,["title"]);t!==void 0&&r!=null&&h(t,["instances[]","title"],r);const u=d(o,["outputDimensionality"]);t!==void 0&&u!=null&&h(t,["parameters","outputDimensionality"],u);const p=d(o,["mimeType"]);t!==void 0&&p!=null&&h(t,["instances[]","mimeType"],p);const y=d(o,["autoTruncate"]);return t!==void 0&&y!=null&&h(t,["parameters","autoTruncate"],y),s}function GC(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["contents"]);if(r!=null){let y=Pu(o,r);Array.isArray(y)&&(y=y.map(x=>x)),h(s,["requests[]","content"],y)}const u=d(t,["config"]);u!=null&&BC(u,s);const p=d(t,["model"]);return p!==void 0&&h(s,["requests[]","model"],Nt(o,p)),s}function VC(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["contents"]);if(r!=null){let p=Pu(o,r);Array.isArray(p)&&(p=p.map(y=>y)),h(s,["instances[]","content"],p)}const u=d(t,["config"]);return u!=null&&qC(u,s),s}function HC(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["embeddings"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(p=>p)),h(t,["embeddings"],u)}const r=d(o,["metadata"]);return r!=null&&h(t,["metadata"],r),t}function OC(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["predictions[]","embeddings"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(p=>EC(p))),h(t,["embeddings"],u)}const r=d(o,["metadata"]);return r!=null&&h(t,["metadata"],r),t}function FC(o){const t={},s=d(o,["endpoint"]);s!=null&&h(t,["name"],s);const a=d(o,["deployedModelId"]);return a!=null&&h(t,["deployedModelId"],a),t}function YC(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["fileUri"]);s!=null&&h(t,["fileUri"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function JC(o){const t={};if(d(o,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const s=d(o,["description"]);s!=null&&h(t,["description"],s);const a=d(o,["name"]);a!=null&&h(t,["name"],a);const r=d(o,["parameters"]);r!=null&&h(t,["parameters"],r);const u=d(o,["parametersJsonSchema"]);u!=null&&h(t,["parametersJsonSchema"],u);const p=d(o,["response"]);p!=null&&h(t,["response"],p);const y=d(o,["responseJsonSchema"]);return y!=null&&h(t,["responseJsonSchema"],y),t}function XC(o,t,s){const a={},r=d(t,["systemInstruction"]);s!==void 0&&r!=null&&h(s,["systemInstruction"],Oi(An(r)));const u=d(t,["temperature"]);u!=null&&h(a,["temperature"],u);const p=d(t,["topP"]);p!=null&&h(a,["topP"],p);const y=d(t,["topK"]);y!=null&&h(a,["topK"],y);const x=d(t,["candidateCount"]);x!=null&&h(a,["candidateCount"],x);const m=d(t,["maxOutputTokens"]);m!=null&&h(a,["maxOutputTokens"],m);const v=d(t,["stopSequences"]);v!=null&&h(a,["stopSequences"],v);const b=d(t,["responseLogprobs"]);b!=null&&h(a,["responseLogprobs"],b);const S=d(t,["logprobs"]);S!=null&&h(a,["logprobs"],S);const N=d(t,["presencePenalty"]);N!=null&&h(a,["presencePenalty"],N);const _=d(t,["frequencyPenalty"]);_!=null&&h(a,["frequencyPenalty"],_);const M=d(t,["seed"]);M!=null&&h(a,["seed"],M);const G=d(t,["responseMimeType"]);G!=null&&h(a,["responseMimeType"],G);const k=d(t,["responseSchema"]);k!=null&&h(a,["responseSchema"],Bu(k));const V=d(t,["responseJsonSchema"]);if(V!=null&&h(a,["responseJsonSchema"],V),d(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const R=d(t,["safetySettings"]);if(s!==void 0&&R!=null){let L=R;Array.isArray(L)&&(L=L.map(H=>U1(H))),h(s,["safetySettings"],L)}const B=d(t,["tools"]);if(s!==void 0&&B!=null){let L=Es(B);Array.isArray(L)&&(L=L.map(H=>V1(Ss(H)))),h(s,["tools"],L)}const U=d(t,["toolConfig"]);if(s!==void 0&&U!=null&&h(s,["toolConfig"],U),d(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const $=d(t,["cachedContent"]);s!==void 0&&$!=null&&h(s,["cachedContent"],Po(o,$));const D=d(t,["responseModalities"]);D!=null&&h(a,["responseModalities"],D);const E=d(t,["mediaResolution"]);E!=null&&h(a,["mediaResolution"],E);const K=d(t,["speechConfig"]);if(K!=null&&h(a,["speechConfig"],qu(K)),d(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const I=d(t,["thinkingConfig"]);I!=null&&h(a,["thinkingConfig"],I);const X=d(t,["imageConfig"]);return X!=null&&h(a,["imageConfig"],X),a}function KC(o,t,s){const a={},r=d(t,["systemInstruction"]);s!==void 0&&r!=null&&h(s,["systemInstruction"],An(r));const u=d(t,["temperature"]);u!=null&&h(a,["temperature"],u);const p=d(t,["topP"]);p!=null&&h(a,["topP"],p);const y=d(t,["topK"]);y!=null&&h(a,["topK"],y);const x=d(t,["candidateCount"]);x!=null&&h(a,["candidateCount"],x);const m=d(t,["maxOutputTokens"]);m!=null&&h(a,["maxOutputTokens"],m);const v=d(t,["stopSequences"]);v!=null&&h(a,["stopSequences"],v);const b=d(t,["responseLogprobs"]);b!=null&&h(a,["responseLogprobs"],b);const S=d(t,["logprobs"]);S!=null&&h(a,["logprobs"],S);const N=d(t,["presencePenalty"]);N!=null&&h(a,["presencePenalty"],N);const _=d(t,["frequencyPenalty"]);_!=null&&h(a,["frequencyPenalty"],_);const M=d(t,["seed"]);M!=null&&h(a,["seed"],M);const G=d(t,["responseMimeType"]);G!=null&&h(a,["responseMimeType"],G);const k=d(t,["responseSchema"]);k!=null&&h(a,["responseSchema"],Bu(k));const V=d(t,["responseJsonSchema"]);V!=null&&h(a,["responseJsonSchema"],V);const R=d(t,["routingConfig"]);R!=null&&h(a,["routingConfig"],R);const B=d(t,["modelSelectionConfig"]);B!=null&&h(a,["modelConfig"],B);const U=d(t,["safetySettings"]);if(s!==void 0&&U!=null){let j=U;Array.isArray(j)&&(j=j.map(z=>z)),h(s,["safetySettings"],j)}const $=d(t,["tools"]);if(s!==void 0&&$!=null){let j=Es($);Array.isArray(j)&&(j=j.map(z=>Kg(Ss(z)))),h(s,["tools"],j)}const D=d(t,["toolConfig"]);s!==void 0&&D!=null&&h(s,["toolConfig"],D);const E=d(t,["labels"]);s!==void 0&&E!=null&&h(s,["labels"],E);const K=d(t,["cachedContent"]);s!==void 0&&K!=null&&h(s,["cachedContent"],Po(o,K));const I=d(t,["responseModalities"]);I!=null&&h(a,["responseModalities"],I);const X=d(t,["mediaResolution"]);X!=null&&h(a,["mediaResolution"],X);const L=d(t,["speechConfig"]);L!=null&&h(a,["speechConfig"],Xg(qu(L)));const H=d(t,["audioTimestamp"]);H!=null&&h(a,["audioTimestamp"],H);const ue=d(t,["thinkingConfig"]);ue!=null&&h(a,["thinkingConfig"],ue);const ve=d(t,["imageConfig"]);return ve!=null&&h(a,["imageConfig"],ve),a}function Vm(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["contents"]);if(r!=null){let p=lo(r);Array.isArray(p)&&(p=p.map(y=>Oi(y))),h(s,["contents"],p)}const u=d(t,["config"]);return u!=null&&h(s,["generationConfig"],XC(o,u,s)),s}function Hm(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["contents"]);if(r!=null){let p=lo(r);Array.isArray(p)&&(p=p.map(y=>y)),h(s,["contents"],p)}const u=d(t,["config"]);return u!=null&&h(s,["generationConfig"],KC(o,u,s)),s}function Om(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["candidates"]);if(a!=null){let x=a;Array.isArray(x)&&(x=x.map(m=>vC(m))),h(t,["candidates"],x)}const r=d(o,["modelVersion"]);r!=null&&h(t,["modelVersion"],r);const u=d(o,["promptFeedback"]);u!=null&&h(t,["promptFeedback"],u);const p=d(o,["responseId"]);p!=null&&h(t,["responseId"],p);const y=d(o,["usageMetadata"]);return y!=null&&h(t,["usageMetadata"],y),t}function Fm(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["candidates"]);if(a!=null){let m=a;Array.isArray(m)&&(m=m.map(v=>v)),h(t,["candidates"],m)}const r=d(o,["createTime"]);r!=null&&h(t,["createTime"],r);const u=d(o,["modelVersion"]);u!=null&&h(t,["modelVersion"],u);const p=d(o,["promptFeedback"]);p!=null&&h(t,["promptFeedback"],p);const y=d(o,["responseId"]);y!=null&&h(t,["responseId"],y);const x=d(o,["usageMetadata"]);return x!=null&&h(t,["usageMetadata"],x),t}function $C(o,t){const s={};if(d(o,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(o,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=d(o,["numberOfImages"]);t!==void 0&&a!=null&&h(t,["parameters","sampleCount"],a);const r=d(o,["aspectRatio"]);t!==void 0&&r!=null&&h(t,["parameters","aspectRatio"],r);const u=d(o,["guidanceScale"]);if(t!==void 0&&u!=null&&h(t,["parameters","guidanceScale"],u),d(o,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const p=d(o,["safetyFilterLevel"]);t!==void 0&&p!=null&&h(t,["parameters","safetySetting"],p);const y=d(o,["personGeneration"]);t!==void 0&&y!=null&&h(t,["parameters","personGeneration"],y);const x=d(o,["includeSafetyAttributes"]);t!==void 0&&x!=null&&h(t,["parameters","includeSafetyAttributes"],x);const m=d(o,["includeRaiReason"]);t!==void 0&&m!=null&&h(t,["parameters","includeRaiReason"],m);const v=d(o,["language"]);t!==void 0&&v!=null&&h(t,["parameters","language"],v);const b=d(o,["outputMimeType"]);t!==void 0&&b!=null&&h(t,["parameters","outputOptions","mimeType"],b);const S=d(o,["outputCompressionQuality"]);if(t!==void 0&&S!=null&&h(t,["parameters","outputOptions","compressionQuality"],S),d(o,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(o,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const N=d(o,["imageSize"]);if(t!==void 0&&N!=null&&h(t,["parameters","sampleImageSize"],N),d(o,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return s}function ZC(o,t){const s={},a=d(o,["outputGcsUri"]);t!==void 0&&a!=null&&h(t,["parameters","storageUri"],a);const r=d(o,["negativePrompt"]);t!==void 0&&r!=null&&h(t,["parameters","negativePrompt"],r);const u=d(o,["numberOfImages"]);t!==void 0&&u!=null&&h(t,["parameters","sampleCount"],u);const p=d(o,["aspectRatio"]);t!==void 0&&p!=null&&h(t,["parameters","aspectRatio"],p);const y=d(o,["guidanceScale"]);t!==void 0&&y!=null&&h(t,["parameters","guidanceScale"],y);const x=d(o,["seed"]);t!==void 0&&x!=null&&h(t,["parameters","seed"],x);const m=d(o,["safetyFilterLevel"]);t!==void 0&&m!=null&&h(t,["parameters","safetySetting"],m);const v=d(o,["personGeneration"]);t!==void 0&&v!=null&&h(t,["parameters","personGeneration"],v);const b=d(o,["includeSafetyAttributes"]);t!==void 0&&b!=null&&h(t,["parameters","includeSafetyAttributes"],b);const S=d(o,["includeRaiReason"]);t!==void 0&&S!=null&&h(t,["parameters","includeRaiReason"],S);const N=d(o,["language"]);t!==void 0&&N!=null&&h(t,["parameters","language"],N);const _=d(o,["outputMimeType"]);t!==void 0&&_!=null&&h(t,["parameters","outputOptions","mimeType"],_);const M=d(o,["outputCompressionQuality"]);t!==void 0&&M!=null&&h(t,["parameters","outputOptions","compressionQuality"],M);const G=d(o,["addWatermark"]);t!==void 0&&G!=null&&h(t,["parameters","addWatermark"],G);const k=d(o,["labels"]);t!==void 0&&k!=null&&h(t,["labels"],k);const V=d(o,["imageSize"]);t!==void 0&&V!=null&&h(t,["parameters","sampleImageSize"],V);const R=d(o,["enhancePrompt"]);return t!==void 0&&R!=null&&h(t,["parameters","enhancePrompt"],R),s}function WC(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["prompt"]);r!=null&&h(s,["instances[0]","prompt"],r);const u=d(t,["config"]);return u!=null&&$C(u,s),s}function QC(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["prompt"]);r!=null&&h(s,["instances[0]","prompt"],r);const u=d(t,["config"]);return u!=null&&ZC(u,s),s}function e1(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["predictions"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(p=>f1(p))),h(t,["generatedImages"],u)}const r=d(o,["positivePromptSafetyAttributes"]);return r!=null&&h(t,["positivePromptSafetyAttributes"],Yg(r)),t}function t1(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["predictions"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(p=>Fi(p))),h(t,["generatedImages"],u)}const r=d(o,["positivePromptSafetyAttributes"]);return r!=null&&h(t,["positivePromptSafetyAttributes"],Jg(r)),t}function n1(o,t){const s={},a=d(o,["numberOfVideos"]);if(t!==void 0&&a!=null&&h(t,["parameters","sampleCount"],a),d(o,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(o,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=d(o,["durationSeconds"]);if(t!==void 0&&r!=null&&h(t,["parameters","durationSeconds"],r),d(o,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=d(o,["aspectRatio"]);t!==void 0&&u!=null&&h(t,["parameters","aspectRatio"],u);const p=d(o,["resolution"]);t!==void 0&&p!=null&&h(t,["parameters","resolution"],p);const y=d(o,["personGeneration"]);if(t!==void 0&&y!=null&&h(t,["parameters","personGeneration"],y),d(o,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const x=d(o,["negativePrompt"]);t!==void 0&&x!=null&&h(t,["parameters","negativePrompt"],x);const m=d(o,["enhancePrompt"]);if(t!==void 0&&m!=null&&h(t,["parameters","enhancePrompt"],m),d(o,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const v=d(o,["lastFrame"]);t!==void 0&&v!=null&&h(t,["instances[0]","lastFrame"],Yi(v));const b=d(o,["referenceImages"]);if(t!==void 0&&b!=null){let S=b;Array.isArray(S)&&(S=S.map(N=>t2(N))),h(t,["instances[0]","referenceImages"],S)}if(d(o,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(o,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return s}function o1(o,t){const s={},a=d(o,["numberOfVideos"]);t!==void 0&&a!=null&&h(t,["parameters","sampleCount"],a);const r=d(o,["outputGcsUri"]);t!==void 0&&r!=null&&h(t,["parameters","storageUri"],r);const u=d(o,["fps"]);t!==void 0&&u!=null&&h(t,["parameters","fps"],u);const p=d(o,["durationSeconds"]);t!==void 0&&p!=null&&h(t,["parameters","durationSeconds"],p);const y=d(o,["seed"]);t!==void 0&&y!=null&&h(t,["parameters","seed"],y);const x=d(o,["aspectRatio"]);t!==void 0&&x!=null&&h(t,["parameters","aspectRatio"],x);const m=d(o,["resolution"]);t!==void 0&&m!=null&&h(t,["parameters","resolution"],m);const v=d(o,["personGeneration"]);t!==void 0&&v!=null&&h(t,["parameters","personGeneration"],v);const b=d(o,["pubsubTopic"]);t!==void 0&&b!=null&&h(t,["parameters","pubsubTopic"],b);const S=d(o,["negativePrompt"]);t!==void 0&&S!=null&&h(t,["parameters","negativePrompt"],S);const N=d(o,["enhancePrompt"]);t!==void 0&&N!=null&&h(t,["parameters","enhancePrompt"],N);const _=d(o,["generateAudio"]);t!==void 0&&_!=null&&h(t,["parameters","generateAudio"],_);const M=d(o,["lastFrame"]);t!==void 0&&M!=null&&h(t,["instances[0]","lastFrame"],uo(M));const G=d(o,["referenceImages"]);if(t!==void 0&&G!=null){let R=G;Array.isArray(R)&&(R=R.map(B=>n2(B))),h(t,["instances[0]","referenceImages"],R)}const k=d(o,["mask"]);t!==void 0&&k!=null&&h(t,["instances[0]","mask"],e2(k));const V=d(o,["compressionQuality"]);return t!==void 0&&V!=null&&h(t,["parameters","compressionQuality"],V),s}function l1(o){const t={},s=d(o,["name"]);s!=null&&h(t,["name"],s);const a=d(o,["metadata"]);a!=null&&h(t,["metadata"],a);const r=d(o,["done"]);r!=null&&h(t,["done"],r);const u=d(o,["error"]);u!=null&&h(t,["error"],u);const p=d(o,["response","generateVideoResponse"]);return p!=null&&h(t,["response"],r1(p)),t}function s1(o){const t={},s=d(o,["name"]);s!=null&&h(t,["name"],s);const a=d(o,["metadata"]);a!=null&&h(t,["metadata"],a);const r=d(o,["done"]);r!=null&&h(t,["done"],r);const u=d(o,["error"]);u!=null&&h(t,["error"],u);const p=d(o,["response"]);return p!=null&&h(t,["response"],c1(p)),t}function a1(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["prompt"]);r!=null&&h(s,["instances[0]","prompt"],r);const u=d(t,["image"]);u!=null&&h(s,["instances[0]","image"],Yi(u));const p=d(t,["video"]);p!=null&&h(s,["instances[0]","video"],$g(p));const y=d(t,["source"]);y!=null&&u1(y,s);const x=d(t,["config"]);return x!=null&&n1(x,s),s}function i1(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["prompt"]);r!=null&&h(s,["instances[0]","prompt"],r);const u=d(t,["image"]);u!=null&&h(s,["instances[0]","image"],uo(u));const p=d(t,["video"]);p!=null&&h(s,["instances[0]","video"],Zg(p));const y=d(t,["source"]);y!=null&&d1(y,s);const x=d(t,["config"]);return x!=null&&o1(x,s),s}function r1(o){const t={},s=d(o,["generatedSamples"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(p=>p1(p))),h(t,["generatedVideos"],u)}const a=d(o,["raiMediaFilteredCount"]);a!=null&&h(t,["raiMediaFilteredCount"],a);const r=d(o,["raiMediaFilteredReasons"]);return r!=null&&h(t,["raiMediaFilteredReasons"],r),t}function c1(o){const t={},s=d(o,["videos"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(p=>m1(p))),h(t,["generatedVideos"],u)}const a=d(o,["raiMediaFilteredCount"]);a!=null&&h(t,["raiMediaFilteredCount"],a);const r=d(o,["raiMediaFilteredReasons"]);return r!=null&&h(t,["raiMediaFilteredReasons"],r),t}function u1(o,t){const s={},a=d(o,["prompt"]);t!==void 0&&a!=null&&h(t,["instances[0]","prompt"],a);const r=d(o,["image"]);t!==void 0&&r!=null&&h(t,["instances[0]","image"],Yi(r));const u=d(o,["video"]);return t!==void 0&&u!=null&&h(t,["instances[0]","video"],$g(u)),s}function d1(o,t){const s={},a=d(o,["prompt"]);t!==void 0&&a!=null&&h(t,["instances[0]","prompt"],a);const r=d(o,["image"]);t!==void 0&&r!=null&&h(t,["instances[0]","image"],uo(r));const u=d(o,["video"]);return t!==void 0&&u!=null&&h(t,["instances[0]","video"],Zg(u)),s}function f1(o){const t={},s=d(o,["_self"]);s!=null&&h(t,["image"],C1(s));const a=d(o,["raiFilteredReason"]);a!=null&&h(t,["raiFilteredReason"],a);const r=d(o,["_self"]);return r!=null&&h(t,["safetyAttributes"],Yg(r)),t}function Fi(o){const t={},s=d(o,["_self"]);s!=null&&h(t,["image"],Fg(s));const a=d(o,["raiFilteredReason"]);a!=null&&h(t,["raiFilteredReason"],a);const r=d(o,["_self"]);r!=null&&h(t,["safetyAttributes"],Jg(r));const u=d(o,["prompt"]);return u!=null&&h(t,["enhancedPrompt"],u),t}function h1(o){const t={},s=d(o,["_self"]);s!=null&&h(t,["mask"],Fg(s));const a=d(o,["labels"]);if(a!=null){let r=a;Array.isArray(r)&&(r=r.map(u=>u)),h(t,["labels"],r)}return t}function p1(o){const t={},s=d(o,["video"]);return s!=null&&h(t,["video"],W1(s)),t}function m1(o){const t={},s=d(o,["_self"]);return s!=null&&h(t,["video"],Q1(s)),t}function g1(o){const t={},s=d(o,["modelSelectionConfig"]);s!=null&&h(t,["modelConfig"],s);const a=d(o,["audioTimestamp"]);a!=null&&h(t,["audioTimestamp"],a);const r=d(o,["candidateCount"]);r!=null&&h(t,["candidateCount"],r);const u=d(o,["enableAffectiveDialog"]);u!=null&&h(t,["enableAffectiveDialog"],u);const p=d(o,["frequencyPenalty"]);p!=null&&h(t,["frequencyPenalty"],p);const y=d(o,["logprobs"]);y!=null&&h(t,["logprobs"],y);const x=d(o,["maxOutputTokens"]);x!=null&&h(t,["maxOutputTokens"],x);const m=d(o,["mediaResolution"]);m!=null&&h(t,["mediaResolution"],m);const v=d(o,["presencePenalty"]);v!=null&&h(t,["presencePenalty"],v);const b=d(o,["responseJsonSchema"]);b!=null&&h(t,["responseJsonSchema"],b);const S=d(o,["responseLogprobs"]);S!=null&&h(t,["responseLogprobs"],S);const N=d(o,["responseMimeType"]);N!=null&&h(t,["responseMimeType"],N);const _=d(o,["responseModalities"]);_!=null&&h(t,["responseModalities"],_);const M=d(o,["responseSchema"]);M!=null&&h(t,["responseSchema"],M);const G=d(o,["routingConfig"]);G!=null&&h(t,["routingConfig"],G);const k=d(o,["seed"]);k!=null&&h(t,["seed"],k);const V=d(o,["speechConfig"]);V!=null&&h(t,["speechConfig"],Xg(V));const R=d(o,["stopSequences"]);R!=null&&h(t,["stopSequences"],R);const B=d(o,["temperature"]);B!=null&&h(t,["temperature"],B);const U=d(o,["thinkingConfig"]);U!=null&&h(t,["thinkingConfig"],U);const $=d(o,["topK"]);$!=null&&h(t,["topK"],$);const D=d(o,["topP"]);if(D!=null&&h(t,["topP"],D),d(o,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function y1(o,t){const s={},a=d(t,["model"]);return a!=null&&h(s,["_url","name"],Nt(o,a)),s}function x1(o,t){const s={},a=d(t,["model"]);return a!=null&&h(s,["_url","name"],Nt(o,a)),s}function v1(o){const t={};if(d(o,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=d(o,["enableWidget"]);return s!=null&&h(t,["enableWidget"],s),t}function b1(o){const t={},s=d(o,["timeRangeFilter"]);if(s!=null&&h(t,["timeRangeFilter"],s),d(o,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return t}function C1(o){const t={},s=d(o,["bytesBase64Encoded"]);s!=null&&h(t,["imageBytes"],pl(s));const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function Fg(o){const t={},s=d(o,["gcsUri"]);s!=null&&h(t,["gcsUri"],s);const a=d(o,["bytesBase64Encoded"]);a!=null&&h(t,["imageBytes"],pl(a));const r=d(o,["mimeType"]);return r!=null&&h(t,["mimeType"],r),t}function Yi(o){const t={};if(d(o,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const s=d(o,["imageBytes"]);s!=null&&h(t,["bytesBase64Encoded"],pl(s));const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function uo(o){const t={},s=d(o,["gcsUri"]);s!=null&&h(t,["gcsUri"],s);const a=d(o,["imageBytes"]);a!=null&&h(t,["bytesBase64Encoded"],pl(a));const r=d(o,["mimeType"]);return r!=null&&h(t,["mimeType"],r),t}function S1(o,t,s){const a={},r=d(t,["pageSize"]);s!==void 0&&r!=null&&h(s,["_query","pageSize"],r);const u=d(t,["pageToken"]);s!==void 0&&u!=null&&h(s,["_query","pageToken"],u);const p=d(t,["filter"]);s!==void 0&&p!=null&&h(s,["_query","filter"],p);const y=d(t,["queryBase"]);return s!==void 0&&y!=null&&h(s,["_url","models_url"],zg(o,y)),a}function E1(o,t,s){const a={},r=d(t,["pageSize"]);s!==void 0&&r!=null&&h(s,["_query","pageSize"],r);const u=d(t,["pageToken"]);s!==void 0&&u!=null&&h(s,["_query","pageToken"],u);const p=d(t,["filter"]);s!==void 0&&p!=null&&h(s,["_query","filter"],p);const y=d(t,["queryBase"]);return s!==void 0&&y!=null&&h(s,["_url","models_url"],zg(o,y)),a}function T1(o,t){const s={},a=d(t,["config"]);return a!=null&&S1(o,a,s),s}function w1(o,t){const s={},a=d(t,["config"]);return a!=null&&E1(o,a,s),s}function N1(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["nextPageToken"]);a!=null&&h(t,["nextPageToken"],a);const r=d(o,["_self"]);if(r!=null){let u=Pg(r);Array.isArray(u)&&(u=u.map(p=>Ru(p))),h(t,["models"],u)}return t}function A1(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["nextPageToken"]);a!=null&&h(t,["nextPageToken"],a);const r=d(o,["_self"]);if(r!=null){let u=Pg(r);Array.isArray(u)&&(u=u.map(p=>Iu(p))),h(t,["models"],u)}return t}function _1(o){const t={},s=d(o,["maskMode"]);s!=null&&h(t,["maskMode"],s);const a=d(o,["segmentationClasses"]);a!=null&&h(t,["maskClasses"],a);const r=d(o,["maskDilation"]);return r!=null&&h(t,["dilation"],r),t}function Ru(o){const t={},s=d(o,["name"]);s!=null&&h(t,["name"],s);const a=d(o,["displayName"]);a!=null&&h(t,["displayName"],a);const r=d(o,["description"]);r!=null&&h(t,["description"],r);const u=d(o,["version"]);u!=null&&h(t,["version"],u);const p=d(o,["_self"]);p!=null&&h(t,["tunedModelInfo"],H1(p));const y=d(o,["inputTokenLimit"]);y!=null&&h(t,["inputTokenLimit"],y);const x=d(o,["outputTokenLimit"]);x!=null&&h(t,["outputTokenLimit"],x);const m=d(o,["supportedGenerationMethods"]);return m!=null&&h(t,["supportedActions"],m),t}function Iu(o){const t={},s=d(o,["name"]);s!=null&&h(t,["name"],s);const a=d(o,["displayName"]);a!=null&&h(t,["displayName"],a);const r=d(o,["description"]);r!=null&&h(t,["description"],r);const u=d(o,["versionId"]);u!=null&&h(t,["version"],u);const p=d(o,["deployedModels"]);if(p!=null){let b=p;Array.isArray(b)&&(b=b.map(S=>FC(S))),h(t,["endpoints"],b)}const y=d(o,["labels"]);y!=null&&h(t,["labels"],y);const x=d(o,["_self"]);x!=null&&h(t,["tunedModelInfo"],O1(x));const m=d(o,["defaultCheckpointId"]);m!=null&&h(t,["defaultCheckpointId"],m);const v=d(o,["checkpoints"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(S=>S)),h(t,["checkpoints"],b)}return t}function M1(o){const t={},s=d(o,["videoMetadata"]);s!=null&&h(t,["videoMetadata"],s);const a=d(o,["thought"]);a!=null&&h(t,["thought"],a);const r=d(o,["inlineData"]);r!=null&&h(t,["inlineData"],xC(r));const u=d(o,["fileData"]);u!=null&&h(t,["fileData"],YC(u));const p=d(o,["thoughtSignature"]);p!=null&&h(t,["thoughtSignature"],p);const y=d(o,["functionCall"]);y!=null&&h(t,["functionCall"],y);const x=d(o,["codeExecutionResult"]);x!=null&&h(t,["codeExecutionResult"],x);const m=d(o,["executableCode"]);m!=null&&h(t,["executableCode"],m);const v=d(o,["functionResponse"]);v!=null&&h(t,["functionResponse"],v);const b=d(o,["text"]);return b!=null&&h(t,["text"],b),t}function R1(o){const t={},s=d(o,["productImage"]);return s!=null&&h(t,["image"],uo(s)),t}function I1(o,t){const s={},a=d(o,["numberOfImages"]);t!==void 0&&a!=null&&h(t,["parameters","sampleCount"],a);const r=d(o,["baseSteps"]);t!==void 0&&r!=null&&h(t,["parameters","editConfig","baseSteps"],r);const u=d(o,["outputGcsUri"]);t!==void 0&&u!=null&&h(t,["parameters","storageUri"],u);const p=d(o,["seed"]);t!==void 0&&p!=null&&h(t,["parameters","seed"],p);const y=d(o,["safetyFilterLevel"]);t!==void 0&&y!=null&&h(t,["parameters","safetySetting"],y);const x=d(o,["personGeneration"]);t!==void 0&&x!=null&&h(t,["parameters","personGeneration"],x);const m=d(o,["addWatermark"]);t!==void 0&&m!=null&&h(t,["parameters","addWatermark"],m);const v=d(o,["outputMimeType"]);t!==void 0&&v!=null&&h(t,["parameters","outputOptions","mimeType"],v);const b=d(o,["outputCompressionQuality"]);t!==void 0&&b!=null&&h(t,["parameters","outputOptions","compressionQuality"],b);const S=d(o,["enhancePrompt"]);t!==void 0&&S!=null&&h(t,["parameters","enhancePrompt"],S);const N=d(o,["labels"]);return t!==void 0&&N!=null&&h(t,["labels"],N),s}function k1(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["source"]);r!=null&&L1(r,s);const u=d(t,["config"]);return u!=null&&I1(u,s),s}function D1(o){const t={},s=d(o,["predictions"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(r=>Fi(r))),h(t,["generatedImages"],a)}return t}function L1(o,t){const s={},a=d(o,["prompt"]);t!==void 0&&a!=null&&h(t,["instances[0]","prompt"],a);const r=d(o,["personImage"]);t!==void 0&&r!=null&&h(t,["instances[0]","personImage","image"],uo(r));const u=d(o,["productImages"]);if(t!==void 0&&u!=null){let p=u;Array.isArray(p)&&(p=p.map(y=>R1(y))),h(t,["instances[0]","productImages"],p)}return s}function j1(o){const t={},s=d(o,["referenceImage"]);s!=null&&h(t,["referenceImage"],uo(s));const a=d(o,["referenceId"]);a!=null&&h(t,["referenceId"],a);const r=d(o,["referenceType"]);r!=null&&h(t,["referenceType"],r);const u=d(o,["maskImageConfig"]);u!=null&&h(t,["maskImageConfig"],_1(u));const p=d(o,["controlImageConfig"]);p!=null&&h(t,["controlImageConfig"],wC(p));const y=d(o,["styleImageConfig"]);y!=null&&h(t,["styleImageConfig"],y);const x=d(o,["subjectImageConfig"]);return x!=null&&h(t,["subjectImageConfig"],x),t}function Yg(o){const t={},s=d(o,["safetyAttributes","categories"]);s!=null&&h(t,["categories"],s);const a=d(o,["safetyAttributes","scores"]);a!=null&&h(t,["scores"],a);const r=d(o,["contentType"]);return r!=null&&h(t,["contentType"],r),t}function Jg(o){const t={},s=d(o,["safetyAttributes","categories"]);s!=null&&h(t,["categories"],s);const a=d(o,["safetyAttributes","scores"]);a!=null&&h(t,["scores"],a);const r=d(o,["contentType"]);return r!=null&&h(t,["contentType"],r),t}function U1(o){const t={};if(d(o,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=d(o,["category"]);s!=null&&h(t,["category"],s);const a=d(o,["threshold"]);return a!=null&&h(t,["threshold"],a),t}function z1(o){const t={},s=d(o,["image"]);return s!=null&&h(t,["image"],uo(s)),t}function P1(o,t){const s={},a=d(o,["mode"]);t!==void 0&&a!=null&&h(t,["parameters","mode"],a);const r=d(o,["maxPredictions"]);t!==void 0&&r!=null&&h(t,["parameters","maxPredictions"],r);const u=d(o,["confidenceThreshold"]);t!==void 0&&u!=null&&h(t,["parameters","confidenceThreshold"],u);const p=d(o,["maskDilation"]);t!==void 0&&p!=null&&h(t,["parameters","maskDilation"],p);const y=d(o,["binaryColorThreshold"]);t!==void 0&&y!=null&&h(t,["parameters","binaryColorThreshold"],y);const x=d(o,["labels"]);return t!==void 0&&x!=null&&h(t,["labels"],x),s}function B1(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["source"]);r!=null&&G1(r,s);const u=d(t,["config"]);return u!=null&&P1(u,s),s}function q1(o){const t={},s=d(o,["predictions"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(r=>h1(r))),h(t,["generatedMasks"],a)}return t}function G1(o,t){const s={},a=d(o,["prompt"]);t!==void 0&&a!=null&&h(t,["instances[0]","prompt"],a);const r=d(o,["image"]);t!==void 0&&r!=null&&h(t,["instances[0]","image"],uo(r));const u=d(o,["scribbleImage"]);return t!==void 0&&u!=null&&h(t,["instances[0]","scribble"],z1(u)),s}function Xg(o){const t={},s=d(o,["voiceConfig"]);if(s!=null&&h(t,["voiceConfig"],s),d(o,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const a=d(o,["languageCode"]);return a!=null&&h(t,["languageCode"],a),t}function V1(o){const t={},s=d(o,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),h(t,["functionDeclarations"],m)}if(d(o,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=d(o,["googleSearch"]);a!=null&&h(t,["googleSearch"],b1(a));const r=d(o,["googleSearchRetrieval"]);if(r!=null&&h(t,["googleSearchRetrieval"],r),d(o,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=d(o,["googleMaps"]);u!=null&&h(t,["googleMaps"],v1(u));const p=d(o,["urlContext"]);p!=null&&h(t,["urlContext"],p);const y=d(o,["computerUse"]);y!=null&&h(t,["computerUse"],y);const x=d(o,["codeExecution"]);return x!=null&&h(t,["codeExecution"],x),t}function Kg(o){const t={},s=d(o,["functionDeclarations"]);if(s!=null){let b=s;Array.isArray(b)&&(b=b.map(S=>JC(S))),h(t,["functionDeclarations"],b)}const a=d(o,["retrieval"]);a!=null&&h(t,["retrieval"],a);const r=d(o,["googleSearch"]);r!=null&&h(t,["googleSearch"],r);const u=d(o,["googleSearchRetrieval"]);u!=null&&h(t,["googleSearchRetrieval"],u);const p=d(o,["enterpriseWebSearch"]);p!=null&&h(t,["enterpriseWebSearch"],p);const y=d(o,["googleMaps"]);y!=null&&h(t,["googleMaps"],y);const x=d(o,["urlContext"]);x!=null&&h(t,["urlContext"],x);const m=d(o,["computerUse"]);m!=null&&h(t,["computerUse"],m);const v=d(o,["codeExecution"]);return v!=null&&h(t,["codeExecution"],v),t}function H1(o){const t={},s=d(o,["baseModel"]);s!=null&&h(t,["baseModel"],s);const a=d(o,["createTime"]);a!=null&&h(t,["createTime"],a);const r=d(o,["updateTime"]);return r!=null&&h(t,["updateTime"],r),t}function O1(o){const t={},s=d(o,["labels","google-vertex-llm-tuning-base-model-id"]);s!=null&&h(t,["baseModel"],s);const a=d(o,["createTime"]);a!=null&&h(t,["createTime"],a);const r=d(o,["updateTime"]);return r!=null&&h(t,["updateTime"],r),t}function F1(o,t){const s={},a=d(o,["displayName"]);t!==void 0&&a!=null&&h(t,["displayName"],a);const r=d(o,["description"]);t!==void 0&&r!=null&&h(t,["description"],r);const u=d(o,["defaultCheckpointId"]);return t!==void 0&&u!=null&&h(t,["defaultCheckpointId"],u),s}function Y1(o,t){const s={},a=d(o,["displayName"]);t!==void 0&&a!=null&&h(t,["displayName"],a);const r=d(o,["description"]);t!==void 0&&r!=null&&h(t,["description"],r);const u=d(o,["defaultCheckpointId"]);return t!==void 0&&u!=null&&h(t,["defaultCheckpointId"],u),s}function J1(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","name"],Nt(o,a));const r=d(t,["config"]);return r!=null&&F1(r,s),s}function X1(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["config"]);return r!=null&&Y1(r,s),s}function K1(o,t){const s={},a=d(o,["outputGcsUri"]);t!==void 0&&a!=null&&h(t,["parameters","storageUri"],a);const r=d(o,["includeRaiReason"]);t!==void 0&&r!=null&&h(t,["parameters","includeRaiReason"],r);const u=d(o,["outputMimeType"]);t!==void 0&&u!=null&&h(t,["parameters","outputOptions","mimeType"],u);const p=d(o,["outputCompressionQuality"]);t!==void 0&&p!=null&&h(t,["parameters","outputOptions","compressionQuality"],p);const y=d(o,["enhanceInputImage"]);t!==void 0&&y!=null&&h(t,["parameters","upscaleConfig","enhanceInputImage"],y);const x=d(o,["imagePreservationFactor"]);t!==void 0&&x!=null&&h(t,["parameters","upscaleConfig","imagePreservationFactor"],x);const m=d(o,["labels"]);t!==void 0&&m!=null&&h(t,["labels"],m);const v=d(o,["numberOfImages"]);t!==void 0&&v!=null&&h(t,["parameters","sampleCount"],v);const b=d(o,["mode"]);return t!==void 0&&b!=null&&h(t,["parameters","mode"],b),s}function $1(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["_url","model"],Nt(o,a));const r=d(t,["image"]);r!=null&&h(s,["instances[0]","image"],uo(r));const u=d(t,["upscaleFactor"]);u!=null&&h(s,["parameters","upscaleConfig","upscaleFactor"],u);const p=d(t,["config"]);return p!=null&&K1(p,s),s}function Z1(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["predictions"]);if(a!=null){let r=a;Array.isArray(r)&&(r=r.map(u=>Fi(u))),h(t,["generatedImages"],r)}return t}function W1(o){const t={},s=d(o,["uri"]);s!=null&&h(t,["uri"],s);const a=d(o,["encodedVideo"]);a!=null&&h(t,["videoBytes"],pl(a));const r=d(o,["encoding"]);return r!=null&&h(t,["mimeType"],r),t}function Q1(o){const t={},s=d(o,["gcsUri"]);s!=null&&h(t,["uri"],s);const a=d(o,["bytesBase64Encoded"]);a!=null&&h(t,["videoBytes"],pl(a));const r=d(o,["mimeType"]);return r!=null&&h(t,["mimeType"],r),t}function e2(o){const t={},s=d(o,["image"]);s!=null&&h(t,["_self"],uo(s));const a=d(o,["maskMode"]);return a!=null&&h(t,["maskMode"],a),t}function t2(o){const t={},s=d(o,["image"]);s!=null&&h(t,["image"],Yi(s));const a=d(o,["referenceType"]);return a!=null&&h(t,["referenceType"],a),t}function n2(o){const t={},s=d(o,["image"]);s!=null&&h(t,["image"],uo(s));const a=d(o,["referenceType"]);return a!=null&&h(t,["referenceType"],a),t}function $g(o){const t={},s=d(o,["uri"]);s!=null&&h(t,["uri"],s);const a=d(o,["videoBytes"]);a!=null&&h(t,["encodedVideo"],pl(a));const r=d(o,["mimeType"]);return r!=null&&h(t,["encoding"],r),t}function Zg(o){const t={},s=d(o,["uri"]);s!=null&&h(t,["gcsUri"],s);const a=d(o,["videoBytes"]);a!=null&&h(t,["bytesBase64Encoded"],pl(a));const r=d(o,["mimeType"]);return r!=null&&h(t,["mimeType"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const o2="Content-Type",l2="X-Server-Timeout",s2="User-Agent",ku="x-goog-api-client",a2="1.26.0",i2=`google-genai-sdk/${a2}`,r2="v1beta1",c2="v1beta",Ym=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class u2{constructor(t){var s,a;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:r2,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(a=this.clientOptions.apiVersion)!==null&&a!==void 0?a:c2,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const a=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&a.push(t.apiVersion),a.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),s=new URL(t);return s.protocol=s.protocol=="http:"?"ws":"wss",s.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,s,a){const r=[this.getRequestUrlInternal(s)];return a&&r.push(this.getBaseResourcePath()),t!==""&&r.push(t),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let s=this.clientOptions.httpOptions;t.httpOptions&&(s=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const a=this.shouldPrependVertexProjectPath(t),r=this.constructUrl(t.path,s,a);if(t.queryParams)for(const[p,y]of Object.entries(t.queryParams))r.searchParams.append(p,String(y));let u={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else u.body=t.body;return u=await this.includeExtraHttpOptionsToRequestInit(u,s,t.abortSignal),this.unaryApiCall(r,u,t.httpMethod)}patchHttpOptions(t,s){const a=JSON.parse(JSON.stringify(t));for(const[r,u]of Object.entries(s))typeof u=="object"?a[r]=Object.assign(Object.assign({},a[r]),u):u!==void 0&&(a[r]=u);return a}async requestStream(t){let s=this.clientOptions.httpOptions;t.httpOptions&&(s=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const a=this.shouldPrependVertexProjectPath(t),r=this.constructUrl(t.path,s,a);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let u={};return u.body=t.body,u=await this.includeExtraHttpOptionsToRequestInit(u,s,t.abortSignal),this.streamApiCall(r,u,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,s,a){if(s&&s.timeout||a){const r=new AbortController,u=r.signal;if(s.timeout&&(s==null?void 0:s.timeout)>0){const p=setTimeout(()=>r.abort(),s.timeout);p&&typeof p.unref=="function"&&p.unref()}a&&a.addEventListener("abort",()=>{r.abort()}),t.signal=u}return s&&s.extraBody!==null&&d2(t,s.extraBody),t.headers=await this.getHeadersInternal(s),t}async unaryApiCall(t,s,a){return this.apiCall(t.toString(),Object.assign(Object.assign({},s),{method:a})).then(async r=>(await Jm(r),new Au(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(t,s,a){return this.apiCall(t.toString(),Object.assign(Object.assign({},s),{method:a})).then(async r=>(await Jm(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(t){var s;return xs(this,arguments,function*(){const r=(s=t==null?void 0:t.body)===null||s===void 0?void 0:s.getReader(),u=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let p="";for(;;){const{done:y,value:x}=yield Kt(r.read());if(y){if(p.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=u.decode(x,{stream:!0});try{const b=JSON.parse(m);if("error"in b){const S=JSON.parse(JSON.stringify(b.error)),N=S.status,_=S.code,M=`got status: ${N}. ${JSON.stringify(b)}`;if(_>=400&&_<600)throw new Hi({message:M,status:_})}}catch(b){if(b.name==="ApiError")throw b}p+=m;let v=p.match(Ym);for(;v;){const b=v[1];try{const S=new Response(b,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Kt(new Au(S)),p=p.slice(v[0].length),v=p.match(Ym)}catch(S){throw new Error(`exception parsing stream chunk ${b}. ${S}`)}}}}finally{r.releaseLock()}})}async apiCall(t,s){return fetch(t,s).catch(a=>{throw new Error(`exception ${a} sending request`)})}getDefaultHeaders(){const t={},s=i2+" "+this.clientOptions.userAgentExtra;return t[s2]=s,t[ku]=s,t[o2]="application/json",t}async getHeadersInternal(t){const s=new Headers;if(t&&t.headers){for(const[a,r]of Object.entries(t.headers))s.append(a,r);t.timeout&&t.timeout>0&&s.append(l2,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(s),s}async uploadFile(t,s){var a;const r={};s!=null&&(r.mimeType=s.mimeType,r.name=s.name,r.displayName=s.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const u=this.clientOptions.uploader,p=await u.stat(t);r.sizeBytes=String(p.size);const y=(a=s==null?void 0:s.mimeType)!==null&&a!==void 0?a:p.type;if(y===void 0||y==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=y;const x=await this.fetchUploadUrl(r,s);return u.upload(t,x,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,s){var a;let r={};s!=null&&s.httpOptions?r=s.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const u={file:t},p=await this.request({path:Pe("upload/v1beta/files",u._url),body:JSON.stringify(u),httpMethod:"POST",httpOptions:r});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const y=(a=p==null?void 0:p.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(y===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return y}}async function Jm(o){var t;if(o===void 0)throw new Error("response is undefined");if(!o.ok){const s=o.status;let a;!((t=o.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?a=await o.json():a={error:{message:await o.text(),code:o.status,status:o.statusText}};const r=JSON.stringify(a);throw s>=400&&s<600?new Hi({message:r,status:s}):new Error(r)}}function d2(o,t){if(!t||Object.keys(t).length===0)return;if(o.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let s={};if(typeof o.body=="string"&&o.body.length>0)try{const u=JSON.parse(o.body);if(typeof u=="object"&&u!==null&&!Array.isArray(u))s=u;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function a(u,p){const y=Object.assign({},u);for(const x in p)if(Object.prototype.hasOwnProperty.call(p,x)){const m=p[x],v=y[x];m&&typeof m=="object"&&!Array.isArray(m)&&v&&typeof v=="object"&&!Array.isArray(v)?y[x]=a(v,m):(v&&m&&typeof v!=typeof m&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${x}". Original type: ${typeof v}, New type: ${typeof m}. Overwriting.`),y[x]=m)}return y}const r=a(s,t);o.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const f2="mcp_used/unknown";let h2=!1;function Wg(o){for(const t of o)if(p2(t)||typeof t=="object"&&"inputSchema"in t)return!0;return h2}function Qg(o){var t;const s=(t=o[ku])!==null&&t!==void 0?t:"";o[ku]=(s+` ${f2}`).trimStart()}function p2(o){return o!==null&&typeof o=="object"&&o instanceof Vu}function m2(o,t=100){return xs(this,arguments,function*(){let a,r=0;for(;r<t;){const u=yield Kt(o.listTools({cursor:a}));for(const p of u.tools)yield yield Kt(p),r++;if(!u.nextCursor)break;a=u.nextCursor}})}class Vu{constructor(t=[],s){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=s}static create(t,s){return new Vu(t,s)}async initialize(){var t,s,a,r;if(this.mcpTools.length>0)return;const u={},p=[];for(const v of this.mcpClients)try{for(var y=!0,x=(s=void 0,ba(m2(v))),m;m=await x.next(),t=m.done,!t;y=!0){r=m.value,y=!1;const b=r;p.push(b);const S=b.name;if(u[S])throw new Error(`Duplicate function name ${S} found in MCP tools. Please ensure function names are unique.`);u[S]=v}}catch(b){s={error:b}}finally{try{!y&&!t&&(a=x.return)&&await a.call(x)}finally{if(s)throw s.error}}this.mcpTools=p,this.functionNameToMcpClient=u}async tool(){return await this.initialize(),bv(this.mcpTools,this.config)}async callTool(t){await this.initialize();const s=[];for(const a of t)if(a.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[a.name];let u;this.config.timeout&&(u={timeout:this.config.timeout});const p=await r.callTool({name:a.name,arguments:a.args},void 0,u);s.push({functionResponse:{name:a.name,response:p.isError?{error:p}:p}})}return s}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function g2(o,t,s){const a=new fv;let r;s.data instanceof Blob?r=JSON.parse(await s.data.text()):r=JSON.parse(s.data),Object.assign(a,r),t(a)}class y2{constructor(t,s,a){this.apiClient=t,this.auth=s,this.webSocketFactory=a}async connect(t){var s,a;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion(),p=b2(this.apiClient.getDefaultHeaders()),y=this.apiClient.getApiKey(),x=`${r}/ws/google.ai.generativelanguage.${u}.GenerativeService.BidiGenerateMusic?key=${y}`;let m=()=>{};const v=new Promise(R=>{m=R}),b=t.callbacks,S=function(){m({})},N=this.apiClient,_={onopen:S,onmessage:R=>{g2(N,b.onmessage,R)},onerror:(s=b==null?void 0:b.onerror)!==null&&s!==void 0?s:function(R){},onclose:(a=b==null?void 0:b.onclose)!==null&&a!==void 0?a:function(R){}},M=this.webSocketFactory.create(x,v2(p),_);M.connect(),await v;const V={setup:{model:Nt(this.apiClient,t.model)}};return M.send(JSON.stringify(V)),new x2(M,this.apiClient)}}class x2{constructor(t,s){this.conn=t,this.apiClient=s}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const s=cC(t);this.conn.send(JSON.stringify({clientContent:s}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const s=rC(t);this.conn.send(JSON.stringify(s))}sendPlaybackControl(t){const s={playbackControl:t};this.conn.send(JSON.stringify(s))}play(){this.sendPlaybackControl(ms.PLAY)}pause(){this.sendPlaybackControl(ms.PAUSE)}stop(){this.sendPlaybackControl(ms.STOP)}resetContext(){this.sendPlaybackControl(ms.RESET_CONTEXT)}close(){this.conn.close()}}function v2(o){const t={};return o.forEach((s,a)=>{t[a]=s}),t}function b2(o){const t=new Headers;for(const[s,a]of Object.entries(o))t.append(s,a);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C2="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function S2(o,t,s){const a=new dv;let r;s.data instanceof Blob?r=await s.data.text():s.data instanceof ArrayBuffer?r=new TextDecoder().decode(s.data):r=s.data;const u=JSON.parse(r);if(o.isVertexAI()){const p=fC(u);Object.assign(a,p)}else Object.assign(a,u);t(a)}class E2{constructor(t,s,a){this.apiClient=t,this.auth=s,this.webSocketFactory=a,this.music=new y2(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var s,a,r,u,p,y;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const x=this.apiClient.getWebsocketBaseUrl(),m=this.apiClient.getApiVersion();let v;const b=this.apiClient.getHeaders();t.config&&t.config.tools&&Wg(t.config.tools)&&Qg(b);const S=A2(b);if(this.apiClient.isVertexAI())v=`${x}/ws/google.cloud.aiplatform.${m}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(S);else{const K=this.apiClient.getApiKey();let I="BidiGenerateContent",X="key";K!=null&&K.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),m!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),I="BidiGenerateContentConstrained",X="access_token"),v=`${x}/ws/google.ai.generativelanguage.${m}.GenerativeService.${I}?${X}=${K}`}let N=()=>{};const _=new Promise(K=>{N=K}),M=t.callbacks,G=function(){var K;(K=M==null?void 0:M.onopen)===null||K===void 0||K.call(M),N({})},k=this.apiClient,V={onopen:G,onmessage:K=>{S2(k,M.onmessage,K)},onerror:(s=M==null?void 0:M.onerror)!==null&&s!==void 0?s:function(K){},onclose:(a=M==null?void 0:M.onclose)!==null&&a!==void 0?a:function(K){}},R=this.webSocketFactory.create(v,N2(S),V);R.connect(),await _;let B=Nt(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&B.startsWith("publishers/")){const K=this.apiClient.getProject(),I=this.apiClient.getLocation();B=`projects/${K}/locations/${I}/`+B}let U={};this.apiClient.isVertexAI()&&((r=t.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[bs.AUDIO]}:t.config.responseModalities=[bs.AUDIO]),!((u=t.config)===null||u===void 0)&&u.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const $=(y=(p=t.config)===null||p===void 0?void 0:p.tools)!==null&&y!==void 0?y:[],D=[];for(const K of $)if(this.isCallableTool(K)){const I=K;D.push(await I.tool())}else D.push(K);D.length>0&&(t.config.tools=D);const E={model:B,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?U=iC(this.apiClient,E):U=aC(this.apiClient,E),delete U.config,R.send(JSON.stringify(U)),new w2(R,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const T2={turnComplete:!0};class w2{constructor(t,s){this.conn=t,this.apiClient=s}tLiveClientContent(t,s){if(s.turns!==null&&s.turns!==void 0){let a=[];try{a=lo(s.turns),t.isVertexAI()||(a=a.map(r=>Oi(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof s.turns}'`)}return{clientContent:{turns:a,turnComplete:s.turnComplete}}}return{clientContent:{turnComplete:s.turnComplete}}}tLiveClienttToolResponse(t,s){let a=[];if(s.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(s.functionResponses)?a=s.functionResponses:a=[s.functionResponses],a.length===0)throw new Error("functionResponses is required.");for(const u of a){if(typeof u!="object"||u===null||!("name"in u)||!("response"in u))throw new Error(`Could not parse function response, type '${typeof u}'.`);if(!t.isVertexAI()&&!("id"in u))throw new Error(C2)}return{toolResponse:{functionResponses:a}}}sendClientContent(t){t=Object.assign(Object.assign({},T2),t);const s=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(s))}sendRealtimeInput(t){let s={};this.apiClient.isVertexAI()?s={realtimeInput:dC(t)}:s={realtimeInput:uC(t)},this.conn.send(JSON.stringify(s))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const s=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(s))}close(){this.conn.close()}}function N2(o){const t={};return o.forEach((s,a)=>{t[a]=s}),t}function A2(o){const t=new Headers;for(const[s,a]of Object.entries(o))t.append(s,a);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xm=10;function Km(o){var t,s,a;if(!((t=o==null?void 0:o.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let r=!1;for(const p of(s=o==null?void 0:o.tools)!==null&&s!==void 0?s:[])if(vs(p)){r=!0;break}if(!r)return!0;const u=(a=o==null?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls;return u&&(u<0||!Number.isInteger(u))||u==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",u),!0):!1}function vs(o){return"callTool"in o&&typeof o.callTool=="function"}function _2(o){var t,s,a;return(a=(s=(t=o.config)===null||t===void 0?void 0:t.tools)===null||s===void 0?void 0:s.some(r=>vs(r)))!==null&&a!==void 0?a:!1}function M2(o){var t,s,a;return(a=(s=(t=o.config)===null||t===void 0?void 0:t.tools)===null||s===void 0?void 0:s.some(r=>!vs(r)))!==null&&a!==void 0?a:!1}function $m(o){var t;return!(!((t=o==null?void 0:o.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class R2 extends jl{constructor(t){super(),this.apiClient=t,this.generateContent=async s=>{var a,r,u,p,y;const x=await this.processParamsMaybeAddMcpUsage(s);if(this.maybeMoveToResponseJsonSchem(s),!_2(s)||Km(s.config))return await this.generateContentInternal(x);if(M2(s))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let m,v;const b=lo(x.contents),S=(u=(r=(a=x.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&u!==void 0?u:Xm;let N=0;for(;N<S&&(m=await this.generateContentInternal(x),!(!m.functionCalls||m.functionCalls.length===0));){const _=m.candidates[0].content,M=[];for(const G of(y=(p=s.config)===null||p===void 0?void 0:p.tools)!==null&&y!==void 0?y:[])if(vs(G)){const V=await G.callTool(m.functionCalls);M.push(...V)}N++,v={role:"user",parts:M},x.contents=lo(x.contents),x.contents.push(_),x.contents.push(v),$m(x.config)&&(b.push(_),b.push(v))}return $m(x.config)&&(m.automaticFunctionCallingHistory=b),m},this.generateContentStream=async s=>{if(this.maybeMoveToResponseJsonSchem(s),Km(s.config)){const a=await this.processParamsMaybeAddMcpUsage(s);return await this.generateContentStreamInternal(a)}else return await this.processAfcStream(s)},this.generateImages=async s=>await this.generateImagesInternal(s).then(a=>{var r;let u;const p=[];if(a!=null&&a.generatedImages)for(const x of a.generatedImages)x&&(x!=null&&x.safetyAttributes)&&((r=x==null?void 0:x.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?u=x==null?void 0:x.safetyAttributes:p.push(x);let y;return u?y={generatedImages:p,positivePromptSafetyAttributes:u,sdkHttpResponse:a.sdkHttpResponse}:y={generatedImages:p,sdkHttpResponse:a.sdkHttpResponse},y}),this.list=async s=>{var a;const p={config:Object.assign(Object.assign({},{queryBase:!0}),s==null?void 0:s.config)};if(this.apiClient.isVertexAI()&&!p.config.queryBase){if(!((a=p.config)===null||a===void 0)&&a.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");p.config.filter="labels.tune-type:*"}return new Sa(Dl.PAGED_ITEM_MODELS,y=>this.listInternal(y),await this.listInternal(p),p)},this.editImage=async s=>{const a={model:s.model,prompt:s.prompt,referenceImages:[],config:s.config};return s.referenceImages&&s.referenceImages&&(a.referenceImages=s.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(a)},this.upscaleImage=async s=>{let a={numberOfImages:1,mode:"upscale"};s.config&&(a=Object.assign(Object.assign({},a),s.config));const r={model:s.model,image:s.image,upscaleFactor:s.upscaleFactor,config:a};return await this.upscaleImageInternal(r)},this.generateVideos=async s=>{var a,r,u,p,y,x;if((s.prompt||s.image||s.video)&&s.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((a=s.video)===null||a===void 0)&&a.uri&&(!((r=s.video)===null||r===void 0)&&r.videoBytes)?s.video={uri:s.video.uri,mimeType:s.video.mimeType}:!((p=(u=s.source)===null||u===void 0?void 0:u.video)===null||p===void 0)&&p.uri&&(!((x=(y=s.source)===null||y===void 0?void 0:y.video)===null||x===void 0)&&x.videoBytes)&&(s.source.video={uri:s.source.video.uri,mimeType:s.source.video.mimeType})),await this.generateVideosInternal(s)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var s,a,r;const u=(s=t.config)===null||s===void 0?void 0:s.tools;if(!u)return t;const p=await Promise.all(u.map(async x=>vs(x)?await x.tool():x)),y={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:p})};if(y.config.tools=p,t.config&&t.config.tools&&Wg(t.config.tools)){const x=(r=(a=t.config.httpOptions)===null||a===void 0?void 0:a.headers)!==null&&r!==void 0?r:{};let m=Object.assign({},x);Object.keys(m).length===0&&(m=this.apiClient.getDefaultHeaders()),Qg(m),y.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:m})}return y}async initAfcToolsMap(t){var s,a,r;const u=new Map;for(const p of(a=(s=t.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[])if(vs(p)){const y=p,x=await y.tool();for(const m of(r=x.functionDeclarations)!==null&&r!==void 0?r:[]){if(!m.name)throw new Error("Function declaration name is required.");if(u.has(m.name))throw new Error(`Duplicate tool declaration name: ${m.name}`);u.set(m.name,y)}}return u}async processAfcStream(t){var s,a,r;const u=(r=(a=(s=t.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&r!==void 0?r:Xm;let p=!1,y=0;const x=await this.initAfcToolsMap(t);return(function(m,v,b){var S,N;return xs(this,arguments,function*(){for(var _,M,G,k;y<u;){p&&(y++,p=!1);const U=yield Kt(m.processParamsMaybeAddMcpUsage(b)),$=yield Kt(m.generateContentStreamInternal(U)),D=[],E=[];try{for(var V=!0,R=(M=void 0,ba($)),B;B=yield Kt(R.next()),_=B.done,!_;V=!0){k=B.value,V=!1;const K=k;if(yield yield Kt(K),K.candidates&&(!((S=K.candidates[0])===null||S===void 0)&&S.content)){E.push(K.candidates[0].content);for(const I of(N=K.candidates[0].content.parts)!==null&&N!==void 0?N:[])if(y<u&&I.functionCall){if(!I.functionCall.name)throw new Error("Function call name was not returned by the model.");if(v.has(I.functionCall.name)){const X=yield Kt(v.get(I.functionCall.name).callTool([I.functionCall]));D.push(...X)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${v.keys()}, mising tool: ${I.functionCall.name}`)}}}}catch(K){M={error:K}}finally{try{!V&&!_&&(G=R.return)&&(yield Kt(G.call(R)))}finally{if(M)throw M.error}}if(D.length>0){p=!0;const K=new xa;K.candidates=[{content:{role:"user",parts:D}}],yield yield Kt(K);const I=[];I.push(...E),I.push({role:"user",parts:D});const X=lo(b.contents).concat(I);b.contents=X}else break}})})(this,x,t)}async generateContentInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=Hm(this.apiClient,t);return y=Pe("{model}:generateContent",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=Fm(v),S=new xa;return Object.assign(S,b),S})}else{const m=Vm(this.apiClient,t);return y=Pe("{model}:generateContent",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=Om(v),S=new xa;return Object.assign(S,b),S})}}async generateContentStreamInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=Hm(this.apiClient,t);return y=Pe("{model}:streamGenerateContent?alt=sse",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.requestStream({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}),p.then(function(b){return xs(this,arguments,function*(){var S,N,_,M;try{for(var G=!0,k=ba(b),V;V=yield Kt(k.next()),S=V.done,!S;G=!0){M=V.value,G=!1;const R=M,B=Fm(yield Kt(R.json()));B.sdkHttpResponse={headers:R.headers};const U=new xa;Object.assign(U,B),yield yield Kt(U)}}catch(R){N={error:R}}finally{try{!G&&!S&&(_=k.return)&&(yield Kt(_.call(k)))}finally{if(N)throw N.error}}})})}else{const m=Vm(this.apiClient,t);return y=Pe("{model}:streamGenerateContent?alt=sse",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.requestStream({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}),p.then(function(b){return xs(this,arguments,function*(){var S,N,_,M;try{for(var G=!0,k=ba(b),V;V=yield Kt(k.next()),S=V.done,!S;G=!0){M=V.value,G=!1;const R=M,B=Om(yield Kt(R.json()));B.sdkHttpResponse={headers:R.headers};const U=new xa;Object.assign(U,B),yield yield Kt(U)}}catch(R){N={error:R}}finally{try{!G&&!S&&(_=k.return)&&(yield Kt(_.call(k)))}finally{if(N)throw N.error}}})})}}async embedContent(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=VC(this.apiClient,t);return y=Pe("{model}:predict",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=OC(v),S=new Nm;return Object.assign(S,b),S})}else{const m=GC(this.apiClient,t);return y=Pe("{model}:batchEmbedContents",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=HC(v),S=new Nm;return Object.assign(S,b),S})}}async generateImagesInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=QC(this.apiClient,t);return y=Pe("{model}:predict",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=t1(v),S=new Am;return Object.assign(S,b),S})}else{const m=WC(this.apiClient,t);return y=Pe("{model}:predict",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=e1(v),S=new Am;return Object.assign(S,b),S})}}async editImageInternal(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI()){const y=zC(this.apiClient,t);return u=Pe("{model}:predict",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:x.headers},v})),r.then(x=>{const m=PC(x),v=new ov;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI()){const y=$1(this.apiClient,t);return u=Pe("{model}:predict",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:x.headers},v})),r.then(x=>{const m=Z1(x),v=new lv;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI()){const y=k1(this.apiClient,t);return u=Pe("{model}:predict",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json()),r.then(x=>{const m=D1(x),v=new sv;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI()){const y=B1(this.apiClient,t);return u=Pe("{model}:predict",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json()),r.then(x=>{const m=q1(x),v=new av;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=x1(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json()),p.then(v=>Iu(v))}else{const m=y1(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json()),p.then(v=>Ru(v))}}async listInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=w1(this.apiClient,t);return y=Pe("{models_url}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=A1(v),S=new _m;return Object.assign(S,b),S})}else{const m=T1(this.apiClient,t);return y=Pe("{models_url}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=N1(v),S=new _m;return Object.assign(S,b),S})}}async update(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=X1(this.apiClient,t);return y=Pe("{model}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json()),p.then(v=>Iu(v))}else{const m=J1(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"PATCH",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json()),p.then(v=>Ru(v))}}async delete(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=DC(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=jC(v),S=new Mm;return Object.assign(S,b),S})}else{const m=kC(this.apiClient,t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=LC(v),S=new Mm;return Object.assign(S,b),S})}}async countTokens(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=MC(this.apiClient,t);return y=Pe("{model}:countTokens",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=IC(v),S=new Rm;return Object.assign(S,b),S})}else{const m=_C(this.apiClient,t);return y=Pe("{model}:countTokens",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=RC(v),S=new Rm;return Object.assign(S,b),S})}}async computeTokens(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI()){const y=CC(this.apiClient,t);return u=Pe("{model}:computeTokens",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:x.headers},v})),r.then(x=>{const m=SC(x),v=new iv;return Object.assign(v,m),v})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=i1(this.apiClient,t);return y=Pe("{model}:predictLongRunning",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json()),p.then(v=>{const b=s1(v),S=new qi;return Object.assign(S,b),S})}else{const m=a1(this.apiClient,t);return y=Pe("{model}:predictLongRunning",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json()),p.then(v=>{const b=l1(v),S=new qi;return Object.assign(S,b),S})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class I2 extends jl{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const s=t.operation,a=t.config;if(s.name===void 0||s.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=s.name.split("/operations/")[0];let u;a&&"httpOptions"in a&&(u=a.httpOptions);const p=await this.fetchPredictVideosOperationInternal({operationName:s.name,resourceName:r,config:{httpOptions:u}});return s._fromAPIResponse({apiResponse:p,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:s.name,config:a});return s._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async get(t){const s=t.operation,a=t.config;if(s.name===void 0||s.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=s.name.split("/operations/")[0];let u;a&&"httpOptions"in a&&(u=a.httpOptions);const p=await this.fetchPredictVideosOperationInternal({operationName:s.name,resourceName:r,config:{httpOptions:u}});return s._fromAPIResponse({apiResponse:p,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:s.name,config:a});return s._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async getVideosOperationInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=ev(t);return y=Pe("{operationName}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json()),p}else{const m=Q0(t);return y=Pe("{operationName}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json()),p}}async fetchPredictVideosOperationInternal(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI()){const y=Y0(t);return u=Pe("{resourceName}:fetchPredictOperation",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function k2(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["data"]);s!=null&&h(t,["data"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function D2(o){const t={},s=d(o,["parts"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(u=>G2(u))),h(t,["parts"],r)}const a=d(o,["role"]);return a!=null&&h(t,["role"],a),t}function L2(o,t,s){const a={},r=d(t,["expireTime"]);s!==void 0&&r!=null&&h(s,["expireTime"],r);const u=d(t,["newSessionExpireTime"]);s!==void 0&&u!=null&&h(s,["newSessionExpireTime"],u);const p=d(t,["uses"]);s!==void 0&&p!=null&&h(s,["uses"],p);const y=d(t,["liveConnectConstraints"]);s!==void 0&&y!=null&&h(s,["bidiGenerateContentSetup"],q2(o,y));const x=d(t,["lockAdditionalFields"]);return s!==void 0&&x!=null&&h(s,["fieldMask"],x),a}function j2(o,t){const s={},a=d(t,["config"]);return a!=null&&h(s,["config"],L2(o,a,s)),s}function U2(o){const t={};if(d(o,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=d(o,["fileUri"]);s!=null&&h(t,["fileUri"],s);const a=d(o,["mimeType"]);return a!=null&&h(t,["mimeType"],a),t}function z2(o){const t={};if(d(o,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=d(o,["enableWidget"]);return s!=null&&h(t,["enableWidget"],s),t}function P2(o){const t={},s=d(o,["timeRangeFilter"]);if(s!=null&&h(t,["timeRangeFilter"],s),d(o,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return t}function B2(o,t){const s={},a=d(o,["generationConfig"]);t!==void 0&&a!=null&&h(t,["setup","generationConfig"],a);const r=d(o,["responseModalities"]);t!==void 0&&r!=null&&h(t,["setup","generationConfig","responseModalities"],r);const u=d(o,["temperature"]);t!==void 0&&u!=null&&h(t,["setup","generationConfig","temperature"],u);const p=d(o,["topP"]);t!==void 0&&p!=null&&h(t,["setup","generationConfig","topP"],p);const y=d(o,["topK"]);t!==void 0&&y!=null&&h(t,["setup","generationConfig","topK"],y);const x=d(o,["maxOutputTokens"]);t!==void 0&&x!=null&&h(t,["setup","generationConfig","maxOutputTokens"],x);const m=d(o,["mediaResolution"]);t!==void 0&&m!=null&&h(t,["setup","generationConfig","mediaResolution"],m);const v=d(o,["seed"]);t!==void 0&&v!=null&&h(t,["setup","generationConfig","seed"],v);const b=d(o,["speechConfig"]);t!==void 0&&b!=null&&h(t,["setup","generationConfig","speechConfig"],Gu(b));const S=d(o,["thinkingConfig"]);t!==void 0&&S!=null&&h(t,["setup","generationConfig","thinkingConfig"],S);const N=d(o,["enableAffectiveDialog"]);t!==void 0&&N!=null&&h(t,["setup","generationConfig","enableAffectiveDialog"],N);const _=d(o,["systemInstruction"]);t!==void 0&&_!=null&&h(t,["setup","systemInstruction"],D2(An(_)));const M=d(o,["tools"]);if(t!==void 0&&M!=null){let $=Es(M);Array.isArray($)&&($=$.map(D=>H2(Ss(D)))),h(t,["setup","tools"],$)}const G=d(o,["sessionResumption"]);t!==void 0&&G!=null&&h(t,["setup","sessionResumption"],V2(G));const k=d(o,["inputAudioTranscription"]);t!==void 0&&k!=null&&h(t,["setup","inputAudioTranscription"],k);const V=d(o,["outputAudioTranscription"]);t!==void 0&&V!=null&&h(t,["setup","outputAudioTranscription"],V);const R=d(o,["realtimeInputConfig"]);t!==void 0&&R!=null&&h(t,["setup","realtimeInputConfig"],R);const B=d(o,["contextWindowCompression"]);t!==void 0&&B!=null&&h(t,["setup","contextWindowCompression"],B);const U=d(o,["proactivity"]);return t!==void 0&&U!=null&&h(t,["setup","proactivity"],U),s}function q2(o,t){const s={},a=d(t,["model"]);a!=null&&h(s,["setup","model"],Nt(o,a));const r=d(t,["config"]);return r!=null&&h(s,["config"],B2(r,s)),s}function G2(o){const t={},s=d(o,["videoMetadata"]);s!=null&&h(t,["videoMetadata"],s);const a=d(o,["thought"]);a!=null&&h(t,["thought"],a);const r=d(o,["inlineData"]);r!=null&&h(t,["inlineData"],k2(r));const u=d(o,["fileData"]);u!=null&&h(t,["fileData"],U2(u));const p=d(o,["thoughtSignature"]);p!=null&&h(t,["thoughtSignature"],p);const y=d(o,["functionCall"]);y!=null&&h(t,["functionCall"],y);const x=d(o,["codeExecutionResult"]);x!=null&&h(t,["codeExecutionResult"],x);const m=d(o,["executableCode"]);m!=null&&h(t,["executableCode"],m);const v=d(o,["functionResponse"]);v!=null&&h(t,["functionResponse"],v);const b=d(o,["text"]);return b!=null&&h(t,["text"],b),t}function V2(o){const t={},s=d(o,["handle"]);if(s!=null&&h(t,["handle"],s),d(o,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function H2(o){const t={},s=d(o,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),h(t,["functionDeclarations"],m)}if(d(o,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const a=d(o,["googleSearch"]);a!=null&&h(t,["googleSearch"],P2(a));const r=d(o,["googleSearchRetrieval"]);if(r!=null&&h(t,["googleSearchRetrieval"],r),d(o,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=d(o,["googleMaps"]);u!=null&&h(t,["googleMaps"],z2(u));const p=d(o,["urlContext"]);p!=null&&h(t,["urlContext"],p);const y=d(o,["computerUse"]);y!=null&&h(t,["computerUse"],y);const x=d(o,["codeExecution"]);return x!=null&&h(t,["codeExecution"],x),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function O2(o){const t=[];for(const s in o)if(Object.prototype.hasOwnProperty.call(o,s)){const a=o[s];if(typeof a=="object"&&a!=null&&Object.keys(a).length>0){const r=Object.keys(a).map(u=>`${s}.${u}`);t.push(...r)}else t.push(s)}return t.join(",")}function F2(o,t){let s=null;const a=o.bidiGenerateContentSetup;if(typeof a=="object"&&a!==null&&"setup"in a){const u=a.setup;typeof u=="object"&&u!==null?(o.bidiGenerateContentSetup=u,s=u):delete o.bidiGenerateContentSetup}else a!==void 0&&delete o.bidiGenerateContentSetup;const r=o.fieldMask;if(s){const u=O2(s);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)u?o.fieldMask=u:delete o.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const p=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let y=[];r.length>0&&(y=r.map(m=>p.includes(m)?`generationConfig.${m}`:m));const x=[];u&&x.push(u),y.length>0&&x.push(...y),x.length>0?o.fieldMask=x.join(","):delete o.fieldMask}else delete o.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?o.fieldMask=r.join(","):delete o.fieldMask;return o}class Y2 extends jl{constructor(t){super(),this.apiClient=t}async create(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const y=j2(this.apiClient,t);u=Pe("auth_tokens",y._url),p=y._query,delete y.config,delete y._url,delete y._query;const x=F2(y,t.config);return r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(m=>m.json()),r.then(m=>m)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function J2(o){const t={},s=d(o,["name"]);return s!=null&&h(t,["_url","name"],s),t}function X2(o){const t={},s=d(o,["name"]);return s!=null&&h(t,["_url","name"],s),t}function K2(o,t){const s={};if(d(o,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=d(o,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&h(t,["displayName"],a),d(o,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=d(o,["epochCount"]);t!==void 0&&r!=null&&h(t,["tuningTask","hyperparameters","epochCount"],r);const u=d(o,["learningRateMultiplier"]);if(u!=null&&h(s,["tuningTask","hyperparameters","learningRateMultiplier"],u),d(o,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(o,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(o,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const p=d(o,["batchSize"]);t!==void 0&&p!=null&&h(t,["tuningTask","hyperparameters","batchSize"],p);const y=d(o,["learningRate"]);if(t!==void 0&&y!=null&&h(t,["tuningTask","hyperparameters","learningRate"],y),d(o,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return s}function $2(o,t){const s={},a=d(o,["validationDataset"]);t!==void 0&&a!=null&&h(t,["supervisedTuningSpec"],dS(a,s));const r=d(o,["tunedModelDisplayName"]);t!==void 0&&r!=null&&h(t,["tunedModelDisplayName"],r);const u=d(o,["description"]);t!==void 0&&u!=null&&h(t,["description"],u);const p=d(o,["epochCount"]);t!==void 0&&p!=null&&h(t,["supervisedTuningSpec","hyperParameters","epochCount"],p);const y=d(o,["learningRateMultiplier"]);t!==void 0&&y!=null&&h(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],y);const x=d(o,["exportLastCheckpointOnly"]);t!==void 0&&x!=null&&h(t,["supervisedTuningSpec","exportLastCheckpointOnly"],x);const m=d(o,["adapterSize"]);if(t!==void 0&&m!=null&&h(t,["supervisedTuningSpec","hyperParameters","adapterSize"],m),d(o,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(o,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const v=d(o,["labels"]);return t!==void 0&&v!=null&&h(t,["labels"],v),s}function Z2(o){const t={},s=d(o,["baseModel"]);s!=null&&h(t,["baseModel"],s);const a=d(o,["preTunedModel"]);a!=null&&h(t,["preTunedModel"],a);const r=d(o,["trainingDataset"]);r!=null&&h(t,["tuningTask","trainingData"],rS(r));const u=d(o,["config"]);return u!=null&&K2(u,t),t}function W2(o){const t={},s=d(o,["baseModel"]);s!=null&&h(t,["baseModel"],s);const a=d(o,["preTunedModel"]);a!=null&&h(t,["preTunedModel"],a);const r=d(o,["trainingDataset"]);r!=null&&h(t,["supervisedTuningSpec","trainingDatasetUri"],cS(r,t));const u=d(o,["config"]);return u!=null&&$2(u,t),t}function Q2(o){const t={},s=d(o,["name"]);return s!=null&&h(t,["_url","name"],s),t}function eS(o){const t={},s=d(o,["name"]);return s!=null&&h(t,["_url","name"],s),t}function tS(o,t){const s={},a=d(o,["pageSize"]);t!==void 0&&a!=null&&h(t,["_query","pageSize"],a);const r=d(o,["pageToken"]);t!==void 0&&r!=null&&h(t,["_query","pageToken"],r);const u=d(o,["filter"]);return t!==void 0&&u!=null&&h(t,["_query","filter"],u),s}function nS(o,t){const s={},a=d(o,["pageSize"]);t!==void 0&&a!=null&&h(t,["_query","pageSize"],a);const r=d(o,["pageToken"]);t!==void 0&&r!=null&&h(t,["_query","pageToken"],r);const u=d(o,["filter"]);return t!==void 0&&u!=null&&h(t,["_query","filter"],u),s}function oS(o){const t={},s=d(o,["config"]);return s!=null&&tS(s,t),t}function lS(o){const t={},s=d(o,["config"]);return s!=null&&nS(s,t),t}function sS(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["nextPageToken"]);a!=null&&h(t,["nextPageToken"],a);const r=d(o,["tunedModels"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>ey(p))),h(t,["tuningJobs"],u)}return t}function aS(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["nextPageToken"]);a!=null&&h(t,["nextPageToken"],a);const r=d(o,["tuningJobs"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(p=>Du(p))),h(t,["tuningJobs"],u)}return t}function iS(o){const t={},s=d(o,["name"]);s!=null&&h(t,["model"],s);const a=d(o,["name"]);return a!=null&&h(t,["endpoint"],a),t}function rS(o){const t={};if(d(o,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(o,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const s=d(o,["examples"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(r=>r)),h(t,["examples","examples"],a)}return t}function cS(o,t){const s={},a=d(o,["gcsUri"]);t!==void 0&&a!=null&&h(t,["supervisedTuningSpec","trainingDatasetUri"],a);const r=d(o,["vertexDatasetResource"]);if(t!==void 0&&r!=null&&h(t,["supervisedTuningSpec","trainingDatasetUri"],r),d(o,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return s}function ey(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["name"]);a!=null&&h(t,["name"],a);const r=d(o,["state"]);r!=null&&h(t,["state"],jg(r));const u=d(o,["createTime"]);u!=null&&h(t,["createTime"],u);const p=d(o,["tuningTask","startTime"]);p!=null&&h(t,["startTime"],p);const y=d(o,["tuningTask","completeTime"]);y!=null&&h(t,["endTime"],y);const x=d(o,["updateTime"]);x!=null&&h(t,["updateTime"],x);const m=d(o,["description"]);m!=null&&h(t,["description"],m);const v=d(o,["baseModel"]);v!=null&&h(t,["baseModel"],v);const b=d(o,["_self"]);return b!=null&&h(t,["tunedModel"],iS(b)),t}function Du(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["name"]);a!=null&&h(t,["name"],a);const r=d(o,["state"]);r!=null&&h(t,["state"],jg(r));const u=d(o,["createTime"]);u!=null&&h(t,["createTime"],u);const p=d(o,["startTime"]);p!=null&&h(t,["startTime"],p);const y=d(o,["endTime"]);y!=null&&h(t,["endTime"],y);const x=d(o,["updateTime"]);x!=null&&h(t,["updateTime"],x);const m=d(o,["error"]);m!=null&&h(t,["error"],m);const v=d(o,["description"]);v!=null&&h(t,["description"],v);const b=d(o,["baseModel"]);b!=null&&h(t,["baseModel"],b);const S=d(o,["tunedModel"]);S!=null&&h(t,["tunedModel"],S);const N=d(o,["preTunedModel"]);N!=null&&h(t,["preTunedModel"],N);const _=d(o,["supervisedTuningSpec"]);_!=null&&h(t,["supervisedTuningSpec"],_);const M=d(o,["tuningDataStats"]);M!=null&&h(t,["tuningDataStats"],M);const G=d(o,["encryptionSpec"]);G!=null&&h(t,["encryptionSpec"],G);const k=d(o,["partnerModelTuningSpec"]);k!=null&&h(t,["partnerModelTuningSpec"],k);const V=d(o,["customBaseModel"]);V!=null&&h(t,["customBaseModel"],V);const R=d(o,["experiment"]);R!=null&&h(t,["experiment"],R);const B=d(o,["labels"]);B!=null&&h(t,["labels"],B);const U=d(o,["outputUri"]);U!=null&&h(t,["outputUri"],U);const $=d(o,["pipelineJob"]);$!=null&&h(t,["pipelineJob"],$);const D=d(o,["serviceAccount"]);D!=null&&h(t,["serviceAccount"],D);const E=d(o,["tunedModelDisplayName"]);E!=null&&h(t,["tunedModelDisplayName"],E);const K=d(o,["veoTuningSpec"]);return K!=null&&h(t,["veoTuningSpec"],K),t}function uS(o){const t={},s=d(o,["sdkHttpResponse"]);s!=null&&h(t,["sdkHttpResponse"],s);const a=d(o,["name"]);a!=null&&h(t,["name"],a);const r=d(o,["metadata"]);r!=null&&h(t,["metadata"],r);const u=d(o,["done"]);u!=null&&h(t,["done"],u);const p=d(o,["error"]);return p!=null&&h(t,["error"],p),t}function dS(o,t){const s={},a=d(o,["gcsUri"]);a!=null&&h(s,["validationDatasetUri"],a);const r=d(o,["vertexDatasetResource"]);return t!==void 0&&r!=null&&h(t,["supervisedTuningSpec","trainingDatasetUri"],r),s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fS extends jl{constructor(t){super(),this.apiClient=t,this.get=async s=>await this.getInternal(s),this.list=async(s={})=>new Sa(Dl.PAGED_ITEM_TUNING_JOBS,a=>this.listInternal(a),await this.listInternal(s),s),this.tune=async s=>{var a;if(this.apiClient.isVertexAI())if(s.baseModel.startsWith("projects/")){const r={tunedModelName:s.baseModel};!((a=s.config)===null||a===void 0)&&a.preTunedModelCheckpointId&&(r.checkpointId=s.config.preTunedModelCheckpointId);const u=Object.assign(Object.assign({},s),{preTunedModel:r});return u.baseModel=void 0,await this.tuneInternal(u)}else{const r=Object.assign({},s);return await this.tuneInternal(r)}else{const r=Object.assign({},s),u=await this.tuneMldevInternal(r);let p="";return u.metadata!==void 0&&u.metadata.tunedModel!==void 0?p=u.metadata.tunedModel:u.name!==void 0&&u.name.includes("/operations/")&&(p=u.name.split("/operations/")[0]),{name:p,state:Nu.JOB_STATE_QUEUED}}}}async getInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=eS(t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>Du(v))}else{const m=Q2(t);return y=Pe("{name}",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>ey(v))}}async listInternal(t){var s,a,r,u;let p,y="",x={};if(this.apiClient.isVertexAI()){const m=lS(t);return y=Pe("tuningJobs",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=aS(v),S=new Im;return Object.assign(S,b),S})}else{const m=oS(t);return y=Pe("tunedModels",m._url),x=m._query,delete m._url,delete m._query,p=this.apiClient.request({path:y,queryParams:x,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal}).then(v=>v.json().then(b=>{const S=b;return S.sdkHttpResponse={headers:v.headers},S})),p.then(v=>{const b=sS(v),S=new Im;return Object.assign(S,b),S})}}async cancel(t){var s,a,r,u;let p="",y={};if(this.apiClient.isVertexAI()){const x=X2(t);p=Pe("{name}:cancel",x._url),y=x._query,delete x._url,delete x._query,await this.apiClient.request({path:p,queryParams:y,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal})}else{const x=J2(t);p=Pe("{name}:cancel",x._url),y=x._query,delete x._url,delete x._query,await this.apiClient.request({path:p,queryParams:y,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(r=t.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=t.config)===null||u===void 0?void 0:u.abortSignal})}}async tuneInternal(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI()){const y=W2(t);return u=Pe("tuningJobs",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:x.headers},v})),r.then(x=>Du(x))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var s,a;let r,u="",p={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const y=Z2(t);return u=Pe("tunedModels",y._url),p=y._query,delete y._url,delete y._query,r=this.apiClient.request({path:u,queryParams:p,body:JSON.stringify(y),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=t.config)===null||a===void 0?void 0:a.abortSignal}).then(x=>x.json().then(m=>{const v=m;return v.sdkHttpResponse={headers:x.headers},v})),r.then(x=>uS(x))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hS{async download(t,s){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const pS=1024*1024*8,mS=3,gS=1e3,yS=2,xu="x-goog-upload-status";async function xS(o,t,s){var a,r,u;let p=0,y=0,x=new Au(new Response),m="upload";for(p=o.size;y<p;){const b=Math.min(pS,p-y),S=o.slice(y,y+b);y+b>=p&&(m+=", finalize");let N=0,_=gS;for(;N<mS&&(x=await s.request({path:"",body:S,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":String(y),"Content-Length":String(b)}}}),!(!((a=x==null?void 0:x.headers)===null||a===void 0)&&a[xu]));)N++,await bS(_),_=_*yS;if(y+=b,((r=x==null?void 0:x.headers)===null||r===void 0?void 0:r[xu])!=="active")break;if(p<=y)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const v=await(x==null?void 0:x.json());if(((u=x==null?void 0:x.headers)===null||u===void 0?void 0:u[xu])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return v.file}async function vS(o){return{size:o.size,type:o.type}}function bS(o){return new Promise(t=>setTimeout(t,o))}class CS{async upload(t,s,a){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await xS(t,s,a)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await vS(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SS{create(t,s,a){return new ES(t,s,a)}}class ES{constructor(t,s,a){this.url=t,this.headers=s,this.callbacks=a}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Zm="x-goog-api-key";class TS{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(t.get(Zm)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(Zm,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wS="gl-node/";class NS{constructor(t){var s;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=t.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=t.apiKey;const a=O0(t.httpOptions,t.vertexai,void 0,void 0);a&&(t.httpOptions?t.httpOptions.baseUrl=a:t.httpOptions={baseUrl:a}),this.apiVersion=t.apiVersion;const r=new TS(this.apiKey);this.apiClient=new u2({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:wS+"web",uploader:new CS,downloader:new hS}),this.models=new R2(this.apiClient),this.live=new E2(this.apiClient,r,new SS),this.batches=new cb(this.apiClient),this.chats=new Gb(this.models,this.apiClient),this.caches=new Pb(this.apiClient),this.files=new Zb(this.apiClient),this.operations=new I2(this.apiClient),this.authTokens=new Y2(this.apiClient),this.tunings=new fS(this.apiClient)}}const AS={apiKey:"AIzaSyBK5eiKiX7GFTVMy_LrTYDKYVEfoV8vImY",authDomain:"sketcher-companion.firebaseapp.com",projectId:"sketcher-companion",storageBucket:"sketcher-companion.firebasestorage.app",messagingSenderId:"629894472307",appId:"1:629894472307:web:7be8c8a190d1e9a25e4006"},Hu=w0(AS),Lu=b0(Hu),xo=N0(Hu),vo=M0(Hu),Ji=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"m4 4 7.07 17 2.51-7.39 7.39-2.51L4 4z"})}),Cs=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:o,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})}),Ea=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21H7Z"}),c.jsx("path",{d:"M18 9 9.5 17.5"})]}),Xi=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M17 3l5 5L9 21H4v-5L17 3z"}),c.jsx("path",{d:"M15 5l5 5"}),c.jsx("path",{d:"M7 13l-2.5 2.5"}),c.jsx("path",{d:"M14 20h5"})]}),Ki=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M5 3h14"}),c.jsx("path",{d:"M12 3v18"})]}),_S=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),c.jsx("polyline",{points:"2 17 12 22 22 17"}),c.jsx("polyline",{points:"2 12 12 17 22 12"})]}),Wm=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),c.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Qm=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"m9.9 9.9 4.2 4.2"}),c.jsx("path",{d:"M10.5 10.5c.5.5.8 1.2.8 2s-.3 1.5-.8 2"}),c.jsx("path",{d:"M13.5 13.5c-.5-.5-.8-1.2-.8-2s.3-1.5.8-2"}),c.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7a13.3 13.3 0 0 1-5-1.2"}),c.jsx("path",{d:"m2 2 20 20"})]}),Vi=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),c.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),$i=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M4 20L17 7"}),c.jsx("path",{d:"M17 5H21M19 3V7"}),c.jsx("path",{d:"M18 4L20 6M18 6L20 4"})]}),Zi=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"2 2",children:c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"})}),Wi=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M12 22a7 7 0 0 0-7-7c0-4 7-4 7-10 0 6 7 6 7 10a7 7 0 0 0-7 7z"}),c.jsx("path",{d:"M12 15a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"})]}),Ta=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"m9.88 2.88 1.42 1.42"}),c.jsx("path",{d:"m14.12 2.88 1.42-1.42"}),c.jsx("path",{d:"m12 6.88-1.42-1.42"}),c.jsx("path",{d:"M16 8 2 2"}),c.jsx("path",{d:"M12 22V10"}),c.jsx("path",{d:"M7 10H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2"}),c.jsx("path",{d:"m19 10 2 2"}),c.jsx("path",{d:"M17 10h2a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-2"})]}),Ll=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("polyline",{points:"3 6 5 6 21 6"}),c.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),Qi=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),c.jsx("polyline",{points:"17 8 12 3 7 8"}),c.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),zi=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.23A2 2 0 0 0 8.27 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"})}),eg=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),c.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),c.jsx("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})]}),ty=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("circle",{cx:"11",cy:"11",r:"8"}),c.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),c.jsx("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),c.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"})]}),ny=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("circle",{cx:"11",cy:"11",r:"8"}),c.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),c.jsx("line",{x1:"8",y1:"11",x2:"14",y2:"11"})]}),oy=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:o,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.05 4.575a1.575 1.575 0 1 0-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 0 1 3.15 0v1.5m-3.15 0 .075 5.925m3.075.75V4.575m0 0a1.575 1.575 0 0 1 3.15 0V15M6.9 7.575a1.575 1.575 0 1 0-3.15 0v8.175a6.75 6.75 0 0 0 6.75 6.75h2.018a5.25 5.25 0 0 0 3.712-1.538l1.732-1.732a5.25 5.25 0 0 0 1.538-3.712l.003-2.024a.668.668 0 0 1 .198-.471 1.575 1.575 0 1 0-2.228-2.228 3.818 3.818 0 0 0-1.12 2.687M6.9 7.575V12m6.27 4.318A4.49 4.49 0 0 1 16.35 15m.002 0h-.002"})}),ly=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10"}),c.jsx("line",{x1:"22",y1:"12",x2:"18",y2:"12"}),c.jsx("line",{x1:"6",y1:"12",x2:"2",y2:"12"}),c.jsx("line",{x1:"12",y1:"6",x2:"12",y2:"2"}),c.jsx("line",{x1:"12",y1:"22",x2:"12",y2:"18"})]}),tg=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M12 22v-8"}),c.jsx("path",{d:"m15 17-3 3-3-3"}),c.jsx("path",{d:"M3 3v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3"})]}),MS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M12 2v8"}),c.jsx("path",{d:"m15 7-3-3-3 3"}),c.jsx("path",{d:"M3 21v-10a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10"})]}),RS=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"m6 9 6 6 6-6"})}),sy=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M3 7v6h6"}),c.jsx("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]}),ay=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M21 7v6h-6"}),c.jsx("path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"})]}),IS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),c.jsx("path",{d:"M21 3v5h-5"}),c.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),c.jsx("path",{d:"M3 21v-5h5"})]}),iy=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),c.jsx("polyline",{points:"15 3 21 3 21 9"}),c.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]}),er=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M6.13 1L6 16a2 2 0 0 0 2 2h15"}),c.jsx("path",{d:"M1 6.13L16 6a2 2 0 0 1 2 2v15"})]}),ry=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("polyline",{points:"20 6 9 17 4 12"})}),bo=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),c.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),kS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("circle",{cx:"6",cy:"6",r:"3"}),c.jsx("circle",{cx:"18",cy:"18",r:"3"}),c.jsx("line",{x1:"8.12",y1:"8.12",x2:"15.88",y2:"15.88"})]}),DS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M3 21h18"}),c.jsx("path",{d:"M7 21l3-14"}),c.jsx("path",{d:"M17 21l-3-14"}),c.jsx("path",{d:"M10 7h4"})]}),LS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),c.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),jS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M12 2v20"}),c.jsx("path",{d:"M5 12a7.7 7.7 0 0 0 7 7.7 7.7 7.7 0 0 0 7-7.7c0-4.5-3-7.7-7-7.7-4 0-7 3.2-7 7.7z"}),c.jsx("path",{d:"M19 12a7.7 7.7 0 0 1-7 7.7 7.7 7.7 0 0 1-7-7.7c0-4.5 3-7.7 7-7.7 4 0 7 3.2 7 7.7z"})]}),ng=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}),c.jsx("path",{d:"M3 9h18M3 15h18M9 3v18M15 3v18"})]}),US=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M12 2 22 8 12 14 2 8 12 2z"}),c.jsx("path",{d:"m2 8 v8 l10 6 10-6 V8"}),c.jsx("path",{d:"m12 14 v8"})]}),og=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),c.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),lg=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),c.jsx("path",{d:"M7 11V7a5 5 0 0 1 9.9-1"})]}),tr=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M4 4L20 4L20 20L4 20Z",strokeDasharray:"2 2",strokeWidth:"1.5"}),c.jsx("path",{d:"M7 7L17 7L17 17L7 17Z"}),c.jsx("path",{d:"M4 4m-1.5 0a1.5 1.5 0 1 0 3 0a1.5 1.5 0 1 0-3 0"}),c.jsx("path",{d:"M20 4m-1.5 0a1.5 1.5 0 1 0 3 0a1.5 1.5 0 1 0-3 0"}),c.jsx("path",{d:"M4 20m-1.5 0a1.5 1.5 0 1 0 3 0a1.5 1.5 0 1 0-3 0"}),c.jsx("path",{d:"M20 20m-1.5 0a1.5 1.5 0 1 0 3 0a1.5 1.5 0 1 0-3 0"})]}),nr=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M5 5L19 3l-1 16L4 18z"}),c.jsx("circle",{cx:"5",cy:"5",r:"1.5"}),c.jsx("circle",{cx:"19",cy:"3",r:"1.5"}),c.jsx("circle",{cx:"18",cy:"19",r:"1.5"}),c.jsx("circle",{cx:"4",cy:"18",r:"1.5"})]}),zS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("circle",{cx:"12",cy:"12",r:"4"}),c.jsx("path",{d:"M12 2v2"}),c.jsx("path",{d:"M12 20v2"}),c.jsx("path",{d:"m4.93 4.93 1.41 1.41"}),c.jsx("path",{d:"m17.66 17.66 1.41 1.41"}),c.jsx("path",{d:"M2 12h2"}),c.jsx("path",{d:"M20 12h2"}),c.jsx("path",{d:"m6.34 17.66-1.41 1.41"}),c.jsx("path",{d:"m19.07 4.93-1.41 1.41"})]}),PS=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"})}),cy=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),c.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),BS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("circle",{cx:"6",cy:"6",r:"3"}),c.jsx("circle",{cx:"6",cy:"18",r:"3"}),c.jsx("line",{x1:"20",y1:"4",x2:"8.12",y2:"15.88"}),c.jsx("line",{x1:"14.47",y1:"14.48",x2:"20",y2:"20"}),c.jsx("line",{x1:"8.12",y1:"8.12",x2:"12",y2:"12"})]}),qS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),c.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})]}),GS=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"m15 18-6-6 6-6"})}),uy=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"m9 18 6-6-6-6"})}),dy=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),c.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),VS=({className:o})=>c.jsxs("svg",{className:o,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),c.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),c.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z",fill:"#FBBC05"}),c.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),HS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),c.jsx("polyline",{points:"16 17 21 12 16 7"}),c.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),fy=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),c.jsx("polyline",{points:"5 12 12 5 19 12"})]}),OS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),c.jsx("polyline",{points:"19 12 12 19 5 12"})]}),vu=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M4 13a8 8 0 0 1 8-8v8h8a8 8 0 0 1-8 8 8 8 0 0 1-8-8z"}),c.jsx("path",{d:"M4 21V19"}),c.jsx("path",{d:"M20 21V19"}),c.jsx("path",{d:"M12 4V2"})]}),hy=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"m19 21-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"})}),FS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),c.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),c.jsx("polyline",{points:"7 3 7 8 15 8"})]}),YS=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),JS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),c.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),c.jsx("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}),sg=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M4 12c4 0 8-4 16-4"})}),ag=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("line",{x1:"4",y1:"20",x2:"20",y2:"4"})}),ig=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M4 20 10 4 16 16 20 12"})}),rg=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M4 12A8 8 0 0 1 12 4"})}),cg=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M4 4c4 0 8 8 16 8"})}),XS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M15 3h6v6"}),c.jsx("path",{d:"M9 21H3v-6"}),c.jsx("path",{d:"M21 3l-7 7"}),c.jsx("path",{d:"M3 21l7-7"})]}),KS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M4 14h6v6"}),c.jsx("path",{d:"M20 10h-6V4"}),c.jsx("path",{d:"M14 10l7-7"}),c.jsx("path",{d:"M3 21l7-7"})]}),ug=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12"})}),dg=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M4 12h4m6 0h4m-5 0h2"})}),fg=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M4 12h.01M8 12h.01M12 12h.01M16 12h.01M20 12h.01"})}),hg=({className:o})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M4 12h4m4 0h.01M16 12h4"})}),$S=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),c.jsx("path",{d:"M3 3v5h5"}),c.jsx("path",{d:"M12 7v5l4 2"})]}),ju=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("circle",{cx:"12",cy:"12",r:"1"}),c.jsx("circle",{cx:"12",cy:"5",r:"1"}),c.jsx("circle",{cx:"12",cy:"19",r:"1"})]}),ZS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("line",{x1:"12",y1:"13",x2:"12",y2:"23"}),c.jsx("line",{x1:"7",y1:"18",x2:"17",y2:"18"}),c.jsx("line",{x1:"12",y1:"7",x2:"12",y2:"1"}),c.jsx("polyline",{points:"9 4 12 1 15 4"})]}),WS=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"11"}),c.jsx("line",{x1:"7",y1:"6",x2:"17",y2:"6"}),c.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"23"}),c.jsx("polyline",{points:"9 20 12 23 15 20"})]}),or=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M20.7 7.3c-2-2.7-5.3-4.3-8.7-4.3-4.9 0-9 4-9 9 0 2.6.9 5 2.5 6.7"}),c.jsx("path",{d:"M12 21c-2.4 0-4.6-.9-6.3-2.5"}),c.jsx("path",{d:"m15.5 13.5-3.8 2.3"}),c.jsx("path",{d:"M18 10.2s-2.3 2.5-5.5 1.6"}),c.jsx("path",{d:"M13.2 5.3s3.1-1.1 5.4 1.1"})]}),lr=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"M6 18h4"}),c.jsx("path",{d:"M14 18h4"}),c.jsx("path",{d:"M10 22h4"}),c.jsx("path",{d:"M12 18v-4"}),c.jsx("path",{d:"M12 14c-4.42 0-8-2.69-8-6s3.58-6 8-6 8 2.69 8 6"}),c.jsx("path",{d:"M12 2a4 4 0 0 0-4 4"})]}),ws=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"m16.86 3.46 1.41-1.41a2 2 0 1 1 2.83 2.83l-1.41 1.41"}),c.jsx("path",{d:"m3.46 16.86 1.41-1.41a2 2 0 1 1 2.83 2.83l-1.41 1.41"}),c.jsx("path",{d:"M3 21v-3h3"}),c.jsx("path",{d:"M21 3v3h-3"}),c.jsx("path",{d:"M12 3v3"}),c.jsx("path",{d:"M12 21v-3"}),c.jsx("path",{d:"M3 12h3"}),c.jsx("path",{d:"M21 12h-3"}),c.jsx("path",{d:"m16.86 15.46.7-.7a2 2 0 1 0-2.83-2.83l-.7.7"}),c.jsx("path",{d:"m8.54 7.14-.7.7a2 2 0 1 0 2.83 2.83l.7-.7"})]}),sr=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"m16.86 3.46 1.41-1.41a2 2 0 1 1 2.83 2.83l-1.41 1.41m-12.02 12.02 1.41-1.41a2 2 0 1 1 2.83 2.83l-1.41 1.41"}),c.jsx("path",{d:"m6.34 17.66 11.32-11.32"})]}),ar=({className:o})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("path",{d:"m20.55 3.45-1.5 1.5"}),c.jsx("path",{d:"m16 6 3.19 3.19"}),c.jsx("path",{d:"M14.28 15.16 5.72 6.6a2.07 2.07 0 0 0-2.93 0L2.2 7.19a2.07 2.07 0 0 0 0 2.93l8.56 8.56"}),c.jsx("path",{d:"M18 11.45c0 3.22-2.1 5.5-5.34 5.5-1.7 0-3.32-.83-4.48-2.22"}),c.jsx("path",{d:"M18.01 19.38c.6-.57.99-1.37.99-2.25 0-1.77-1.43-3.2-3.2-3.2-1.29 0-2.4.76-2.93 1.84"})]}),Fn=({title:o,children:t,defaultOpen:s=!1})=>{const[a,r]=T.useState(s);return c.jsxs("div",{className:"border-b border-[--bg-tertiary]",children:[c.jsxs("button",{onClick:()=>r(!a),className:"w-full flex justify-between items-center p-2 text-xs font-bold uppercase text-[--text-secondary] hover:bg-[--bg-tertiary]",children:[c.jsx("span",{children:o}),c.jsx(RS,{className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`})]}),a&&c.jsx("div",{className:"p-4 space-y-4",children:t})]})},QS=[{name:"Normal",value:"source-over"},{name:"Multiply",value:"multiply"},{name:"Screen",value:"screen"},{name:"Overlay",value:"overlay"},{name:"Darken",value:"darken"},{name:"Lighten",value:"lighten"},{name:"Color Dodge",value:"color-dodge"},{name:"Color Burn",value:"color-burn"},{name:"Hard Light",value:"hard-light"},{name:"Soft Light",value:"soft-light"},{name:"Difference",value:"difference"},{name:"Exclusion",value:"exclusion"},{name:"Hue",value:"hue"},{name:"Saturation",value:"saturation"},{name:"Color",value:"color"},{name:"Luminosity",value:"luminosity"}],eE=["Arial","Verdana","Georgia","Courier New","Lucida Console","Impact","Comic Sans MS"],pg=[{tool:"marquee-rect",name:"Marco Rectangular",icon:Zi},{tool:"lasso",name:"Lazo",icon:Wi},{tool:"magic-wand",name:"Varita Mgica",icon:Ta}],mg=[{tool:"brush",name:"Rapidograph Solido",icon:Cs},{tool:"simple-marker",name:"Marcador Slido",icon:Xi},{tool:"advanced-marker",name:"Marcador Avanzado",icon:or},{tool:"natural-marker",name:"Marcador Natural",icon:sr},{tool:"airbrush",name:"Aergrafo",icon:lr},{tool:"fx-brush",name:"Pincel de Efectos",icon:ws},{tool:"watercolor",name:"Acuarela",icon:ar}],gg={select:Ji,"marquee-rect":Zi,lasso:Wi,"magic-wand":Ta,brush:Cs,eraser:Ea,"simple-marker":Xi,transform:tr,"free-transform":nr,enhance:$i,crop:er,pan:()=>null,"debug-brush":Cs,text:Ki,"natural-marker":sr,airbrush:lr,"fx-brush":ws,"advanced-marker":or,watercolor:ar},tE=({tool:o,setTool:t,brushSettings:s,setBrushSettings:a,eraserSettings:r,setEraserSettings:u,simpleMarkerSettings:p,setSimpleMarkerSettings:y,naturalMarkerSettings:x,setNaturalMarkerSettings:m,airbrushSettings:v,setAirbrushSettings:b,fxBrushSettings:S,setFxBrushSettings:N,advancedMarkerSettings:_,setAdvancedMarkerSettings:M,watercolorSettings:G,setWatercolorSettings:k,magicWandSettings:V,setMagicWandSettings:R,textSettings:B,setTextSettings:U,activeGuide:$,setActiveGuide:D,isOrthogonalVisible:E,onToggleOrthogonal:K,onExportClick:I,onEnhance:X,isEnhancing:L,enhancementPreview:H,onGenerateEnhancementPreview:ue,objects:ve,libraryItems:j,backgroundDataUrl:z,debugInfo:oe,strokeMode:ge,setStrokeMode:Z,strokeModifier:A,setStrokeModifier:O,brushPresets:W,...ye})=>{const[be,me]=T.useState(null),[Me,De]=T.useState(null),[Ae,Ke]=T.useState(null),mt=T.useRef(null),Rt=T.useRef(null),[he,Ee]=T.useState(!1),[Se,je]=T.useState(!1),Ve=T.useRef(null),[Fe,tt]=T.useState(!1),rt=T.useRef(null),[Ht,Ze]=T.useState(!1),It=T.useRef(null),[$e,bt]=T.useState(!1),Ue=T.useRef(null),[We,Ut]=T.useState("marquee-rect"),[mn,un]=T.useState("brush"),[ft,Yt]=T.useState("object"),[hn,Wt]=T.useState(""),[Qt,At]=T.useState(""),[Ot,Et]=T.useState(""),[Ne,_e]=T.useState(100),[Ge,it]=T.useState("none"),[ct,gt]=T.useState("full"),[Oe,Ye]=T.useState("#FFFFFF"),[at,Ct]=T.useState(""),[Te,Ce]=T.useState(null),[Ie,ae]=T.useState(!1),[Y,le]=T.useState(""),[xe,we]=T.useState(!0),[ke,Re]=T.useState({main:null,a:null,b:null,c:null}),Le=T.useRef(null),Je=T.useRef(null),[nt,St]=T.useState({description:[],style:[],negative:[]}),[ot,Ft]=T.useState({openFor:null,anchorEl:null}),$t=T.useRef(null);T.useEffect(()=>{try{const fe=localStorage.getItem("sketcher-ai-prompts");fe&&St(JSON.parse(fe))}catch(fe){console.error("Failed to load prompts from localStorage",fe)}},[]),T.useEffect(()=>{const fe=q=>{$t.current&&!$t.current.contains(q.target)&&Ft({openFor:null,anchorEl:null}),Ve.current&&!Ve.current.contains(q.target)&&je(!1),rt.current&&!rt.current.contains(q.target)&&tt(!1),It.current&&!It.current.contains(q.target)&&Ze(!1),Ue.current&&!Ue.current.contains(q.target)&&bt(!1),be!=="enhance"&&mt.current&&!mt.current.contains(q.target)&&Me&&!Me.contains(q.target)&&(me(null),De(null),Ke(null))};return document.addEventListener("mousedown",fe),()=>document.removeEventListener("mousedown",fe)},[Me,be]),T.useEffect(()=>{he?Ge==="none"&&it("green"):it("none")},[he,it]),T.useEffect(()=>{pg.some(fe=>fe.tool===o)?Ut(o):mg.some(fe=>fe.tool===o)&&un(o)},[o]);const _t=fe=>{o!==fe&&(me(null),De(null),Ke(null)),t(fe)},gn=(fe,q)=>{fe==="enhance"&&be!=="enhance"&&ue(),me(ie=>{const xt=q.currentTarget;return ie===fe&&Me===xt?(De(null),Ke(null),null):(De(xt),Ke(null),je(!1),tt(!1),Ze(!1),bt(!1),fe)})},Sn=(fe,q)=>{fe.stopPropagation();const ie=fe.currentTarget,xt=ie.getBoundingClientRect(),Gt=Rt.current.getBoundingClientRect();Ze(!1),bt(!1),je(!1),tt(!1),Ke({left:xt.right-Gt.left+8,top:xt.top-Gt.top}),De(ie),me(q)},nn=fe=>`p-3 rounded-lg transition-colors ${o===fe?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,Jn=fe=>{if(fe.preventDefault(),ae(!1),fe.dataTransfer.files&&fe.dataTransfer.files[0]){const q=fe.dataTransfer.files[0];if(q.type.startsWith("image/")){const ie=new FileReader;ie.onload=xt=>{var Gt;Ce({url:(Gt=xt.target)==null?void 0:Gt.result,name:q.name})},ie.readAsDataURL(q)}}},En=(fe,q)=>{if(fe.preventDefault(),fe.stopPropagation(),fe.dataTransfer.files&&fe.dataTransfer.files.length>0){const ie=fe.dataTransfer.files[0];if(ie.type.startsWith("image/")){const xt=new FileReader;xt.onload=Gt=>{var Kn;const wn=(Kn=Gt.target)==null?void 0:Kn.result;Re(fo=>({...fo,[q]:{id:`file-${Date.now()}`,type:"file",url:wn,name:ie.name}}))},xt.readAsDataURL(ie)}return}try{const ie=fe.dataTransfer.getData("application/json");if(!ie)return;const xt=JSON.parse(ie);if(xt.type==="outliner-item"){const Gt=ve.find(wn=>wn.id===xt.id);if(Gt&&Gt.type==="object"&&Gt.canvas){const wn=Gt.canvas.toDataURL();Re(Kn=>({...Kn,[q]:{id:Gt.id,type:"outliner",url:wn,name:Gt.name}}))}}else if(xt.type==="library-item"){const Gt=j.find(wn=>wn.id===xt.id);Gt&&Gt.type==="image"&&Gt.dataUrl&&Re(wn=>({...wn,[q]:{id:Gt.id,type:"library",url:Gt.dataUrl,name:Gt.name}}))}}catch(ie){console.error("Error handling drop:",ie)}},zt=fe=>{if(fe.target.files&&fe.target.files[0]&&Je.current){const q=fe.target.files[0],ie=Je.current,xt=new FileReader;xt.onload=Gt=>{var Kn;const wn=(Kn=Gt.target)==null?void 0:Kn.result;Re(fo=>({...fo,[ie]:{id:`file-${Date.now()}`,type:"file",url:wn,name:q.name}}))},xt.readAsDataURL(q)}fe.target&&(fe.target.value=""),Je.current=null},Xn=(fe,q)=>{if(!q.trim()||nt[fe].includes(q.trim()))return;const ie={...nt,[fe]:[...nt[fe],q.trim()]};St(ie),localStorage.setItem("sketcher-ai-prompts",JSON.stringify(ie))},qo=(fe,q)=>{const ie={...nt,[fe]:nt[fe].filter(xt=>xt!==q)};St(ie),localStorage.setItem("sketcher-ai-prompts",JSON.stringify(ie))},Un=(fe,q)=>{fe==="description"&&Wt(q),fe==="style"&&At(q),fe==="negative"&&Et(q),Ft({openFor:null,anchorEl:null})},kt=({type:fe,value:q})=>c.jsxs("div",{className:"flex justify-end gap-2 mt-1",children:[c.jsx("button",{onClick:()=>Xn(fe,q),className:"text-xs px-2 py-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Guardar"}),c.jsx("button",{onClick:ie=>Ft({openFor:fe,anchorEl:ie.currentTarget}),className:"text-xs px-2 py-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cargar"})]}),zn=({slotData:fe,onDrop:q,onClear:ie,onFileSelect:xt,placeholder:Gt,className:wn=""})=>{const[Kn,fo]=T.useState(!1),rr=dn=>{dn.preventDefault(),dn.stopPropagation(),dn.dataTransfer.dropEffect="copy",fo(!0)},_s=dn=>{dn.preventDefault(),dn.stopPropagation(),fo(!1)},Ul=dn=>{_s(dn),q(dn)};return c.jsx("div",{onClick:fe?void 0:xt,onDrop:Ul,onDragOver:rr,onDragLeave:_s,onDragEnd:_s,className:`relative bg-[--bg-tertiary] rounded-md flex items-center justify-center text-center text-xs text-[--text-secondary] p-2 transition-all ${Kn?"border-2 border-dashed border-[--accent-primary]":"border-2 border-dashed border-transparent"} ${fe?"":"cursor-pointer"} ${wn}`,children:fe?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:fe.url,alt:fe.name,className:"max-w-full max-h-full object-contain rounded-md"}),c.jsx("button",{onClick:ie,className:"absolute top-1 right-1 p-0.5 w-5 h-5 flex items-center justify-center bg-black/50 hover:bg-red-600 rounded-full text-white text-base",children:c.jsx(bo,{className:"w-3 h-3"})})]}):c.jsxs("div",{className:"flex flex-col items-center gap-1 pointer-events-none",children:[c.jsx(Qi,{className:"w-5 h-5"}),c.jsx("span",{children:Gt}),c.jsx("span",{className:"text-[10px]",children:"(Arrastra o haz clic para cargar)"})]})})},ml=({value:fe,onChange:q})=>c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Modo de Fusin"}),c.jsx("select",{value:fe,onChange:ie=>q(ie.target.value),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-xs rounded-md p-2",children:QS.map(ie=>c.jsx("option",{value:ie.value,children:ie.name},ie.value))})]}),gl=fe=>{switch(fe){case"select":case"transform":case"free-transform":case"marquee-rect":case"lasso":return null;case"text":return c.jsxs("div",{className:"p-4 space-y-4",children:[c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Herramienta de Texto"}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Fuente"}),c.jsx("select",{value:B.fontFamily,onChange:q=>U(ie=>({...ie,fontFamily:q.target.value})),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-xs rounded-md p-2",children:eE.map(q=>c.jsx("option",{value:q,children:q},q))})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Tamao: ",B.fontSize,"px"]}),c.jsx("input",{type:"range",min:"8",max:"256",value:B.fontSize,onChange:q=>U(ie=>({...ie,fontSize:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Color"}),c.jsx("input",{type:"color",value:B.color,onChange:q=>U(ie=>({...ie,color:q.target.value})),className:"w-full h-8 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Alineacin"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsx("button",{onClick:()=>U(q=>({...q,textAlign:"left"})),className:`text-xs p-2 rounded ${B.textAlign==="left"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Izquierda"}),c.jsx("button",{onClick:()=>U(q=>({...q,textAlign:"center"})),className:`text-xs p-2 rounded ${B.textAlign==="center"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Centro"}),c.jsx("button",{onClick:()=>U(q=>({...q,textAlign:"right"})),className:`text-xs p-2 rounded ${B.textAlign==="right"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Derecha"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Estilo"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsx("button",{onClick:()=>U(q=>({...q,fontWeight:"normal"})),className:`text-xs p-2 rounded ${B.fontWeight==="normal"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Normal"}),c.jsx("button",{onClick:()=>U(q=>({...q,fontWeight:"bold"})),className:`text-xs p-2 rounded ${B.fontWeight==="bold"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Negrita"}),c.jsx("button",{onClick:()=>U(q=>({...q,fontWeight:"italic"})),className:`text-xs p-2 rounded ${B.fontWeight==="italic"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Cursiva"})]})]})]});case"magic-wand":return c.jsxs("div",{className:"p-4 space-y-4",children:[c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Varita Mgica"}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Tolerancia: ",V.tolerance]}),c.jsx("input",{type:"range",min:"0",max:"100",value:V.tolerance,onChange:q=>R(ie=>({...ie,tolerance:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"contiguous-toggle",className:"text-xs text-[--text-secondary]",children:"Contiguo (solo pxeles adyacentes)"}),c.jsx("button",{id:"contiguous-toggle",role:"switch","aria-checked":V.contiguous,onClick:()=>R(q=>({...q,contiguous:!q.contiguous})),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[--accent-primary] focus:ring-offset-[--bg-primary] ${V.contiguous?"bg-[--accent-primary]":"bg-[--bg-tertiary]"}`,children:c.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${V.contiguous?"translate-x-6":"translate-x-1"}`})})]})]});case"enhance":return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex border-b border-[--bg-tertiary]",children:[c.jsx("button",{onClick:()=>Yt("object"),className:`flex-1 p-2 text-sm font-semibold transition-colors ${ft==="object"?"text-[--accent-primary] border-b-2 border-[--accent-primary]":"text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,children:"OBJETO"}),c.jsx("button",{onClick:()=>Yt("composition"),className:`flex-1 p-2 text-sm font-semibold transition-colors ${ft==="composition"?"text-[--accent-primary] border-b-2 border-[--accent-primary]":"text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,children:"COMPOSICIN"}),c.jsx("button",{onClick:()=>Yt("free"),className:`flex-1 p-2 text-sm font-semibold transition-colors ${ft==="free"?"text-[--accent-primary] border-b-2 border-[--accent-primary]":"text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,children:"LIBRE"})]}),ft==="object"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{style:{backgroundColor:Oe},className:"rounded-md p-2 aspect-video flex items-center justify-center",children:H?c.jsx("img",{src:ct==="bbox"&&H.croppedDataUrl?H.croppedDataUrl:H.fullDataUrl,alt:"AI Input Preview",className:"max-w-full max-h-full object-contain"}):c.jsx("span",{className:"text-xs text-[--text-secondary]",children:"Generando vista previa..."})}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"preview-bg-color",className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Fondo"}),c.jsx("input",{type:"color",id:"preview-bg-color",value:Oe,onChange:q=>Ye(q.target.value),className:"w-full h-8 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer",disabled:L})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-2",children:"Imagen de Entrada"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:()=>gt("full"),disabled:L,className:`text-xs p-2 rounded transition-colors ${ct==="full"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Lienzo Completo"}),c.jsx("button",{onClick:()=>gt("bbox"),disabled:L||!(H!=null&&H.bbox),className:`text-xs p-2 rounded transition-colors ${ct==="bbox"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed"}`,children:"Ajustar a Contenido"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Descripcin del Objeto (Necesario)"}),c.jsx("textarea",{value:hn,onChange:q=>Wt(q.target.value),placeholder:"Ej: 'aade un castillo de fantasa en el fondo'",className:"w-full h-20 p-2 bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md resize-none",disabled:L}),c.jsx(kt,{type:"description",value:hn})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Estilo (Necesario)"}),c.jsx("textarea",{value:Qt,onChange:q=>At(q.target.value),placeholder:"Ej: 'fotorrealista, colores vivos, pintura al leo'",className:"w-full h-16 p-2 bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md resize-none",disabled:L}),c.jsx(kt,{type:"style",value:Qt})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Negativo/Evitar (Opcional)"}),c.jsx("textarea",{value:Ot,onChange:q=>Et(q.target.value),placeholder:"Ej: 'borroso, baja resolucin, texto, marcas de agua'",className:"w-full h-16 p-2 bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md resize-none",disabled:L}),c.jsx(kt,{type:"negative",value:Ot})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:["Creatividad: ",Ne]}),c.jsx("input",{type:"range",min:"0",max:"150",value:Ne,onChange:q=>_e(parseInt(q.target.value)),className:"w-full",disabled:L}),c.jsxs("div",{className:"flex justify-between text-xs text-[--text-secondary] mt-1",children:[c.jsx("span",{children:"Fiel"}),c.jsx("span",{children:"Equilibrado"}),c.jsx("span",{children:"Imaginativo"})]})]}),c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"chroma-key-toggle",className:"text-xs font-bold text-[--text-secondary]",children:"Forzar Fondo Chroma"}),c.jsx("button",{id:"chroma-key-toggle",role:"switch","aria-checked":he,onClick:()=>Ee(q=>!q),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[--accent-primary] focus:ring-offset-[--bg-primary] ${he?"bg-[--accent-primary]":"bg-[--bg-tertiary]"}`,disabled:L,children:c.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${he?"translate-x-6":"translate-x-1"}`})})]}),he&&c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:()=>it("green"),disabled:L,className:`text-xs p-2 rounded transition-colors ${Ge==="green"?"bg-green-600 text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Verde"}),c.jsx("button",{onClick:()=>it("blue"),disabled:L,className:`text-xs p-2 rounded transition-colors ${Ge==="blue"?"bg-blue-600 text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Azul"})]}),c.jsx("button",{onClick:()=>X({activeAiTab:ft,enhancementPrompt:hn,enhancementStylePrompt:Qt,enhancementNegativePrompt:Ot,enhancementCreativity:Ne,enhancementInputMode:ct,enhancementChromaKey:he?Ge:"none",enhancementPreviewBgColor:Oe}),disabled:!hn.trim()||!Qt.trim()||L,className:"w-full bg-[--accent-primary] hover:bg-[--accent-hover] text-white font-bold py-2 px-4 rounded-md disabled:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed mt-2",children:L?"Generando...":"Generar"}),L&&c.jsx("div",{className:"text-center text-xs text-[--text-secondary]",children:"Esto puede tardar unos momentos..."})]}),ft==="composition"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h5",{className:"font-bold text-md",children:"Composicin de Escena"}),c.jsx("p",{className:"text-xs text-[--text-secondary]",children:"Describe cmo combinar, estilizar o modificar la escena actual. La IA usar todos los objetos visibles y el fondo como base. El resultado reemplazar el fondo actual."}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Preview de Entrada"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("div",{className:"bg-[--bg-tertiary] p-1 rounded-md text-center aspect-video flex items-center justify-center flex-col",children:[H!=null&&H.fullDataUrl?c.jsx("img",{src:H.fullDataUrl,alt:"Composite Preview",className:"max-w-full max-h-[80%] object-contain"}):c.jsx("span",{className:"text-xs text-[--text-secondary]",children:"Cargando..."}),c.jsx("span",{className:"text-xs text-[--text-secondary] mt-1",children:"Objetos Visibles"})]}),c.jsxs("div",{className:"bg-[--bg-tertiary] p-1 rounded-md text-center aspect-video flex items-center justify-center flex-col",children:[z?c.jsx("img",{src:z,alt:"Background Preview",className:"max-w-full max-h-[80%] object-contain"}):c.jsx("span",{className:"text-xs text-[--text-secondary]",children:"Sin Fondo"}),c.jsx("span",{className:"text-xs text-[--text-secondary] mt-1",children:"Fondo"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Instrucciones de Composicin (Necesario)"}),c.jsx("textarea",{value:at,onChange:q=>Ct(q.target.value),placeholder:"Ej: 'mezcla los objetos en un estilo de acuarela, con una iluminacin suave desde la izquierda'",className:"w-full h-24 p-2 bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md resize-none",disabled:L})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Referencia de Estilo (Opcional)"}),c.jsx("div",{onDrop:Jn,onDragOver:q=>{q.preventDefault(),ae(!0)},onDragLeave:()=>ae(!1),className:`w-full h-24 p-2 bg-[--bg-tertiary] rounded-md flex items-center justify-center text-center transition-colors ${Ie?"border-2 border-dashed border-[--accent-primary]":"border-2 border-dashed border-transparent"}`,children:Te?c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:Te.url,alt:"Style reference",className:"max-h-20 object-contain"}),c.jsx("button",{onClick:()=>Ce(null),className:"absolute -top-1 -right-1 p-0.5 w-5 h-5 flex items-center justify-center bg-black/50 hover:bg-red-600 rounded-full text-white text-base",children:c.jsx(bo,{className:"w-3 h-3"})})]}):c.jsx("span",{className:"text-xs text-[--text-secondary]",children:"Arrastra una imagen de referencia aqu"})})]}),c.jsx("button",{onClick:()=>X({activeAiTab:ft,compositionPrompt:at,styleRef:Te}),disabled:!at.trim()||L,className:"w-full bg-[--accent-primary] hover:bg-[--accent-hover] text-white font-bold py-2 px-4 rounded-md disabled:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed mt-2",children:L?"Generando...":"Generar"})]}),ft==="free"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h5",{className:"font-bold text-md",children:"Creacin Libre"}),c.jsx("p",{className:"text-xs text-[--text-secondary]",children:"Arrastra objetos desde el Outliner/Librera o haz clic para cargar imgenes en las ranuras. Luego, describe cmo combinarlos."}),c.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:Le,onChange:zt}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(zn,{slotData:ke.main,onDrop:q=>En(q,"main"),onClear:()=>Re(q=>({...q,main:null})),onFileSelect:()=>{var q;Je.current="main",(q=Le.current)==null||q.click()},placeholder:"[Objeto 1] Principal",className:"h-28"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsx(zn,{slotData:ke.a,onDrop:q=>En(q,"a"),onClear:()=>Re(q=>({...q,a:null})),onFileSelect:()=>{var q;Je.current="a",(q=Le.current)==null||q.click()},placeholder:"[Aadido A]",className:"h-20"}),c.jsx(zn,{slotData:ke.b,onDrop:q=>En(q,"b"),onClear:()=>Re(q=>({...q,b:null})),onFileSelect:()=>{var q;Je.current="b",(q=Le.current)==null||q.click()},placeholder:"[Aadido B]",className:"h-20"}),c.jsx(zn,{slotData:ke.c,onDrop:q=>En(q,"c"),onClear:()=>Re(q=>({...q,c:null})),onFileSelect:()=>{var q;Je.current="c",(q=Le.current)==null||q.click()},placeholder:"[Aadido C]",className:"h-20"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Instrucciones"}),c.jsx("textarea",{value:Y,onChange:q=>le(q.target.value),placeholder:"Ej: Coloca [Objeto 1] en un paisaje similar a [Aadido A]",className:"w-full h-24 p-2 bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md resize-none",disabled:L})]}),c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"add-to-library-toggle-free",className:"text-xs font-bold text-[--text-secondary]",children:"Aadir a la Librera"}),c.jsx("button",{id:"add-to-library-toggle-free",role:"switch","aria-checked":xe,onClick:()=>we(q=>!q),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[--accent-primary] focus:ring-offset-[--bg-primary] ${xe?"bg-[--accent-primary]":"bg-[--bg-tertiary]"}`,disabled:L,children:c.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${xe?"translate-x-6":"translate-x-1"}`})})]}),c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"chroma-key-toggle-free",className:"text-xs font-bold text-[--text-secondary]",children:"Forzar Fondo Chroma"}),c.jsx("button",{id:"chroma-key-toggle-free",role:"switch","aria-checked":he,onClick:()=>Ee(q=>!q),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[--accent-primary] focus:ring-offset-[--bg-primary] ${he?"bg-[--accent-primary]":"bg-[--bg-tertiary]"}`,disabled:L,children:c.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${he?"translate-x-6":"translate-x-1"}`})})]}),c.jsx("button",{onClick:()=>X({activeAiTab:ft,freeFormPrompt:Y,freeFormSlots:ke,addEnhancedImageToLibrary:xe,enhancementChromaKey:he?Ge:"none"}),disabled:!Y.trim()||L,className:"w-full bg-[--accent-primary] hover:bg-[--accent-hover] text-white font-bold py-2 px-4 rounded-md disabled:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed mt-2",children:L?"Generando...":"Generar"})]}),oe&&c.jsxs(Fn,{title:"Debug Preview",defaultOpen:!0,children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Prompt Final Enviada"}),c.jsx("pre",{className:"text-xs p-2 bg-[--bg-tertiary] rounded-md whitespace-pre-wrap font-sans",children:oe.prompt})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-bold text-[--text-secondary] block mb-1",children:"Imgenes Enviadas"}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:oe.images.map((q,ie)=>c.jsxs("div",{className:"bg-[--bg-tertiary] p-1 rounded-md text-center",children:[c.jsx("img",{src:q.url,alt:q.name,className:"max-w-full max-h-24 object-contain mx-auto"}),c.jsx("span",{className:"text-xs text-[--text-secondary] mt-1 block",children:q.name})]},ie))})]})]})]});case"brush":return c.jsxs("div",{className:"max-h-[calc(100vh-80px)] overflow-y-auto",children:[c.jsx("div",{className:"p-4 space-y-3 bg-[--bg-secondary] sticky top-0 z-10 border-b border-[--bg-tertiary]",children:c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Rapidograph Solido"})}),c.jsxs(Fn,{title:"General",defaultOpen:!0,children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Tamao: ",s.size,"px"]}),c.jsx("input",{type:"range",min:"1",max:"200",value:s.size,onChange:q=>a(ie=>({...ie,size:parseInt(q.target.value)})),className:"w-full"})]}),c.jsx("div",{className:"pt-2",children:c.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,3,5,10,20,40].map(q=>c.jsxs("button",{onClick:()=>a(ie=>({...ie,size:q})),className:`text-xs p-2 rounded ${s.size===q?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:[q,"px"]},q))})}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Color"}),c.jsx("input",{type:"color",value:s.color,onChange:q=>a(ie=>({...ie,color:q.target.value})),className:"w-full h-8 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer"})]})]}),c.jsx(Fn,{title:"Dinmica de Presin",children:c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"pressure-size-brush",className:"text-xs text-[--text-secondary]",children:"Controlar Tamao"}),c.jsx("input",{id:"pressure-size-brush",type:"checkbox",checked:s.pressureControl.size,onChange:q=>a(ie=>({...ie,pressureControl:{...ie.pressureControl,size:q.target.checked}})),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] rounded focus:ring-[--accent-primary]"})]})})]});case"simple-marker":return c.jsxs("div",{className:"max-h-[calc(100vh-80px)] overflow-y-auto",children:[c.jsx("div",{className:"p-4 space-y-3 bg-[--bg-secondary] sticky top-0 z-10 border-b border-[--bg-tertiary]",children:c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Marcador Slido"})}),c.jsxs(Fn,{title:"General",defaultOpen:!0,children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Tamao: ",p.size,"px"]}),c.jsx("input",{type:"range",min:"1",max:"200",value:p.size,onChange:q=>y(ie=>({...ie,size:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Opacidad: ",Math.round(p.opacity*100),"%"]}),c.jsx("input",{type:"range",min:"1",max:"100",value:p.opacity*100,onChange:q=>y(ie=>({...ie,opacity:parseInt(q.target.value)/100})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Color"}),c.jsx("input",{type:"color",value:p.color,onChange:q=>y(ie=>({...ie,color:q.target.value})),className:"w-full h-8 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer"})]}),c.jsx(ml,{value:p.blendMode,onChange:q=>y(ie=>({...ie,blendMode:q}))})]}),c.jsx(Fn,{title:"Punta",children:c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Forma de la punta"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>y(q=>({...q,tipShape:"square"})),className:`flex-1 text-xs p-2 rounded ${p.tipShape==="square"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Cuadrada"}),c.jsx("button",{onClick:()=>y(q=>({...q,tipShape:"line"})),className:`flex-1 text-xs p-2 rounded ${p.tipShape==="line"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Lnea"})]})]})}),c.jsx(Fn,{title:"Dinmica de Presin",children:c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"pressure-opacity-marker",className:"text-xs text-[--text-secondary]",children:"Controlar Opacidad"}),c.jsx("input",{id:"pressure-opacity-marker",type:"checkbox",checked:p.pressureControl.opacity,onChange:q=>y(ie=>({...ie,pressureControl:{...ie.pressureControl,opacity:q.target.checked}})),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] rounded focus:ring-[--accent-primary]"})]})})]});case"advanced-marker":return c.jsxs("div",{className:"max-h-[calc(100vh-80px)] overflow-y-auto",children:[c.jsx("div",{className:"p-4 space-y-3 bg-[--bg-secondary] sticky top-0 z-10 border-b border-[--bg-tertiary]",children:c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Marcador Avanzado"})}),c.jsxs(Fn,{title:"General",defaultOpen:!0,children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Tamao: ",_.size,"px"]}),c.jsx("input",{type:"range",min:"1",max:"300",value:_.size,onChange:q=>M(ie=>({...ie,size:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Flujo: ",_.flow,"%"]}),c.jsx("input",{type:"range",min:"1",max:"100",value:_.flow,onChange:q=>M(ie=>({...ie,flow:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Color"}),c.jsx("input",{type:"color",value:_.color,onChange:q=>M(ie=>({...ie,color:q.target.value})),className:"w-full h-8 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer"})]}),c.jsx(ml,{value:_.blendMode,onChange:q=>M(ie=>({...ie,blendMode:q}))})]}),c.jsxs(Fn,{title:"Punta",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Dureza: ",_.hardness,"%"]}),c.jsx("input",{type:"range",min:"0",max:"100",value:_.hardness,onChange:q=>M(ie=>({...ie,hardness:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Espaciado: ",_.spacing,"%"]}),c.jsx("input",{type:"range",min:"1",max:"100",value:_.spacing,onChange:q=>M(ie=>({...ie,spacing:parseInt(q.target.value)})),className:"w-full"})]})]}),c.jsxs(Fn,{title:"Dinmica de Presin",children:[c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"pressure-size-adv",className:"text-xs text-[--text-secondary]",children:"Controlar Tamao"}),c.jsx("input",{id:"pressure-size-adv",type:"checkbox",checked:_.pressureControl.size,onChange:q=>M(ie=>({...ie,pressureControl:{...ie.pressureControl,size:q.target.checked}})),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] rounded focus:ring-[--accent-primary]"})]}),c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"pressure-flow-adv",className:"text-xs text-[--text-secondary]",children:"Controlar Flujo"}),c.jsx("input",{id:"pressure-flow-adv",type:"checkbox",checked:_.pressureControl.flow,onChange:q=>M(ie=>({...ie,pressureControl:{...ie.pressureControl,flow:q.target.checked}})),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] rounded focus:ring-[--accent-primary]"})]})]})]});case"watercolor":return c.jsxs("div",{className:"max-h-[calc(100vh-80px)] overflow-y-auto",children:[c.jsx("div",{className:"p-4 space-y-3 bg-[--bg-secondary] sticky top-0 z-10 border-b border-[--bg-tertiary]",children:c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Acuarela"})}),c.jsxs(Fn,{title:"General",defaultOpen:!0,children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Tamao: ",G.size,"px"]}),c.jsx("input",{type:"range",min:"1",max:"300",value:G.size,onChange:q=>k(ie=>({...ie,size:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Flujo (Densidad): ",G.flow,"%"]}),c.jsx("input",{type:"range",min:"1",max:"100",value:G.flow,onChange:q=>k(ie=>({...ie,flow:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Humedad (Opacidad): ",G.wetness,"%"]}),c.jsx("input",{type:"range",min:"1",max:"100",value:G.wetness,onChange:q=>k(ie=>({...ie,wetness:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Color"}),c.jsx("input",{type:"color",value:G.color,onChange:q=>k(ie=>({...ie,color:q.target.value})),className:"w-full h-8 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer"})]})]}),c.jsxs(Fn,{title:"Dinmica de Presin",children:[c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"pressure-size-wc",className:"text-xs text-[--text-secondary]",children:"Controlar Tamao"}),c.jsx("input",{id:"pressure-size-wc",type:"checkbox",checked:G.pressureControl.size,onChange:q=>k(ie=>({...ie,pressureControl:{...ie.pressureControl,size:q.target.checked}})),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] rounded focus:ring-[--accent-primary]"})]}),c.jsxs("div",{className:"flex items-center justify-between py-1",children:[c.jsx("label",{htmlFor:"pressure-flow-wc",className:"text-xs text-[--text-secondary]",children:"Controlar Flujo"}),c.jsx("input",{id:"pressure-flow-wc",type:"checkbox",checked:G.pressureControl.flow,onChange:q=>k(ie=>({...ie,pressureControl:{...ie.pressureControl,flow:q.target.checked}})),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] rounded focus:ring-[--accent-primary]"})]})]})]});case"natural-marker":return c.jsxs("div",{className:"p-4 space-y-4",children:[c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Marcador Natural"}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Tamao: ",x.size,"px"]}),c.jsx("input",{type:"range",min:"1",max:"200",value:x.size,onChange:q=>m(ie=>({...ie,size:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Opacidad: ",Math.round(x.opacity*100),"%"]}),c.jsx("input",{type:"range",min:"1",max:"100",value:x.opacity*100,onChange:q=>m(ie=>({...ie,opacity:parseInt(q.target.value)/100})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Color"}),c.jsx("input",{type:"color",value:x.color,onChange:q=>m(ie=>({...ie,color:q.target.value})),className:"w-full h-8 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer"})]})]});case"airbrush":return c.jsxs("div",{className:"p-4 space-y-4",children:[c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Aergrafo"}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Tamao: ",v.size,"px"]}),c.jsx("input",{type:"range",min:"1",max:"500",value:v.size,onChange:q=>b(ie=>({...ie,size:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Flujo: ",Math.round(v.flow*100),"%"]}),c.jsx("input",{type:"range",min:"1",max:"100",value:v.flow*100,onChange:q=>b(ie=>({...ie,flow:parseInt(q.target.value)/100})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Color"}),c.jsx("input",{type:"color",value:v.color,onChange:q=>b(ie=>({...ie,color:q.target.value})),className:"w-full h-8 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer"})]})]});case"fx-brush":return c.jsxs("div",{className:"p-4 space-y-4",children:[c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Pincel de Efectos"}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Preset"}),c.jsxs("select",{value:S.presetId||"",onChange:q=>N(ie=>({...ie,presetId:q.target.value||null})),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-xs rounded-md p-2",children:[c.jsx("option",{value:"",children:"Ninguno"}),W.map(q=>c.jsx("option",{value:q.id,children:q.name},q.id))]})]})]});case"eraser":return c.jsxs("div",{className:"max-h-[calc(100vh-80px)] overflow-y-auto",children:[c.jsx("div",{className:"p-4 space-y-3 bg-[--bg-secondary] sticky top-0 z-10 border-b border-[--bg-tertiary]",children:c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Goma de Borrar"})}),c.jsxs(Fn,{title:"General",defaultOpen:!0,children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Tamao: ",r.size,"px"]}),c.jsx("input",{type:"range",min:"1",max:"500",value:r.size,onChange:q=>u(ie=>({...ie,size:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Opacidad: ",Math.round(r.opacity*100),"%"]}),c.jsx("input",{type:"range",min:"1",max:"100",value:r.opacity*100,onChange:q=>u(ie=>({...ie,opacity:parseInt(q.target.value)/100})),className:"w-full"})]})]}),c.jsxs(Fn,{title:"Punta",defaultOpen:!0,children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-[--text-secondary] block mb-1",children:["Dureza: ",r.hardness,"%"]}),c.jsx("input",{type:"range",min:"0",max:"100",value:r.hardness,onChange:q=>u(ie=>({...ie,hardness:parseInt(q.target.value)})),className:"w-full"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary] block mb-1",children:"Forma"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:()=>u(q=>({...q,tipShape:"round"})),className:`text-xs p-2 rounded ${r.tipShape==="round"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Redonda"}),c.jsx("button",{onClick:()=>u(q=>({...q,tipShape:"square"})),className:`text-xs p-2 rounded ${r.tipShape==="square"?"bg-[--accent-hover] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Cuadrada"})]})]})]})]});default:return null}},Ns={freehand:sg,line:ag,polyline:ig,curve:cg,arc:rg}[ge],Go=[{mode:"freehand",label:"A mano alzada",icon:sg},{mode:"line",label:"Lnea (2 Puntos)",icon:ag},{mode:"polyline",label:"Polilnea",icon:ig},{mode:"curve",label:"Curva (3 Puntos)",icon:cg},{mode:"arc",label:"Arco (Centro)",icon:rg}],Vo={solid:ug,dashed:dg,dotted:fg,"dash-dot":hg}[A.style],Mn=[{style:"solid",label:"Slido",icon:ug},{style:"dashed",label:"Segmentado",icon:dg},{style:"dotted",label:"Punteado",icon:fg},{style:"dash-dot",label:"Lnea y punto",icon:hg}],so=`p-3 rounded-lg transition-colors ${["brush","simple-marker","eraser","natural-marker","advanced-marker","airbrush","fx-brush","watercolor"].includes(o)?"bg-[--accent-primary] text-white hover:bg-[--accent-hover]":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,re=`p-3 rounded-lg transition-colors ${A.style!=="solid"?"bg-[--accent-primary] text-white hover:bg-[--accent-hover]":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,qe=["marquee-rect","lasso","magic-wand"],st=["brush","simple-marker","natural-marker","advanced-marker","airbrush","fx-brush","watercolor"],yt=qe.includes(o),Dt=st.includes(o),yn=gg[yt?o:We],wa=gg[Dt?o:mn],As=()=>{if(!be)return{display:"none"};if(Ae)return{position:"absolute",left:`${Ae.left}px`,top:`${Ae.top}px`,maxHeight:`calc(100vh - ${Ae.top+16}px)`};if(!Me||!Rt.current)return{display:"none"};const fe=Me.getBoundingClientRect(),q=Rt.current.getBoundingClientRect();return{position:"absolute",left:`${fe.right-q.left+8}px`,top:`${fe.top-q.top}px`,maxHeight:`calc(100vh - ${fe.top-q.top+16}px)`}};return c.jsxs("div",{ref:Rt,className:"relative flex-shrink-0",children:[c.jsxs("div",{className:"bg-[--bg-primary] text-[--text-primary] h-full flex flex-col p-2",children:[c.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[c.jsx("button",{onClick:()=>_t("select"),className:nn("select"),title:"Seleccionar",children:c.jsx(Ji,{className:"w-6 h-6"})}),c.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),c.jsxs("div",{className:"relative",ref:It,children:[c.jsx("button",{onClick:()=>{bt(!1),je(!1),tt(!1),Ze(fe=>!fe)},onDoubleClick:fe=>gn(yt?o:We,fe),className:`p-3 rounded-lg transition-colors ${yt?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Herramientas de Seleccin (doble clic para opciones)",children:c.jsx(yn,{className:"w-6 h-6"})}),Ht&&c.jsx("div",{className:"absolute left-full top-0 ml-2 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-60 z-20 p-2 space-y-1",children:pg.map(({tool:fe,name:q,icon:ie})=>c.jsxs("div",{className:`flex items-center justify-between rounded-md text-sm ${o===fe?"bg-[--accent-primary] text-white":"hover:bg-[--bg-tertiary]"}`,children:[c.jsxs("button",{onClick:()=>{_t(fe),Ze(!1)},className:"flex items-center gap-3 p-2 flex-grow text-left",children:[c.jsx(ie,{className:"w-5 h-5"}),c.jsx("span",{children:q})]}),c.jsx("button",{onClick:xt=>{Sn(xt,fe)},className:"p-2 mr-1 rounded-full hover:bg-black/10 flex-shrink-0",title:"Configuracin de la herramienta",children:c.jsx(ju,{className:"w-4 h-4"})})]},fe))})]}),c.jsxs("div",{className:"relative",ref:Ve,children:[c.jsx("button",{onClick:()=>{tt(!1),Ze(!1),bt(!1),je(fe=>!fe)},className:so,title:`Modo de Trazo: ${ge} (clic para cambiar)`,children:c.jsx(Ns,{className:"w-6 h-6"})}),Se&&c.jsxs("div",{className:"absolute left-full top-0 ml-2 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-60 z-20 p-2 space-y-1",children:[c.jsx("h4",{className:"px-2 pb-1 text-sm font-bold uppercase text-[--text-secondary]",children:"Modos de Trazo"}),Go.map(({mode:fe,label:q,icon:ie})=>c.jsxs("button",{onClick:()=>{Z(fe),je(!1)},className:`w-full flex items-center gap-3 p-2 rounded-md text-sm ${ge===fe?"bg-[--accent-primary] text-white":"hover:bg-[--bg-tertiary]"}`,children:[c.jsx(ie,{className:"w-5 h-5"}),c.jsx("span",{children:q})]},fe))]})]}),c.jsxs("div",{className:"relative",ref:rt,children:[c.jsx("button",{onClick:()=>{je(!1),Ze(!1),bt(!1),tt(fe=>!fe)},className:re,title:`Estilo de Trazo: ${A.style} (clic para cambiar)`,children:c.jsx(Vo,{className:"w-6 h-6"})}),Fe&&c.jsxs("div",{className:"absolute left-full top-0 ml-2 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-60 z-20 p-2 space-y-2",children:[c.jsx("h4",{className:"px-2 pb-1 text-sm font-bold uppercase text-[--text-secondary]",children:"Estilo de Trazo"}),c.jsx("div",{className:"space-y-1",children:Mn.map(({style:fe,label:q,icon:ie})=>c.jsxs("button",{onClick:()=>{O(xt=>({...xt,style:fe}))},className:`w-full flex items-center gap-3 p-2 rounded-md text-sm ${A.style===fe?"bg-[--accent-primary] text-white":"hover:bg-[--bg-tertiary]"}`,children:[c.jsx(ie,{className:"w-5 h-5"}),c.jsx("span",{children:q})]},fe))}),c.jsxs("div",{className:"border-t border-[--bg-tertiary] pt-2 mt-2",children:[c.jsxs("label",{className:"px-2 text-xs font-bold text-[--text-secondary]",children:["Escala del Patrn: ",A.scale.toFixed(1)]}),c.jsx("input",{type:"range",min:"0.5",max:"10",step:"0.5",value:A.scale,onChange:fe=>O(q=>({...q,scale:parseFloat(fe.target.value)})),className:"w-full mt-1",disabled:A.style==="solid"})]})]})]}),c.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),c.jsxs("div",{className:"relative",ref:Ue,children:[c.jsx("button",{onClick:()=>{Ze(!1),je(!1),tt(!1),bt(fe=>!fe)},onDoubleClick:fe=>gn(Dt?o:mn,fe),className:`p-3 rounded-lg transition-colors ${Dt?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Herramientas de Dibujo (doble clic para opciones)",children:c.jsx(wa,{className:"w-6 h-6"})}),$e&&c.jsx("div",{className:"absolute left-full top-0 ml-2 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-60 z-20 p-2 space-y-1",children:mg.map(({tool:fe,name:q,icon:ie})=>c.jsxs("div",{className:`flex items-center justify-between rounded-md text-sm ${o===fe?"bg-[--accent-primary] text-white":"hover:bg-[--bg-tertiary]"}`,children:[c.jsxs("button",{onClick:()=>{_t(fe),bt(!1)},className:"flex items-center gap-3 p-2 flex-grow text-left",children:[c.jsx(ie,{className:"w-5 h-5"}),c.jsx("span",{children:q})]}),c.jsx("button",{onClick:xt=>{Sn(xt,fe)},className:"p-2 mr-1 rounded-full hover:bg-black/10 flex-shrink-0",title:"Configuracin de la herramienta",children:c.jsx(ju,{className:"w-4 h-4"})})]},fe))})]}),c.jsx("button",{onClick:()=>_t("eraser"),onDoubleClick:fe=>gn("eraser",fe),className:nn("eraser"),title:"Goma de Borrar (doble clic para opciones)",children:c.jsx(Ea,{className:"w-6 h-6"})}),c.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),c.jsx("button",{onClick:()=>_t("text"),onDoubleClick:fe=>gn("text",fe),className:nn("text"),title:"Texto (doble clic para opciones)",children:c.jsx(Ki,{className:"w-6 h-6"})})]}),c.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),c.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[c.jsx("button",{onClick:()=>D("ruler"),className:`p-3 rounded-lg transition-colors ${$==="ruler"?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Gua de Regla",children:c.jsx(kS,{className:"w-6 h-6"})}),c.jsx("button",{onClick:()=>D("perspective"),className:`p-3 rounded-lg transition-colors ${$==="perspective"?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Gua de Perspectiva",children:c.jsx(DS,{className:"w-6 h-6"})}),c.jsx("button",{onClick:K,className:`p-3 rounded-lg transition-colors ${E?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Gua Ortogonal",children:c.jsx(LS,{className:"w-6 h-6"})}),c.jsx("button",{onClick:()=>D("mirror"),className:`p-3 rounded-lg transition-colors ${$==="mirror"?"bg-[--accent-primary] text-white":"bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]"}`,title:"Gua de Espejo",children:c.jsx(jS,{className:"w-6 h-6"})})]}),c.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),c.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[c.jsx("button",{onClick:()=>_t("transform"),className:nn("transform"),title:"Transformar (Escalar/Rotar)",children:c.jsx(tr,{className:"w-6 h-6"})}),c.jsx("button",{onClick:()=>_t("free-transform"),className:nn("free-transform"),title:"Transformacin Libre (Distorsionar)",children:c.jsx(nr,{className:"w-6 h-6"})})]}),c.jsx("div",{className:"w-10/12 h-px bg-[--bg-tertiary] my-2 self-center"}),c.jsx("div",{className:"flex flex-col items-center space-y-2",children:c.jsx("button",{onClick:()=>_t("enhance"),onDoubleClick:fe=>gn("enhance",fe),className:nn("enhance"),title:"Mejora con IA (doble clic para opciones)",children:c.jsx($i,{className:"w-6 h-6"})})}),c.jsxs("div",{className:"mt-auto flex flex-col items-center space-y-2",children:[c.jsx("button",{onClick:()=>_t("crop"),className:nn("crop"),title:"Recortar",children:c.jsx(er,{className:"w-6 h-6"})}),c.jsx("button",{onClick:I,className:"p-3 rounded-lg bg-[--bg-secondary] text-[--text-secondary] hover:bg-[--bg-tertiary]",title:"Exportar Imagen",children:c.jsx(iy,{className:"w-6 h-6"})})]})]}),be&&be!=="enhance"&&c.jsx("div",{ref:mt,className:"bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-80 z-20 overflow-y-auto",style:As(),children:gl(be)}),be==="enhance"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40",onClick:()=>{me(null),De(null)}}),c.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:c.jsxs("div",{ref:mt,className:"bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg w-[500px] max-h-[90vh] flex flex-col pointer-events-auto",children:[c.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-[--bg-tertiary] flex justify-between items-center",children:[c.jsx("h4",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Mejora con IA"}),c.jsx("button",{onClick:()=>{me(null),De(null)},className:"p-1 rounded-full hover:bg-[--bg-hover]",children:c.jsx(bo,{className:"w-5 h-5"})})]}),c.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:gl(be)})]})})]}),ot.openFor&&ot.anchorEl&&c.jsx("div",{ref:$t,className:"absolute z-30 bg-[--bg-secondary] border border-[--bg-tertiary] rounded-lg shadow-lg w-64 max-h-60 overflow-y-auto",style:{left:ot.anchorEl.getBoundingClientRect().right+8,top:ot.anchorEl.getBoundingClientRect().top},children:c.jsx("ul",{className:"p-1",children:nt[ot.openFor].length>0?nt[ot.openFor].map((fe,q)=>c.jsxs("li",{className:"group flex items-center justify-between text-sm text-[--text-primary] rounded-md hover:bg-[--bg-hover]",children:[c.jsx("button",{onClick:()=>Un(ot.openFor,fe),className:"flex-grow text-left p-2 truncate",children:fe}),c.jsx("button",{onClick:()=>qo(ot.openFor,fe),className:"p-2 text-[--text-secondary] opacity-0 group-hover:opacity-100 hover:text-red-500",children:c.jsx(Ll,{className:"w-4 h-4"})})]},q)):c.jsx("li",{className:"p-2 text-center text-xs text-[--text-secondary]",children:"No hay prompts guardados."})})})]})},nE=({items:o,activeItemId:t,onAddItem:s,onCopyItem:a,onDeleteItem:r,onSelectItem:u,onUpdateItem:p,onMoveItem:y,onMergeItems:x,onUpdateBackground:m,onRemoveBackgroundImage:v,onExportItem:b,onOpenCanvasSizeModal:S,activeItemState:N,onMoveItemUpDown:_,onMergeItemDown:M,onMergeItemUp:G,onAddObjectAbove:k,onAddObjectBelow:V})=>{const[R,B]=T.useState(!1),U=T.useRef(null),[$,D]=T.useState(null),E=o.find(z=>z.type==="object"&&z.isBackground),K=!!((E==null?void 0:E.type)==="object"&&E.backgroundImage);T.useEffect(()=>{const z=oe=>{U.current&&!U.current.contains(oe.target)&&B(!1)};return document.addEventListener("mousedown",z),()=>{document.removeEventListener("mousedown",z)}},[]);const I=z=>{z.target.files&&z.target.files[0]&&(m({file:z.target.files[0]}),z.target.value="")},X=(z,oe)=>{z.stopPropagation(),z.dataTransfer.effectAllowed="copyMove",z.dataTransfer.setData("application/json",JSON.stringify({type:"outliner-item",id:oe.id}))},L=(z,oe)=>{z.preventDefault(),z.stopPropagation();const ge=z.currentTarget.getBoundingClientRect(),Z=z.clientY-ge.top,A=ge.height;let O;if(!z.dataTransfer.types.find(be=>be==="application/json"))return;if(oe.type==="group"||oe.type==="object"&&!0){const be=A*.25;Z<be?O="top":Z>A-be?O="bottom":O="middle"}else O=Z<A/2?"top":"bottom";D({id:oe.id,position:O})},H=z=>{z.stopPropagation(),D(null)},ue=(z,oe)=>{z.preventDefault(),z.stopPropagation(),D(null);try{const ge=JSON.parse(z.dataTransfer.getData("application/json"));if(ge.type!=="outliner-item"||!ge.id)return;const Z=ge.id;$&&$.id===oe.id&&($.position==="middle"&&oe.type==="object"?x(Z,oe.id):y(Z,oe.id,$.position))}catch{}},ve=(z,oe)=>{if(z.type==="object"&&z.isBackground)return null;const ge=z.type==="group",Z=z.type==="object",A=t===z.id,O=($==null?void 0:$.id)===z.id,W=$==null?void 0:$.position,ye=Z&&O&&W==="middle",be=()=>O&&W==="middle"&&Z?"bg-red-700":A?"bg-[--accent-hover]":"bg-[--bg-secondary] hover:bg-[--bg-tertiary]";return c.jsxs("div",{draggable:!(z.type==="object"&&z.isBackground),onDragStart:me=>X(me,z),onDragOver:me=>L(me,z),onDragLeave:H,onDrop:me=>ue(me,z),onClick:()=>u(z.id),className:`group relative p-2 rounded-lg transition-colors duration-100 ${be()}`,style:{marginLeft:`${oe*16}px`},children:[O&&W==="top"&&c.jsx("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-[--accent-primary] z-10"}),O&&W==="bottom"&&c.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[--accent-primary] z-10"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center flex-grow min-w-0",children:[c.jsx("span",{className:"flex-shrink-0 cursor-grab text-[--text-secondary] hover:text-[--text-primary] mr-2",children:c.jsx(ju,{className:"w-5 h-5"})}),ge&&c.jsx(zi,{className:"w-4 h-4 mr-2 text-red-400 flex-shrink-0"}),ye&&c.jsx(tg,{className:"w-4 h-4 mr-2 text-red-400"}),c.jsx("input",{type:"text",value:z.name,onClick:me=>me.stopPropagation(),onDragStart:me=>me.stopPropagation(),onChange:me=>p(z.id,{name:me.target.value}),className:"bg-transparent text-sm w-full outline-none pointer-events-auto truncate"})]}),c.jsxs("div",{className:"flex items-center space-x-2 ml-2 flex-shrink-0",children:[c.jsx("button",{onClick:me=>{me.stopPropagation(),p(z.id,{isVisible:!z.isVisible})},className:"p-1",children:z.isVisible?c.jsx(Wm,{className:"w-4 h-4"}):c.jsx(Qm,{className:"w-4 h-4 text-gray-500"})}),!(z.type==="object"&&z.isBackground)&&c.jsx("button",{onClick:me=>{me.stopPropagation(),r(z.id)},className:"p-1 text-[--text-secondary] hover:text-red-500",children:c.jsx(Ll,{className:"w-4 h-4"})})]})]}),A&&z.type==="object"&&c.jsxs("div",{className:"mt-2 space-y-2",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`opacity-${z.id}`,className:"text-xs text-[--text-secondary]",children:"Opacidad"}),c.jsx("input",{id:`opacity-${z.id}`,type:"range",min:"0",max:"100",value:z.opacity*100,onClick:me=>me.stopPropagation(),onChange:me=>p(z.id,{opacity:parseInt(me.target.value,10)/100}),className:"w-full h-1 bg-[--bg-tertiary] rounded-lg appearance-none cursor-pointer"})]}),c.jsxs("div",{className:"flex items-center flex-wrap gap-1 border-t border-[--bg-tertiary] pt-2",children:[c.jsx("button",{onClick:me=>{me.stopPropagation(),_(z.id,"up")},disabled:!N.canMoveUp,className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Mover arriba",children:c.jsx(fy,{className:"w-3.5 h-3.5"})}),c.jsx("button",{onClick:me=>{me.stopPropagation(),_(z.id,"down")},disabled:!N.canMoveDown,className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Mover abajo",children:c.jsx(OS,{className:"w-3.5 h-3.5"})}),Z&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-px h-3.5 bg-[--bg-tertiary] mx-0.5"}),c.jsx("button",{onClick:me=>{me.stopPropagation(),k(z.id)},className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover]",title:"Aadir objeto arriba",children:c.jsx(ZS,{className:"w-3.5 h-3.5"})}),c.jsx("button",{onClick:me=>{me.stopPropagation(),V(z.id)},className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover]",title:"Aadir objeto abajo",children:c.jsx(WS,{className:"w-3.5 h-3.5"})}),c.jsx("div",{className:"w-px h-3.5 bg-[--bg-tertiary] mx-0.5"}),c.jsx("button",{onClick:me=>{me.stopPropagation(),G(z.id)},disabled:!N.canMergeUp,className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Combinar arriba",children:c.jsx(MS,{className:"w-3.5 h-3.5"})}),c.jsx("button",{onClick:me=>{me.stopPropagation(),M(z.id)},disabled:!N.canMergeDown,className:"p-1 rounded bg-[--bg-tertiary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Combinar abajo",children:c.jsx(tg,{className:"w-3.5 h-3.5"})})]})]})]})]},z.id)},j=(z=null,oe=0)=>o.filter(ge=>ge.parentId===z&&!(ge.type==="object"&&ge.isBackground)).reverse().flatMap(ge=>[ve(ge,oe),...ge.type==="group"?j(ge.id,oe+1):[]]);return c.jsxs("div",{className:"bg-[--bg-primary] text-[--text-primary] p-4 flex flex-col h-full",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(_S,{className:"w-5 h-5 mr-2 text-[--text-secondary]"}),c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Outliner"})]}),c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx("button",{onClick:b,disabled:!t||!!o.find(z=>z.id===t&&z.type==="object"&&z.isBackground),className:"p-2 rounded-md hover:bg-[--bg-tertiary] disabled:text-gray-600 disabled:cursor-not-allowed disabled:hover:bg-transparent",title:"Exportar objeto seleccionado",children:c.jsx(iy,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>t&&a(t),disabled:!t||!!o.find(z=>z.id===t&&z.type==="object"&&z.isBackground),className:"p-2 rounded-md hover:bg-[--bg-tertiary] disabled:text-gray-600 disabled:cursor-not-allowed disabled:hover:bg-transparent",title:"Duplicar objeto seleccionado",children:c.jsx(cy,{className:"w-5 h-5"})}),c.jsxs("div",{className:"relative",ref:U,children:[c.jsx("button",{onClick:()=>B(!R),className:"p-2 rounded-md hover:bg-[--bg-tertiary]",children:c.jsx(Vi,{className:"w-5 h-5"})}),R&&c.jsxs("div",{className:"absolute right-0 mt-2 w-40 bg-[--bg-tertiary] rounded-md shadow-lg z-10",children:[c.jsx("button",{onClick:()=>{s("group"),B(!1)},className:"block w-full text-left px-4 py-2 text-sm text-[--text-primary] hover:bg-[--bg-hover]",children:"Nueva Carpeta"}),c.jsx("button",{onClick:()=>{s("object"),B(!1)},className:"block w-full text-left px-4 py-2 text-sm text-[--text-primary] hover:bg-[--bg-hover]",children:"Nuevo Objeto"})]})]})]})]}),c.jsx("div",{className:"flex-grow overflow-y-auto space-y-2 pr-2",children:j()}),c.jsxs("div",{className:"flex-shrink-0 border-t border-[--bg-tertiary] mt-4 pt-4",children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-3",children:"Canvas"}),c.jsx("div",{className:"space-y-2",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"color",id:"canvas-color",value:(E==null?void 0:E.type)==="object"&&E.color||"#FFFFFF",onChange:z=>m({color:z.target.value}),className:"w-10 h-10 p-0.5 bg-[--bg-tertiary] border border-[--bg-hover] rounded-md cursor-pointer flex-shrink-0",title:"Color de fondo"}),c.jsx("button",{onDoubleClick:S,className:"h-10 px-3 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary] text-sm flex-grow",title:"Tamao del lienzo (doble clic)",children:"Personalizado"}),E&&c.jsx("button",{onClick:()=>p(E.id,{isVisible:!E.isVisible}),className:"h-10 w-10 flex-shrink-0 p-2 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary]",title:E.isVisible?"Ocultar fondo":"Mostrar fondo",children:E.isVisible?c.jsx(Wm,{className:"w-5 h-5"}):c.jsx(Qm,{className:"w-5 h-5"})}),c.jsx("label",{htmlFor:"canvas-image-upload",className:"h-10 w-10 flex items-center justify-center p-2 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary] flex-shrink-0",title:"Importar imagen de fondo",children:c.jsx(Qi,{className:"w-5 h-5"})}),c.jsx("input",{id:"canvas-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:I}),K&&c.jsx("button",{onClick:v,className:"h-10 w-10 flex-shrink-0 p-2 rounded-lg bg-red-800 hover:bg-red-700 cursor-pointer text-gray-200",title:"Eliminar imagen de fondo",children:c.jsx(Ll,{className:"w-5 h-5"})})]})})]})]})},gs=(o,t,s)=>{const a=s.getBoundingClientRect(),r=o.clientX-a.left,u=o.clientY-a.top;return{x:(r-t.pan.x)/t.zoom,y:(u-t.pan.y)/t.zoom}},yg=(o,t,s)=>{const a=r=>`0${Math.round(r).toString(16)}`.slice(-2);return`#${a(o)}${a(t)}${a(s)}`},oE=(o,t,s)=>{const a=s.x-t.x,r=s.y-t.y;if(a===0&&r===0)return t;const u=a*a+r*r,p=((o.x-t.x)*a+(o.y-t.y)*r)/u,y=t.x+p*a,x=t.y+p*r;return{x:y,y:x}},bu=(o,t)=>{const{start:s,end:a}=o,{start:r,end:u}=t,p=(s.x-a.x)*(r.y-u.y)-(s.y-a.y)*(r.x-u.x);if(p===0)return null;const x=((s.x-r.x)*(r.y-u.y)-(s.y-r.y)*(r.x-u.x))/p;return{x:s.x+x*(a.x-s.x),y:s.y+x*(a.y-s.y)}},co=(o,t,s)=>Math.hypot(o.x-t.x,o.y-t.y)<s,lE=(o,t,s)=>{const a=(t.x-s.x)**2+(t.y-s.y)**2;if(a===0)return Math.hypot(o.x-t.x,o.y-t.y);let r=((o.x-t.x)*(s.x-t.x)+(o.y-t.y)*(s.y-t.y))/a;r=Math.max(0,Math.min(1,r));const u={x:t.x+r*(s.x-t.x),y:t.y+r*(s.y-t.y)};return Math.hypot(o.x-u.x,o.y-u.y)},ir=(o,t=1)=>{const s=o.getContext("2d",{willReadFrequently:!0});if(!s)return null;try{const r=s.getImageData(0,0,o.width,o.height).data;let u=o.width,p=o.height,y=-1,x=-1;for(let m=0;m<o.height;m++)for(let v=0;v<o.width;v++)r[(m*o.width+v)*4+3]>=t&&(u=Math.min(u,v),p=Math.min(p,m),y=Math.max(y,v),x=Math.max(x,m));return y===-1?null:{x:u,y:p,width:y-u+1,height:x-p+1}}catch(a){return console.error("Could not get canvas image data, it may be tainted.",a),{x:0,y:0,width:o.width,height:o.height}}},zo=o=>{o.save(),o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,o.canvas.width,o.canvas.height),o.restore()};function sE(o,t){const s=o.length;for(let r=0;r<s;r++){let u=r;for(let p=r+1;p<s;p++)Math.abs(o[p][r])>Math.abs(o[u][r])&&(u=p);if([o[r],o[u]]=[o[u],o[r]],[t[r],t[u]]=[t[u],t[r]],Math.abs(o[r][r])<=1e-10)return null;for(let p=r+1;p<s;p++){const y=o[p][r]/o[r][r];t[p]-=y*t[r];for(let x=r;x<s;x++)o[p][x]-=y*o[r][x]}}const a=new Array(s);for(let r=s-1;r>=0;r--){let u=0;for(let p=r+1;p<s;p++)u+=o[r][p]*a[p];a[r]=(t[r]-u)/o[r][r]}return a}function py(o,t){if(o.length!==4||t.length!==4)return null;const s=[];for(let u=0;u<4;u++){const{x:p,y}=o[u],{x,y:m}=t[u];s.push([p,y,1,0,0,0,-x*p,-x*y]),s.push([0,0,0,p,y,1,-m*p,-m*y])}const a=[];for(const{x:u,y:p}of t)a.push(u,p);const r=sE(s,a);return r?[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],1]:null}const aE=(o,t)=>{const s="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)",a=py(o,t);if(!a)return s;const r=[[a[0],a[1],a[2]],[a[3],a[4],a[5]],[a[6],a[7],1]];return`matrix3d(${[r[0][0],r[1][0],0,r[2][0],r[0][1],r[1][1],0,r[2][1],0,0,1,0,r[0][2],r[1][2],0,1].join(", ")})`},iE=(o,t)=>{let s=!1;for(let a=0,r=t.length-1;a<t.length;r=a++){const u=t[a].x,p=t[a].y,y=t[r].x,x=t[r].y;p>o.y!=x>o.y&&o.x<(y-u)*(o.y-p)/(x-p)+u&&(s=!s)}return s},Ca=o=>{const t=document.createElement("canvas");t.width=o.width,t.height=o.height;const s=t.getContext("2d",{willReadFrequently:!0});return s&&s.drawImage(o,0,0),t},xg=o=>{const t=document.createElement("canvas");t.width=o.width,t.height=o.height;const s=t.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("Failed to get 2D context for cloned canvas");return s.drawImage(o,0,0),{canvas:t,context:s}},Yn=(o,t)=>{const s=document.createElement("canvas");s.width=o,s.height=t;const a=s.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("Failed to get 2D context");return{canvas:s,context:a}},rE=(o,t,s)=>new Promise((a,r)=>{const u=document.createElement("canvas"),p=u.getContext("2d");if(!p)return r(new Error("Could not create thumbnail context"));const y=o.width/o.height;let x=t,m=x/y;m>s&&(m=s,x=m*y),u.width=x,u.height=m,p.drawImage(o,0,0,o.width,o.height,0,0,x,m),u.toBlob(v=>{v?a(v):r(new Error("Canvas toBlob returned null"))},"image/png",.9)});function vg(o,t,s,a,r,u,p,y,x){if(a<128&&y<128)return!0;if(a<128||y<128)return!1;const m=(x/100*255)**2*3;return(o-r)**2+(t-u)**2+(s-p)**2<=m}function cE(o,t,s,a,r){const{width:u,height:p,data:y}=o;if(t<0||t>=u||s<0||s>=p)return null;const x=(s*u+t)*4,m=y[x],v=y[x+1],b=y[x+2],S=y[x+3],N=new Uint8Array(u*p);let _=u,M=p,G=-1,k=-1;if(r){if(S<128)return null;const R=[[t,s]];N[s*u+t]=1;let B=0;for(;B<R.length;){const[U,$]=R[B++];_=Math.min(_,U),M=Math.min(M,$),G=Math.max(G,U),k=Math.max(k,$);const D=[[U,$-1],[U+1,$],[U,$+1],[U-1,$]];for(const[E,K]of D)if(E>=0&&E<u&&K>=0&&K<p){const I=K*u+E;if(N[I]===0){const X=I*4;vg(m,v,b,S,y[X],y[X+1],y[X+2],y[X+3],a)&&(N[I]=1,R.push([E,K]))}}}}else for(let R=0;R<p;R++)for(let B=0;B<u;B++){const U=(R*u+B)*4;vg(m,v,b,S,y[U],y[U+1],y[U+2],y[U+3],a)&&(N[R*u+B]=1,_=Math.min(_,B),M=Math.min(M,R),G=Math.max(G,B),k=Math.max(k,R))}if(G===-1)return null;const V=new Path2D;for(let R=0;R<p;R++)for(let B=0;B<u;B++)if(N[R*u+B]===1){let U=B;for(;B+1<u&&N[R*u+(B+1)]===1;)B++;V.rect(U,R,B-U+1,1)}return{path:V,bbox:{x:_,y:M,width:G-_+1,height:k-M+1}}}class Bo{constructor(){this.points=[],this.beforeCanvas=null,this.isDrawing=!1,this.strokeSeed=0,this.smoothing=0}updateSmoothing(t){this.smoothing=t}onPointerDown(t,s){var a;this.strokeSeed=t.x*1337+t.y*31337+Date.now(),this.isDrawing=!0,this.points=[t],this.beforeCanvas=document.createElement("canvas"),this.beforeCanvas.width=s.mainCtx.canvas.width,this.beforeCanvas.height=s.mainCtx.canvas.height,(a=this.beforeCanvas.getContext("2d"))==null||a.drawImage(s.mainCtx.canvas,0,0),this.onStrokeStart&&this.onStrokeStart(t,s)}onPointerMove(t,s){if(this.isDrawing){if(this.smoothing>0&&this.points.length>0){const a=this.points[this.points.length-1],r={x:a.x+(t.x-a.x)*(1-this.smoothing),y:a.y+(t.y-a.y)*(1-this.smoothing),pressure:t.pressure!==void 0?a.pressure!==void 0?a.pressure+(t.pressure-a.pressure)*(1-this.smoothing):t.pressure:void 0};this.points.push(r)}else this.points.push(t);this.updatePreview(s)}}onPointerUp(t){if(!this.isDrawing||!this.beforeCanvas)return;this.isDrawing=!1;const s=t.mainCtx;this.drawWithMirroring(s,this.points,t),t.onDrawCommit(t.activeItemId,this.beforeCanvas),this.clearPreview(t),this.reset()}onPointerCancel(t){if(t)this.onPointerUp(t);else{if(!this.isDrawing)return;this.isDrawing=!1,this.reset()}}updatePreview(t){const{previewCtx:s,viewTransform:a}=t;if(this.drawSegment&&this.points.length>1){const r=this.points[this.points.length-2],u=this.points[this.points.length-1];this.drawWithMirroringSegment(s,r,u,t)}else this.clearPreview(t),s.save(),s.setTransform(a.zoom,0,0,a.zoom,a.pan.x,a.pan.y),this.drawWithMirroring(s,this.points,t),s.restore()}clearPreview(t){const{previewCtx:s}=t;(!this.drawSegment||!this.isDrawing)&&zo(s)}reset(){this.points=[],this.beforeCanvas=null,this.isDrawing=!1,this.strokeSeed=0}drawWithMirroring(t,s,a){t.save();try{this.drawStroke(t,s,a)}finally{t.restore()}const{activeGuide:r,mirrorGuides:u}=a;r==="mirror"&&u.length>0&&u.forEach(p=>{t.save();try{const[y,x]=[p.start,p.end],m=x.x-y.x,v=x.y-y.y,b=Math.atan2(v,m);t.translate(y.x,y.y),t.rotate(b),t.scale(1,-1),t.rotate(-b),t.translate(-y.x,-y.y),this.drawStroke(t,s,a)}finally{t.restore()}})}drawWithMirroringSegment(t,s,a,r){if(!this.drawSegment)return;t.save(),t.setTransform(r.viewTransform.zoom,0,0,r.viewTransform.zoom,r.viewTransform.pan.x,r.viewTransform.pan.y);try{this.drawSegment(t,s,a,r)}finally{t.restore()}const{activeGuide:u,mirrorGuides:p,viewTransform:y}=r;u==="mirror"&&p.length>0&&p.forEach(x=>{t.save(),t.setTransform(y.zoom,0,0,y.zoom,y.pan.x,y.pan.y);try{const[m,v]=[x.start,x.end],b=v.x-m.x,S=v.y-m.y,N=Math.atan2(S,b);t.translate(m.x,m.y),t.rotate(N),t.scale(1,-1),t.rotate(-N),t.translate(-m.x,-m.y),this.drawSegment(t,s,a,r)}finally{t.restore()}})}}class Ou extends Bo{constructor(t){super(),this.incrementalState={patternPos:0,patternIndex:0,isDrawingDash:!0},this.settings=t}updateSettings(t){this.settings=t}onStrokeStart(t,s){this.incrementalState={patternPos:0,patternIndex:0,isDrawingDash:!0}}drawSegment(t,s,a,r){this.setupContext(t);const{strokeModifier:u}=r,p=this.getDashPattern(u.style,u.scale);this.drawInterpolatedLine(t,s,a,this.incrementalState,p)}drawStroke(t,s,a){if(this.setupContext(t),s.length<1)return;const{strokeModifier:r}=a,u=this.getDashPattern(r.style,r.scale);if(s.length===1){u||this.drawDab(t,s[0],s[0].pressure??1);return}const p={patternPos:0,patternIndex:0,isDrawingDash:!0};for(let y=1;y<s.length;y++)this.drawInterpolatedLine(t,s[y-1],s[y],p,u)}setupContext(t){const{color:s,lineCap:a,lineJoin:r,opacity:u}=this.settings;t.lineCap=a,t.lineJoin=r,t.globalAlpha=u,t.globalCompositeOperation="source-over",t.fillStyle=s}getDashPattern(t,s){switch(t){case"dashed":return[10*s,5*s];case"dotted":return[2*s,4*s];case"dash-dot":return[10*s,4*s,2*s,4*s];default:return null}}drawDab(t,s,a){const{size:r,pressureControl:u}=this.settings,p=a&&u.size?a*r:r;p>.5&&(t.beginPath(),t.arc(s.x,s.y,p/2,0,Math.PI*2),t.fill())}drawInterpolatedLine(t,s,a,r,u){const{size:p}=this.settings,y=Math.hypot(a.x-s.x,a.y-s.y),x=Math.atan2(a.y-s.y,a.x-s.x),m=s.pressure??1,v=a.pressure??1,b=p*Math.min(m,v)*.5,S=Math.max(.25,b*.2);for(let N=0;N<y;N+=S){const _=!u||r.isDrawingDash;if(u&&(r.patternPos+=S,r.patternPos>=u[r.patternIndex]&&(r.patternPos-=u[r.patternIndex],r.patternIndex=(r.patternIndex+1)%u.length,r.isDrawingDash=!r.isDrawingDash)),_){const M=y>0?N/y:0,G=s.x+Math.cos(x)*N,k=s.y+Math.sin(x)*N,V=m+(v-m)*M;this.drawDab(t,{x:G,y:k},V)}}}}class uE extends Bo{constructor(t){super(),this.settings=t}updateSettings(t){this.settings=t}updatePreview(t){const{previewCtx:s,mainCtx:a,viewTransform:r}=t;this.clearPreview(t),s.save(),s.setTransform(r.zoom,0,0,r.zoom,r.pan.x,r.pan.y),s.drawImage(a.canvas,0,0),this.drawWithMirroring(s,this.points,t),s.restore()}drawStroke(t,s,a){t.globalCompositeOperation="destination-out";const{size:r,hardness:u,tipShape:p,opacity:y}=this.settings;if(s.length===0)return;const x=v=>{if(t.beginPath(),p==="round"?t.arc(v.x,v.y,r/2,0,Math.PI*2):t.rect(v.x-r/2,v.y-r/2,r,r),u>=100)t.fillStyle=`rgba(0,0,0,${y})`;else{const b=t.createRadialGradient(v.x,v.y,r/2*(u/100),v.x,v.y,r/2);b.addColorStop(0,`rgba(0,0,0,${y})`),b.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=b}t.fill()};if(s.length===1){x(s[0]);return}let m=s[0];for(let v=1;v<s.length;v++){const b=s[v],S=Math.hypot(b.x-m.x,b.y-m.y),N=Math.atan2(b.y-m.y,b.x-m.x),_=Math.max(1,r*.1);for(let M=0;M<S;M+=_){const G=m.x+Math.cos(N)*M,k=m.y+Math.sin(N)*M;x({x:G,y:k})}m=b}}}class dE extends Bo{constructor(t){super(),this.settings=t}updateSettings(t){this.settings=t}drawStroke(t,s,a){const{color:r,tipShape:u,size:p,blendMode:y,opacity:x,pressureControl:m}=this.settings,{strokeModifier:v}=a;if(t.strokeStyle=r,t.lineCap=u==="line"?"butt":"square",t.lineJoin="miter",t.lineWidth=p,t.globalCompositeOperation=y,s.length<2)return;const S=((N,_)=>{if(N==="solid")return null;const M=G=>G*_*Math.max(1,p/5);switch(N){case"dashed":return[M(10),M(5)];case"dotted":return[M(1),M(4)];case"dash-dot":return[M(10),M(4),M(2),M(4)];default:return null}})(v.style,v.scale);if(S){t.setLineDash(S),t.globalAlpha=x,t.beginPath(),t.moveTo(s[0].x,s[0].y);for(let N=1;N<s.length;N++)t.lineTo(s[N].x,s[N].y);t.stroke(),t.setLineDash([])}else for(let N=1;N<s.length;N++){const _=s[N-1],M=s[N],G=M.pressure??1;let k=x;m.opacity&&(k*=G),t.globalAlpha=k,t.beginPath(),t.moveTo(_.x,_.y),t.lineTo(M.x,M.y),t.stroke()}}}class fE extends Bo{constructor(t){super(),this.settings=t,this.pencilEquivalent=new Ou({...t,lineCap:"round",lineJoin:"round",hasStrokeCaps:!0})}updateSettings(t){this.settings=t,this.pencilEquivalent.updateSettings({...t,lineCap:"round",lineJoin:"round",hasStrokeCaps:!0})}drawStroke(t,s,a){this.pencilEquivalent.drawStroke(t,s,a)}}class hE extends Bo{constructor(t){super(),this.settings=t}updateSettings(t){this.settings=t}drawStroke(t,s,a){t.globalCompositeOperation="source-over";const{size:r,flow:u,color:p}=this.settings;if(s.length===0)return;const y=m=>{const v=t.createRadialGradient(m.x,m.y,0,m.x,m.y,r/2);t.strokeStyle,t.fillStyle=p;const b=parseInt(t.fillStyle.slice(1,3),16),S=parseInt(t.fillStyle.slice(3,5),16),N=parseInt(t.fillStyle.slice(5,7),16);v.addColorStop(0,`rgba(${b},${S},${N},${u})`),v.addColorStop(1,`rgba(${b},${S},${N},0)`),t.fillStyle=v,t.beginPath(),t.arc(m.x,m.y,r/2,0,Math.PI*2),t.fill()};if(s.length===1){y(s[0]);return}let x=s[0];for(let m=1;m<s.length;m++){const v=s[m],b=Math.hypot(v.x-x.x,v.y-x.y),S=Math.atan2(v.y-x.y,v.x-x.x),N=Math.max(1,r*.1);for(let _=0;_<b;_+=N){const M=x.x+Math.cos(S)*_,G=x.y+Math.sin(S)*_;y({x:M,y:G})}x=v}}}class pE extends Bo{constructor(t){super(),this.settings=t,this.pencilEquivalent=new Ou({...t,lineCap:"round",lineJoin:"round",hasStrokeCaps:!0,pressureControl:{size:!0}})}updateSettings(t){this.settings=t,this.pencilEquivalent.updateSettings({...t,lineCap:"round",lineJoin:"round",hasStrokeCaps:!0,pressureControl:{size:!0}})}drawStroke(t,s,a){this.pencilEquivalent.drawStroke(t,s,a)}}class mE extends Bo{constructor(){super()}drawStroke(t,s,a){}}class gE extends Bo{constructor(t){super(),this.settings=t}updateSettings(t){this.settings=t}drawStroke(t,s,a){const{color:r,size:u,hardness:p,flow:y,blendMode:x,pressureControl:m,spacing:v}=this.settings,{strokeModifier:b}=a;if(t.globalCompositeOperation=x,s.length<1)return;const S=D=>{const E=document.createElement("canvas").getContext("2d");if(E){E.fillStyle=D,E.fillRect(0,0,1,1);const K=E.getImageData(0,0,1,1).data;return[K[0],K[1],K[2]]}return[0,0,0]},[N,_,M]=S(r),G=(D,E)=>{const K=m.size?E*u:u;if(K<.5)return;const I=m.flow?E*(y/100):y/100;if(t.beginPath(),p>=100)t.arc(D.x,D.y,K/2,0,Math.PI*2),t.fillStyle=`rgba(${N},${_},${M},${I})`;else{const X=t.createRadialGradient(D.x,D.y,K/2*(p/100),D.x,D.y,K/2);X.addColorStop(0,`rgba(${N},${_},${M},${I})`),X.addColorStop(1,`rgba(${N},${_},${M},0)`),t.fillStyle=X,t.arc(D.x,D.y,K/2,0,Math.PI*2)}t.fill()},V=((D,E)=>{switch(D){case"dashed":return[10*E,5*E];case"dotted":return[2*E,4*E];case"dash-dot":return[10*E,4*E,2*E,4*E];default:return null}})(b.style,b.scale);if(s.length===1){V||G(s[0],s[0].pressure??1);return}let R=s[0],B=0,U=0,$=!0;for(let D=1;D<s.length;D++){const E=s[D],K=Math.hypot(E.x-R.x,E.y-R.y),I=Math.atan2(E.y-R.y,E.x-R.x),X=R.pressure??1,L=E.pressure??1,H=Math.max(1,u*(v/100));for(let ue=0;ue<K;ue+=H){const ve=!V||$;if(V&&(B+=H,B>=V[U]&&(B-=V[U],U=(U+1)%V.length,$=!$)),ve){const j=K>0?ue/K:0,z=R.x+Math.cos(I)*ue,oe=R.y+Math.sin(I)*ue,ge=X+(L-X)*j;G({x:z,y:oe},ge)}}R=E}}}function yE(o){return function(){var t=o+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}class xE extends Bo{constructor(t){super(),this.settings=t}updateSettings(t){this.settings=t}drawStroke(t,s,a){const r=yE(this.strokeSeed),{color:u,size:p,flow:y,wetness:x,pressureControl:m}=this.settings,{strokeModifier:v}=a;if(t.globalCompositeOperation="source-over",s.length<1)return;const b=$=>{const D=document.createElement("canvas").getContext("2d");if(D){D.fillStyle=$,D.fillRect(0,0,1,1);const E=D.getImageData(0,0,1,1).data;return[E[0],E[1],E[2]]}return[0,0,0]},[S,N,_]=b(u),M=($,D)=>{const E=m.size?D*p:p;if(E<1)return;const K=m.flow?D*(y/100):y/100,I=Math.max(1,Math.floor(K*5));for(let X=0;X<I;X++){const L=(r()-.5)*E*.4,H=(r()-.5)*E*.4,ue=$.x+L,ve=$.y+H,j=E*(.8+r()*.4),z=x/100*(.5+r()*.5),oe=t.createRadialGradient(ue,ve,0,ue,ve,j/2);oe.addColorStop(0,`rgba(${S},${N},${_},${z})`),oe.addColorStop(1,`rgba(${S},${N},${_},0)`),t.fillStyle=oe,t.beginPath(),t.arc(ue,ve,j/2,0,Math.PI*2),t.fill()}},k=(($,D)=>{switch($){case"dashed":return[10*D,5*D];case"dotted":return[2*D,4*D];case"dash-dot":return[10*D,4*D,2*D,4*D];default:return null}})(v.style,v.scale);if(s.length===1){k||M(s[0],s[0].pressure??1);return}let V=s[0],R=0,B=0,U=!0;for(let $=1;$<s.length;$++){const D=s[$],E=Math.hypot(D.x-V.x,D.y-V.y),K=Math.atan2(D.y-V.y,D.x-V.x),I=V.pressure??1,X=D.pressure??1,L=Math.max(1,p*.2);for(let H=0;H<E;H+=L){const ue=!k||U;if(k&&(R+=L,R>=k[B]&&(R-=k[B],B=(B+1)%k.length,U=!U)),ue){const ve=E>0?H/E:0,j=V.x+Math.cos(K)*H,z=V.y+Math.sin(K)*H,oe=I+(X-I)*ve;M({x:j,y:z},oe)}}V=D}}}function vE({brushSettings:o,eraserSettings:t,simpleMarkerSettings:s,naturalMarkerSettings:a,airbrushSettings:r,fxBrushSettings:u,advancedMarkerSettings:p,watercolorSettings:y}){const x=T.useMemo(()=>({brush:new Ou(o),eraser:new uE(t),"simple-marker":new dE(s),"natural-marker":new fE(a),airbrush:new hE(r),"fx-brush":new pE(u),"debug-brush":new mE,"advanced-marker":new gE(p),watercolor:new xE(y)}),[]);return x.brush.updateSettings(o),x.eraser.updateSettings(t),x["simple-marker"].updateSettings(s),x["natural-marker"].updateSettings(a),x.airbrush.updateSettings(r),x["fx-brush"].updateSettings(u),x["advanced-marker"].updateSettings(p),x.watercolor.updateSettings(y),{getBrushForTool:v=>x[v]||null}}function bE({mainCanvasRef:o,guideCanvasRef:t,uiCanvasRef:s,items:a,viewTransform:r,activeItemId:u,activeGuide:p,isOrthogonalVisible:y,rulerGuides:x,mirrorGuides:m,perspectiveGuide:v,orthogonalGuide:b,gridGuide:S,isCropping:N,cropRect:_,isTransforming:M,transformState:G,transformSourceBbox:k,livePreviewLayerId:V}){const R=T.useRef({vpGreen:null,vpRed:null,vpBlue:null}),B=T.useCallback(E=>{if(S.type==="none"||S.spacing<=0)return;const K={x:-r.pan.x/r.zoom,y:-r.pan.y/r.zoom,width:E.canvas.width/r.zoom,height:E.canvas.height/r.zoom},{spacing:I,majorLineFrequency:X,type:L,isoAngle:H,majorLineColor:ue,minorLineColor:ve}=S;E.lineWidth=.5/r.zoom;const j=ve,z=ue;if(L==="cartesian"){const oe=Math.floor(K.x/I)*I,ge=K.x+K.width,Z=Math.floor(K.y/I)*I,A=K.y+K.height;let O=Math.round(oe/I);for(let ye=oe;ye<=ge;ye+=I)E.strokeStyle=O%X===0?z:j,E.beginPath(),E.moveTo(ye,K.y),E.lineTo(ye,A),E.stroke(),O++;let W=Math.round(Z/I);for(let ye=Z;ye<=A;ye+=I)E.strokeStyle=W%X===0?z:j,E.beginPath(),E.moveTo(K.x,ye),E.lineTo(ge,ye),E.stroke(),W++}else if(L==="isometric"){const oe=Math.hypot(K.width,K.height)*1.2,ge={x:K.x+K.width/2,y:K.y+K.height/2};[90*(Math.PI/180),(90-H)*(Math.PI/180),(90+H)*(Math.PI/180)].forEach(A=>{const O=Math.cos(A),W=Math.sin(A),ye=Math.cos(A+Math.PI/2),be=Math.sin(A+Math.PI/2),me=ge.x*ye+ge.y*be,Me=Math.floor((me-oe/2)/I),De=Math.ceil((me+oe/2)/I);for(let Ae=Me;Ae<=De;Ae++){const Ke=Ae*I,mt={x:Ke*ye,y:Ke*be},Rt={x:mt.x-oe*O,y:mt.y-oe*W},he={x:mt.x+oe*O,y:mt.y+oe*W};E.strokeStyle=Ae%X===0?z:j,E.beginPath(),E.moveTo(Rt.x,Rt.y),E.lineTo(he.x,he.y),E.stroke()}})}},[S,r]),U=T.useCallback(()=>{var X;const E=(X=o.current)==null?void 0:X.getContext("2d");if(!E)return;E.save(),E.setTransform(1,0,0,1,0,0),E.clearRect(0,0,E.canvas.width,E.canvas.height),E.restore(),E.save(),E.setTransform(r.zoom,0,0,r.zoom,r.pan.x,r.pan.y);const K=a.find(L=>L.type==="object"&&L.isBackground),I=a.filter(L=>L.type==="object"&&!L.isBackground);K&&K.canvas&&K.isVisible&&(E.globalAlpha=K.opacity,E.drawImage(K.canvas,K.offsetX||0,K.offsetY||0)),B(E),I.forEach(L=>{if(!L.isVisible)return;const H=L.id===V;M&&L.id===u||H||L.canvas&&(E.globalAlpha=L.opacity,E.drawImage(L.canvas,L.offsetX||0,L.offsetY||0))}),E.restore()},[a,r,u,M,V,B]),$=T.useCallback(()=>{var X;const E=(X=t.current)==null?void 0:X.getContext("2d");if(!E)return;E.save(),E.setTransform(1,0,0,1,0,0),E.clearRect(0,0,E.canvas.width,E.canvas.height),E.restore(),E.save(),E.translate(r.pan.x,r.pan.y),E.scale(r.zoom,r.zoom);const K=8/r.zoom,I={x:-r.pan.x/r.zoom,y:-r.pan.y/r.zoom,width:E.canvas.width/r.zoom,height:E.canvas.height/r.zoom};if(p==="ruler"&&x&&x.forEach(L=>{E.strokeStyle="cyan",E.lineWidth=1/r.zoom,E.beginPath(),E.moveTo(L.start.x,L.start.y),E.lineTo(L.end.x,L.end.y),E.stroke(),E.fillStyle="cyan";const H={x:(L.start.x+L.end.x)/2,y:(L.start.y+L.end.y)/2};[L.start,L.end,H].forEach(ue=>{E.beginPath(),E.arc(ue.x,ue.y,K,0,2*Math.PI),E.fill()})}),p==="mirror"&&m&&m.forEach(L=>{E.strokeStyle="rgba(139, 0, 255, 0.8)",E.lineWidth=1/r.zoom,E.setLineDash([5/r.zoom,5/r.zoom]),E.beginPath(),E.moveTo(L.start.x,L.start.y),E.lineTo(L.end.x,L.end.y),E.stroke(),E.setLineDash([]),E.fillStyle="rgba(139, 0, 255, 0.8)";const H={x:(L.start.x+L.end.x)/2,y:(L.start.y+L.end.y)/2};[L.start,L.end,H].forEach(ue=>{E.beginPath(),E.arc(ue.x,ue.y,K,0,2*Math.PI),E.fill()})}),y&&b){const L={x:I.x+I.width/2,y:I.y+I.height/2},H=Math.max(I.width,I.height)*1.5;E.save(),E.translate(L.x,L.y),E.rotate(b.angle*Math.PI/180),E.strokeStyle="rgba(255, 165, 0, 0.7)",E.lineWidth=1/r.zoom,E.setLineDash([5/r.zoom,5/r.zoom]),E.beginPath(),E.moveTo(-H/2,0),E.lineTo(H/2,0),E.moveTo(0,-H/2),E.lineTo(0,H/2),E.stroke(),E.restore(),E.setLineDash([])}if(p==="perspective"&&v){const{lines:L,guidePoint:H,extraGuideLines:ue}=v,ve=Math.hypot(I.width,I.height)*10,j=bu(L.green[0],L.green[1]),z=bu(L.red[0],L.red[1]),oe=bu(L.blue[0],L.blue[1]);if(R.current={vpGreen:j,vpRed:z,vpBlue:oe},j&&z){E.strokeStyle="rgba(255, 255, 0, 0.7)",E.lineWidth=1.5/r.zoom,E.setLineDash([8/r.zoom,4/r.zoom]),E.beginPath();const Z=z.x-j.x,A=z.y-j.y,O=Math.hypot(Z,A)||1;E.moveTo(j.x-Z/O*ve,j.y-A/O*ve),E.lineTo(z.x+Z/O*ve,z.y+A/O*ve),E.stroke(),E.setLineDash([])}const ge=(Z,A,O,W)=>{const ye=Z.replace("0.5","0.4"),be=Z,me=Z;A&&(E.strokeStyle=ye,E.lineWidth=.8/r.zoom,E.setLineDash([4/r.zoom,4/r.zoom]),[...O.flatMap(Ae=>[Ae.start,Ae.end]),...W,H].forEach(Ae=>{E.beginPath(),E.moveTo(A.x,A.y),E.lineTo(Ae.x,Ae.y),E.stroke()}),E.setLineDash([])),E.strokeStyle=be,E.lineWidth=1/r.zoom,O.forEach(De=>{E.beginPath(),E.moveTo(De.start.x,De.start.y),E.lineTo(De.end.x,De.end.y),E.stroke()}),E.fillStyle=me,[...O.flatMap(De=>[De.start,De.end]),...W].forEach(De=>{E.beginPath(),E.arc(De.x,De.y,K,0,2*Math.PI),E.fill()})};if(ge("rgba(0, 255, 0, 0.5)",j,L.green,ue.green.map(Z=>Z.handle)),ge("rgba(255, 0, 0, 0.5)",z,L.red,ue.red.map(Z=>Z.handle)),oe)ge("rgba(0, 0, 255, 0.5)",oe,L.blue,ue.blue.map(Z=>Z.handle));else{const Z="rgba(0, 0, 255, 0.5)",A="rgba(0, 0, 255, 0.4)";if(E.strokeStyle=A,E.lineWidth=.8/r.zoom,E.setLineDash([4/r.zoom,4/r.zoom]),L.blue.length>0){const W=L.blue[0],ye=Math.atan2(W.end.y-W.start.y,W.end.x-W.start.x),be=Math.cos(ye),me=Math.sin(ye);[...L.blue.flatMap(De=>[De.start,De.end]),...ue.blue.map(De=>De.handle),H].forEach(De=>{E.beginPath(),E.moveTo(De.x-be*ve,De.y-me*ve),E.lineTo(De.x+be*ve,De.y+me*ve),E.stroke()})}E.setLineDash([]),E.strokeStyle=Z,E.lineWidth=1/r.zoom,L.blue.forEach(W=>{E.beginPath(),E.moveTo(W.start.x,W.start.y),E.lineTo(W.end.x,W.end.y),E.stroke()}),E.fillStyle=Z,[...L.blue.flatMap(W=>[W.start,W.end]),...ue.blue.map(W=>W.handle)].forEach(W=>{E.beginPath(),E.arc(W.x,W.y,K,0,2*Math.PI),E.fill()})}E.fillStyle="yellow",E.strokeStyle="black",E.lineWidth=.5/r.zoom,E.beginPath(),E.arc(H.x,H.y,K*1.5,0,2*Math.PI),E.fill(),E.stroke()}E.restore()},[r,p,x,m,y,b,v]),D=T.useCallback(()=>{var I;const E=(I=s.current)==null?void 0:I.getContext("2d");if(!E)return;E.save(),E.setTransform(1,0,0,1,0,0),E.clearRect(0,0,E.canvas.width,E.canvas.height),E.restore(),E.save(),E.setTransform(r.zoom,0,0,r.zoom,r.pan.x,r.pan.y);const K=8/r.zoom;if(N&&_){E.strokeStyle="rgba(255, 255, 255, 0.7)",E.lineWidth=1/r.zoom,E.setLineDash([4/r.zoom,2/r.zoom]),E.strokeRect(_.x,_.y,_.width,_.height),E.setLineDash([]);const{x:X,y:L,width:H,height:ue}=_,ve=[{x:X,y:L},{x:X+H,y:L},{x:X,y:L+ue},{x:X+H,y:L+ue},{x:X+H/2,y:L},{x:X+H/2,y:L+ue},{x:X,y:L+ue/2},{x:X+H,y:L+ue/2}];E.fillStyle="white",E.strokeStyle="black",E.lineWidth=1/r.zoom,ve.forEach(j=>{E.beginPath(),E.rect(j.x-K/2,j.y-K/2,K,K),E.fill(),E.stroke()})}if(M&&G){E.lineWidth=1/r.zoom,E.strokeStyle="#00BFFF",E.fillStyle="white";const X=(L,H=!1)=>{E.strokeStyle="black",E.lineWidth=.5/r.zoom,E.beginPath(),H?E.arc(L.x,L.y,K/2,0,2*Math.PI):E.rect(L.x-K/2,L.y-K/2,K,K),E.fill(),E.stroke()};if(G.type==="affine"){const{x:L,y:H,width:ue,height:ve,rotation:j}=G,z={x:L+ue/2,y:H+ve/2};E.save(),E.translate(z.x,z.y),E.rotate(j),E.strokeStyle="#00BFFF",E.lineWidth=1/r.zoom,E.strokeRect(-ue/2,-ve/2,ue,ve),E.restore();const oe=Math.cos(j),ge=Math.sin(j),Z=ye=>({x:z.x+(ye.x-z.x)*oe-(ye.y-z.y)*ge,y:z.y+(ye.x-z.x)*ge+(ye.y-z.y)*oe}),A={tl:Z({x:L,y:H}),tr:Z({x:L+ue,y:H}),bl:Z({x:L,y:H+ve}),br:Z({x:L+ue,y:H+ve}),t:Z({x:L+ue/2,y:H}),b:Z({x:L+ue/2,y:H+ve}),l:Z({x:L,y:H+ve/2}),r:Z({x:L+ue,y:H+ve/2})};Object.values(A).forEach(ye=>X(ye));const O=Z({x:L+ue/2,y:H-25/r.zoom}),W=Z({x:L+ue/2,y:H});E.strokeStyle="#00BFFF",E.lineWidth=1/r.zoom,E.beginPath(),E.moveTo(O.x,O.y),E.lineTo(W.x,W.y),E.stroke(),X(O,!0)}else if(G.type==="free"){const{tl:L,tr:H,br:ue,bl:ve}=G.corners;E.strokeStyle="#00BFFF",E.lineWidth=1/r.zoom,E.beginPath(),E.moveTo(L.x,L.y),E.lineTo(H.x,H.y),E.lineTo(ue.x,ue.y),E.lineTo(ve.x,ve.y),E.closePath(),E.stroke(),[L,H,ue,ve].forEach(j=>X(j))}}E.restore()},[r,N,_,M,G]);return{redrawMainCanvas:U,redrawGuides:$,redrawUI:D,perspectiveVPs:R}}function bg(o){if(o.length<3)return o;const t=[],[s,a,r]=o;for(let u=0;u<=1;u+=.01){const p=(1-u)**2*s.x+2*(1-u)*u*a.x+u**2*r.x,y=(1-u)**2*s.y+2*(1-u)*u*a.y+u**2*r.y,x=s.pressure??1,m=a.pressure??x+((r.pressure??1)-x)/2,v=r.pressure??1,b=(1-u)**2*x+2*(1-u)*u*m+u**2*v;t.push({x:p,y,pressure:b})}return t}function Cg(o,t){if(o.length<3)return o;const[s,a,r]=o,u=Math.hypot(a.x-s.x,a.y-s.y),p=Math.atan2(a.y-s.y,a.x-s.x);let y;if(t!==void 0)y=t;else{const v=Math.atan2(r.y-s.y,r.x-s.x),b=Math.PI*2;y=v-p,y>Math.PI&&(y-=b),y<-Math.PI&&(y+=b)}const x=[],m=Math.max(10,Math.ceil(Math.abs(y*u)/2));for(let v=0;v<=m;v++){const b=v/m,S=p+y*b,N=s.x+u*Math.cos(S),_=s.y+u*Math.sin(S),M=(a.pressure??1)*(1-b)+(r.pressure??1)*b;x.push({x:N,y:_,pressure:M})}return x}function CE({items:o,uiCanvasRef:t,previewCanvasRef:s,viewTransform:a,setViewTransform:r,activeItem:u,tool:p,isDrawingTool:y,isSelectionTool:x,onDrawCommit:m,onSelectItem:v,getBrushForTool:b,areGuidesLocked:S,activeGuide:N,isOrthogonalVisible:_,rulerGuides:M,setRulerGuides:G,mirrorGuides:k,setMirrorGuides:V,perspectiveGuide:R,setPerspectiveGuide:B,perspectiveVPs:U,orthogonalGuide:$,guideDragState:D,setGuideDragState:E,cropRect:K,setCropRect:I,transformState:X,setTransformState:L,isAspectRatioLocked:H,isAngleSnapEnabled:ue,angleSnapValue:ve,livePreviewLayerId:j,setLivePreviewLayerId:z,isPerspectiveStrokeLockEnabled:oe,isSnapToGridEnabled:ge,gridGuide:Z,strokeMode:A,strokeState:O,setStrokeState:W,magicWandSettings:ye,selection:be,setSelection:me,onUpdateItem:Me,forceRender:De,getMinZoom:Ae,MAX_ZOOM:Ke,onAddItem:mt,textEditState:Rt,setTextEditState:he,onCommitText:Ee,strokeSmoothing:Se,strokeModifier:je,setDebugPointers:Ve}){const Fe=T.useRef(null),tt=T.useRef({type:"none"}),rt=T.useRef(null),Ht=T.useRef(null),Ze=T.useRef(null),It=T.useRef(null),$e=T.useRef(new Map),bt=T.useRef(null),Ue=T.useRef(!1),We=T.useRef(null),Ut=T.useRef(null),mn=T.useRef(0);T.useEffect(()=>{const Ne=()=>{t.current&&(Fe.current=t.current.getBoundingClientRect())};return Ne(),window.addEventListener("resize",Ne),window.addEventListener("scroll",Ne,{capture:!0,passive:!0}),()=>{window.removeEventListener("resize",Ne),window.removeEventListener("scroll",Ne,{capture:!0})}},[t]);const un=T.useCallback((Ne,_e)=>{var Ye,at,Ct,Te;if(!Fe.current&&t.current&&(Fe.current=t.current.getBoundingClientRect()),!Fe.current)return{x:0,y:0};const Ge=Fe.current,it="clientX"in Ne?Ne.clientX:((at=(Ye=Ne.changedTouches)==null?void 0:Ye[0])==null?void 0:at.clientX)??0,ct="clientY"in Ne?Ne.clientY:((Te=(Ct=Ne.changedTouches)==null?void 0:Ct[0])==null?void 0:Te.clientY)??0,gt=it-Ge.left,Oe=ct-Ge.top;return{x:(gt-_e.pan.x)/_e.zoom,y:(Oe-_e.pan.y)/_e.zoom}},[]),ft=Ne=>{tt.current=Ne,De()};T.useEffect(()=>{var Ne;if(!O){const _e=(Ne=s.current)==null?void 0:Ne.getContext("2d");_e&&zo(_e)}},[O,s]),T.useEffect(()=>{It.current=null},[p,A]);const Yt=T.useCallback(Ne=>{if(!ge||Z.type==="none")return Ne;const{spacing:_e}=Z;if(Z.type==="cartesian")return{...Ne,x:Math.round(Ne.x/_e)*_e,y:Math.round(Ne.y/_e)*_e};if(Z.type==="isometric"){const Ge=_e,{x:it,y:ct}=Ne,gt=-30*(Math.PI/180),Oe=Math.cos(gt),Ye=Math.sin(gt),at=it*Oe-ct*Ye,Ct=it*Ye+ct*Oe,Te=Ge*2/Math.sqrt(3),Ce=(at*(Math.sqrt(3)/3)-Ct/3)/(Te/Math.sqrt(3)),Ie=Ct*2/3/(Te/Math.sqrt(3)),ae=-Ce-Ie;let Y=Math.round(Ce),le=Math.round(Ie),xe=Math.round(ae);const we=Math.abs(Y-Ce),ke=Math.abs(le-Ie),Re=Math.abs(xe-ae);we>ke&&we>Re?Y=-le-xe:ke>Re&&(le=-Y-xe);const Le=Te*(Y+le/2),Je=Te*(le*Math.sqrt(3)/2),nt=30*(Math.PI/180),St=Math.cos(nt),ot=Math.sin(nt),Ft=Le*St-Je*ot,$t=Le*ot+Je*St;return{...Ne,x:Ft,y:$t}}return Ne},[ge,Z]),hn=T.useCallback(Ne=>{var Oe,Ye,at,Ct;if(!t.current||(Fe.current=t.current.getBoundingClientRect(),Ne.button!==0&&Ne.pointerType==="mouse"&&Ne.button!==1)||Ne.pointerType==="pen"&&Ne.pressure===0)return;if($e.current.set(Ne.pointerId,{x:Ne.clientX,y:Ne.clientY}),Ve(new Map($e.current)),$e.current.size>=2){if(Ue.current=!0,(Oe=rt.current)!=null&&Oe.isDrawing){rt.current.onPointerCancel(null),rt.current=null;const Te=(Ye=s.current)==null?void 0:Ye.getContext("2d");Te&&zo(Te)}if(W(null),Ut.current&&clearTimeout(Ut.current),bt.current=null,$e.current.size===2){const Te=Array.from($e.current.values()),Ce=Te[0],Ie=Te[1],ae={x:(Ce.x+Ie.x)/2,y:(Ce.y+Ie.y)/2},Y=Ie.x-Ce.x,le=Ie.y-Ce.y,xe=Math.hypot(Y,le);We.current={distance:xe,midpoint:ae,zoom:a.zoom,pan:a.pan},ft({type:"pan",startX:ae.x,startY:ae.y,startPan:a.pan})}else ft({type:"none"});return}const _e=un(Ne,a);let Ge=Yt(_e);if(N==="ruler"&&M.length>0){const Te=M[0],Ce=Te.start,Ie=Te.end,ae=Ge,Y={x:Ie.x-Ce.x,y:Ie.y-Ce.y},le={x:ae.x-Ce.x,y:ae.y-Ce.y},xe=Y.x*Y.x+Y.y*Y.y;if(xe>0){const we=(le.x*Y.x+le.y*Y.y)/xe;Ge={x:Ce.x+Y.x*we,y:Ce.y+Y.y*we}}}const ct=A==="freehand"&&Ne.pointerType==="pen"?Ne.pressure:1,gt={...Ge,pressure:ct};if(Ht.current=null,Ze.current=null,!S){const Te=10/a.zoom;if(N==="ruler")for(const Ce of M){if(co(_e,Ce.start,Te)){E({type:"ruler",id:Ce.id,part:"start",offset:{x:0,y:0}});return}if(co(_e,Ce.end,Te)){E({type:"ruler",id:Ce.id,part:"end",offset:{x:0,y:0}});return}}if(N==="mirror")for(const Ce of k){if(co(_e,Ce.start,Te)){E({type:"mirror",id:Ce.id,part:"start",offset:{x:0,y:0}});return}if(co(_e,Ce.end,Te)){E({type:"mirror",id:Ce.id,part:"end",offset:{x:0,y:0}});return}if(lE(_e,Ce.start,Ce.end)<Te){E({type:"mirror",id:Ce.id,part:"line",offset:{x:Ce.start.x-_e.x,y:Ce.start.y-_e.y}});return}}if(N==="perspective"&&R){const{lines:Ce,guidePoint:Ie,extraGuideLines:ae}=R;if(co(_e,Ie,Te*1.5)){E({type:"perspective-point",part:"point"});return}for(const Y of["green","red","blue"]){for(const le of Ce[Y]){if(co(_e,le.start,Te)){E({type:"perspective",color:Y,lineId:le.id,part:"start"});return}if(co(_e,le.end,Te)){E({type:"perspective",color:Y,lineId:le.id,part:"end"});return}}for(const le of ae[Y])if(co(_e,le.handle,Te)){E({type:"perspective-extra",color:Y,id:le.id});return}}}}if(p==="crop"&&K){const Ce=(ae=>({tl:{x:ae.x,y:ae.y},tr:{x:ae.x+ae.width,y:ae.y},bl:{x:ae.x,y:ae.y+ae.height},br:{x:ae.x+ae.width,y:ae.y+ae.height},t:{x:ae.x+ae.width/2,y:ae.y},b:{x:ae.x+ae.width/2,y:ae.y+ae.height},l:{x:ae.x,y:ae.y+ae.height/2},r:{x:ae.x+ae.width,y:ae.y+ae.height/2}}))(K),Ie=10/a.zoom;for(const[ae,Y]of Object.entries(Ce))if(Y&&co(_e,Y,Ie)){ft({type:"crop",handle:ae,startRect:K,startPoint:_e});return}if(_e.x>K.x&&_e.x<K.x+K.width&&_e.y>K.y&&_e.y<K.y+K.height){ft({type:"crop",handle:"move",startRect:K,startPoint:_e});return}}if((p==="transform"||p==="free-transform")&&X){const Te=10/a.zoom;if(X.type==="affine"){const{x:Ce,y:Ie,width:ae,height:Y,rotation:le}=X,xe={x:Ce+ae/2,y:Ie+Y/2},we=Math.cos(le),ke=Math.sin(le),Re=Je=>({x:xe.x+(Je.x-xe.x)*we-(Je.y-xe.y)*ke,y:xe.y+(Je.x-xe.x)*ke+(Je.y-xe.y)*we}),Le={tl:Re({x:Ce,y:Ie}),tr:Re({x:Ce+ae,y:Ie}),bl:Re({x:Ce,y:Ie+Y}),br:Re({x:Ce+ae,y:Ie+Y}),t:Re({x:Ce+ae/2,y:Ie}),b:Re({x:Ce+ae/2,y:Ie+Y}),l:Re({x:Ce,y:Ie+Y/2}),r:Re({x:Ce+ae,y:Ie+Y/2}),rotate:Re({x:Ce+ae/2,y:Ie-25/a.zoom})};for(const[Je,nt]of Object.entries(Le))if(nt&&co(_e,nt,Te)){ft({type:"transform",handle:Je,startState:X,startPoint:_e,center:xe});return}}else if(X.type==="free"){const Ce=X.corners;for(const[Ie,ae]of Object.entries(Ce))if(ae&&co(_e,ae,Te)){ft({type:"transform",handle:Ie,startState:X,startPoint:_e});return}}if(X.type==="free"&&iE(_e,Object.values(X.corners))){ft({type:"transform",handle:"move",startState:X,startPoint:_e});return}if(X.type==="affine"){const Ce={x:_e.x-(X.x+X.width/2),y:_e.y-(X.y+X.height/2)},Ie={x:Ce.x*Math.cos(-X.rotation)-Ce.y*Math.sin(-X.rotation),y:Ce.x*Math.sin(-X.rotation)+Ce.y*Math.cos(-X.rotation)};if(Math.abs(Ie.x)<X.width/2&&Math.abs(Ie.y)<X.height/2){ft({type:"transform",handle:"move",startState:X,startPoint:_e});return}}}if(p==="text"){Rt&&Ee(Rt),ft({type:"text-place"});return}if(x){if(me(null),p==="marquee-rect"||p==="lasso"){ft({type:"selection",tool:p,startPoint:Ge,points:[Ge]});return}else if(p==="magic-wand"){if(u&&u.type==="object"&&u.canvas){const Te=u.canvas,Ce=Te.getContext("2d",{willReadFrequently:!0});if(!Ce)return;try{const Ie=Ce.getImageData(0,0,Te.width,Te.height),ae=Math.floor(Ge.x),Y=Math.floor(Ge.y),le=cE(Ie,ae,Y,ye.tolerance,ye.contiguous);le&&me({path:le.path,boundingBox:le.bbox,sourceItemId:u.id})}catch(Ie){console.error("Could not get image data for magic wand.",Ie),alert("Error: Could not perform magic wand selection. The canvas may be tainted by cross-origin content.")}}return}}if(y&&A==="line"){ft({type:"draw"}),O||W({mode:"line",points:[gt]});return}if(y&&["polyline","curve","arc"].includes(A)){if(A==="polyline"&&(Ut.current&&clearTimeout(Ut.current),Ut.current=window.setTimeout(()=>{if(u&&u.type==="object"&&O&&O.points.length>1){const Te=Ca(u.canvas),Ce=u.context,Ie=b(p);if(Ie){const ae={mainCtx:Ce,previewCtx:s.current.getContext("2d"),viewTransform:a,onDrawCommit:m,activeItemId:u.id,activeGuide:N,mirrorGuides:k,strokeModifier:je};Ie.drawWithMirroring(Ce,O.points,ae),m(u.id,Te)}}W(null),Ut.current=null},700)),!O)W({mode:A,points:[gt]}),A==="arc"&&(It.current=null);else{const Te=[...O.points,gt];W({...O,points:Te});let Ce=!1;if(A==="curve"&&Te.length===3&&(Ce=!0),A==="arc"&&Te.length===3&&(Ce=!0),Ce&&(u==null?void 0:u.type)==="object"){const Ie=Ca(u.canvas),ae=u.context,Y=b(p);if(Y){const le={mainCtx:ae,previewCtx:s.current.getContext("2d"),viewTransform:a,onDrawCommit:m,activeItemId:u.id,activeGuide:N,mirrorGuides:k,strokeModifier:je};let xe=Te;A==="curve"&&(xe=bg(Te)),A==="arc"&&(xe=Cg(Te,(at=It.current)==null?void 0:at.totalAngle)),Y.drawWithMirroring(ae,xe,le),m(u.id,Ie)}W(null)}}return}if(p==="pan"||Ne.button===1&&Ne.pointerType==="mouse"){ft({type:"pan",startX:Ne.clientX,startY:Ne.clientY,startPan:a.pan}),Ne.currentTarget.style.cursor="grabbing";return}if(y&&u&&u.type==="object"&&A==="freehand"){p==="eraser"&&z(u.id);const Te=b(p);if(!Te)return;if(Te.updateSmoothing(Se),rt.current=Te,ft({type:"draw"}),Ze.current={axis:"x",startPoint:Ge},oe&&N==="perspective"&&U.current){const{vpGreen:ae,vpRed:Y,vpBlue:le}=U.current,xe=[ae,Y,le].filter(Boolean);let we=null,ke=1/0;xe.forEach(Re=>{if(Re){const Le=(Ge.x-Re.x)**2+(Ge.y-Re.y)**2;Le<ke&&(ke=Le,we=Re)}}),Ht.current={startPoint:Ge,targetVP:we}}const Ce=u.context,Ie=(Ct=s.current)==null?void 0:Ct.getContext("2d");if(Ce&&Ie){const ae={mainCtx:Ce,previewCtx:Ie,viewTransform:a,onDrawCommit:m,activeItemId:u.id,activeGuide:N,mirrorGuides:k,strokeModifier:je};Te.onPointerDown(gt,ae)}}},[p,a,u,y,x,ye,me,K,N,M,k,R,S,B,G,V,E,U,X,oe,Yt,A,O,W,m,mt,he,Rt,Ee,b,Se,je,Ve]),Wt=T.useCallback(Ne=>{var Ct,Te,Ce,Ie;if(!t.current)return;const _e=Ne.nativeEvent,Ge=_e.getCoalescedEvents?_e.getCoalescedEvents():[_e];for(const ae of Ge)$e.current.has(ae.pointerId)&&$e.current.set(ae.pointerId,{x:ae.clientX,y:ae.clientY});const it=Date.now();if(it-mn.current>16&&(Ve(new Map($e.current)),mn.current=it),$e.current.size>=2){const ae=Array.from($e.current.values());if(ae.length<2)return;const[Y,le]=ae,xe={x:(Y.x+le.x)/2,y:(Y.y+le.y)/2},we=le.x-Y.x,ke=le.y-Y.y,Re=Math.hypot(we,ke);We.current||(We.current={distance:Re,midpoint:xe,zoom:a.zoom,pan:a.pan});const Le=We.current,Je=Le.distance>0?Re/Le.distance:1;let nt=Le.zoom*Je;const St=Ae?Ae():.1;nt<St&&(nt=St),nt>Ke&&(nt=Ke);const ot=Le.zoom>0?nt/Le.zoom:1,Ft=xe.x-(Le.midpoint.x-Le.pan.x)*ot,$t=xe.y-(Le.midpoint.y-Le.pan.y)*ot;r(_t=>({..._t,zoom:nt,pan:{x:Ft,y:$t}})),Ue.current=!0;return}const ct=_e.getCoalescedEvents?_e.getCoalescedEvents():[_e],gt=ct[ct.length-1],Oe=tt.current;if(Oe.type==="draw"&&rt.current){const ae=u==null?void 0:u.context,Y=(Ct=s.current)==null?void 0:Ct.getContext("2d");if(ae&&Y&&u){const le={mainCtx:ae,previewCtx:Y,viewTransform:a,onDrawCommit:m,activeItemId:u.id,activeGuide:N,mirrorGuides:k,strokeModifier:je};for(const xe of ct){const we=un(xe,a);let ke=we,Re=!1;if(_&&Ze.current){const{startPoint:St}=Ze.current,ot=Math.abs(we.x-St.x),Ft=Math.abs(we.y-St.y);(ot>5||Ft>5)&&(ot>Ft?Ze.current.axis="x":Ze.current.axis="y"),Ze.current.axis==="x"?ke={...we,y:St.y}:ke={...we,x:St.x},Re=!0}else if(N==="ruler"&&M.length>0){const St=M[0],ot=St.start,Ft=St.end,$t=we,_t={x:Ft.x-ot.x,y:Ft.y-ot.y},gn={x:$t.x-ot.x,y:$t.y-ot.y},Sn=_t.x*_t.x+_t.y*_t.y;if(Sn>0){const nn=(gn.x*_t.x+gn.y*_t.y)/Sn;ke={x:ot.x+_t.x*nn,y:ot.y+_t.y*nn}}Re=!0}else oe&&N==="perspective"&&((Te=Ht.current)!=null&&Te.targetVP)&&(ke=oE(we,Ht.current.startPoint,Ht.current.targetVP),Re=!0);Re||(ke=Yt(we));const Je=A==="freehand"&&xe.pointerType==="pen"?xe.pressure:1,nt={...ke,pressure:Je};rt.current.onPointerMove(nt,le)}}return}const Ye=un(gt,a);let at=Ye;if(D){D.type==="ruler"?G(ae=>ae.map(Y=>{if(Y.id===D.id){const le={...Y};if(D.part==="start")le.start=Ye;else if(D.part==="end")le.end=Ye;else if(D.part==="line"){const xe=Y.end.x-Y.start.x,we=Y.end.y-Y.start.y;le.start.x=Ye.x+D.offset.x,le.start.y=Ye.y+D.offset.y,le.end.x=le.start.x+xe,le.end.y=le.start.y+we}return le}return Y})):D.type==="mirror"?V(ae=>ae.map(Y=>{if(Y.id===D.id){const le={...Y};if(D.part==="start")le.start=Ye;else if(D.part==="end")le.end=Ye;else if(D.part==="line"){const xe=Y.end.x-Y.start.x,we=Y.end.y-Y.start.y;le.start.x=Ye.x+D.offset.x,le.start.y=Ye.y+D.offset.y,le.end.x=le.start.x+xe,le.end.y=le.start.y+we}return le}return Y})):(D.type==="perspective"||D.type==="perspective-point"||D.type==="perspective-extra")&&B(ae=>{if(!ae)return null;const Y=JSON.parse(JSON.stringify(ae));if(D.type==="perspective-point")Y.guidePoint=Ye;else if(D.type==="perspective-extra"){const le=Y.extraGuideLines[D.color].find(xe=>xe.id===D.id);le&&(le.handle=Ye)}else if(D.type==="perspective"){const le=Y.lines[D.color].find(xe=>xe.id===D.lineId);le&&(le[D.part]=Ye)}return Y});return}if(at=Yt(Ye),O){const ae=(Ce=s.current)==null?void 0:Ce.getContext("2d");if(!ae)return;const Y=gt.pointerType==="pen"?gt.pressure:1,le={...at,pressure:Y};zo(ae),ae.save(),ae.setTransform(a.zoom,0,0,a.zoom,a.pan.x,a.pan.y);const xe=b(p);if(xe&&u){const we={mainCtx:u.context,previewCtx:ae,viewTransform:a,onDrawCommit:m,activeItemId:u.id,activeGuide:N,mirrorGuides:k,strokeModifier:je};let ke;if(O.mode==="line"?ke=[O.points[0],le]:ke=[...O.points,le],O.mode==="curve"&&ke.length>=2)ke.length===3&&(ke=bg(ke));else if(O.mode==="arc"&&ke.length>=2){const[Re,Le]=ke,Je=Math.hypot(Le.x-Re.x,Le.y-Re.y);if(ae.strokeStyle="rgba(0,0,0,0.4)",ae.lineWidth=1/a.zoom,ae.setLineDash([4/a.zoom,2/a.zoom]),ae.beginPath(),ae.arc(Re.x,Re.y,Je,0,2*Math.PI),ae.stroke(),ae.setLineDash([]),ke.length===3){const nt=ke[2],St=Math.atan2(nt.y-Re.y,nt.x-Re.x);if(!It.current)It.current={lastAngle:St,totalAngle:0};else{let ot=St-It.current.lastAngle;ot>Math.PI&&(ot-=2*Math.PI),ot<-Math.PI&&(ot+=2*Math.PI),It.current.totalAngle+=ot,It.current.lastAngle=St}ke=Cg(ke,It.current.totalAngle)}else ke=[Le,at]}xe.drawWithMirroring(ae,ke,we)}ae.restore();return}if(Oe.type==="pan"&&r(ae=>({...ae,pan:{x:ae.pan.x+gt.movementX,y:ae.pan.y+gt.movementY}})),Oe.type==="selection"){let ae;if(Oe.tool==="lasso"){ae=[...Oe.points];for(const le of ct){const xe=gs(le,a,t.current);ae.push(Yt(xe))}}else ae=[...Oe.points,at];ft({...Oe,points:ae});const Y=(Ie=s.current)==null?void 0:Ie.getContext("2d");if(!Y)return;if(zo(Y),Y.save(),Y.setTransform(a.zoom,0,0,a.zoom,a.pan.x,a.pan.y),Y.lineWidth=1/a.zoom,Y.strokeStyle="black",Y.setLineDash([4/a.zoom,4/a.zoom]),Y.beginPath(),Oe.tool==="marquee-rect"){const{startPoint:le}=Oe;Y.rect(le.x,le.y,at.x-le.x,at.y-le.y)}else{Y.moveTo(ae[0].x,ae[0].y);for(let le=1;le<ae.length;le++)Y.lineTo(ae[le].x,ae[le].y)}Y.stroke(),Y.restore();return}if(Oe.type,Oe.type==="transform"&&X){const ae=Ye;if(Oe.startState.type==="affine"){const{startState:Y,startPoint:le,handle:xe}=Oe,we=Oe.center;let ke=ae.x-le.x,Re=ae.y-le.y;if(xe==="rotate"&&we){const Le=Math.atan2(le.y-we.y,le.x-we.x),Je=Math.atan2(ae.y-we.y,ae.x-we.x);let nt=Y.rotation+(Je-Le);if(ue){const St=ve*Math.PI/180;nt=Math.round(nt/St)*St}L({...Y,rotation:nt})}else if(xe==="move")L({...Y,x:Y.x+ke,y:Y.y+Re});else{const{rotation:Le}=Y,Je=Math.cos(-Le),nt=Math.sin(-Le),St=ke*Je-Re*nt,ot=ke*nt+Re*Je;let Ft=Y.width,$t=Y.height;if(xe.includes("r")&&(Ft+=St),xe.includes("l")&&(Ft-=St),xe.includes("b")&&($t+=ot),xe.includes("t")&&($t-=ot),H&&(Ft!==Y.width||$t!==Y.height)){const kt=Y.width/Y.height;Math.abs(Ft-Y.width)>Math.abs($t-Y.height)?$t=Ft/kt:Ft=$t*kt}let _t=Y.x,gn=Y.y;const Sn=Ft-Y.width,nn=$t-Y.height,Jn=Math.cos(Le),En=Math.sin(Le);let zt=0,Xn=0;xe.includes("l")&&(zt+=Sn),xe.includes("t")&&(Xn+=nn);const qo=(zt*Jn-Xn*En)/2,Un=(zt*En+Xn*Jn)/2;_t-=qo,gn-=Un,L({...Y,x:_t,y:gn,width:Ft,height:$t})}}else if(Oe.startState.type==="free"){const{handle:Y,startState:le,startPoint:xe}=Oe;if(le.type!=="free")return;const we=ae.x-xe.x,ke=ae.y-xe.y;if(Y==="move")L({...le,corners:{tl:{x:le.corners.tl.x+we,y:le.corners.tl.y+ke},tr:{x:le.corners.tr.x+we,y:le.corners.tr.y+ke},bl:{x:le.corners.bl.x+we,y:le.corners.bl.y+ke},br:{x:le.corners.br.x+we,y:le.corners.br.y+ke}}});else if(Y in le.corners){const Re={...le.corners};Re[Y]=ae,L({...le,corners:Re})}}}},[a,r,u,p,O,W,D,E,G,V,B,I,L,Yt,Ae,Ke,H,ue,ve,y,N,M,_,oe,U,m,k,je,b,Ve]),Qt=T.useCallback(Ne=>{var it,ct,gt;const _e=$e.current.size;if($e.current.delete(Ne.pointerId),Ve(new Map($e.current)),$e.current.size===0&&(Ue.current=!1),_e>1){$e.current.size<2&&(bt.current=null,We.current=null,ft({type:"none"}));return}if(Ue.current)return;if(Ut.current&&(clearTimeout(Ut.current),Ut.current=null),(it=rt.current)!=null&&it.isDrawing){const Oe=u==null?void 0:u.context,Ye=(ct=s.current)==null?void 0:ct.getContext("2d");if(Oe&&Ye&&u){const at={mainCtx:Oe,previewCtx:Ye,viewTransform:a,onDrawCommit:m,activeItemId:u.id,activeGuide:N,mirrorGuides:k,strokeModifier:je};rt.current.onPointerUp(at)}rt.current=null}if(p==="eraser"&&z(null),tt.current.type==="draw"&&O&&O.mode==="line"&&O.points.length>0&&(u==null?void 0:u.type)==="object"){const Oe=Ca(u.canvas),Ye=u.context,at=b(p),Ct=Yt(gs(Ne.nativeEvent,a,t.current)),Te=Ne.pointerType==="pen"?Ne.pressure:1,Ce={...Ct,pressure:Te},Ie=[O.points[0],Ce];if(at&&Ie.length>1){const ae={mainCtx:Ye,previewCtx:s.current.getContext("2d"),viewTransform:a,onDrawCommit:m,activeItemId:u.id,activeGuide:N,mirrorGuides:k,strokeModifier:je};at.drawWithMirroring(Ye,Ie,ae),m(u.id,Oe)}W(null)}if(tt.current.type==="selection"&&u){const{tool:Oe,points:Ye,startPoint:at}=tt.current;if(Ye.length>1){let Ct,Te;if(Oe==="marquee-rect"){const Ce=Ye[Ye.length-1],Ie=Math.min(at.x,Ce.x),ae=Math.min(at.y,Ce.y),Y=Math.abs(at.x-Ce.x),le=Math.abs(at.y-Ce.y);Ct=new Path2D,Ct.rect(Ie,ae,Y,le),Te={x:Ie,y:ae,width:Y,height:le}}else{Ct=new Path2D,Ct.moveTo(Ye[0].x,Ye[0].y);for(let le=1;le<Ye.length;le++)Ct.lineTo(Ye[le].x,Ye[le].y);Ct.closePath();let Ce=1/0,Ie=1/0,ae=-1/0,Y=-1/0;Ye.forEach(le=>{Ce=Math.min(Ce,le.x),Ie=Math.min(Ie,le.y),ae=Math.max(ae,le.x),Y=Math.max(Y,le.y)}),Te={x:Ce,y:Ie,width:ae-Ce,height:Y-Ie}}me({path:Ct,boundingBox:Te,sourceItemId:u.id})}}if(tt.current.type==="text-place"){const Oe=Yt(gs(Ne.nativeEvent,a,t.current));he({position:Oe,value:"",activeItemId:(u==null?void 0:u.id)||""})}(p==="pan"||Ne.button===1&&Ne.pointerType==="mouse")&&(Ne.currentTarget.style.cursor="grab");const Ge=(gt=s.current)==null?void 0:gt.getContext("2d");Ge&&!O&&zo(Ge),ft({type:"none"}),E(null)},[a,t,u,m,v,p,E,y,O,W,Yt,me,he,Ee,je,k,N,z,b,Ve]),At=T.useCallback(Ne=>{Qt(Ne)},[Qt]),Ot=T.useCallback(Ne=>{if(!t.current)return;const _e=Ne.deltaY>0?1/1.1:1.1,Ge=t.current.getBoundingClientRect(),it=Ne.clientX-Ge.left,ct=Ne.clientY-Ge.top;r(gt=>{const Oe=Ae(),Ye=Math.max(Oe,Math.min(gt.zoom*_e,Ke)),at=(it-gt.pan.x)/gt.zoom,Ct=(ct-gt.pan.y)/gt.zoom,Te=it-at*Ye,Ce=ct-Ct*Ye;return{zoom:Ye,pan:{x:Te,y:Ce}}})},[r,Ae,Ke]),Et=T.useCallback(Ne=>{if(p==="select"){const _e=gs(Ne.nativeEvent,a,t.current);let Ge=!1;[...o].reverse().forEach(it=>{if(Ge||it.type!=="object"||!it.isVisible||!it.canvas)return;const ct=it.context;ct&&ct.getImageData(Math.floor(_e.x),Math.floor(_e.y),1,1).data[3]>0&&(v(it.id),Ge=!0)}),Ge||v(null)}},[y,A,O,W,m,u,v,o,p,a,b,N,k,je]);return{dragActionRef:tt,onPointerDown:hn,onPointerMove:Wt,onPointerUp:Qt,onPointerCancel:At,onWheel:Ot,onDoubleClick:Et}}const SE=({selection:o,viewTransform:t,onCut:s,onCopy:a,onDelete:r,onDeselect:u})=>{if(!o)return null;const{x:p,y,width:x}=o.boundingBox,m=y-10,b=(p+x/2)*t.zoom+t.pan.x,N={position:"absolute",top:`${m*t.zoom+t.pan.y}px`,left:`${b}px`,transform:"translate(-50%, -100%)",zIndex:20};return c.jsxs("div",{style:N,className:"bg-[--bg-primary]/80 backdrop-blur-sm rounded-lg p-1 flex items-center gap-1 shadow-lg",onPointerDown:_=>_.stopPropagation(),children:[c.jsx("button",{onClick:a,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Copiar",children:c.jsx(cy,{className:"w-5 h-5"})}),c.jsx("button",{onClick:s,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Cortar",children:c.jsx(BS,{className:"w-5 h-5"})}),c.jsx("button",{onClick:r,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Eliminar",children:c.jsx(Ll,{className:"w-5 h-5"})}),c.jsx("div",{className:"h-6 w-px bg-[--bg-hover] mx-1"}),c.jsx("button",{onClick:u,className:"p-2 rounded-md bg-[--bg-tertiary] text-red-500 hover:bg-red-500 hover:text-white",title:"Deseleccionar",children:c.jsx(bo,{className:"w-5 h-5"})})]})},EE=o=>{const{items:t,activeItemId:s,tool:a,viewTransform:r,setViewTransform:u,onDrawCommit:p,onSelectItem:y,onUpdateItem:x,activeGuide:m,isOrthogonalVisible:v,rulerGuides:b,setRulerGuides:S,mirrorGuides:N,setMirrorGuides:_,perspectiveGuide:M,setPerspectiveGuide:G,orthogonalGuide:k,gridGuide:V,areGuidesLocked:R,isCropping:B,cropRect:U,setCropRect:$,isTransforming:D,transformState:E,setTransformState:K,transformSourceBbox:I,isAspectRatioLocked:X,isAngleSnapEnabled:L,angleSnapValue:H,isPerspectiveStrokeLockEnabled:ue,setIsPerspectiveStrokeLockEnabled:ve,isSnapToGridEnabled:j,strokeMode:z,strokeState:oe,setStrokeState:ge,selection:Z,setSelection:A,onCutSelection:O,onCopySelection:W,onDeleteSelection:ye,onDeselect:be,getMinZoom:me,MAX_ZOOM:Me,onAddItem:De,textSettings:Ae,textEditState:Ke,setTextEditState:mt,onCommitText:Rt,strokeSmoothing:he,strokeModifier:Ee}=o,Se=T.useRef(null),je=T.useRef(null),Ve=T.useRef(null),Fe=T.useRef(null),tt=T.useRef(null),rt=T.useRef(null),Ht=T.useRef(null),Ze=T.useRef(null),[It,$e]=T.useReducer(Y=>Y+1,0),[bt,Ue]=T.useState(null),We=T.useRef(!1),[Ut,mn]=T.useState(null),[un,ft]=T.useState(null),[Yt,hn]=T.useState(null),[Wt,Qt]=T.useState(new Map),At=t.find(Y=>Y.id===s),Ot=["brush","eraser","simple-marker","natural-marker","airbrush","fx-brush","debug-brush","advanced-marker","watercolor"].includes(a),Et=["marquee-rect","lasso","magic-wand"].includes(a),{getBrushForTool:Ne}=vE({brushSettings:o.brushSettings,eraserSettings:o.eraserSettings,simpleMarkerSettings:o.simpleMarkerSettings,naturalMarkerSettings:o.naturalMarkerSettings,airbrushSettings:o.airbrushSettings,fxBrushSettings:o.fxBrushSettings,advancedMarkerSettings:o.advancedMarkerSettings,watercolorSettings:o.watercolorSettings}),{redrawMainCanvas:_e,redrawGuides:Ge,redrawUI:it,perspectiveVPs:ct}=bE({mainCanvasRef:je,guideCanvasRef:Ht,uiCanvasRef:tt,items:t,viewTransform:r,isTransforming:D,activeItemId:s,activeGuide:m,isOrthogonalVisible:v,rulerGuides:b,mirrorGuides:N,perspectiveGuide:M,orthogonalGuide:k,gridGuide:V,isCropping:B,cropRect:U,transformState:E,transformSourceBbox:I,livePreviewLayerId:Yt}),{dragActionRef:gt,...Oe}=CE({items:t,uiCanvasRef:tt,previewCanvasRef:Ve,viewTransform:r,setViewTransform:u,activeItem:At,tool:a,isDrawingTool:Ot,isSelectionTool:Et,onDrawCommit:p,onSelectItem:y,onUpdateItem:x,getBrushForTool:Ne,areGuidesLocked:R,activeGuide:m,isOrthogonalVisible:v,rulerGuides:b,setRulerGuides:S,mirrorGuides:N,setMirrorGuides:_,perspectiveGuide:M,setPerspectiveGuide:G,perspectiveVPs:ct,orthogonalGuide:k,guideDragState:Ut,setGuideDragState:mn,cropRect:U,setCropRect:$,transformState:E,setTransformState:K,isAspectRatioLocked:X,isAngleSnapEnabled:L,angleSnapValue:H,livePreviewLayerId:Yt,setLivePreviewLayerId:hn,isPerspectiveStrokeLockEnabled:ue,isSnapToGridEnabled:j,gridGuide:V,strokeMode:z,strokeState:oe,setStrokeState:ge,magicWandSettings:o.magicWandSettings,selection:Z,setSelection:A,forceRender:$e,getMinZoom:me,MAX_ZOOM:Me,onAddItem:De,textEditState:Ke,setTextEditState:mt,onCommitText:Rt,strokeSmoothing:he,strokeModifier:Ee,setDebugPointers:Qt}),Ye={onPointerDown:Y=>{We.current=!0,Oe.onPointerDown(Y)},onPointerUp:Y=>{We.current=!1,Oe.onPointerUp(Y)},onPointerCancel:Y=>{We.current=!1,Oe.onPointerCancel(Y)},onPointerMove:Oe.onPointerMove,onDoubleClick:Oe.onDoubleClick,onWheel:Oe.onWheel};T.useEffect(()=>{if(D&&(At==null?void 0:At.type)==="object"&&(At!=null&&At.canvas)&&I){const Y=document.createElement("canvas");Y.width=I.width,Y.height=I.height;const le=Y.getContext("2d");le&&(le.drawImage(At.canvas,I.x,I.y,I.width,I.height,0,0,I.width,I.height),ft(Y.toDataURL()))}else ft(null)},[D,At,I]),T.useEffect(()=>{const Y=we=>{if(!tt.current)return;const ke={x:we.clientX-tt.current.getBoundingClientRect().left,y:we.clientY-tt.current.getBoundingClientRect().top};Ue(ke)},le=()=>{Ue(null),We.current=!1},xe=Se.current;return xe==null||xe.addEventListener("pointermove",Y),xe==null||xe.addEventListener("pointerleave",le),()=>{xe==null||xe.removeEventListener("pointermove",Y),xe==null||xe.removeEventListener("pointerleave",le)}},[]),T.useEffect(()=>{var le;const Y=(le=Fe.current)==null?void 0:le.getContext("2d");if(Y&&(Y.clearRect(0,0,Y.canvas.width,Y.canvas.height),Wt.size<=1&&Ot&&bt&&(!We.current||a==="eraser"))){let xe=0;switch(a){case"brush":xe=o.brushSettings.size;break;case"eraser":xe=o.eraserSettings.size;break;case"simple-marker":xe=o.simpleMarkerSettings.size;break;case"natural-marker":xe=o.naturalMarkerSettings.size;break;case"airbrush":xe=o.airbrushSettings.size;break;case"fx-brush":xe=o.fxBrushSettings.size;break;case"debug-brush":xe=2;break;case"advanced-marker":xe=o.advancedMarkerSettings.size;break;case"watercolor":xe=o.watercolorSettings.size;break}if(xe>0){const we=xe*r.zoom,ke=Le=>{Y.lineWidth=1,Y.strokeStyle="rgba(0, 0, 0, 0.7)",Y.setLineDash([]),Y.beginPath(),Le==="circle"?Y.arc(bt.x,bt.y,we/2,0,2*Math.PI):Y.rect(bt.x-we/2,bt.y-we/2,we,we),Y.stroke(),Y.strokeStyle="rgba(255, 255, 255, 0.7)",Y.setLineDash([2,2]),Y.beginPath(),Le==="circle"?Y.arc(bt.x,bt.y,we/2,0,2*Math.PI):Y.rect(bt.x-we/2,bt.y-we/2,we,we),Y.stroke(),Y.setLineDash([])},Re=a==="eraser"&&o.eraserSettings.tipShape==="square"||a==="simple-marker"&&o.simpleMarkerSettings.tipShape!=="line"?"square":"circle";ke(Re)}}},[Ot,a,bt,r.zoom,o.brushSettings,o.eraserSettings,o.simpleMarkerSettings,o.naturalMarkerSettings,o.airbrushSettings,o.fxBrushSettings,o.advancedMarkerSettings,o.watercolorSettings,We.current,Wt]),T.useEffect(()=>{var ke;const Y=(ke=rt.current)==null?void 0:ke.getContext("2d");if(!Z||!Y||Z.sourceItemId!==s){Y&&zo(Y);return}let le,xe=0;const we=()=>{xe=(xe+.5)%8,zo(Y),Y.save(),Y.setTransform(r.zoom,0,0,r.zoom,r.pan.x,r.pan.y),Y.lineWidth=1/r.zoom,Y.strokeStyle="white",Y.setLineDash([4/r.zoom,4/r.zoom]),Y.lineDashOffset=-xe,Y.stroke(Z.path),Y.strokeStyle="black",Y.lineDashOffset=4-xe,Y.stroke(Z.path),Y.restore(),le=requestAnimationFrame(we)};return we(),()=>{cancelAnimationFrame(le),Y&&zo(Y)}},[Z,r,s]),T.useLayoutEffect(()=>{_e(),Ge(),it()},[_e,Ge,it,D,E,At,I,r,It,Yt]),T.useEffect(()=>{const Y=Se.current,le=[je.current,Ve.current,Fe.current,tt.current,Ht.current,rt.current];if(!Y||le.some(we=>!we))return;const xe=new ResizeObserver(we=>{const ke=we[0],{width:Re,height:Le}=ke.contentRect;le.forEach(Je=>{Je&&(Je.width=Re,Je.height=Le)}),_e(),Ge(),it()});return xe.observe(Y),()=>xe.disconnect()},[_e,Ge,it]),T.useEffect(()=>{Ke&&Ze.current&&(Ze.current.focus(),Ze.current.value=Ke.value)},[Ke]),T.useEffect(()=>{Ze.current&&(Ze.current.style.height="auto",Ze.current.style.height=`${Ze.current.scrollHeight}px`)},[Ke==null?void 0:Ke.value]);let at={display:"none"};if(D&&E&&I&&un){if(E.type==="affine"){const{x:Y,y:le,width:xe,height:we,rotation:ke}=E,Re=xe/I.width,Le=we/I.height,Je=`
                matrix(${r.zoom}, 0, 0, ${r.zoom}, ${r.pan.x}, ${r.pan.y})
                translate(${Y+xe/2}px, ${le+we/2}px)
                rotate(${ke}rad)
                scale(${Re}, ${Le})
                translate(-${I.width/2}px, -${I.height/2}px)
             `;at={position:"absolute",top:0,left:0,width:`${I.width}px`,height:`${I.height}px`,willChange:"transform",imageRendering:"pixelated",transformOrigin:"top left",transform:Je}}else if(E.type==="free"){const{corners:Y}=E,{width:le,height:xe}=I,we=[{x:0,y:0},{x:le,y:0},{x:le,y:xe},{x:0,y:xe}],ke=[Y.tl,Y.tr,Y.br,Y.bl].map(Le=>({x:Le.x*r.zoom+r.pan.x,y:Le.y*r.zoom+r.pan.y})),Re=aE(we,ke);at={position:"absolute",top:0,left:0,width:`${le}px`,height:`${xe}px`,willChange:"transform",imageRendering:"pixelated",transformOrigin:"top left",transform:Re}}}const Ct=()=>a==="text"?"text":Ot?"none":Et?"crosshair":a==="pan"?We.current?"grabbing":"grab":"default",Te=()=>{Ke&&Rt(Ke)},Ce=Y=>{Ke&&mt({...Ke,value:Y.target.value})},Ie=Y=>{Y.key==="Escape"?mt(null):Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),Te())};let ae={display:"none"};if(Ke){const{position:Y}=Ke,le=Y.x*r.zoom+r.pan.x,xe=Y.y*r.zoom+r.pan.y;ae={position:"absolute",left:`${le}px`,top:`${xe}px`,transform:Ae.textAlign==="center"?"translateX(-50%)":Ae.textAlign==="right"?"translateX(-100%)":"none",display:"block",background:"rgba(255, 255, 255, 0.1)",border:"1px dashed rgba(255, 255, 255, 0.8)",borderRadius:"2px",padding:"0",margin:"0",resize:"none",overflow:"hidden",outline:"none",whiteSpace:"pre-wrap",fontFamily:Ae.fontFamily,fontSize:`${Ae.fontSize*r.zoom}px`,lineHeight:1.2,color:Ae.color,textAlign:Ae.textAlign,fontWeight:Ae.fontWeight,minWidth:`${10*r.zoom}px`,minHeight:`${Ae.fontSize*1.2*r.zoom}px`,height:"auto"}}return c.jsxs("div",{ref:Se,className:"w-full h-full overflow-hidden relative bg-[--bg-tertiary]",style:{cursor:Ct(),touchAction:"none"},...Ye,onContextMenu:Y=>Y.preventDefault(),children:[c.jsx("canvas",{ref:je,className:"absolute inset-0"}),c.jsx("canvas",{ref:Ht,className:"absolute inset-0 pointer-events-none"}),c.jsx("canvas",{ref:Ve,className:"absolute inset-0 pointer-events-none"}),c.jsx("img",{src:un||"",alt:"Transform preview",className:"pointer-events-none",style:at}),c.jsx("canvas",{ref:tt,className:"absolute inset-0 pointer-events-none"}),c.jsx("canvas",{ref:rt,className:"absolute inset-0 pointer-events-none"}),c.jsx("canvas",{ref:Fe,className:"absolute inset-0 pointer-events-none"}),Ke&&c.jsx("textarea",{ref:Ze,style:ae,defaultValue:Ke.value,onChange:Ce,onBlur:Te,onKeyDown:Ie,onPointerDown:Y=>Y.stopPropagation()}),Z&&s===Z.sourceItemId&&c.jsx(SE,{selection:Z,viewTransform:r,onCut:O,onCopy:W,onDelete:ye,onDeselect:be})]})},TE=({item:o,onApply:t,onCancel:s})=>{const a=T.useRef(null),r=T.useRef(null),u=T.useRef(null),p=T.useRef(null),y=T.useRef(null),x=T.useRef(null),[m,v]=T.useState("picker"),[b,S]=T.useState({zoom:1,pan:{x:0,y:0}}),[N,_]=T.useState(30),[M,G]=T.useState({size:50}),[k,V]=T.useState(5),[R,B]=T.useState("mm"),[U,$]=T.useState("5"),[D,E]=T.useState(null),[K,I]=T.useState([]),[X,L]=T.useState(-1),H=T.useRef({isPanning:!1,isErasing:!1,lastPoint:null}),ue=T.useMemo(()=>K[X],[K,X]),ve=T.useMemo(()=>(ue==null?void 0:ue.colors)??[],[ue]),j=X>0,z=X<K.length-1,oe=T.useMemo(()=>({mm:1,cm:10,m:1e3}),[]),ge=T.useCallback(he=>{const Ee=K.slice(0,X+1);I([...Ee,he]),L(Ee.length)},[K,X]);T.useEffect(()=>{if(o){const he=o.scaleFactor||5,Ee=o.scaleUnit||"mm";V(he),B(Ee),$(String(Number((he*oe[Ee]).toFixed(2)))),_(o.tolerance!==void 0?o.tolerance:30);const Se=new Image;Se.crossOrigin="anonymous",Se.onload=()=>{E(Se)},Se.src=o.originalDataUrl}else E(null),I([]),L(-1),S({zoom:1,pan:{x:0,y:0}})},[o,oe]);const Z=T.useCallback(()=>{if(!x.current||!r.current)return;const he=x.current,Ee=r.current,Se=Ee.getContext("2d");if(!Se)return;Se.clearRect(0,0,Ee.width,Ee.height),Se.save(),Se.translate(b.pan.x,b.pan.y),Se.scale(b.zoom,b.zoom),he.width>0&&(Se.imageSmoothingEnabled=b.zoom<3,Se.drawImage(he,0,0)),Se.restore(),Se.save();const je=Ee.height-30,Ve=20,Fe=100,tt=1/(k*b.zoom),rt=Fe*tt,Ht=[.1,.5,1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4];let Ze=Ht[0];for(const un of Ht){if(un>rt)break;Ze=un}const It=Ze*k*b.zoom;let $e=`${Ze}mm`;Ze>=1e3?$e=`${Ze/1e3}m`:Ze>=10&&($e=`${Ze/10}cm`),Se.font="12px sans-serif";const Ue=Se.measureText($e).width,We=Math.max(It,Ue)+16,Ut=Ve-8,mn=je-18;Se.fillStyle="rgba(255, 255, 255, 0.7)",Se.fillRect(Ut,mn,We,24),Se.strokeStyle="rgba(0, 0, 0, 0.8)",Se.lineWidth=1.5,Se.beginPath(),Se.moveTo(Ve,je-5),Se.lineTo(Ve,je),Se.lineTo(Ve+It,je),Se.lineTo(Ve+It,je-5),Se.stroke(),Se.fillStyle="rgba(0, 0, 0, 0.8)",Se.textAlign="center",Se.fillText($e,Ve+It/2,je-8),Se.restore()},[b,k]),A=T.useCallback(()=>{const he=u.current,Ee=p.current,Se=y.current,je=x.current;if(!he||!Ee||!Se||!je)return;const Ve=je.getContext("2d");Ve&&(Ve.clearRect(0,0,je.width,je.height),Ve.drawImage(he,0,0),Ve.globalCompositeOperation="destination-in",Ve.drawImage(Ee,0,0),Ve.globalCompositeOperation="destination-out",Ve.drawImage(Se,0,0),Ve.globalCompositeOperation="source-over",Z())},[Z]);T.useEffect(()=>{var $e,bt,Ue;if(!ue||!D)return;const he=($e=u.current)==null?void 0:$e.getContext("2d",{willReadFrequently:!0}),Ee=(bt=p.current)==null?void 0:bt.getContext("2d"),Se=(Ue=y.current)==null?void 0:Ue.getContext("2d");if(!he||!Ee||!Se)return;const{width:je,height:Ve}=D,{colors:Fe,eraserMaskData:tt}=ue;tt?Se.putImageData(tt,0,0):Se.clearRect(0,0,je,Ve);const rt=he.getImageData(0,0,je,Ve).data,Ht=Ee.createImageData(je,Ve),Ze=Ht.data,It=(N/100*255)**2*3;for(let We=0;We<rt.length;We+=4){let Ut=!1;if(Fe.length>0){const mn=rt[We],un=rt[We+1],ft=rt[We+2];for(const Yt of Fe)if((mn-Yt.r)**2+(un-Yt.g)**2+(ft-Yt.b)**2<=It){Ut=!0;break}}Ze[We]=255,Ze[We+1]=255,Ze[We+2]=255,Ze[We+3]=Ut?0:255}Ee.putImageData(Ht,0,0),A()},[ue,N,D,A]),T.useEffect(()=>{var Ve;if(!D||!u.current||!y.current||!x.current)return;const{width:he,height:Ee}=D;[u.current,y.current,x.current,p.current].forEach(Fe=>{Fe&&(Fe.width=he,Fe.height=Ee)}),(Ve=u.current.getContext("2d"))==null||Ve.drawImage(D,0,0);const Se=y.current.getContext("2d");if(!Se)return;Se.clearRect(0,0,he,Ee);const je=Se.getImageData(0,0,he,Ee);I([{colors:(o==null?void 0:o.transparentColors)||[],eraserMaskData:je}]),L(0)},[D,o]),T.useEffect(()=>{if(D&&a.current&&X===0){const he=a.current.offsetWidth,Ee=a.current.offsetHeight,Se=.9,je=he/D.width,Ve=Ee/D.height,Fe=Math.min(je,Ve)*Se,tt=(he-D.width*Fe)/2,rt=(Ee-D.height*Fe)/2;S({zoom:Fe,pan:{x:tt,y:rt}})}},[D,X]),T.useEffect(()=>{const he=new ResizeObserver(()=>{if(a.current&&r.current){const{width:Ee,height:Se}=a.current.getBoundingClientRect();r.current.width=Ee,r.current.height=Se,Z()}});return a.current&&he.observe(a.current),()=>he.disconnect()},[Z]),T.useEffect(Z,[Z]);const O=he=>{if(he.button!==0&&he.button!==1||!ue)return;he.currentTarget.setPointerCapture(he.pointerId);const Ee=gs(he.nativeEvent,b,r.current);if(H.current.lastPoint=Ee,m==="pan"||he.button===1)H.current.isPanning=!0;else if(m==="picker"&&u.current){const Se=u.current.getContext("2d",{willReadFrequently:!0});if(Se&&Ee.x>=0&&Ee.x<u.current.width&&Ee.y>=0&&Ee.y<u.current.height){const je=Se.getImageData(Math.floor(Ee.x),Math.floor(Ee.y),1,1).data,Ve={r:je[0],g:je[1],b:je[2]};ve.some(Fe=>Fe.r===Ve.r&&Fe.g===Ve.g&&Fe.b===Ve.b)||ge({colors:[...ve,Ve],eraserMaskData:ue.eraserMaskData})}}else if(m==="eraser"&&y.current){H.current.isErasing=!0;const Se=y.current.getContext("2d");Se&&(Se.fillStyle="black",Se.beginPath(),Se.arc(Ee.x,Ee.y,M.size/2,0,Math.PI*2),Se.fill(),A())}},W=he=>{const Ee=gs(he.nativeEvent,b,r.current),{isPanning:Se,isErasing:je,lastPoint:Ve}=H.current;if(Se)S(Fe=>({...Fe,pan:{x:Fe.pan.x+he.movementX,y:Fe.pan.y+he.movementY}}));else if(je&&Ve&&y.current){const Fe=y.current.getContext("2d");Fe&&(Fe.fillStyle="black",Fe.strokeStyle="black",Fe.lineWidth=M.size,Fe.lineCap="round",Fe.lineJoin="round",Fe.beginPath(),Fe.moveTo(Ve.x,Ve.y),Fe.lineTo(Ee.x,Ee.y),Fe.stroke(),A())}H.current.lastPoint=Ee},ye=he=>{var Ee;if(he.currentTarget.releasePointerCapture(he.pointerId),H.current.isErasing){const Se=(Ee=y.current)==null?void 0:Ee.getContext("2d");if(Se&&ue){const je=Se.getImageData(0,0,Se.canvas.width,Se.canvas.height);ge({colors:ve,eraserMaskData:je})}}H.current={isPanning:!1,isErasing:!1,lastPoint:null}},be=()=>{x.current&&t(x.current.toDataURL(),ve,k,N,R)},me=()=>j&&L(he=>he-1),Me=()=>z&&L(he=>he+1),De=()=>K.length>0&&L(0),Ae=()=>{if(!D||!y.current)return;const he=y.current.getContext("2d");if(!he)return;const{width:Ee,height:Se}=D;he.clearRect(0,0,Ee,Se);const je=he.getImageData(0,0,Ee,Se);I([{colors:[],eraserMaskData:je}]),L(0)},Ke=he=>{const Ee=he.target.value,Se=k;B(Ee),$(String(Number((Se*oe[Ee]).toFixed(2))))},mt=he=>{const Ee=he.target.value;$(Ee);const Se=parseFloat(Ee);!isNaN(Se)&&Se>0&&V(Se/oe[R])};if(!o)return null;const Rt=he=>`p-2 rounded-md transition-colors ${m===he?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`;return c.jsx("div",{className:"fixed inset-0 bg-black/75 z-40 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-[--bg-secondary] rounded-lg shadow-xl w-full h-full max-w-6xl max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-2 border-b border-[--bg-tertiary]",children:[c.jsxs("h2",{className:"text-lg font-bold",children:["Editar Transparencia: ",o.name]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:be,className:"px-4 py-2 rounded-md bg-green-600 hover:bg-green-500 text-white font-semibold",children:"Aplicar"}),c.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-[--bg-tertiary]",children:c.jsx(bo,{className:"w-6 h-6"})})]})]}),c.jsxs("div",{className:"flex-grow flex min-h-0",children:[c.jsxs("div",{className:"w-64 flex-shrink-0 bg-[--bg-primary] p-4 flex flex-col gap-4 border-r border-[--bg-tertiary] overflow-y-auto",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Herramientas"}),c.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.jsx("button",{onClick:()=>v("picker"),className:Rt("picker"),title:"Cuentagotas",children:c.jsx(ly,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>v("eraser"),className:Rt("eraser"),title:"Borrador",children:c.jsx(Ea,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>v("pan"),className:Rt("pan"),title:"Mover",children:c.jsx(oy,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>S(he=>({...he,zoom:he.zoom*1.2})),className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Acercar",children:c.jsx(ty,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>S(he=>({...he,zoom:he.zoom/1.2})),className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Alejar",children:c.jsx(ny,{className:"w-5 h-5"})})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Historial"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:me,disabled:!j,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Deshacer",children:c.jsx(sy,{className:"w-5 h-5"})}),c.jsx("button",{onClick:Me,disabled:!z,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Rehacer",children:c.jsx(ay,{className:"w-5 h-5"})}),c.jsx("button",{onClick:De,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Restablecer Sesin",children:c.jsx($S,{className:"w-5 h-5"})}),c.jsx("button",{onClick:Ae,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Restaurar Original (sin transparencia)",children:c.jsx(IS,{className:"w-5 h-5"})})]})]}),m==="eraser"&&c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Ajustes del Borrador"}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"eraser-size",className:"text-xs text-[--text-secondary]",children:["Tamao: ",M.size]}),c.jsx("input",{type:"range",id:"eraser-size",min:"1",max:"200",step:"1",value:M.size,onChange:he=>G(Ee=>({...Ee,size:parseInt(he.target.value,10)})),className:"w-full"})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Seleccin de Color"}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"tolerance",className:"text-xs text-[--text-secondary]",children:["Tolerancia: ",N]}),c.jsx("input",{type:"range",id:"tolerance",min:"0",max:"100",step:"1",value:N,onChange:he=>_(parseInt(he.target.value,10)),className:"w-full"})]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"flex justify-between items-center mb-2",children:c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Colores Transparentes"})}),c.jsxs("div",{className:"max-h-60 overflow-y-auto space-y-1 pr-2",children:[ve.map((he,Ee)=>c.jsxs("div",{className:"flex items-center justify-between p-1 rounded bg-[--bg-tertiary]",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-6 h-6 rounded border border-white/20",style:{backgroundColor:yg(he.r,he.g,he.b)}}),c.jsx("span",{className:"text-xs font-mono",children:yg(he.r,he.g,he.b)})]}),c.jsx("button",{onClick:()=>{if(!ue)return;const Se=ve.filter((je,Ve)=>Ve!==Ee);ge({colors:Se,eraserMaskData:ue.eraserMaskData})},className:"p-1 rounded-full text-xs text-gray-400 hover:bg-red-500 hover:text-white",children:""})]},Ee)),ve.length===0&&c.jsx("p",{className:"text-xs text-center text-[--text-secondary] py-2",children:"Usa el cuentagotas para aadir colores."})]})]}),c.jsxs("div",{className:"mt-auto pt-4 border-t border-[--bg-tertiary]",children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Propiedades"}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary]",children:"Factor de Escala"}),c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsx("span",{className:"text-sm",children:"1"}),c.jsxs("select",{value:R,onChange:Ke,className:"bg-[--bg-tertiary] text-sm rounded-md p-1 border border-[--bg-hover]",children:[c.jsx("option",{value:"mm",children:"mm"}),c.jsx("option",{value:"cm",children:"cm"}),c.jsx("option",{value:"m",children:"m"})]}),c.jsx("span",{className:"text-sm",children:"="}),c.jsx("input",{type:"number",value:U,onChange:mt,className:"w-20 bg-[--bg-secondary] text-sm rounded-md p-1 border border-[--bg-tertiary]"}),c.jsx("span",{className:"text-sm",children:"px"})]})]})]})]}),c.jsxs("div",{ref:a,className:"flex-grow bg-gray-500",onPointerDown:O,onPointerMove:W,onPointerUp:ye,onPointerLeave:ye,style:{cursor:m==="pan"?H.current.isPanning?"grabbing":"grab":"crosshair",backgroundImage:"linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px"},children:[c.jsx("canvas",{ref:r,className:"w-full h-full"}),c.jsx("canvas",{ref:u,className:"hidden"}),c.jsx("canvas",{ref:p,className:"hidden"}),c.jsx("canvas",{ref:y,className:"hidden"}),c.jsx("canvas",{ref:x,className:"hidden"})]})]})]})})},wE=({user:o,items:t,onImportImage:s,onCreateFolder:a,onEditItem:r,onDeleteItem:u,onAddItemToScene:p,onMoveItems:y})=>{const[x,m]=T.useState(null),[v,b]=T.useState(!1),[S,N]=T.useState(""),_=T.useRef(null),[M,G]=T.useState(new Set),k=I=>{I.target.files&&I.target.files[0]&&(s(I.target.files[0],x),I.target.value="")},V=(I,X)=>{if(X.type==="folder"){I.preventDefault();return}I.stopPropagation(),I.dataTransfer.effectAllowed="copy",I.dataTransfer.setData("application/json",JSON.stringify({type:"library-item",id:X.id}))},R=()=>{S.trim()&&a(S.trim(),x),N(""),b(!1)},B=I=>{G(X=>{const L=new Set(X);return L.has(I)?L.delete(I):L.add(I),L})},U=I=>{m(I)},$=()=>{M.size!==0&&(y(Array.from(M),x),G(new Set))},D=T.useMemo(()=>{const I=[];let X=x;for(;X;){const L=t.find(H=>H.id===X);if(L)I.unshift(L),X=L.parentId;else break}return I},[x,t]),E=T.useMemo(()=>t.filter(X=>X.parentId===x).sort((X,L)=>X.type==="folder"&&L.type!=="folder"?-1:X.type!=="folder"&&L.type==="folder"?1:X.name.localeCompare(L.name)),[t,x]),K=I=>{I.type==="folder"?U(I.id):p(I.id)};return c.jsxs("div",{className:"p-4 flex flex-col h-full bg-[--bg-primary]",children:[c.jsxs("div",{className:"flex-shrink-0 mb-3",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary]",children:"Libreria"}),M.size>0&&c.jsxs("button",{onClick:$,className:"text-sm px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-500",children:["Mover ",M.size," aqu"]})]}),c.jsxs("div",{className:"flex items-center text-sm text-[--text-secondary] flex-wrap",children:[x!==null&&c.jsx("button",{onClick:()=>U(D.length>1?D[D.length-2].id:null),className:"p-1 rounded-md hover:bg-[--bg-tertiary] mr-1",title:"Subir un nivel",children:c.jsx(fy,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>U(null),className:"hover:text-[--text-primary]",children:"Raz"}),D.map(I=>c.jsxs(Mg.Fragment,{children:[c.jsx(uy,{className:"w-4 h-4 mx-1"}),c.jsx("button",{onClick:()=>U(I.id),className:"hover:text-[--text-primary]",children:I.name})]},I.id))]})]}),c.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:o?E.length===0&&!v?c.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center text-[--text-secondary] p-4",children:[c.jsx(eg,{className:"w-12 h-12 mb-4"}),c.jsx("p",{className:"text-sm font-bold",children:"La carpeta est vaca"}),c.jsx("p",{className:"text-xs",children:"Importe imgenes o cree una nueva carpeta."})]}):c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[v&&c.jsxs("div",{className:"aspect-square bg-[--bg-secondary] rounded-md flex flex-col items-center justify-center p-2",children:[c.jsx(zi,{className:"w-10 h-10 text-[--text-secondary] mb-1"}),c.jsx("input",{ref:_,type:"text",value:S,onChange:I=>N(I.target.value),onBlur:R,onKeyDown:I=>{I.key==="Enter"&&R(),I.key==="Escape"&&(b(!1),N(""))},placeholder:"Nombre...",className:"w-full text-center bg-[--bg-tertiary] text-[--text-primary] rounded text-xs p-1",autoFocus:!0})]}),E.map(I=>{const X=M.has(I.id);return c.jsxs("div",{draggable:I.type==="image",onDragStart:L=>V(L,I),onDoubleClick:()=>K(I),className:`group relative aspect-square bg-[--bg-secondary] rounded-md flex flex-col items-center justify-center p-1 hover:bg-[--bg-hover] ${I.type==="folder"?"cursor-pointer":"cursor-grab"} transition-all duration-150 border-2 ${X?"border-[--accent-primary]":"border-transparent"}`,title:I.name,children:[c.jsx("button",{onClick:L=>{L.stopPropagation(),B(I.id)},"aria-label":`Select ${I.name}`,className:"absolute top-1 left-1 w-5 h-5 bg-black/30 backdrop-blur-sm rounded-sm flex items-center justify-center border border-white/30 z-10 hover:bg-black/50",children:X&&c.jsx(ry,{className:"w-4 h-4 text-white"})}),I.type==="image"&&I.dataUrl?c.jsx("img",{src:I.dataUrl,alt:I.name,className:"max-w-full max-h-full object-contain pointer-events-none"}):I.type==="folder"?c.jsx(zi,{className:"w-10 h-10 text-red-400"}):c.jsx(eg,{className:"w-8 h-8 text-gray-500 pointer-events-none"}),c.jsx("span",{className:"text-xs text-[--text-secondary] mt-1 truncate w-full text-center pointer-events-none",children:I.name}),c.jsx("button",{onClick:L=>{L.stopPropagation(),u(I)},"aria-label":`Delete ${I.name}`,className:"absolute top-1 right-1 p-1 bg-[--bg-primary]/60 rounded-full text-[--text-primary] opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-500 z-10",children:c.jsx(Ll,{className:"w-4 h-4"})}),I.type==="image"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:L=>{L.stopPropagation(),p(I.id)},"aria-label":`Add ${I.name} to scene`,className:"absolute bottom-1 left-1 p-1 bg-[--bg-primary]/60 rounded-full text-[--text-primary] opacity-0 group-hover:opacity-100 transition-opacity hover:bg-green-500 z-10",children:c.jsx(Vi,{className:"w-4 h-4"})}),c.jsx("button",{onClick:L=>{L.stopPropagation(),r(I.id)},"aria-label":`Edit transparency for ${I.name}`,className:"absolute bottom-1 right-1 p-1 bg-[--bg-primary]/60 rounded-full text-[--text-primary] opacity-0 group-hover:opacity-100 transition-opacity hover:bg-[--accent-primary] z-10",children:c.jsx(Ta,{className:"w-4 h-4"})})]})]},I.id)})]}):c.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center text-[--text-secondary] p-4",children:[c.jsx(dy,{className:"w-12 h-12 mb-4"}),c.jsx("p",{className:"text-sm font-bold",children:"Se requiere iniciar sesin"}),c.jsx("p",{className:"text-xs",children:"Por favor, inicie sesin para acceder a su librera de activos en lnea."})]})}),c.jsxs("div",{className:"flex-shrink-0 mt-4 flex items-center gap-2",children:[c.jsxs("label",{htmlFor:"library-image-upload",className:"flex-grow flex items-center justify-center p-2 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary] disabled:opacity-50 disabled:cursor-not-allowed",children:[c.jsx(Qi,{className:"w-5 h-5 mr-2"}),c.jsx("span",{className:"text-sm",children:"Importar"})]}),c.jsx("input",{id:"library-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:k,disabled:!o}),c.jsxs("button",{onClick:()=>b(!0),disabled:!o||v,className:"flex-shrink-0 flex items-center justify-center p-2 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] cursor-pointer text-[--text-secondary] disabled:opacity-50 disabled:cursor-not-allowed",title:"Crear nueva carpeta",children:[c.jsx(zi,{className:"w-5 h-5 mr-2"}),c.jsx("span",{className:"text-sm",children:"Nueva Carpeta"})]})]})]})},NE=({tool:o,setTool:t,onSetActiveGuide:s,onSetGridType:a,isSnapToGridEnabled:r,onToggleSnapToGrid:u,isOrthogonalVisible:p,onZoomExtents:y,onZoomIn:x,onZoomOut:m,onUndo:v,onRedo:b,onClearAll:S,canUndo:N,canRedo:_,isCropping:M,onApplyCrop:G,onCancelCrop:k,isTransforming:V,transformState:R,onApplyTransform:B,onCancelTransform:U,isAspectRatioLocked:$,onSetAspectRatioLocked:D,isAngleSnapEnabled:E,onToggleAngleSnap:K,angleSnapValue:I,onSetAngleSnapValue:X,activeGuide:L,orthogonalGuide:H,onSetOrthogonalAngle:ue,gridGuide:ve,onSetGridSpacing:j,onSetGridMajorLineFrequency:z,onSetGridIsoAngle:oe,onSetGridMajorLineColor:ge,onSetGridMinorLineColor:Z,areGuidesLocked:A,onSetAreGuidesLocked:O,isPerspectiveStrokeLockEnabled:W,onSetIsPerspectiveStrokeLockEnabled:ye,scaleFactor:be,scaleUnit:me,onPaste:Me,hasClipboardContent:De,strokeSmoothing:Ae,setStrokeSmoothing:Ke})=>{const[mt,Rt]=T.useState(""),[he,Ee]=T.useState("50"),[Se,je]=T.useState("5"),[Ve,Fe]=T.useState(!1),tt=T.useRef(null),rt=T.useRef(null),Ht=[{name:"Gris",value:"rgba(128, 128, 128, 0.6)"},{name:"Rojo",value:"rgba(239, 68, 68, 0.6)"},{name:"Verde",value:"rgba(34, 197, 94, 0.6)"},{name:"Azul",value:"rgba(59, 130, 246, 0.6)"},{name:"Negro",value:"rgba(0, 0, 0, 0.6)"}],Ze=[{name:"Gris",value:"rgba(128, 128, 128, 0.3)"},{name:"Rojo",value:"rgba(239, 68, 68, 0.3)"},{name:"Verde",value:"rgba(34, 197, 94, 0.3)"},{name:"Azul",value:"rgba(59, 130, 246, 0.3)"},{name:"Negro",value:"rgba(0, 0, 0, 0.3)"}];T.useEffect(()=>{ve&&(Ee(String(ve.spacing)),je(String(ve.majorLineFrequency)))},[ve]),T.useEffect(()=>{const Ue=We=>{tt.current&&!tt.current.contains(We.target)&&rt.current&&!rt.current.contains(We.target)&&Fe(!1)};return document.addEventListener("mousedown",Ue),()=>document.removeEventListener("mousedown",Ue)},[]);const It=T.useMemo(()=>{if(!ve||!be)return`${he}px`;const Ue=parseInt(he)/be;let We;switch(me){case"cm":We=(Ue/10).toFixed(1);break;case"m":We=(Ue/1e3).toFixed(2);break;case"mm":default:We=Ue.toFixed(1);break}return`${he}px (${We}${me})`},[he,ve,be,me]),$e=T.useMemo(()=>L!=="none"||p||ve&&ve.type!=="none",[L,p,ve]),bt=Ue=>`p-2 rounded-md transition-colors ${o===Ue?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`;return c.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-[--bg-primary]/80 backdrop-blur-sm rounded-lg p-1 flex items-center gap-1 shadow-lg z-10",children:[(M||V)&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:M?k:U,className:"p-2 rounded-md bg-red-600 text-white hover:bg-red-500 transition-colors",title:"Cancelar",children:c.jsx(bo,{className:"w-5 h-5"})}),c.jsx("button",{onClick:M?G:B,className:"p-2 rounded-md bg-green-600 text-white hover:bg-green-500 transition-colors",title:"Aplicar",children:c.jsx(ry,{className:"w-5 h-5"})}),c.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"})]}),V&&(R==null?void 0:R.type)==="affine"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>D(Ue=>!Ue),className:`p-2 rounded-md transition-colors ${$?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:$?"Desbloquear relacin de aspecto":"Bloquear relacin de aspecto",children:$?c.jsx(og,{className:"w-5 h-5"}):c.jsx(lg,{className:"w-5 h-5"})}),c.jsx("button",{onClick:K,className:`p-2 rounded-md transition-colors ${E?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:"Activar anclaje de ngulo",children:c.jsx(vu,{className:"w-5 h-5"})}),E&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),[1,5,10,15].map(Ue=>c.jsxs("button",{onClick:()=>X(Ue),className:`px-2 py-1 rounded-md text-xs font-semibold transition-colors ${I===Ue?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:`Anclar a ${Ue}`,children:[Ue,""]},Ue))]})]}),!M&&!V&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>t("pan"),className:bt("pan"),title:"Mover (Arrastrar)",children:c.jsx(oy,{className:"w-5 h-5"})}),c.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),c.jsx("button",{onClick:m,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Alejar",children:c.jsx(ny,{className:"w-5 h-5"})}),c.jsx("button",{onClick:x,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Acercar",children:c.jsx(ty,{className:"w-5 h-5"})}),c.jsx("button",{onClick:y,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Ajustar a la vista",children:c.jsx(ly,{className:"w-5 h-5"})}),c.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),c.jsx("button",{onClick:v,disabled:!N,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Deshacer",children:c.jsx(sy,{className:"w-5 h-5"})}),c.jsx("button",{onClick:b,disabled:!_,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Rehacer",children:c.jsx(ay,{className:"w-5 h-5"})}),c.jsx("button",{onClick:Me,disabled:!De,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover] disabled:opacity-50 disabled:cursor-not-allowed",title:"Pegar",children:c.jsx(qS,{className:"w-5 h-5"})}),c.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),c.jsx("div",{className:"flex items-center gap-2 group",title:`Suavizado: ${Math.round(Ae*100)}%`,children:c.jsx("input",{type:"range",min:"0",max:"0.95",step:"0.05",value:Ae,onChange:Ue=>Ke(parseFloat(Ue.target.value)),className:"w-24"})}),c.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),$e&&c.jsx("button",{onClick:()=>O(Ue=>!Ue),className:`p-2 rounded-md transition-colors ${A?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:A?"Desbloquear Guas":"Bloquear Guas",children:A?c.jsx(og,{className:"w-5 h-5"}):c.jsx(lg,{className:"w-5 h-5"})}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{ref:rt,onClick:()=>Fe(Ue=>!Ue),className:`p-2 rounded-md transition-colors ${ve&&ve.type!=="none"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:"Ajustes de la Retcula",children:c.jsx(ng,{className:"w-5 h-5"})}),Ve&&ve&&c.jsxs("div",{ref:tt,className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-72 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg p-3 space-y-3 z-20",children:[c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsx("button",{onClick:()=>a("none"),className:`text-xs p-2 rounded ${ve.type==="none"?"bg-red-500 text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Apagado"}),c.jsxs("button",{onClick:()=>a("cartesian"),className:`flex items-center justify-center gap-1 text-xs p-2 rounded ${ve.type==="cartesian"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:[c.jsx(ng,{className:"w-4 h-4"})," Cartesiana"]}),c.jsxs("button",{onClick:()=>a("isometric"),className:`flex items-center justify-center gap-1 text-xs p-2 rounded ${ve.type==="isometric"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:[c.jsx(US,{className:"w-4 h-4"})," Isomtrica"]})]}),ve.type!=="none"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary]",children:"Color de Lnea Principal"}),c.jsx("div",{className:"flex items-center gap-2 mt-1",children:Ht.map(Ue=>c.jsx("button",{title:Ue.name,onClick:()=>ge(Ue.value),className:`w-6 h-6 rounded-full border-2 transition-all ${ve.majorLineColor===Ue.value?"border-[--accent-primary] ring-2 ring-offset-2 ring-offset-[--bg-primary] ring-[--accent-primary]":"border-transparent hover:border-gray-400"}`,style:{backgroundColor:Ue.value.replace(/, 0.6\)$/,", 1)")}},Ue.name))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-[--text-secondary]",children:"Color de Lnea Fina"}),c.jsx("div",{className:"flex items-center gap-2 mt-1",children:Ze.map(Ue=>c.jsx("button",{title:Ue.name,onClick:()=>Z(Ue.value),className:`w-6 h-6 rounded-full border-2 transition-all ${ve.minorLineColor===Ue.value?"border-[--accent-primary] ring-2 ring-offset-2 ring-offset-[--bg-primary] ring-[--accent-primary]":"border-transparent hover:border-gray-400"}`,style:{backgroundColor:Ue.value.replace(/, 0.3\)$/,", 1)")}},Ue.name))})]}),c.jsx("div",{className:"border-t border-[--bg-tertiary] my-2"}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"grid-spacing",className:"text-xs text-[--text-secondary]",children:["Espaciado: ",It]}),c.jsx("input",{type:"range",id:"grid-spacing",min:"10",max:"200",step:"5",value:he,onChange:Ue=>{Ee(Ue.target.value),j(parseInt(Ue.target.value))},className:"w-full"})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"major-line-freq",className:"text-xs text-[--text-secondary]",children:["Lnea principal cada: ",Se]}),c.jsx("input",{type:"range",id:"major-line-freq",min:"2",max:"10",step:"1",value:Se,onChange:Ue=>{je(Ue.target.value),z(parseInt(Ue.target.value))},className:"w-full"})]}),ve.type==="isometric"&&c.jsx("div",{children:c.jsx("label",{className:"text-xs text-[--text-secondary]",children:"ngulo: 60"})})]})]})]}),c.jsx("button",{onClick:u,disabled:!ve||ve.type==="none",className:`p-2 rounded-md transition-colors ${r?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"} disabled:opacity-50 disabled:cursor-not-allowed`,title:"Ajustar a la Retcula",children:c.jsx(vu,{className:"w-5 h-5"})}),L==="perspective"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-px h-6 bg-[--bg-hover] mx-1"}),c.jsx("button",{onClick:()=>ye(Ue=>!Ue),className:`p-2 rounded-md transition-colors ${W?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]"}`,title:W?"Desactivar bloqueo de trazo a perspectiva":"Activar bloqueo de trazo a perspectiva",children:c.jsx(vu,{className:"w-5 h-5"})})]}),c.jsx("button",{onClick:S,className:"p-2 rounded-md bg-[--bg-tertiary] text-[--text-primary] hover:bg-[--bg-hover]",title:"Limpiar Lienzo",children:c.jsx(Ll,{className:"w-5 h-5"})})]})]})},AE=({isOpen:o,onClose:t,drawableObjects:s,canvasSize:a})=>{const[r,u]=T.useState(!0),[p,y]=T.useState("mi-boceto.png"),[x,m]=T.useState(""),[v,b]=T.useState(!1),[S,N]=T.useState("full"),_=T.useRef(null),M=s.find(B=>B.isBackground),G=(M==null?void 0:M.isVisible)??!1,k=T.useCallback(B=>{let U=null;return B.forEach($=>{if(!$.canvas)return;const D=ir($.canvas);if(D)if(!U)U={...D};else{const E=Math.min(U.x,D.x),K=Math.min(U.y,D.y),I=Math.max(U.x+U.width,D.x+D.width),X=Math.max(U.y+U.height,D.y+D.height);U={x:E,y:K,width:I-E,height:X-K}}}),U},[]),V=T.useCallback(async(B,U)=>{var L;if(!_.current||a.width===0)return null;const $=_.current,D=document.createElement("canvas");D.width=a.width,D.height=a.height;const E=D.getContext("2d");if(!E)return null;E.clearRect(0,0,D.width,D.height),B&&M&&M.canvas&&M.isVisible&&E.drawImage(M.canvas,0,0);const K=s.filter(H=>!H.isBackground&&H.isVisible&&H.canvas);for(const H of[...K].reverse())E.globalAlpha=H.opacity,E.drawImage(H.canvas,0,0),E.globalAlpha=1;if(U==="full"){$.width=a.width,$.height=a.height;const H=$.getContext("2d");return H==null||H.drawImage(D,0,0),$}const I=k(K);if(!I)return $.width=1,$.height=1,(L=$.getContext("2d"))==null||L.clearRect(0,0,1,1),$;$.width=I.width,$.height=I.height;const X=$.getContext("2d");return X?(X.drawImage(D,I.x,I.y,I.width,I.height,0,0,I.width,I.height),$):null},[a,s,M,k]);T.useEffect(()=>{o&&(u(G),N("full"))},[o,G]),T.useEffect(()=>{o&&(b(!0),V(r,S).then(B=>{B&&m(B.toDataURL("image/png")),b(!1)}))},[o,r,S,V]);const R=async()=>{b(!0);const B=await V(r,S);if(!B){alert("Error al generar la imagen."),b(!1);return}B.toBlob(U=>{if(U){const $=URL.createObjectURL(U),D=document.createElement("a");D.href=$,D.download=p.endsWith(".png")?p:`${p}.png`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL($),t()}else alert("Error al crear el archivo de imagen.");b(!1)},"image/png")};return o?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-2xl flex flex-col space-y-4",children:[c.jsx("h2",{className:"text-xl font-bold",children:"Exportar Imagen"}),c.jsxs("div",{className:"flex-grow p-2 rounded-md flex justify-center items-center min-h-0 bg-[--bg-primary]",style:{minHeight:"20rem",backgroundImage:"linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px"},children:[v&&c.jsx("p",{children:"Generando vista previa..."}),!v&&x&&c.jsx("img",{src:x,alt:"Vista previa de la exportacin",className:"max-w-full max-h-80 object-contain"}),c.jsx("canvas",{ref:_,className:"hidden"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"filename",className:"block text-sm text-[--text-secondary] mb-1",children:"Nombre del Archivo"}),c.jsx("input",{type:"text",id:"filename",value:p,onChange:B=>y(B.target.value),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md p-2"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-[--text-secondary] mb-2",children:"Tamao de Exportacin"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",name:"exportMode",value:"full",checked:S==="full",onChange:()=>N("full"),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] focus:ring-[--accent-primary]"}),c.jsx("span",{className:"ml-2 text-sm",children:"Tamao completo del lienzo"})]}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",name:"exportMode",value:"bbox",checked:S==="bbox",onChange:()=>N("bbox"),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] focus:ring-[--accent-primary]"}),c.jsx("span",{className:"ml-2 text-sm",children:"Ajustar a contenido"})]})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"includeBackground",checked:r,onChange:B=>u(B.target.checked),disabled:!G,className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] rounded focus:ring-[--accent-primary] disabled:opacity-50"}),c.jsx("label",{htmlFor:"includeBackground",className:`ml-2 text-sm ${G?"text-[--text-primary]":"text-[--text-secondary] opacity-50"}`,children:"Incluir fondo"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-4 pt-2",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",disabled:v,children:"Cancelar"}),c.jsx("button",{onClick:R,className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white disabled:bg-gray-500 disabled:cursor-wait",disabled:v,children:v?"Exportando...":"Exportar como PNG"})]})]})}):null},_E=({isOpen:o,onClose:t,item:s,canvasSize:a,onSaveToLibrary:r})=>{const[u,p]=T.useState("full"),[y,x]=T.useState(""),[m,v]=T.useState(""),[b,S]=T.useState(!1),N=T.useRef(null);T.useEffect(()=>{s!=null&&s.name?x(s.name.endsWith(".png")?s.name:`${s.name}.png`):x("objeto.png")},[s]);const _=T.useCallback(async k=>{if(!s||!s.canvas||!N.current)return null;const V=s.canvas,R=N.current;if(k==="full"){R.width=a.width,R.height=a.height;const B=R.getContext("2d");if(!B)return null;B.clearRect(0,0,R.width,R.height),B.globalAlpha=s.opacity,B.drawImage(V,0,0),B.globalAlpha=1}else{const B=ir(V);if(B){R.width=B.width,R.height=B.height;const U=R.getContext("2d");if(!U)return null;U.clearRect(0,0,R.width,R.height),U.globalAlpha=s.opacity,U.drawImage(V,B.x,B.y,B.width,B.height,0,0,B.width,B.height),U.globalAlpha=1}else{R.width=1,R.height=1;const U=R.getContext("2d");U==null||U.clearRect(0,0,1,1)}}return R},[s,a]);T.useEffect(()=>{!o||!s||(S(!0),_(u).then(k=>{k&&v(k.toDataURL("image/png")),S(!1)}))},[o,s,u,_]);const M=async()=>{S(!0);const k=await _(u);if(!k){alert("Error al generar la imagen."),S(!1);return}k.toBlob(V=>{if(V){const R=URL.createObjectURL(V),B=document.createElement("a");B.href=R,B.download=y.endsWith(".png")?y:`${y}.png`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(R),t()}else alert("Error al crear el archivo de imagen.");S(!1)},"image/png")},G=async()=>{S(!0);const k=await _(u);if(!k){alert("Error al generar la imagen."),S(!1);return}const V=k.toDataURL("image/png");r(V,y),S(!1),t()};return o?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-2xl flex flex-col space-y-4",children:[c.jsxs("h2",{className:"text-xl font-bold",children:['Exportar Objeto: "',s==null?void 0:s.name,'"']}),c.jsxs("div",{className:"flex-grow p-2 rounded-md flex justify-center items-center min-h-0 bg-[--bg-primary]",style:{minHeight:"20rem",backgroundImage:"linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px"},children:[b&&c.jsx("p",{children:"Generando vista previa..."}),!b&&m&&c.jsx("img",{src:m,alt:"Vista previa de la exportacin",className:"max-w-full max-h-80 object-contain"}),c.jsx("canvas",{ref:N,className:"hidden"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"filename",className:"block text-sm text-[--text-secondary] mb-1",children:"Nombre del Archivo"}),c.jsx("input",{type:"text",id:"filename",value:y,onChange:k=>x(k.target.value),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md p-2"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm text-[--text-secondary] mb-2",children:"Tamao de Exportacin"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",name:"exportMode",value:"full",checked:u==="full",onChange:()=>p("full"),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] focus:ring-[--accent-primary]"}),c.jsx("span",{className:"ml-2 text-sm",children:"Tamao completo del lienzo"})]}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",name:"exportMode",value:"bbox",checked:u==="bbox",onChange:()=>p("bbox"),className:"w-4 h-4 text-[--accent-primary] bg-[--bg-tertiary] border-[--bg-hover] focus:ring-[--accent-primary]"}),c.jsx("span",{className:"ml-2 text-sm",children:"Ajustar a contenido"})]})]})]})]}),c.jsxs("div",{className:"flex justify-end space-x-4 pt-2",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",disabled:b,children:"Cancelar"}),c.jsxs("button",{onClick:G,className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-500 text-white disabled:bg-gray-500 disabled:cursor-wait flex items-center gap-2",disabled:b,children:[c.jsx(Qi,{className:"w-4 h-4"}),b?"Guardando...":"Guardar en Librera"]}),c.jsx("button",{onClick:M,className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white disabled:bg-gray-500 disabled:cursor-wait",disabled:b,children:b?"Exportando...":"Exportar como PNG"})]})]})}):null},ME=({user:o})=>{const[t,s]=T.useState(!1),a=T.useRef(null),r=async()=>{const p=new C0;try{await S0(Lu,p)}catch(y){console.error("Error during sign-in:",y),alert("Could not sign in. Please check the console for details.")}},u=async()=>{try{await E0(Lu),s(!1)}catch(p){console.error("Error during sign-out:",p)}};return T.useEffect(()=>{const p=y=>{a.current&&!a.current.contains(y.target)&&s(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]),o?c.jsxs("div",{className:"relative",ref:a,children:[c.jsx("button",{onClick:()=>s(p=>!p),className:"w-10 h-10 rounded-full border-2 border-[--accent-primary] overflow-hidden focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[--accent-primary] focus:ring-offset-[--bg-primary]",children:c.jsx("img",{src:o.photoURL||void 0,alt:o.displayName||"User Avatar",className:"w-full h-full object-cover"})}),t&&c.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg z-30 py-1",children:[c.jsxs("div",{className:"px-3 py-2 border-b border-[--bg-tertiary]",children:[c.jsx("p",{className:"text-sm font-semibold truncate",children:o.displayName}),c.jsx("p",{className:"text-xs text-[--text-secondary] truncate",children:o.email})]}),c.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-left text-[--text-primary] hover:bg-[--bg-hover]",children:[c.jsx(HS,{className:"w-4 h-4"}),c.jsx("span",{children:"Logout"})]})]})]}):c.jsxs("button",{onClick:r,className:"p-2 flex items-center gap-2 rounded-md bg-[--bg-secondary] text-[--text-primary] hover:bg-[--bg-tertiary] border border-[--bg-tertiary] transition-colors text-sm",title:"Login with Google",children:[c.jsx(VS,{className:"w-5 h-5"}),c.jsx("span",{children:"Login"})]})};function RE(o,t,s){const a=[{x:0,y:0},{x:t.width,y:0},{x:t.width,y:t.height},{x:0,y:t.height}],r=[s.tl,s.tr,s.br,s.bl],u=py(r,a);if(!u){console.error("Could not compute homography matrix for warping."),o.drawImage(t,s.tl.x,s.tl.y);return}const p=Math.floor(Math.min(s.tl.x,s.tr.x,s.br.x,s.bl.x)),y=Math.floor(Math.min(s.tl.y,s.tr.y,s.br.y,s.bl.y)),x=Math.ceil(Math.max(s.tl.x,s.tr.x,s.br.x,s.bl.x)),m=Math.ceil(Math.max(s.tl.y,s.tr.y,s.br.y,s.bl.y)),v=x-p,b=m-y;if(v<=0||b<=0)return;const S=t.getContext("2d",{willReadFrequently:!0});if(!S)return;const N=S.getImageData(0,0,t.width,t.height),_=o.createImageData(v,b),M=N.data,G=_.data,k=N.width,V=N.height;for(let R=0;R<b;R++)for(let B=0;B<v;B++){const U=p+B,$=y+R,D=u[6]*U+u[7]*$+u[8],E=(u[0]*U+u[1]*$+u[2])/D,K=(u[3]*U+u[4]*$+u[5])/D;if(E>=0&&E<k-1&&K>=0&&K<V-1){const I=Math.floor(E),X=Math.floor(K),L=E-I,H=K-X,ue=(X*k+I)*4,ve=(X*k+(I+1))*4,j=((X+1)*k+I)*4,z=((X+1)*k+(I+1))*4,oe=(R*v+B)*4;for(let ge=0;ge<4;ge++){const Z=M[ue+ge],A=M[ve+ge],O=M[j+ge],W=M[z+ge],ye=Z+(A-Z)*L,be=O+(W-O)*L,me=ye+(be-ye)*H;G[oe+ge]=me}}}o.putImageData(_,p,y)}const my={objects:[{id:"background",name:"Background",type:"object",isVisible:!0,opacity:1,parentId:null,isBackground:!0,color:"#F0F0F0"},{id:"object-1",name:"Objeto 1",type:"object",isVisible:!0,opacity:1,parentId:null}],canvasSize:{width:0,height:0},scaleFactor:.1,scaleUnit:"cm"};function IE(o,t){switch(t.type){case"INITIALIZE_CANVASES":{const{width:s,height:a}=t.payload,r=o.objects.map(u=>{if(!u.canvas){const{canvas:p,context:y}=Yn(s,a);return u.isBackground&&(y.fillStyle=u.color||"#F0F0F0",y.fillRect(0,0,s,a)),{...u,canvas:p,context:y}}return u});return{...o,objects:r,canvasSize:{width:s,height:a}}}case"ADD_ITEM":{const{type:s,activeItemId:a,canvasSize:r,newItemId:u,imageElement:p,name:y,initialDimensions:x}=t.payload,m=a?o.objects.find(N=>N.id===a):null;let v=null;m&&(v=m.type==="group"?m.id:m.parentId);let b;if(s==="group")b={id:u??`group-${Date.now()}`,name:y??`Carpeta ${o.objects.filter(_=>_.type==="group").length+1}`,type:"group",isVisible:!0,opacity:1,parentId:v};else{const N={id:u??`object-${Date.now()}`,name:y??`Objeto ${o.objects.filter(G=>G.type==="object"&&!G.isBackground).length+1}`,type:"object",isVisible:!0,opacity:1,parentId:v},{canvas:_,context:M}=Yn(r.width,r.height);if(N.canvas=_,N.context=M,p)if(x){const G=(r.width-x.width)/2,k=(r.height-x.height)/2;M.drawImage(p,G,k,x.width,x.height)}else M.drawImage(p,0,0);b=N}const S=[...o.objects];if(m&&m.type!=="group"){const N=S.findIndex(_=>_.id===a);N!==-1?S.splice(N+1,0,b):S.push(b)}else S.push(b);return{...o,objects:S}}case"ADD_ITEM_BELOW":{const{targetId:s,canvasSize:a,newItemId:r}=t.payload,u=o.objects.find(b=>b.id===s);if(!u)return o;const p={id:r,name:`Objeto ${o.objects.filter(b=>b.type==="object"&&!b.isBackground).length+1}`,type:"object",isVisible:!0,opacity:1,parentId:u.parentId},{canvas:y,context:x}=Yn(a.width,a.height);p.canvas=y,p.context=x;const m=[...o.objects],v=m.findIndex(b=>b.id===s);return v!==-1?m.splice(v,0,p):m.push(p),{...o,objects:m}}case"PASTE_FROM_CLIPBOARD":{const{newItemId:s,clipboard:a,canvasSize:r,activeItemId:u}=t.payload,p=u?o.objects.find(b=>b.id===u):null,y=p?p.type==="group"?p.id:p.parentId:null,{canvas:x,context:m}=Yn(r.width,r.height);m.putImageData(a.imageData,a.sourceRect.x,a.sourceRect.y);const v={id:s,name:`Pegado ${o.objects.filter(b=>b.name.startsWith("Pegado")).length+1}`,type:"object",isVisible:!0,opacity:1,parentId:y,canvas:x,context:m};return{...o,objects:[...o.objects,v]}}case"DELETE_ITEM":{const{id:s}=t.payload,a=new Set([s]),r=y=>{o.objects.forEach(x=>{x.parentId===y&&(a.add(x.id),x.type==="group"&&r(x.id))})},u=o.objects.find(y=>y.id===s);u&&u.type==="group"&&r(s);const p=o.objects.filter(y=>!a.has(y.id));return{...o,objects:p}}case"UPDATE_ITEM":{const{id:s,updates:a}=t.payload,r=o.objects.map(u=>u.id===s?{...u,...a}:u);return{...o,objects:r}}case"MOVE_ITEM":{const{draggedId:s,targetId:a,position:r}=t.payload;if(s===a)return o;const u=(N,_)=>{const M=o.objects.find(G=>G.id===_);return!M||!M.parentId?!1:M.parentId===N?!0:u(N,M.parentId)};if(u(s,a))return o;const p=o.objects.find(N=>N.id===s),y=o.objects.find(N=>N.id===a);if(!p||!y)return o;const x=o.objects.filter(N=>N.id!==s);let m,v;if(r==="middle"&&y.type==="group"){m=y.id;const N=x.filter(_=>_.parentId===y.id);if(N.length>0){const _=N[N.length-1];v=x.findIndex(M=>M.id===_.id)+1}else v=x.findIndex(_=>_.id===a)+1}else{m=y.parentId;const N=x.findIndex(_=>_.id===a);v=r==="top"?N:N+1}const b={...p,parentId:m},S=[...x];return S.splice(v,0,b),{...o,objects:S}}case"COPY_ITEM":{const{id:s}=t.payload,a=o.objects.findIndex(x=>x.id===s);if(a===-1)return o;const r=o.objects[a];if(r.type==="object"&&r.isBackground)return o;let u;const p={...r,id:`${r.type}-${Date.now()}`,name:`Copia de ${r.name}`};if(r.canvas){const{canvas:x,context:m}=Yn(r.canvas.width,r.canvas.height);m.drawImage(r.canvas,0,0),p.canvas=x,p.context=m}u=p;const y=[...o.objects];return y.splice(a+1,0,u),{...o,objects:y}}case"MERGE_ITEMS":{const{sourceId:s,targetId:a}=t.payload,r=o.objects.find(k=>k.id===s),u=o.objects.find(k=>k.id===a);if(!r||!u||!r.canvas||!u.canvas)return o;const p=o.objects.findIndex(k=>k.id===s),y=o.objects.findIndex(k=>k.id===a),x=p>y?r:u,m=p>y?u:r,{canvas:v,context:b}=Yn(m.canvas.width,m.canvas.height),S=k=>{const{canvas:V,context:R}=Yn(k.canvas.width,k.canvas.height);R.drawImage(k.canvas,0,0);try{const B=R.getImageData(0,0,V.width,V.height),U=B.data;for(let $=3;$<U.length;$+=4)U[$]=U[$]*k.opacity;R.putImageData(B,0,0)}catch(B){console.error("Could not bake opacity, falling back to simple draw.",B),R.clearRect(0,0,V.width,V.height),R.globalAlpha=k.opacity,R.drawImage(k.canvas,0,0),R.globalAlpha=1}return V},N=S(m);b.drawImage(N,0,0);const _=S(x);b.drawImage(_,0,0);const M={...m,canvas:v,context:b,opacity:1},G=o.objects.map(k=>k.id===m.id?M:k).filter(k=>k.id!==x.id);return{...o,objects:G}}case"UPDATE_BACKGROUND":{const{color:s,image:a}=t.payload,r=o.objects.map(u=>{if(u.type==="object"&&u.isBackground&&u.context){const p={...u};return s&&(p.color=s,p.context.fillStyle=s,p.context.fillRect(0,0,u.context.canvas.width,u.context.canvas.height),p.backgroundImage&&p.context.drawImage(p.backgroundImage,0,0)),a&&(p.backgroundImage=a,p.context.clearRect(0,0,u.context.canvas.width,u.context.canvas.height),p.color&&(p.context.fillStyle=p.color,p.context.fillRect(0,0,u.context.canvas.width,u.context.canvas.height)),p.context.drawImage(a,0,0,u.context.canvas.width,u.context.canvas.height)),p}return u});return{...o,objects:r}}case"SET_CANVAS_FROM_IMAGE":{const{image:s}=t.payload,a={width:s.width,height:s.height},r=o.objects.map(u=>{const p=u.canvas,{canvas:y,context:x}=Yn(a.width,a.height);return u.isBackground?(x.drawImage(s,0,0),{...u,canvas:y,context:x,color:"#FFFFFF",backgroundImage:s}):(p&&x.drawImage(p,0,0),{...u,canvas:y,context:x})});return{...o,objects:r,canvasSize:a}}case"REMOVE_BACKGROUND_IMAGE":{const s=o.objects.map(a=>{if(a.type==="object"&&a.isBackground&&a.context){a.context.fillStyle=a.color||"#FFFFFF",a.context.fillRect(0,0,a.context.canvas.width,a.context.canvas.height);const{backgroundImage:r,...u}=a;return{...u,color:a.color||"#FFFFFF"}}return a});return{...o,objects:s}}case"CLEAR_CANVAS":{const s={...my};return o.canvasSize.width>0&&(s.objects.forEach(a=>{const{canvas:r,context:u}=Yn(o.canvasSize.width,o.canvasSize.height);a.type==="object"&&(a.canvas=r,a.context=u,a.isBackground&&(u.fillStyle=a.color,u.fillRect(0,0,r.width,r.height)))}),s.canvasSize=o.canvasSize),s}case"CROP_CANVAS":{const{cropRect:s}=t.payload,a={width:Math.round(s.width),height:Math.round(s.height)},r=o.objects.map(u=>{if(u.canvas){const{canvas:p,context:y}=Yn(a.width,a.height);return y.drawImage(u.canvas,s.x,s.y,s.width,s.height,0,0,a.width,a.height),{...u,canvas:p,context:y}}return u});return{...o,objects:r,canvasSize:a}}case"RESIZE_CANVAS":{const{width:s,height:a}=t.payload,r={width:Math.round(s),height:Math.round(a)},u=o.objects.map(p=>{if(p.canvas){const{canvas:y,context:x}=Yn(r.width,r.height);if(p.isBackground)p.backgroundImage?(x.fillStyle=p.color||"#FFFFFF",x.fillRect(0,0,r.width,r.height),x.drawImage(p.backgroundImage,0,0,r.width,r.height)):(x.fillStyle=p.color||"#FFFFFF",x.fillRect(0,0,r.width,r.height));else{const m=(r.width-p.canvas.width)/2,v=(r.height-p.canvas.height)/2;x.drawImage(p.canvas,m,v)}return{...p,canvas:y,context:x}}return p});return{...o,objects:u,canvasSize:r}}case"APPLY_TRANSFORM":{const{id:s,transform:a,sourceBbox:r}=t.payload,u=o.objects.findIndex(N=>N.id===s);if(u===-1)return o;const p=o.objects[u];if(!p.canvas||!p.context)return o;const y=document.createElement("canvas");y.width=r.width,y.height=r.height;const x=y.getContext("2d",{willReadFrequently:!0});if(!x)return o;x.drawImage(p.canvas,r.x,r.y,r.width,r.height,0,0,r.width,r.height);const{canvas:m,context:v}=Yn(p.canvas.width,p.canvas.height);if(v.drawImage(p.canvas,0,0),v.save(),v.globalCompositeOperation="destination-out",v.fillRect(r.x,r.y,r.width,r.height),v.restore(),a.type==="free"){const{corners:N}=a;RE(v,y,N)}else a.type==="affine"&&(v.save(),v.translate(a.x+a.width/2,a.y+a.height/2),v.rotate(a.rotation),v.scale(a.width/r.width,a.height/r.height),v.drawImage(y,-y.width/2,-y.height/2),v.restore());const b={...p,canvas:m,context:v},S=[...o.objects];return S[u]=b,{...o,objects:S}}case"SET_SCALE_FACTOR":return{...o,scaleFactor:t.payload};case"SET_SCALE_UNIT":return{...o,scaleUnit:t.payload};case"SNAPSHOT":case"COMMIT_DRAWING":return{...o};default:return o}}const kE={past:[],present:my,future:[]};function DE(o,t){const{past:s,present:a,future:r}=o;if(t.type==="UNDO"){if(s.length===0)return o;const x=s[s.length-1];return{past:s.slice(0,s.length-1),present:x,future:[a,...r]}}if(t.type==="REDO"){if(r.length===0)return o;const x=r[0],m=r.slice(1);return{past:[...s,a],present:x,future:m}}if(t.type==="LOAD_PROJECT_STATE")return{past:[],present:t.payload.newState,future:[]};if(t.type==="COMMIT_DRAWING"){const{activeItemId:x,beforeCanvas:m}=t.payload,v=m.getContext("2d",{willReadFrequently:!0});if(!v)return console.error("Could not get context for beforeCanvas in COMMIT_DRAWING"),o;const b={...a,objects:a.objects.map(_=>{if(_.id===x&&_.type==="object")return{..._,canvas:m,context:v};if(_.type==="object"&&_.canvas){const{canvas:M,context:G}=xg(_.canvas);return{..._,canvas:M,context:G}}return _})},S=[...s,b].slice(-50),N={...a,objects:[...a.objects]};return{past:S,present:N,future:[]}}const u=IE(a,t);if(a===u)return o;const p={...a,objects:a.objects.map(x=>{if(x.type==="object"&&x.canvas){const{canvas:m,context:v}=xg(x.canvas);return{...x,canvas:m,context:v}}return x})};return{past:[...s,p].slice(-50),present:u,future:[]}}const LE={size:3,opacity:1,color:"#000000",lineCap:"round",lineJoin:"round",hasStrokeCaps:!0,pressureControl:{size:!0}},jE={size:50,opacity:1,hardness:100,tipShape:"round"},UE={size:10,opacity:.8,color:"#facc15",tipShape:"square",blendMode:"source-over",pressureControl:{opacity:!0}},zE={size:20,opacity:.7,color:"#34d399",pressureControl:{size:!0,opacity:!0}},PE={size:60,flow:.5,color:"#60a5fa",pressureControl:{flow:!0}},BE={presetId:null,size:50,opacity:1,color:"#c084fc"},qE={size:30,color:"#f87171",tipShape:"circle",tipAngle:0,hardness:80,flow:90,wetness:10,spacing:25,blendMode:"source-over",pressureControl:{size:!0,flow:!0}},GE={size:40,flow:50,wetness:50,color:"#3b82f6",pressureControl:{size:!0,flow:!1}},VE={tolerance:30,contiguous:!0},HE={content:"Texto",fontFamily:"Arial",fontSize:48,color:"#000000",textAlign:"left",fontWeight:"normal"},Sg="sketcher-fx-presets";function OE(){const[o,t]=T.useState(LE),[s,a]=T.useState(jE),[r,u]=T.useState(UE),[p,y]=T.useState(zE),[x,m]=T.useState(PE),[v,b]=T.useState(BE),[S,N]=T.useState(qE),[_,M]=T.useState(GE),[G,k]=T.useState(VE),[V,R]=T.useState(HE),[B,U]=T.useState([]);T.useEffect(()=>{try{const X=localStorage.getItem(Sg);X&&U(JSON.parse(X))}catch(X){console.error("Failed to load FX presets from localStorage",X)}},[]);const $=T.useCallback(X=>{try{localStorage.setItem(Sg,JSON.stringify(X))}catch(L){console.error("Failed to save FX presets to localStorage",L)}},[]),D=T.useCallback(X=>{const L={id:`fx-${Date.now()}`,name:X};U(H=>{const ue=[...H,L];return $(ue),ue})},[$]),E=T.useCallback((X,L)=>{U(H=>{const ue=H.map(ve=>ve.id===X?{...ve,...L}:ve);return $(ue),ue})},[$]),K=T.useCallback(X=>{b(L=>({...L,presetId:X}))},[]),I=T.useCallback(X=>{U(L=>{const H=L.filter(ue=>ue.id!==X);return $(H),H})},[$]);return{brushSettings:o,setBrushSettings:t,eraserSettings:s,setEraserSettings:a,simpleMarkerSettings:r,setSimpleMarkerSettings:u,naturalMarkerSettings:p,setNaturalMarkerSettings:y,airbrushSettings:x,setAirbrushSettings:m,fxBrushSettings:v,setFxBrushSettings:b,advancedMarkerSettings:S,setAdvancedMarkerSettings:N,watercolorSettings:_,setWatercolorSettings:M,magicWandSettings:G,setMagicWandSettings:k,textSettings:V,setTextSettings:R,brushPresets:B,onSavePreset:D,onUpdatePreset:E,onLoadPreset:K,onDeletePreset:I}}const FE=o=>{try{const t=o.split(",");if(t.length<2)return null;const s=t[0].match(/:(.*?);/);if(!s)return null;const a=s[1],r=atob(t[1]);let u=r.length;const p=new Uint8Array(u);for(;u--;)p[u]=r.charCodeAt(u);return new Blob([p],{type:a})}catch(t){return console.error("Error converting data URL to blob",t),null}};function YE(o){const[t,s]=T.useState([]),[a,r]=T.useState(null),[u,p]=T.useState(null);T.useEffect(()=>{if(o){const M=Cu(fl(xo,`users/${o.uid}/libraryItems`),wg("createdAt","desc")),G=Ng(M,async k=>{const V=k.docs.map(async B=>{const U=B.data();if(U.type==="folder")return{id:B.id,name:U.name,type:"folder",parentId:U.parentId||null};if(!U.storagePath)return null;const $=await Pi(yo(vo,U.storagePath));return{id:B.id,name:U.name,type:"image",storagePath:U.storagePath,transparentColors:U.transparentColors||[],scaleFactor:U.scaleFactor||5,tolerance:U.tolerance,dataUrl:$,parentId:U.parentId||null,scaleUnit:U.scaleUnit||"mm"}}),R=(await Promise.all(V)).filter(Boolean);s(R)},k=>{console.error("Error fetching library items:",k)});return()=>G()}else s([])},[o]);const y=T.useCallback(async(M,G)=>{if(!o){alert("Please log in to save items to your library.");return}const k=`users/${o.uid}/library/${Date.now()}_${M.name}`,V=yo(vo,k);try{await Bi(V,M),await Su(fl(xo,`users/${o.uid}/libraryItems`),{name:M.name.split(".").slice(0,-1).join(".")||"Image",storagePath:k,createdAt:Eu(),type:"image",parentId:G})}catch(R){console.error("Error uploading file to library:",R),alert("Failed to upload image.")}},[o]),x=T.useCallback(async(M,G)=>{if(!o){alert("Please log in to create folders.");return}try{await Su(fl(xo,`users/${o.uid}/libraryItems`),{name:M,parentId:G,type:"folder",createdAt:Eu()})}catch(k){console.error("Error creating folder:",k)}},[o]),m=T.useCallback(async(M,G)=>{if(!o){alert("Please log in to manage library items.");return}const k=fl(xo,`users/${o.uid}/libraryItems`),V=M.map(R=>{const B=(D,E)=>{const K=t.find(I=>I.id===E);return!K||!K.parentId?!1:K.parentId===D?!0:B(D,K.parentId)},U=t.find(D=>D.id===R);if((U==null?void 0:U.type)==="folder"&&(R===G||G&&B(R,G)))return console.warn(`Cannot move folder "${U.name}" into itself or a child folder.`),Promise.resolve();const $=va(k,R);return Tp($,{parentId:G})});try{await Promise.all(V)}catch(R){console.error("Error moving items:",R),alert("Failed to move items.")}},[o,t]),v=T.useCallback(async M=>{const G=t.find(k=>k.id===M);if(!(!G||G.type!=="image"||!G.dataUrl))try{const V=await(await fetch(G.dataUrl)).blob(),R=new FileReader;R.onloadend=()=>{const B=R.result;r({...G,originalDataUrl:B})},R.readAsDataURL(V)}catch(k){console.error("Error preparing image for editing:",k),alert("Could not load image for editing.")}},[t]),b=T.useCallback(async(M,G,k,V,R)=>{if(!a||!o)return;const B=FE(M);if(!B){alert("Error processing image data.");return}const U=yo(vo,a.storagePath),$=va(xo,`users/${o.uid}/libraryItems`,a.id);try{await Bi(U,B);const D=await Pi(U);await Tp($,{transparentColors:G,scaleFactor:k,tolerance:V,scaleUnit:R}),s(E=>E.map(K=>K.id===a.id&&K.type==="image"?{...K,dataUrl:D,transparentColors:G,scaleFactor:k,tolerance:V,scaleUnit:R}:K)),r(null)}catch(D){console.error("Error applying transparency:",D),alert("Failed to save changes.")}},[o,a]),S=M=>p(M),N=T.useCallback(async()=>{if(!u||!o)return;const M=fl(xo,`users/${o.uid}/libraryItems`),G=async k=>{const V=t.find(R=>R.id===k);if(V){if(V.type==="image")await Tu(yo(vo,V.storagePath));else if(V.type==="folder"){const R=Cu(M,A0("parentId","==",k)),U=(await _0(R)).docs.map($=>G($.id));await Promise.all(U)}await Ag(va(M,k))}};try{await G(u.id)}catch(k){console.error("Error deleting item:",k),alert("Failed to delete item.")}finally{p(null)}},[u,o,t]);return{libraryItems:t,imageToEdit:a,deletingLibraryItem:u,onImportToLibrary:y,onCreateFolder:x,onEditTransparency:v,onApplyTransparency:b,onDeleteLibraryItem:S,onConfirmDeleteLibraryItem:N,onCancelDeleteLibraryItem:()=>p(null),onCancelEditTransparency:()=>r(null),onMoveItems:m}}function JE(o){const[t,s]=T.useState("none"),[a,r]=T.useState(!1),[u,p]=T.useState([]),[y,x]=T.useState([]),[m,v]=T.useState(null),[b,S]=T.useState({angle:0}),[N,_]=T.useState({type:"cartesian",spacing:10,majorLineFrequency:10,isoAngle:60,majorLineColor:"rgba(239, 68, 68, 0.6)",minorLineColor:"rgba(128, 128, 128, 0.3)"}),[M,G]=T.useState(!1),[k,V]=T.useState(!1),[R,B]=T.useState(!1),U=T.useCallback(j=>{s(z=>{const oe=z===j?"none":j;if((oe==="none"||oe!=="perspective")&&V(!1),oe==="none"&&G(!1),oe==="ruler"&&u.length===0){const{width:ge,height:Z}=o;p([{id:`ruler-${Date.now()}`,start:{x:ge*.25,y:Z/2},end:{x:ge*.75,y:Z/2}}])}if(oe==="perspective"&&!m){const{width:ge,height:Z}=o,A=Z*.4,O=ge*.1,W=ge*.9;v({lines:{green:[{id:"g1",start:{x:0,y:0},end:{x:O,y:A}},{id:"g2",start:{x:0,y:Z},end:{x:O,y:A}}],red:[{id:"r1",start:{x:ge,y:0},end:{x:W,y:A}},{id:"r2",start:{x:ge,y:Z},end:{x:W,y:A}}],blue:[{id:"b1",start:{x:ge*.3,y:0},end:{x:ge*.3,y:Z}},{id:"b2",start:{x:ge*.7,y:0},end:{x:ge*.7,y:Z}}]},guidePoint:{x:ge/2,y:Z*.8},extraGuideLines:{green:[],red:[],blue:[]}})}if(oe==="mirror"&&y.length===0){const{width:ge,height:Z}=o;x([{id:`mirror-${Date.now()}`,start:{x:ge/2,y:0},end:{x:ge/2,y:Z}}])}return oe})},[m,y,u,o]),$=T.useCallback(j=>{_(z=>({...z,type:j})),j==="none"&&B(!1)},[]),D=T.useCallback(()=>B(j=>!j),[]),E=T.useCallback(()=>r(j=>!j),[]),K=T.useCallback(j=>{S({angle:j})},[]),I=T.useCallback(j=>{j>0&&_(z=>({...z,spacing:j}))},[]),X=T.useCallback(j=>{_(z=>({...z,isoAngle:j}))},[]),L=T.useCallback(j=>{j>0&&_(z=>({...z,majorLineFrequency:j}))},[]),H=T.useCallback(j=>{_(z=>({...z,majorLineColor:j}))},[]),ue=T.useCallback(j=>{_(z=>({...z,minorLineColor:j}))},[]),ve=T.useCallback(j=>{s(j.activeGuide),r(j.isOrthogonalVisible),p(j.rulerGuides),x(j.mirrorGuides),v(j.perspectiveGuide),S(j.orthogonalGuide),j.gridGuide?_({...j.gridGuide,majorLineColor:j.gridGuide.majorLineColor||"rgba(128, 128, 128, 0.6)",minorLineColor:j.gridGuide.minorLineColor||"rgba(128, 128, 128, 0.3)"}):_(z=>({...z,type:j.isGridVisible?"cartesian":"none",majorLineColor:z.majorLineColor||"rgba(128, 128, 128, 0.6)",minorLineColor:z.minorLineColor||"rgba(128, 128, 128, 0.3)"})),G(j.areGuidesLocked),V(j.isPerspectiveStrokeLockEnabled),B(j.isSnapToGridEnabled)},[]);return{activeGuide:t,isOrthogonalVisible:a,rulerGuides:u,setRulerGuides:p,mirrorGuides:y,setMirrorGuides:x,perspectiveGuide:m,setPerspectiveGuide:v,orthogonalGuide:b,gridGuide:N,areGuidesLocked:M,setAreGuidesLocked:G,isPerspectiveStrokeLockEnabled:k,setIsPerspectiveStrokeLockEnabled:V,isSnapToGridEnabled:R,toggleSnapToGrid:D,onSetActiveGuide:U,setGridType:$,toggleOrthogonal:E,onSetOrthogonalAngle:K,onSetGridSpacing:I,onSetGridMajorLineFrequency:L,onSetGridIsoAngle:X,onSetGridMajorLineColor:H,onSetGridMinorLineColor:ue,loadGuideState:ve}}const gy=3;function XE(o,t){const[s,a]=T.useState({zoom:1,pan:{x:0,y:0}}),r=T.useCallback(()=>{if(!o.current||!t.width||!t.height)return .01;const y=o.current.offsetWidth,x=o.current.offsetHeight,m=.9,v=y/t.width,b=x/t.height;return Math.max(.01,Math.min(v,b)*m)},[o,t.width,t.height]);T.useEffect(()=>{const y=()=>{if(o.current){const x=o.current.offsetWidth,m=o.current.offsetHeight;a(v=>{const b=(x-t.width*v.zoom)/2,S=(m-t.height*v.zoom)/2;return{zoom:v.zoom,pan:{x:b,y:S}}})}};return window.addEventListener("resize",y),y(),()=>window.removeEventListener("resize",y)},[t.width,t.height,o]);const u=T.useCallback(()=>{if(!o.current||t.width===0)return;const y=o.current.offsetWidth,x=o.current.offsetHeight,m=r(),v=(y-t.width*m)/2,b=(x-t.height*m)/2;a({zoom:m,pan:{x:v,y:b}})},[t.width,t.height,o,r]),p=T.useCallback(y=>{if(!o.current)return;const x=o.current.offsetWidth,m=o.current.offsetHeight,v=x/2,b=m/2;a(S=>{const N=r(),_=Math.max(N,Math.min(S.zoom*y,gy)),M=(v-S.pan.x)/S.zoom,G=(b-S.pan.y)/S.zoom,k=v-M*_,V=b-G*_;return{zoom:_,pan:{x:k,y:V}}})},[o,r]);return{viewTransform:s,setViewTransform:a,onZoomExtents:u,onZoomIn:()=>p(1.2),onZoomOut:()=>p(1/1.2),getMinZoom:r}}function KE(o,t,s,a,r,u){return{onDropOnCanvas:(y,x,m)=>{if(y.type!=="library-item")return;const v=a.find(N=>N.id===y.id);if(!v||v.type!=="image"||!v.dataUrl)return;const b=`object-${Date.now()}`,S=new Image;S.crossOrigin="anonymous",S.onload=()=>{const _=(v.scaleFactor||5)/u,M={width:S.width*_,height:S.height*_};s({type:"ADD_ITEM",payload:{type:"object",activeItemId:x,newItemId:b,imageElement:S,canvasSize:r,name:v.name,initialDimensions:M}}),m([b]),t("transform")},S.src=v.dataUrl}}}const Eg="sketcher-workspace-templates";function $E(){const[o,t]=T.useState([]);T.useEffect(()=>{try{const u=localStorage.getItem(Eg);u&&t(JSON.parse(u))}catch(u){console.error("Failed to load workspace templates from localStorage",u)}},[]);const s=T.useCallback(u=>{try{localStorage.setItem(Eg,JSON.stringify(u))}catch(p){console.error("Failed to save workspace templates to localStorage",p),alert("Could not save workspace template. The data may be invalid.")}},[]),a=T.useCallback((u,p)=>{const y={id:`template-${Date.now()}`,name:u,...p};return t(x=>{const m=[...x,y];return s(m),m}),y.id},[s]),r=T.useCallback(u=>{t(p=>{const y=p.filter(x=>x.id!==u);return s(y),y})},[s]);return{templates:o,saveTemplate:a,deleteTemplate:r}}const ps={colors:["#ef4444","#22c55e","#3b82f6"],sizes:[10,40,150],tools:[{type:"tool",tool:"brush"},{type:"tool",tool:"eraser"},null]};function ZE(){const[o,t]=T.useState(ps),s=T.useCallback((x,m)=>{t(v=>{const b=[...v.colors];return b[x]=m,{...v,colors:b}})},[]),a=T.useCallback(x=>{t(m=>({...m,colors:[...m.colors,x]}))},[]),r=T.useCallback(x=>{t(m=>({...m,colors:m.colors.filter((v,b)=>b!==x)}))},[]),u=T.useCallback((x,m)=>{m>0&&m<=1e3&&t(v=>{const b=[...v.sizes];return b[x]=m,{...v,sizes:b}})},[]),p=T.useCallback((x,m)=>{t(v=>{const b=[...v.tools];return b[x]=m,{...v,tools:b}})},[]),y=T.useCallback(x=>{if(x&&Array.isArray(x.colors)&&Array.isArray(x.sizes)&&Array.isArray(x.tools)){const m={...ps,...x};m.sizes.length!==3&&(m.sizes=ps.sizes),m.tools.length!==3&&(m.tools=ps.tools),m.colors.length===0&&(m.colors=ps.colors),t(m)}else t(ps)},[]);return{quickAccessSettings:o,updateColor:s,addColor:a,removeColor:r,updateSize:u,updateTool:p,loadState:y}}const WE={select:Ji,brush:Cs,eraser:Ea,"simple-marker":Xi,"natural-marker":sr,airbrush:lr,"fx-brush":ws,transform:tr,"free-transform":nr,enhance:$i,crop:er,pan:()=>null,"marquee-rect":Zi,lasso:Wi,"magic-wand":Ta,"debug-brush":Cs,text:Ki,"advanced-marker":or,watercolor:ar},QE=({anchorEl:o,initialColor:t,onColorChange:s,onClose:a})=>{const[r,u]=T.useState(t),p=T.useRef(null);T.useEffect(()=>{u(t)},[t]),T.useEffect(()=>{const S=N=>{p.current&&!p.current.contains(N.target)&&!o.contains(N.target)&&a()};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[a,o]);const y=S=>{const _=`#${S.target.value.toLowerCase()}`;u(_),/^#[0-9a-f]{6}$/i.test(_)&&s(_)},x=S=>{const N=S.target.value;u(N),s(N)},m=o.getBoundingClientRect(),v={position:"fixed",top:`${m.bottom+8}px`,left:`${m.left}px`,zIndex:50},b=["#ef4444","#f97316","#eab308","#84cc16","#22c55e","#14b8a6","#06b6d4","#3b82f6","#8b5cf6","#d946ef","#f43f5e","#78716c","#ffffff","#000000"];return c.jsxs("div",{ref:p,style:v,className:"bg-[--bg-secondary] p-3 rounded-lg shadow-2xl border border-[--bg-tertiary] space-y-3",onPointerDown:S=>S.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"relative w-10 h-10",children:[c.jsx("input",{type:"color",value:r,onChange:x,className:"absolute inset-0 w-full h-full p-0 bg-transparent border-none rounded-md cursor-pointer opacity-0"}),c.jsx("div",{className:"w-10 h-10 rounded-md border border-[--bg-hover]",style:{backgroundColor:r}})]}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-[--text-secondary] font-mono",children:"#"}),c.jsx("input",{type:"text",value:r.substring(1),onChange:y,className:"w-24 bg-[--bg-tertiary] text-[--text-primary] rounded-md p-2 pl-5 font-mono text-sm",maxLength:6})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-xs font-bold text-[--text-secondary] mb-2",children:"Presets"}),c.jsx("div",{className:"grid grid-cols-7 gap-1",children:b.map(S=>c.jsx("button",{onClick:()=>{u(S),s(S)},className:`w-6 h-6 rounded-full border-2 transition-all ${S===r?"border-[--accent-primary]":"border-transparent hover:border-gray-400"}`,style:{backgroundColor:S}},S))})]})]})},eT=({settings:o,onUpdateColor:t,onAddColor:s,onRemoveColor:a,onUpdateSize:r,onSelectColor:u,onSelectSize:p,onSelectTool:y,onOpenToolSelector:x,activeTool:m,activeColor:v,activeSize:b})=>{const[S,N]=T.useState(null),[_,M]=T.useState(null),G=T.useRef(null),[k,V]=T.useState(null),R=T.useRef(null);T.useEffect(()=>{const I=X=>{_&&G.current&&!G.current.contains(X.target)&&M(null)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[_]);const B=(I,X)=>{V({index:I,value:String(X)}),setTimeout(()=>{var L;return(L=R.current)==null?void 0:L.select()},0)},U=I=>{k!==null&&V({...k,value:I.target.value})},$=()=>{if(k!==null){const I=parseInt(k.value,10);isNaN(I)||r(k.index,I),V(null)}},D=I=>{I.key==="Enter"?$():I.key==="Escape"&&V(null)},E=I=>{if(!I)return c.jsx(Vi,{className:"w-5 h-5 text-[--text-secondary]"});if(I.type==="tool"){const X=WE[I.tool];return X?c.jsx(X,{className:"w-5 h-5"}):null}return I.type==="fx-preset"?c.jsx(ws,{className:"w-5 h-5"}):null},K=I=>I?I.type==="tool"?I.tool:I.type==="fx-preset"?`Preset: ${I.name}`:"":"Seleccionar herramienta";return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"absolute top-4 left-4 right-4 md:left-1/2 md:-translate-x-1/2 md:w-auto md:right-auto bg-[--bg-primary]/80 backdrop-blur-sm rounded-lg p-1 flex flex-wrap items-center justify-center gap-2 shadow-lg z-10",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[o.colors.map((I,X)=>{const L=v&&I.toLowerCase()===v.toLowerCase();return c.jsx("button",{onClick:()=>u(I),onDoubleClick:H=>{N({index:X,initialColor:I,anchorEl:H.currentTarget})},onContextMenu:H=>{H.preventDefault(),M({x:H.clientX,y:H.clientY,index:X})},className:`w-7 h-7 rounded-full border-2 transition-all hover:border-[--accent-primary] ${L?"border-[--accent-primary]":"border-[--bg-secondary]"}`,style:{backgroundColor:I},title:`Color: ${I} (clic para seleccionar, doble clic para editar, clic derecho para eliminar)`},X)}),c.jsx("button",{onClick:()=>s("#ffffff"),className:"w-7 h-7 rounded-full border-2 border-dashed border-[--bg-hover] flex items-center justify-center text-[--text-secondary] hover:bg-[--bg-tertiary] hover:border-[--accent-primary] transition-colors",title:"Agregar color",children:c.jsx(Vi,{className:"w-4 h-4"})})]}),c.jsx("div",{className:"h-6 w-px bg-[--bg-hover]"}),c.jsx("div",{className:"flex items-center gap-2",children:o.sizes.map((I,X)=>{const L=I===b;return c.jsx("div",{className:"relative",children:(k==null?void 0:k.index)===X?c.jsx("input",{ref:R,type:"number",value:k.value,onChange:U,onBlur:$,onKeyDown:D,className:"w-14 text-center bg-[--bg-hover] text-[--text-primary] p-1 rounded-md text-xs"}):c.jsxs("button",{onClick:()=>p(I),onDoubleClick:()=>B(X,I),className:`w-14 p-1 rounded-md text-xs transition-colors ${L?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,title:`Tamao: ${I}px (doble clic para cambiar)`,children:[I,"px"]})},X)})}),c.jsx("div",{className:"h-6 w-px bg-[--bg-hover]"}),c.jsx("div",{className:"flex items-center gap-2",children:o.tools.map((I,X)=>{const L=I!==null&&m!==void 0&&(I.type==="tool"&&I.tool===m||I.type==="fx-preset"&&m==="fx-brush");return c.jsx("button",{onClick:()=>I&&y(I),onContextMenu:H=>{H.preventDefault(),x(X)},className:`p-2 rounded-lg text-[--text-primary] transition-colors ${L?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,title:`${K(I)} (clic derecho para cambiar)`,children:E(I)},X)})})]}),S&&c.jsx(QE,{anchorEl:S.anchorEl,initialColor:S.initialColor,onClose:()=>N(null),onColorChange:I=>{S.index!==null&&(t(S.index,I),N(X=>X?{...X,initialColor:I}:null))}}),_&&c.jsx("div",{ref:G,className:"fixed z-50 bg-[--bg-secondary] rounded-md shadow-lg border border-[--bg-tertiary] py-1",style:{top:_.y,left:_.x},onPointerDown:I=>I.stopPropagation(),children:c.jsx("button",{onClick:()=>{o.colors.length>1?a(_.index):alert("No se puede eliminar el ltimo color."),M(null)},className:"block w-full text-left px-3 py-1 text-sm text-red-500 hover:bg-[--bg-hover]",children:"Eliminar"})})]})},tT=[{name:"select",icon:Ji},{name:"marquee-rect",icon:Zi},{name:"lasso",icon:Wi},{name:"magic-wand",icon:Ta},{name:"text",icon:Ki},{name:"brush",icon:Cs},{name:"eraser",icon:Ea},{name:"simple-marker",icon:Xi},{name:"advanced-marker",icon:or},{name:"natural-marker",icon:sr},{name:"watercolor",icon:ar},{name:"airbrush",icon:lr},{name:"fx-brush",icon:ws},{name:"transform",icon:tr},{name:"free-transform",icon:nr},{name:"enhance",icon:$i},{name:"crop",icon:er}],nT=({isOpen:o,onClose:t,onSelectTool:s,fxPresets:a})=>{if(!o)return null;const r=u=>{s(u),t()};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-lg flex flex-col space-y-4 max-h-[80vh]",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-xl font-bold",children:"Seleccionar Herramienta de Acceso Rpido"}),c.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-[--bg-tertiary]",children:c.jsx(bo,{className:"w-6 h-6"})})]}),c.jsxs("div",{className:"flex-grow overflow-y-auto space-y-4 pr-2",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Herramientas Estndar"}),c.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-2",children:tT.map(({name:u,icon:p})=>c.jsxs("button",{onClick:()=>r({type:"tool",tool:u}),className:"flex flex-col items-center justify-center p-3 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] transition-colors",title:u,children:[c.jsx(p,{className:"w-8 h-8"}),c.jsx("span",{className:"text-xs mt-2 capitalize",children:u.replace("-"," ")})]},u))})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Presets de Pincel FX"}),a.length>0?c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:a.map(u=>c.jsx("button",{onClick:()=>r({type:"fx-preset",id:u.id,name:u.name}),className:"p-3 rounded-lg bg-[--bg-tertiary] hover:bg-[--bg-hover] transition-colors text-left",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ws,{className:"w-6 h-6 flex-shrink-0"}),c.jsx("span",{className:"text-sm truncate",children:u.name})]})},u.id))}):c.jsx("p",{className:"text-sm text-[--text-secondary] text-center p-4",children:"No tienes presets de Pincel FX guardados."})]})]})]})})},oT=({isOpen:o,onClose:t,templates:s,onSave:a,onLoad:r,onDelete:u,onResetPreferences:p})=>{const[y,x]=T.useState(""),m=T.useRef(null);T.useEffect(()=>{const b=S=>{m.current&&!m.current.contains(S.target)&&t()};return o&&document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[o,t]);const v=()=>{y.trim()&&(a(y.trim()),x(""))};return o?c.jsxs("div",{ref:m,className:"absolute top-full right-0 mt-2 w-72 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg z-30 py-2 flex flex-col",style:{maxHeight:"calc(100vh - 100px)"},children:[c.jsxs("div",{className:"flex justify-between items-center px-3 pb-2 border-b border-[--bg-tertiary]",children:[c.jsxs("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] flex items-center gap-2",children:[c.jsx(hy,{className:"w-4 h-4"}),c.jsx("span",{children:"Plantillas de Espacio de Trabajo"})]}),c.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-[--bg-hover]",children:c.jsx(bo,{className:"w-5 h-5"})})]}),c.jsx("div",{className:"flex-grow overflow-y-auto p-2 space-y-1",children:s.length>0?s.map(b=>c.jsxs("div",{className:"group flex items-center justify-between p-2 rounded-md hover:bg-[--bg-tertiary]",children:[c.jsx("button",{onClick:()=>r(b.id),className:"flex-grow text-left text-sm truncate",children:b.name}),c.jsx("button",{onClick:()=>u(b.id),className:"p-1 text-[--text-secondary] opacity-0 group-hover:opacity-100 hover:text-red-500",children:c.jsx(Ll,{className:"w-4 h-4"})})]},b.id)):c.jsx("div",{className:"text-center text-xs text-[--text-secondary] py-4",children:"No hay plantillas guardadas."})}),c.jsx("div",{className:"px-3 pt-2 border-t border-[--bg-tertiary]",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",value:y,onChange:b=>x(b.target.value),onKeyDown:b=>b.key==="Enter"&&v(),placeholder:"Nombre de la nueva plantilla...",className:"flex-grow bg-[--bg-secondary] text-[--text-primary] text-sm rounded-md p-2 border border-[--bg-tertiary] focus:ring-1 focus:ring-[--accent-primary] focus:outline-none"}),c.jsx("button",{onClick:v,disabled:!y.trim(),className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white text-sm font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",children:"Guardar"})]})}),c.jsx("div",{className:"px-3 pt-2 mt-2 border-t border-[--bg-tertiary]",children:c.jsx("button",{onClick:p,className:"w-full text-center px-4 py-2 text-sm text-red-500 hover:bg-red-500 hover:text-white rounded-md transition-colors",children:"Restablecer todas las preferencias"})})]}):null},lT=({isOpen:o,onCancel:t,onConfirm:s,itemName:a,itemType:r})=>{if(!o)return null;const u=r==="group"?`Ests seguro de que quieres eliminar la carpeta "${a}"? Todos los objetos y subcarpetas dentro de ella tambin sern eliminados.`:`Ests seguro de que quieres eliminar el objeto "${a}"?`;return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-sm",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"Confirmar Eliminacin"}),c.jsx("p",{className:"text-[--text-secondary] mb-6",children:u}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),c.jsx("button",{onClick:s,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Eliminar"})]})]})})},Tg={"720p":{width:1280,height:720},"1080p":{width:1920,height:1080},"4K":{width:3840,height:2160}},sT=({isOpen:o,onClose:t,currentSize:s,onApply:a})=>{const[r,u]=T.useState(s.width),[p,y]=T.useState(s.height),[x,m]=T.useState("horizontal");T.useEffect(()=>{o&&(u(s.width),y(s.height),m(s.width>=s.height?"horizontal":"vertical"))},[o,s]);const v=N=>{const _=Tg[N].width,M=Tg[N].height;x==="horizontal"?(u(_),y(M)):(u(M),y(_))},b=N=>{N!==x&&(m(N),u(p),y(r))},S=()=>{const N=Number(r),_=Number(p);!isNaN(N)&&!isNaN(_)&&N>0&&_>0&&a(N,_)};return o?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-md flex flex-col space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-xl font-bold",children:"Tamao del Lienzo"}),c.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-[--bg-tertiary]",children:c.jsx(bo,{className:"w-6 h-6"})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Presets"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsx("button",{onClick:()=>v("720p"),className:"p-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] text-sm",children:"720p"}),c.jsx("button",{onClick:()=>v("1080p"),className:"p-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] text-sm",children:"1080p"}),c.jsx("button",{onClick:()=>v("4K"),className:"p-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] text-sm",children:"2160p (4K)"})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Orientacin"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{onClick:()=>b("horizontal"),className:`p-2 rounded-md text-sm transition-colors ${x==="horizontal"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Horizontal"}),c.jsx("button",{onClick:()=>b("vertical"),className:`p-2 rounded-md text-sm transition-colors ${x==="vertical"?"bg-[--accent-primary] text-white":"bg-[--bg-tertiary] hover:bg-[--bg-hover]"}`,children:"Vertical"})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-bold uppercase text-[--text-secondary] mb-2",children:"Personalizado"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"canvas-width",className:"block text-xs text-[--text-secondary] mb-1",children:"Ancho"}),c.jsx("input",{type:"number",id:"canvas-width",value:r,onChange:N=>u(Number(N.target.value)),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md p-2"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"canvas-height",className:"block text-xs text-[--text-secondary] mb-1",children:"Alto"}),c.jsx("input",{type:"number",id:"canvas-height",value:p,onChange:N=>y(Number(N.target.value)),className:"w-full bg-[--bg-tertiary] text-[--text-primary] text-sm rounded-md p-2"})]})]})]}),c.jsxs("div",{className:"flex justify-end space-x-4 pt-2",children:[c.jsx("button",{onClick:t,className:"px-6 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),c.jsx("button",{onClick:S,className:"px-6 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white",children:"Aplicar"})]})]})}):null},aT=({isOpen:o,onCancel:t,onConfirm:s})=>o?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-sm",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"Limpiar Lienzo"}),c.jsx("p",{className:"text-[--text-secondary] mb-6",children:"Ests seguro de que quieres borrar todo? Esta accin eliminar todas las capas y no se puede deshacer de forma convencional (aunque s con el botn Deshacer)."}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),c.jsx("button",{onClick:s,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Limpiar"})]})]})}):null,iT=({isOpen:o,onCancel:t,onConfirm:s,itemToDelete:a})=>{if(!o||!a)return null;const r=a.type==="folder",u=`Ests seguro de que quieres eliminar "${a.name}"?`;return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-sm",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"Confirmar Eliminacin"}),c.jsxs("p",{className:"text-[--text-secondary] mb-6",children:[u,r&&c.jsx("strong",{className:"block mt-2 text-[--text-primary]",children:"Esto tambin eliminar permanentemente todo su contenido. Esta accin no se puede deshacer."})]}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),c.jsx("button",{onClick:s,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Eliminar"})]})]})})},rT=({isOpen:o,onCancel:t,onConfirm:s})=>o?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-sm",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"Restablecer Preferencias"}),c.jsxs("p",{className:"text-[--text-secondary] mb-6",children:["Ests seguro de que quieres restablecer todas las preferencias a sus valores por defecto? Esto eliminar permanentemente los preajustes de pincel personalizados y otras configuraciones.",c.jsx("strong",{className:"text-[--text-primary] block mt-2",children:"Tus plantillas de espacio de trabajo guardadas no se vern afectadas."}),"Esta accin no se puede deshacer."]}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"}),c.jsx("button",{onClick:s,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Restablecer"})]})]})}):null,Li=o=>o.split(",")[1];function cT(){const[o,t]=T.useState(!1),[s,a]=T.useState(!1),[r,u]=T.useState(null),[p,y]=T.useState(!1),[x,m]=T.useState(!1),[v,b]=T.useState(!1),[S,N]=T.useState(!1),[_,M]=T.useState(window.innerWidth>1024),[G,k]=T.useState(void 0),[V,R]=T.useState(!1),[B,U]=T.useState(!0),$=T.useRef(null),D=T.useRef({isResizing:!1,startY:0,startHeight:0});T.useEffect(()=>{if($.current&&G===void 0){const H=$.current.offsetHeight*.75;k(H)}},[G]),T.useEffect(()=>{const H=()=>{R(!!(document.fullscreenElement||document.webkitFullscreenElement))};return document.addEventListener("fullscreenchange",H),document.addEventListener("webkitfullscreenchange",H),document.addEventListener("mozfullscreenchange",H),document.addEventListener("MSFullscreenChange",H),()=>{document.removeEventListener("fullscreenchange",H),document.removeEventListener("webkitfullscreenchange",H),document.removeEventListener("mozfullscreenchange",H),document.removeEventListener("MSFullscreenChange",H)}},[]);const E=()=>{V?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen().catch(H=>{console.error(`Error attempting to enable full-screen mode: ${H.message} (${H.name})`)})},K=()=>{U(!1),V||document.documentElement.requestFullscreen().catch(H=>{console.error(`Error attempting to enable full-screen mode: ${H.message} (${H.name})`)})},I=T.useCallback(H=>{if(!D.current.isResizing||!$.current)return;const{startY:ue,startHeight:ve}=D.current,j=H.clientY-ue;let z=ve+j;const oe=$.current.offsetHeight;z=Math.max(100,Math.min(z,oe-100-6)),k(z)},[]),X=T.useCallback(()=>{D.current.isResizing=!1,document.body.style.cursor="default",window.removeEventListener("pointermove",I),window.removeEventListener("pointerup",X)},[I]),L=T.useCallback(H=>{if(H.preventDefault(),!$.current)return;const ue=$.current.children[0];D.current={isResizing:!0,startY:H.clientY,startHeight:ue.offsetHeight},document.body.style.cursor="ns-resize",window.addEventListener("pointermove",I),window.addEventListener("pointerup",X,{once:!0})},[I,X]);return{isExportModalOpen:o,setExportModalOpen:t,isSingleExportModalOpen:s,setSingleExportModalOpen:a,deletingItemId:r,setDeletingItemId:u,showClearConfirm:p,setShowClearConfirm:y,isCanvasSizeModalOpen:x,setCanvasSizeModalOpen:m,isProjectGalleryOpen:v,setProjectGalleryOpen:b,isResetConfirmOpen:S,setIsResetConfirmOpen:N,isRightSidebarVisible:_,setIsRightSidebarVisible:M,rightSidebarTopHeight:G,rightSidebarRef:$,handlePointerDownResize:L,isFullscreen:V,showSplash:B,handleStart:K,handleToggleFullscreen:E}}function uT(o,t,s,a,r,u,p){const[y,x]=T.useState([]),[m,v]=T.useState(!0);T.useEffect(()=>{if(o){v(!0);const k=Cu(fl(xo,`users/${o.uid}/projects`),wg("createdAt","desc")),V=Ng(k,async R=>{const B=R.docs.map(async $=>{const D=$.data();try{const E=await Pi(yo(vo,D.thumbnailPath));return{id:$.id,name:D.name,projectFilePath:D.projectFilePath,thumbnailPath:D.thumbnailPath,thumbnailUrl:E}}catch(E){return console.warn(`Could not get thumbnail for project ${D.name}`,E),null}}),U=(await Promise.all(B)).filter(Boolean);x(U),v(!1)},R=>{console.error("Error fetching projects:",R),v(!1)});return()=>V()}else x([]),v(!1)},[o]);const b=T.useCallback(async k=>{const{currentState:V,guides:R,toolSettings:B,quickAccess:U}=k(),$=V.objects.map(H=>{const{canvas:ue,context:ve,backgroundImage:j,...z}=H,oe={...z};return H.type==="object"&&ue&&(oe.dataUrl=ue.toDataURL()),oe}),D={fileFormatVersion:"1.0",canvasSize:V.canvasSize,objects:$,scaleFactor:V.scaleFactor,scaleUnit:V.scaleUnit,guides:R,toolSettings:B,quickAccessSettings:U},E=JSON.stringify(D),K=new Blob([E],{type:"application/json"}),I=document.createElement("canvas");I.width=V.canvasSize.width,I.height=V.canvasSize.height;const X=I.getContext("2d");if(X){const H=V.objects,ue=H.find(j=>j.type==="object"&&j.isBackground);ue!=null&&ue.canvas&&ue.isVisible&&X.drawImage(ue.canvas,0,0),[...H.filter(j=>j.type==="object"&&!j.isBackground&&j.isVisible&&!!j.canvas)].reverse().forEach(j=>{X.globalAlpha=j.opacity,X.drawImage(j.canvas,0,0)}),X.globalAlpha=1}if(!I)throw new Error("Could not create composite for thumbnail.");const L=await rE(I,400,225);return{projectBlob:K,thumbnailBlob:L}},[]),S=T.useCallback(async k=>{try{const V=await k.text(),R=JSON.parse(V);if(!R.fileFormatVersion||!R.canvasSize||!R.objects)throw new Error("Invalid project file format.");const B=R.objects.map(D=>new Promise((E,K)=>{const{dataUrl:I,backgroundImageDataUrl:X,...L}=D;if(D.type==="object"&&I){const H=new Image;H.onload=()=>{const{canvas:ue,context:ve}=Yn(R.canvasSize.width,R.canvasSize.height);ve.drawImage(H,0,0);const j={...L,canvas:ue,context:ve};E(j)},H.onerror=K,H.src=I}else E(L)})),$={objects:await Promise.all(B),canvasSize:R.canvasSize,scaleFactor:R.scaleFactor||5,scaleUnit:R.scaleUnit||"mm"};if(t({type:"LOAD_PROJECT_STATE",payload:{newState:$}}),R.toolSettings){const{brushSettings:D,eraserSettings:E,solidMarkerSettings:K,simpleMarkerSettings:I,naturalMarkerSettings:X,airbrushSettings:L,fxBrushSettings:H,magicWandSettings:ue,textSettings:ve,advancedMarkerSettings:j}=R.toolSettings;r({brushSettings:D,eraserSettings:E,solidMarkerSettings:K,simpleMarkerSettings:I,naturalMarkerSettings:X,airbrushSettings:L,fxBrushSettings:H,magicWandSettings:ue,textSettings:ve,advancedMarkerSettings:j})}R.guides&&u(R.guides),R.quickAccessSettings&&p(R.quickAccessSettings),s(!1),setTimeout(a,100)}catch(V){console.error("Failed to load project from file:",V),alert(`Error loading project: ${V instanceof Error?V.message:String(V)}`)}},[t,r,u,p,s,a]),N=T.useCallback(async(k,V)=>{try{const{projectBlob:R}=await b(V),B=URL.createObjectURL(R),U=document.createElement("a");U.href=B,U.download=k.endsWith(".sketcher")?k:`${k}.sketcher`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(B)}catch(R){throw console.error("Error saving project locally:",R),alert(`Error saving project locally: ${R instanceof Error?R.message:String(R)}`),R}},[b]),_=T.useCallback(async(k,V)=>{if(!o){alert("Please log in to save projects to the cloud.");return}const{projectBlob:R,thumbnailBlob:B}=await b(V),U=va(fl(xo,"dummy")).id,$=`users/${o.uid}/projects/${U}.sketcher`,D=`users/${o.uid}/projects/thumbnails/${U}.png`,E=yo(vo,$),K=yo(vo,D);await Bi(E,R),await Bi(K,B),await Su(fl(xo,`users/${o.uid}/projects`),{name:k,projectFilePath:$,thumbnailPath:D,createdAt:Eu()})},[o,b]),M=T.useCallback(async k=>{if(o)try{const V=await Pi(yo(vo,k.projectFilePath)),B=await(await fetch(V)).blob(),U=new File([B],`${k.name}.sketcher`);await S(U)}catch(V){console.error("Error loading project from cloud:",V),alert("Failed to load project.")}},[o,S]),G=T.useCallback(async k=>{if(o)try{const V=va(xo,`users/${o.uid}/projects`,k.id),R=yo(vo,k.projectFilePath),B=yo(vo,k.thumbnailPath);await Ag(V),await Promise.all([Tu(R).catch(U=>console.warn("Project file delete failed, it might not exist.",U)),Tu(B).catch(U=>console.warn("Thumbnail delete failed, it might not exist.",U))])}catch(V){console.error("Error deleting project:",V),alert("Failed to delete project.")}},[o]);return{projects:y,projectsLoading:m,saveProject:_,loadProject:M,deleteProject:G,saveLocally:N,loadFromFile:S}}function dT(o,t,s,a){const[r,u]=T.useState(!1),[p,y]=T.useState(null),[x,m]=T.useState(null),[v,b]=T.useState(null),S=T.useCallback(G=>{let k=null;return G.forEach(V=>{if(!V.canvas)return;const R=ir(V.canvas);if(R)if(!k)k={...R};else{const B=Math.min(k.x,R.x),U=Math.min(k.y,R.y),$=Math.max(k.x+k.width,R.x+R.width),D=Math.max(k.y+k.height,R.y+R.height);k={x:B,y:U,width:$-B,height:D-U}}}),k},[]),N=T.useCallback((G,k,V,R)=>{const B=document.createElement("canvas");B.width=k.width,B.height=k.height;const U=B.getContext("2d");if(!U)return null;const $=V();return G&&(R!=null&&R.canvas)&&R.isVisible&&U.drawImage(R.canvas,0,0),[...$.filter(E=>E.type==="object"&&!E.isBackground&&E.isVisible&&!!E.canvas)].reverse().forEach(E=>{U.globalAlpha=E.opacity,U.drawImage(E.canvas,0,0)}),U.globalAlpha=1,B},[]),_=T.useCallback((G,k,V)=>{y(null),setTimeout(()=>{const R=N(!1,G,k,V);if(!R)return;const B=k().filter(E=>E.type==="object"&&!E.isBackground&&E.isVisible&&!!E.canvas),U=S(B),$=R.toDataURL("image/png");let D=null;if(U&&U.width>0&&U.height>0){const E=document.createElement("canvas");E.width=U.width,E.height=U.height;const K=E.getContext("2d");K&&(K.drawImage(R,U.x,U.y,U.width,U.height,0,0,U.width,U.height),D=E.toDataURL("image/png"))}y({fullDataUrl:$,croppedDataUrl:D,bbox:U})},10)},[N,S]),M=T.useCallback(async(G,k,V,R)=>{var D,E,K,I;b(null),u(!0);let B="";const U=[],$=[];try{const X=new NS({apiKey:"PLACEHOLDER_API_KEY"});switch(G.activeAiTab){case"object":{const{enhancementPrompt:oe,enhancementStylePrompt:ge,enhancementNegativePrompt:Z,enhancementCreativity:A,enhancementInputMode:O,enhancementChromaKey:W,enhancementPreviewBgColor:ye}=G;if(!oe)throw new Error("Description prompt is required.");const be=N(!1,k,V,R);if(!be)throw new Error("Could not create composite canvas.");let me=be;if(O==="bbox"){const Rt=V().filter(Ee=>Ee.type==="object"&&!Ee.isBackground&&Ee.isVisible&&!!Ee.canvas),he=S(Rt);if(he&&he.width>0&&he.height>0){const Ee=document.createElement("canvas");Ee.width=he.width,Ee.height=he.height,(D=Ee.getContext("2d"))==null||D.drawImage(be,he.x,he.y,he.width,he.height,0,0,he.width,he.height),me=Ee}}let Me=document.createElement("canvas");Me.width=me.width,Me.height=me.height;const De=Me.getContext("2d");De?(De.fillStyle=ye||"#FFFFFF",De.fillRect(0,0,Me.width,Me.height),De.drawImage(me,0,0)):Me=me;const Ae=Me.toDataURL("image/jpeg");$.push({name:"Imagen de Entrada",url:Ae}),U.push({inlineData:{mimeType:"image/jpeg",data:Li(Ae)}});let Ke="";A<=40?Ke="S muy fiel a la imagen de entrada y a la descripcin proporcionada. Realiza solo los cambios solicitados.":A<=80?Ke="Mantn una fidelidad moderada a la imagen y descripcin, pero puedes hacer pequeas mejoras estticas.":A<=120?Ke="Usa la imagen y la descripcin como una fuerte inspiracin. Sintete libre de reinterpretar elementos para un mejor resultado artstico.":Ke="Usa la imagen y la descripcin solo como una vaga inspiracin. Prioriza un resultado impactante y altamente creativo sobre la fidelidad al original.";const mt=["Tu tarea es mejorar o transformar una imagen de entrada.",`Descripcin de la transformacin deseada: "${oe}".`,`El estilo visual a aplicar es: "${ge}".`,Ke];if(Z.trim()&&mt.push(`Asegrate de evitar estrictamente lo siguiente: "${Z}".`),W!=="none"){const Rt=W==="green"?"#00FF00":"#0000FF";mt.push(`Importante: La imagen resultante DEBE tener un fondo de croma slido y uniforme de color ${W} (${Rt}). El sujeto principal no debe contener este color.`)}B=mt.join(" ");break}case"composition":{const oe=N(!0,k,V,R);if(!oe)throw new Error("Could not create composite canvas.");const ge=oe.toDataURL("image/jpeg");$.push({name:"Escena Compuesta",url:ge}),U.push({inlineData:{mimeType:"image/jpeg",data:Li(ge)}}),(E=G.styleRef)!=null&&E.url&&($.push({name:"Referencia de Estilo",url:G.styleRef.url}),U.push({inlineData:{mimeType:"image/jpeg",data:Li(G.styleRef.url)}})),B=G.compositionPrompt;break}case"free":{const oe=["main","a","b","c"],ge=["Objeto 1","Aadido A","Aadido B","Aadido C"];oe.forEach((Z,A)=>{const O=G.freeFormSlots[Z];O!=null&&O.url&&($.push({name:ge[A],url:O.url}),U.push({inlineData:{mimeType:"image/png",data:Li(O.url)}}))}),B=G.freeFormPrompt;break}}b({prompt:B,images:$});const L={text:B},H="gemini-2.5-flash-image",ue={responseModalities:[bs.IMAGE,bs.TEXT]},ve=U.length>0?{parts:[...U,L]}:{parts:[L]},j=await X.models.generateContent({model:H,contents:ve,config:ue});let z=null;for(const oe of((I=(K=j.candidates)==null?void 0:K[0])==null?void 0:I.content.parts)||[])if(oe.inlineData){z=oe.inlineData.data;break}if(z){const oe=new Image;oe.onload=()=>{const ge=`IA: ${B.substring(0,20)}...`;if(G.activeAiTab==="object"||G.activeAiTab==="free"&&G.addEnhancedImageToLibrary){const Z=`data:image/png;base64,${z}`;fetch(Z).then(A=>A.blob()).then(A=>{A&&t(new File([A],`${ge}.png`,{type:"image/png"}),null)})}else if(G.activeAiTab==="composition")o({type:"UPDATE_BACKGROUND",payload:{image:oe}});else{const Z=`object-${Date.now()}`;o({type:"ADD_ITEM",payload:{type:"object",activeItemId:null,newItemId:Z,imageElement:oe,canvasSize:k,name:ge}}),s(Z),a("select")}},oe.src=`data:image/png;base64,${z}`}else alert(`La IA no devolvi una imagen. Dijo: "${j.text}"`)}catch(X){console.error("Error during AI enhancement:",X),alert(`Ocurri un error: ${X instanceof Error?X.message:String(X)}`)}finally{u(!1)}},[o,t,s,a,N,S]);return{isEnhancing:r,enhancementPreview:p,backgroundDataUrl:x,setBackgroundDataUrl:m,debugInfo:v,generateEnhancementPreview:_,handleEnhance:M}}function fT(){const[o,t]=T.useReducer(DE,kE),{present:s,past:a,future:r}=o,{objects:u,canvasSize:p,scaleFactor:y,scaleUnit:x}=s,[m,v]=T.useState([]),[b,S]=T.useState("brush"),N=T.useRef(null),[_,M]=T.useState("dark"),[G,k]=T.useState(null),[V,R]=T.useState(!1),[B,U]=T.useState(null),[$,D]=T.useState("freehand"),[E,K]=T.useState(null),[I,X]=T.useState({style:"solid",scale:1}),[L,H]=T.useState(null),[ue,ve]=T.useState(null),[j,z]=T.useState(null),[oe,ge]=T.useState(.5),Z=cT(),A=OE(),O=YE(G),W=JE(p),{getMinZoom:ye,...be}=XE(N,p),me=$E(),Me=ZE(),De=T.useCallback(F=>{v(F?[F]:[]),(!F||L&&L.sourceItemId!==F)&&H(null)},[L]),Ae=dT(t,O.onImportToLibrary,De,S),Ke=T.useCallback(F=>{A.setBrushSettings(F.brushSettings),A.setEraserSettings(F.eraserSettings),A.setSimpleMarkerSettings(F.solidMarkerSettings||F.simpleMarkerSettings),A.setNaturalMarkerSettings(F.naturalMarkerSettings),A.setAirbrushSettings(F.airbrushSettings),A.setFxBrushSettings(F.fxBrushSettings),F.magicWandSettings&&A.setMagicWandSettings(F.magicWandSettings),F.textSettings&&A.setTextSettings(F.textSettings),F.advancedMarkerSettings&&A.setAdvancedMarkerSettings(F.advancedMarkerSettings)},[A]),mt=uT(G,t,Z.setProjectGalleryOpen,be.onZoomExtents,Ke,W.loadGuideState,Me.loadState),{onDropOnCanvas:Rt}=KE(b,S,t,O.libraryItems,p,s.scaleFactor),[he,Ee]=T.useState(!1),[Se,je]=T.useState(!1),Ve=T.useRef(null),[Fe,tt]=T.useState(!1),rt=T.useRef(null),[Ht,Ze]=T.useState(!1),[It,$e]=T.useState(null),[bt,Ue]=T.useState(!1),[We,Ut]=T.useState(null),[mn,un]=T.useState(null),[ft,Yt]=T.useState(!1),[hn,Wt]=T.useState(!1),[Qt,At]=T.useState(15),Ot=m.length>0?m[m.length-1]:null,Et=Ot?u.find(F=>F.id===Ot):null,Ne=a.length>0,_e=r.length>0,Ge=u.find(F=>F.type==="object"&&!!F.isBackground),it=b==="enhance",{activeColor:ct,activeSize:gt}=T.useMemo(()=>{let F,re;switch(b){case"brush":F=A.brushSettings.color,re=A.brushSettings.size;break;case"simple-marker":F=A.simpleMarkerSettings.color,re=A.simpleMarkerSettings.size;break;case"natural-marker":F=A.naturalMarkerSettings.color,re=A.naturalMarkerSettings.size;break;case"airbrush":F=A.airbrushSettings.color,re=A.airbrushSettings.size;break;case"fx-brush":F=A.fxBrushSettings.color,re=A.fxBrushSettings.size;break;case"eraser":re=A.eraserSettings.size;break}return{activeColor:F,activeSize:re}},[b,A]),Oe=T.useCallback(F=>{switch(b){case"brush":A.setBrushSettings(re=>({...re,color:F}));break;case"simple-marker":A.setSimpleMarkerSettings(re=>({...re,color:F}));break;case"natural-marker":A.setNaturalMarkerSettings(re=>({...re,color:F}));break;case"airbrush":A.setAirbrushSettings(re=>({...re,color:F}));break;case"fx-brush":A.setFxBrushSettings(re=>({...re,color:F}));break}},[b,A]),Ye=T.useCallback(F=>{switch(b){case"brush":A.setBrushSettings(re=>({...re,size:F}));break;case"eraser":A.setEraserSettings(re=>({...re,size:F}));break;case"simple-marker":A.setSimpleMarkerSettings(re=>({...re,size:F}));break;case"natural-marker":A.setNaturalMarkerSettings(re=>({...re,size:F}));break;case"airbrush":A.setAirbrushSettings(re=>({...re,size:F}));break;case"fx-brush":A.setFxBrushSettings(re=>({...re,size:F}));break}},[b,A]),at=T.useCallback(F=>t({type:"SET_SCALE_FACTOR",payload:F}),[t]),Ct=T.useCallback(F=>t({type:"SET_SCALE_UNIT",payload:F}),[t]),Te=F=>{const re={canvasSize:p,backgroundColor:(Ge==null?void 0:Ge.color)||"#FFFFFF",scaleFactor:s.scaleFactor,scaleUnit:s.scaleUnit,guides:{activeGuide:W.activeGuide,isOrthogonalVisible:W.isOrthogonalVisible,rulerGuides:W.rulerGuides,mirrorGuides:W.mirrorGuides,perspectiveGuide:W.perspectiveGuide,orthogonalGuide:W.orthogonalGuide,gridGuide:W.gridGuide,areGuidesLocked:W.areGuidesLocked,isPerspectiveStrokeLockEnabled:W.isPerspectiveStrokeLockEnabled,isSnapToGridEnabled:W.isSnapToGridEnabled},toolSettings:{...A},quickAccessSettings:Me.quickAccessSettings},qe=me.saveTemplate(F,re);localStorage.setItem("sketcher-active-workspace-id",qe)},Ce=T.useCallback(F=>{const re=me.templates.find(qe=>qe.id===F);re&&((re.canvasSize.width!==p.width||re.canvasSize.height!==p.height)&&t({type:"RESIZE_CANVAS",payload:{width:re.canvasSize.width,height:re.canvasSize.height}}),t({type:"UPDATE_BACKGROUND",payload:{color:re.backgroundColor}}),t({type:"SET_SCALE_FACTOR",payload:re.scaleFactor}),t({type:"SET_SCALE_UNIT",payload:re.scaleUnit}),W.loadGuideState(re.guides),Ke(re.toolSettings),Me.loadState(re.quickAccessSettings),localStorage.setItem("sketcher-active-workspace-id",F),setTimeout(be.onZoomExtents,100))},[me.templates,p,t,W,Ke,Me,be.onZoomExtents]),Ie=T.useCallback(()=>{const F=new Map(u.map(qe=>[qe.id,qe])),re=qe=>{if(!qe.isVisible)return!1;if(qe.parentId){const st=F.get(qe.parentId);if(st)return re(st)}return!0};return u.map(qe=>({...qe,isVisible:re(qe)}))},[u]);T.useEffect(()=>{const F=T0(Lu,re=>k(re));return()=>F()},[]),T.useEffect(()=>{const F=localStorage.getItem("sketcher-theme");F&&M(F)},[]),T.useEffect(()=>{document.documentElement.classList.toggle("dark",_==="dark"),localStorage.setItem("sketcher-theme",_)},[_]),T.useLayoutEffect(()=>{if(he||!N.current||Z.showSplash)return;const F=new ResizeObserver(re=>{const qe=re[0],{width:st,height:yt}=qe.contentRect;st>0&&yt>0&&(t({type:"INITIALIZE_CANVASES",payload:{width:Math.floor(st),height:Math.floor(yt)}}),Ee(!0),v(["object-1"]),F.disconnect())});return F.observe(N.current),()=>F.disconnect()},[he,Z.showSplash,t]),T.useEffect(()=>{if(!he)return;const F=localStorage.getItem("sketcher-active-workspace-id"),re=F?me.templates.find(qe=>qe.id===F):null;re?Ce(re.id):be.onZoomExtents()},[he]),T.useEffect(()=>{Ge!=null&&Ge.canvas?Ae.setBackgroundDataUrl(Ge.canvas.toDataURL()):Ae.setBackgroundDataUrl(null)},[Ge,Ge==null?void 0:Ge.canvas,Ae]),T.useEffect(()=>{if(Ze(!1),$e(null),Ue(!1),Ut(null),un(null),b==="crop")Ze(!0),$e({x:0,y:0,width:p.width,height:p.height});else if((b==="transform"||b==="free-transform")&&(Et==null?void 0:Et.type)==="object"&&Et.canvas){const F=ir(Et.canvas);F?(Ue(!0),un(F),Ut(b==="transform"?{type:"affine",x:F.x,y:F.y,width:F.width,height:F.height,rotation:0}:{type:"free",x:F.x,y:F.y,width:F.width,height:F.height,corners:{tl:{x:F.x,y:F.y},tr:{x:F.x+F.width,y:F.y},bl:{x:F.x,y:F.y+F.height},br:{x:F.x+F.width,y:F.y+F.height}}})):S("select")}},[b,p.width,p.height,Et,S]),T.useEffect(()=>{const F=re=>{re.key==="Escape"&&(K(null),H(null))};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[]),T.useEffect(()=>{K(null)},[b,$]);const ae=T.useCallback(()=>t({type:"UNDO"}),[t]),Y=T.useCallback(()=>t({type:"REDO"}),[t]),le=T.useCallback(F=>{const re=`${F}-${Date.now()}`;return t({type:"ADD_ITEM",payload:{type:F,activeItemId:Ot,canvasSize:p,newItemId:re}}),v([re]),re},[Ot,p,t]),xe=T.useCallback(F=>t({type:"COPY_ITEM",payload:{id:F}}),[t]),we=T.useCallback(F=>Z.setDeletingItemId(F),[Z]),ke=T.useCallback((F,re,qe)=>t({type:"MOVE_ITEM",payload:{draggedId:F,targetId:re,position:qe}}),[t]),Re=T.useCallback((F,re)=>t({type:"COMMIT_DRAWING",payload:{activeItemId:F,beforeCanvas:re}}),[t]),Le=T.useCallback((F,re)=>t({type:"UPDATE_ITEM",payload:{id:F,updates:re}}),[t]),Je=T.useCallback(F=>{if(F.file){const re=new FileReader;re.onload=qe=>{var st;if((st=qe.target)!=null&&st.result){const yt=new Image;yt.onload=()=>{t({type:"SET_CANVAS_FROM_IMAGE",payload:{image:yt}}),be.onZoomExtents()},yt.src=qe.target.result}},re.readAsDataURL(F.file)}else F.image?t({type:"UPDATE_BACKGROUND",payload:{image:F.image}}):F.color&&t({type:"UPDATE_BACKGROUND",payload:{color:F.color}})},[be,t]),nt=T.useCallback(()=>t({type:"REMOVE_BACKGROUND_IMAGE"}),[t]),St=T.useCallback(()=>{Z.deletingItemId&&(t({type:"DELETE_ITEM",payload:{id:Z.deletingItemId}}),v(F=>F.filter(re=>re!==Z.deletingItemId)),Z.setDeletingItemId(null))},[Z,t]),ot=T.useCallback(async(F,re)=>{t({type:"MERGE_ITEMS",payload:{sourceId:F,targetId:re}}),v([re])},[t]),Ft=T.useCallback(()=>{t({type:"CLEAR_CANVAS"}),Z.setShowClearConfirm(!1)},[t,Z]),$t=T.useCallback((F,re)=>{fetch(F).then(qe=>qe.blob()).then(qe=>{if(qe){const st=re.endsWith(".png")?re:`${re}.png`;O.onImportToLibrary(new File([qe],st,{type:"image/png"}),null)}})},[O]),_t=T.useCallback(F=>{if(!F.value.trim()){z(null);return}const re=u.find(Dt=>Dt.id===F.activeItemId);if(!re||!re.context){z(null);return}const qe=Ca(re.canvas),st=re.context;st.save();const yt=A.textSettings;st.font=`${yt.fontWeight==="italic"?"italic ":""}${yt.fontWeight==="bold"?"bold ":""}${yt.fontSize}px ${yt.fontFamily}`,st.fillStyle=yt.color,st.textAlign=yt.textAlign,F.value.split(`
`).forEach((Dt,yn)=>st.fillText(Dt,F.position.x,F.position.y+yn*yt.fontSize*1.2)),st.restore(),t({type:"COMMIT_DRAWING",payload:{activeItemId:F.activeItemId,beforeCanvas:qe}}),z(null)},[u,A.textSettings,t]),gn=()=>{It&&(t({type:"CROP_CANVAS",payload:{cropRect:It}}),S("select"))},Sn=()=>S("select"),nn=()=>{We&&mn&&Et&&(t({type:"APPLY_TRANSFORM",payload:{id:Et.id,transform:We,sourceBbox:mn}}),S("select"))},Jn=()=>S("select"),En=T.useCallback(()=>H(null),[]),zt=T.useCallback(()=>{if(!L||!Et||Et.type!=="object"||!Et.context)return;const F=Ca(Et.canvas),re=Et.context;re.save(),re.clip(L.path),re.globalCompositeOperation="destination-out",re.fillRect(0,0,re.canvas.width,re.canvas.height),re.restore(),Re(Et.id,F),H(null)},[L,Et,Re]),Xn=T.useCallback(()=>{if(!L||!Et||Et.type!=="object"||!Et.context)return;const{boundingBox:F,path:re}=L,qe=Et.context,st=document.createElement("canvas");st.width=F.width,st.height=F.height;const yt=st.getContext("2d");if(!yt)return;yt.drawImage(qe.canvas,F.x,F.y,F.width,F.height,0,0,F.width,F.height),yt.globalCompositeOperation="destination-in",yt.save(),yt.translate(-F.x,-F.y),yt.fillStyle="black",yt.fill(re),yt.restore();const Dt=yt.getImageData(0,0,F.width,F.height);ve({imageData:Dt,sourceRect:F})},[L,Et]),qo=T.useCallback(()=>{Xn(),zt()},[Xn,zt]),Un=T.useCallback(()=>{if(!ue)return;const F=`object-${Date.now()}`;t({type:"PASTE_FROM_CLIPBOARD",payload:{newItemId:F,clipboard:ue,canvasSize:p,activeItemId:Ot}}),De(F),S("transform")},[ue,p,Ot,De,t]),kt=T.useMemo(()=>{const F=(re=null)=>u.filter(qe=>qe.parentId===re&&(qe.type!=="object"||!qe.isBackground)).flatMap(qe=>[qe,...qe.type==="group"?F(qe.id):[]]);return F()},[u]),zn=T.useMemo(()=>{if(!Ot)return{canMoveUp:!1,canMoveDown:!1,canMergeDown:!1,canMergeUp:!1};const F=kt.findIndex(yn=>yn.id===Ot);if(F===-1)return{canMoveUp:!1,canMoveDown:!1,canMergeDown:!1,canMergeUp:!1};const re=F<kt.length-1,qe=F>0;let st=!1,yt=!1;const Dt=kt[F];if(re){const yn=kt[F+1];Dt.type==="object"&&yn.type==="object"&&Dt.parentId===yn.parentId&&(st=!0)}if(qe){const yn=kt[F-1];Dt.type==="object"&&yn.type==="object"&&Dt.parentId===yn.parentId&&(yt=!0)}return{canMoveUp:re,canMoveDown:qe,canMergeDown:yt,canMergeUp:st}},[Ot,kt]),ml=T.useCallback((F,re)=>{const qe=kt.findIndex(yn=>yn.id===F);if(qe===-1)return;const st=re==="up"?qe+1:qe-1;if(st<0||st>=kt.length)return;const yt=kt[st],Dt=re==="up"?"bottom":"top";ke(F,yt.id,Dt)},[kt,ke]),gl=T.useCallback(F=>{if(zn.canMergeDown){const re=kt.findIndex(qe=>qe.id===F);ot(F,kt[re-1].id)}},[zn.canMergeDown,kt,ot]),Ns=T.useCallback(F=>{if(zn.canMergeUp){const re=kt.findIndex(qe=>qe.id===F);ot(kt[re+1].id,F)}},[zn.canMergeUp,kt,ot]),Go=T.useCallback(F=>{const re=`object-${Date.now()}`;t({type:"ADD_ITEM",payload:{type:"object",activeItemId:F,canvasSize:p,newItemId:re}}),v([re])},[p,t]),Vo=T.useCallback(F=>{const re=`object-${Date.now()}`;t({type:"ADD_ITEM_BELOW",payload:{targetId:F,canvasSize:p,newItemId:re}}),v([re])},[p,t]),Mn=T.useMemo(()=>{if(p.width>0&&y>0){const F=p.width/y,re=p.height/y;let qe,st;switch(x){case"cm":qe=(F/10).toFixed(2),st=(re/10).toFixed(2);break;case"m":qe=(F/1e3).toFixed(3),st=(re/1e3).toFixed(3);break;default:qe=F.toFixed(1),st=re.toFixed(1);break}return`${p.width} x ${p.height}px    ${qe} x ${st}${x}`}return null},[p,y,x]),Tn=Ie(),so=u.find(F=>F.id===Z.deletingItemId);return Z.showSplash?c.jsx("div",{className:"w-screen h-screen bg-[--bg-primary] text-[--text-primary] flex items-center justify-center font-sans",children:c.jsxs("div",{className:"text-center p-8",children:[c.jsx("h1",{className:"text-5xl font-bold mb-4",children:"Sketcher"}),c.jsx("p",{className:"text-lg text-[--text-secondary] mb-10",children:"Tu lienzo creativo te espera."}),c.jsx("button",{onClick:Z.handleStart,className:"px-10 py-4 bg-[--accent-primary] text-white font-bold text-lg rounded-lg shadow-lg hover:bg-[--accent-hover] transform hover:scale-105 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-offset-2 focus:ring-offset-[--bg-primary] focus:ring-[--accent-primary]",children:"Comenzar a Dibujar"})]})}):c.jsxs("div",{className:"w-screen h-screen bg-[--bg-primary] text-[--text-primary] flex flex-col font-sans overflow-hidden",children:[Z.isExportModalOpen&&c.jsx(AE,{isOpen:Z.isExportModalOpen,onClose:()=>Z.setExportModalOpen(!1),drawableObjects:Tn.filter(F=>F.type==="object"),canvasSize:p}),Z.isSingleExportModalOpen&&c.jsx(_E,{isOpen:Z.isSingleExportModalOpen,onClose:()=>Z.setSingleExportModalOpen(!1),item:Et,canvasSize:p,onSaveToLibrary:$t}),Z.deletingItemId&&c.jsx(lT,{isOpen:!!Z.deletingItemId,onCancel:()=>Z.setDeletingItemId(null),onConfirm:St,itemName:(so==null?void 0:so.name)||"",itemType:(so==null?void 0:so.type)==="group"?"group":"object"}),O.deletingLibraryItem&&c.jsx(iT,{isOpen:!!O.deletingLibraryItem,onCancel:O.onCancelDeleteLibraryItem,onConfirm:O.onConfirmDeleteLibraryItem,itemToDelete:O.deletingLibraryItem}),Z.showClearConfirm&&c.jsx(aT,{isOpen:Z.showClearConfirm,onCancel:()=>Z.setShowClearConfirm(!1),onConfirm:Ft}),Z.isCanvasSizeModalOpen&&c.jsx(sT,{isOpen:Z.isCanvasSizeModalOpen,onClose:()=>Z.setCanvasSizeModalOpen(!1),currentSize:p,onApply:(F,re)=>{t({type:"RESIZE_CANVAS",payload:{width:F,height:re}}),Z.setCanvasSizeModalOpen(!1),setTimeout(be.onZoomExtents,100)}}),Z.isResetConfirmOpen&&c.jsx(rT,{isOpen:Z.isResetConfirmOpen,onCancel:()=>Z.setIsResetConfirmOpen(!1),onConfirm:()=>{console.log("Resetting preferences..."),Z.setIsResetConfirmOpen(!1)}}),O.imageToEdit&&c.jsx(TE,{item:O.imageToEdit,onApply:O.onApplyTransparency,onCancel:O.onCancelEditTransparency}),V&&B!==null&&c.jsx(nT,{isOpen:V,onClose:()=>{R(!1),U(null)},onSelectTool:F=>Me.updateTool(B,F),fxPresets:A.brushPresets}),c.jsx(hT,{isOpen:Z.isProjectGalleryOpen,onClose:()=>Z.setProjectGalleryOpen(!1),user:G,projects:mt.projects,isLoading:mt.projectsLoading,onSave:F=>mt.saveProject(F,()=>({currentState:s,guides:W,toolSettings:{...A},quickAccess:Me.quickAccessSettings})),onLoad:mt.loadProject,onDelete:mt.deleteProject,onSaveLocally:F=>mt.saveLocally(F,()=>({currentState:s,guides:W,toolSettings:{...A},quickAccess:Me.quickAccessSettings})),onLoadFromFile:mt.loadFromFile}),c.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-2 bg-[--bg-primary] border-b border-[--bg-tertiary] z-20",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("h1",{className:"text-xl font-bold",children:"Sketcher"}),c.jsxs("button",{onClick:()=>Z.setProjectGalleryOpen(!0),className:"flex items-center gap-2 p-2 rounded-md bg-[--bg-secondary] hover:bg-[--bg-tertiary] border border-[--bg-tertiary] transition-colors text-sm",children:[c.jsx(JS,{className:"w-5 h-5"}),c.jsx("span",{children:"Galera"})]}),c.jsxs("button",{ref:Ve,onClick:()=>je(F=>!F),className:"flex items-center gap-2 p-2 rounded-md bg-[--bg-secondary] hover:bg-[--bg-tertiary] border border-[--bg-tertiary] transition-colors text-sm relative",children:[c.jsx(hy,{className:"w-5 h-5"}),c.jsx("span",{children:"Plantillas"}),c.jsx(oT,{isOpen:Se,onClose:()=>je(!1),templates:me.templates,onSave:Te,onLoad:Ce,onDelete:me.deleteTemplate,onResetPreferences:()=>Z.setIsResetConfirmOpen(!0)})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>M(_==="dark"?"light":"dark"),className:"p-2 rounded-md bg-[--bg-secondary] hover:bg-[--bg-tertiary] text-[--text-secondary]",children:_==="dark"?c.jsx(zS,{className:"w-5 h-5"}):c.jsx(PS,{className:"w-5 h-5"})}),c.jsx(ME,{user:G})]})]}),c.jsxs("div",{className:"flex flex-grow min-h-0 relative",children:[c.jsx(tE,{tool:b,setTool:S,...A,brushPresets:A.brushPresets,onSavePreset:A.onSavePreset,onUpdatePreset:A.onUpdatePreset,onLoadPreset:A.onLoadPreset,onDeletePreset:A.onDeletePreset,activeGuide:W.activeGuide,setActiveGuide:W.onSetActiveGuide,isOrthogonalVisible:W.isOrthogonalVisible,onToggleOrthogonal:W.toggleOrthogonal,onExportClick:()=>Z.setExportModalOpen(!0),onEnhance:F=>Ae.handleEnhance(F,p,Ie,Ge),isEnhancing:Ae.isEnhancing,enhancementPreview:Ae.enhancementPreview,onGenerateEnhancementPreview:()=>Ae.generateEnhancementPreview(p,Ie,Ge),objects:u,libraryItems:O.libraryItems,backgroundDataUrl:Ae.backgroundDataUrl,debugInfo:Ae.debugInfo,strokeMode:$,setStrokeMode:D,strokeModifier:I,setStrokeModifier:X}),c.jsxs("main",{ref:N,className:"flex-grow relative",onDrop:F=>{F.preventDefault();try{const re=JSON.parse(F.dataTransfer.getData("application/json"));re.type==="library-item"&&Rt(re,Ot,v)}catch{}},onDragOver:F=>{F.preventDefault(),F.dataTransfer.dropEffect="copy"},children:[c.jsx(EE,{items:Tn,activeItemId:Ot,...A,tool:b,setTool:S,onDrawCommit:Re,onUpdateItem:Le,viewTransform:be.viewTransform,setViewTransform:be.setViewTransform,onSelectItem:De,...W,isCropping:Ht,cropRect:It,setCropRect:$e,isTransforming:bt,transformState:We,setTransformState:Ut,transformSourceBbox:mn,isAspectRatioLocked:ft,strokeMode:$,strokeState:E,setStrokeState:K,strokeModifier:I,selection:L,setSelection:H,onCutSelection:qo,onCopySelection:Xn,onDeleteSelection:zt,onDeselect:En,getMinZoom:ye,MAX_ZOOM:gy,isAngleSnapEnabled:hn,angleSnapValue:Qt,onAddItem:le,textEditState:j,setTextEditState:z,onCommitText:_t,strokeSmoothing:oe}),c.jsx("div",{className:"absolute top-2 left-2 flex items-center gap-2 z-10",children:Mn&&c.jsx("button",{ref:rt,onClick:()=>tt(F=>!F),className:"bg-[--bg-primary]/80 backdrop-blur-sm text-[--text-secondary] text-xs rounded-md px-2 py-1 pointer-events-auto hover:bg-[--bg-secondary] transition-colors",title:"Ajustar escala del lienzo",children:Mn})}),c.jsx("button",{onClick:Z.handleToggleFullscreen,className:"absolute top-2 right-2 p-2 rounded-md bg-[--bg-primary]/80 backdrop-blur-sm hover:bg-[--bg-secondary] text-[--text-primary] transition-colors z-10",title:Z.isFullscreen?"Salir de Pantalla Completa":"Entrar en Pantalla Completa",children:Z.isFullscreen?c.jsx(KS,{className:"w-5 h-5"}):c.jsx(XS,{className:"w-5 h-5"})}),c.jsx(pT,{isOpen:Fe,onClose:()=>tt(!1),anchorEl:rt.current,scaleFactor:y,scaleUnit:x,onSetScaleFactor:at,onSetScaleUnit:Ct}),c.jsx(NE,{tool:b,setTool:S,onZoomExtents:be.onZoomExtents,onZoomIn:be.onZoomIn,onZoomOut:be.onZoomOut,onUndo:ae,onRedo:Y,onClearAll:()=>Z.setShowClearConfirm(!0),canUndo:Ne,canRedo:_e,isCropping:Ht,onApplyCrop:gn,onCancelCrop:Sn,isTransforming:bt,transformState:We,onApplyTransform:nn,onCancelTransform:Jn,isAspectRatioLocked:ft,onSetAspectRatioLocked:Yt,isAngleSnapEnabled:hn,onToggleAngleSnap:()=>Wt(F=>!F),angleSnapValue:Qt,onSetAngleSnapValue:At,onSetActiveGuide:W.onSetActiveGuide,onSetGridType:W.setGridType,isSnapToGridEnabled:W.isSnapToGridEnabled,onToggleSnapToGrid:W.toggleSnapToGrid,isOrthogonalVisible:W.isOrthogonalVisible,activeGuide:W.activeGuide,orthogonalGuide:W.orthogonalGuide,onSetOrthogonalAngle:W.onSetOrthogonalAngle,gridGuide:W.gridGuide,onSetGridSpacing:W.onSetGridSpacing,onSetGridMajorLineFrequency:W.onSetGridMajorLineFrequency,onSetGridIsoAngle:W.onSetGridIsoAngle,onSetGridMajorLineColor:W.onSetGridMajorLineColor,onSetGridMinorLineColor:W.onSetGridMinorLineColor,areGuidesLocked:W.areGuidesLocked,onSetAreGuidesLocked:W.setAreGuidesLocked,isPerspectiveStrokeLockEnabled:W.isPerspectiveStrokeLockEnabled,onSetIsPerspectiveStrokeLockEnabled:W.setIsPerspectiveStrokeLockEnabled,scaleFactor:s.scaleFactor,scaleUnit:s.scaleUnit,onPaste:Un,hasClipboardContent:!!ue,strokeSmoothing:oe,setStrokeSmoothing:ge}),c.jsx(eT,{settings:Me.quickAccessSettings,onUpdateColor:Me.updateColor,onAddColor:Me.addColor,onRemoveColor:Me.removeColor,onUpdateSize:Me.updateSize,onUpdateTool:()=>{},onSelectColor:Oe,onSelectSize:Ye,onSelectTool:F=>{F.type==="tool"?S(F.tool):F.type==="fx-preset"&&(S("fx-brush"),A.onLoadPreset(F.id))},onOpenToolSelector:F=>{R(!0),U(F)},activeTool:b,activeColor:ct,activeSize:gt})]}),Z.isRightSidebarVisible&&c.jsxs("aside",{ref:Z.rightSidebarRef,className:`flex-shrink-0 w-80 border-l border-[--bg-tertiary] flex flex-col ${it?"z-50":""}`,children:[c.jsx("div",{style:{height:Z.rightSidebarTopHeight},className:"flex-shrink-0",children:c.jsx(nE,{items:u,activeItemId:Ot,onAddItem:le,onCopyItem:xe,onDeleteItem:we,onSelectItem:De,onUpdateItem:Le,onMoveItem:ke,onMergeItems:ot,onUpdateBackground:Je,onRemoveBackgroundImage:nt,onExportItem:()=>{Et&&Z.setSingleExportModalOpen(!0)},onOpenCanvasSizeModal:()=>Z.setCanvasSizeModalOpen(!0),activeItemState:zn,onMoveItemUpDown:ml,onMergeItemDown:gl,onMergeItemUp:Ns,onAddObjectAbove:Go,onAddObjectBelow:Vo})}),c.jsx("div",{onPointerDown:Z.handlePointerDownResize,className:"flex-shrink-0 h-1.5 bg-[--bg-secondary] hover:bg-[--accent-primary] transition-colors cursor-ns-resize"}),c.jsx("div",{className:"flex-grow min-h-0",children:c.jsx(wE,{user:G,items:O.libraryItems,onImportImage:O.onImportToLibrary,onCreateFolder:O.onCreateFolder,onEditItem:O.onEditTransparency,onDeleteItem:O.onDeleteLibraryItem,onAddItemToScene:F=>Rt({type:"library-item",id:F},Ot,v),onMoveItems:O.onMoveItems})})]}),c.jsx("button",{onClick:()=>Z.setIsRightSidebarVisible(!Z.isRightSidebarVisible),className:"absolute top-1/2 -translate-y-1/2 bg-[--bg-secondary] p-2 rounded-full shadow-xl z-40 border border-[--bg-tertiary] hover:bg-[--bg-tertiary] transition-all",style:{right:Z.isRightSidebarVisible?"20.25rem":"0.25rem"},title:Z.isRightSidebarVisible?"Ocultar paneles":"Mostrar paneles",children:Z.isRightSidebarVisible?c.jsx(uy,{className:"w-5 h-5"}):c.jsx(GS,{className:"w-5 h-5"})})]})]})}const hT=({isOpen:o,onClose:t,user:s,projects:a,isLoading:r,onSave:u,onLoad:p,onDelete:y,onSaveLocally:x,onLoadFromFile:m})=>{const[v,b]=T.useState(""),[S,N]=T.useState(!1),[_,M]=T.useState(null),G=T.useRef(null),[k,V]=T.useState(!1),[R,B]=T.useState("mi-boceto"),U=T.useRef(null);T.useEffect(()=>{o&&(b(""),N(!1),M(null),V(!1))},[o]);const $=()=>{V(!0),setTimeout(()=>{var H,ue;(H=U.current)==null||H.focus(),(ue=U.current)==null||ue.select()},0)},D=async()=>{if(R.trim())try{await x(R.trim()),V(!1)}catch(H){console.error("Failed to save project locally:",H),alert(`Error al guardar el proyecto localmente: ${H instanceof Error?H.message:String(H)}`)}},E=()=>V(!1),K=async()=>{if(!v.trim()){alert("Please enter a project name.");return}N(!0);try{await u(v.trim()),b("")}catch(H){console.error("Failed to save project:",H),alert(`Error saving project: ${H instanceof Error?H.message:String(H)}`)}finally{N(!1)}},I=async()=>{_&&(await y(_),M(null))},X=()=>{var H;return(H=G.current)==null?void 0:H.click()},L=async H=>{var ue;(ue=H.target.files)!=null&&ue[0]&&await m(H.target.files[0]),H.target&&(H.target.value="")};return o?c.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:[c.jsxs("div",{className:"bg-[--bg-secondary] text-[--text-primary] rounded-lg shadow-xl p-6 w-full max-w-4xl h-full max-h-[90vh] flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[c.jsx("h2",{className:"text-2xl font-bold",children:"Galera de Proyectos"}),k?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{ref:U,type:"text",value:R,onChange:H=>B(H.target.value),onKeyDown:H=>{H.key==="Enter"&&D(),H.key==="Escape"&&E()},placeholder:"Nombre del archivo...",className:"bg-[--bg-secondary] text-[--text-primary] text-sm rounded-md p-2 border border-[--bg-tertiary] focus:ring-1 focus:ring-[--accent-primary] focus:outline-none"}),c.jsx("button",{onClick:D,className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white font-semibold",children:"Guardar"}),c.jsx("button",{onClick:E,className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"})]}):c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"file",ref:G,className:"hidden",accept:".sketcher,application/json",onChange:L}),c.jsxs("button",{onClick:X,className:"flex items-center gap-2 px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] font-semibold",children:[" ",c.jsx(YS,{className:"w-5 h-5"})," ",c.jsx("span",{children:"Cargar desde Archivo"})," "]}),c.jsxs("button",{onClick:$,className:"flex items-center gap-2 px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover] font-semibold",children:[" ",c.jsx(FS,{className:"w-5 h-5"})," ",c.jsx("span",{children:"Guardar Local"})," "]}),c.jsxs("button",{onClick:t,className:"p-2 rounded-full hover:bg-[--bg-tertiary]",children:[" ",c.jsx(bo,{className:"w-6 h-6"})," "]})]})]}),s?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-[--bg-primary] p-4 rounded-lg mb-4 flex-shrink-0",children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Guardar Lienzo Actual"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",value:v,onChange:H=>b(H.target.value),placeholder:"Nombre del nuevo proyecto...",className:"flex-grow bg-[--bg-secondary] text-[--text-primary] text-sm rounded-md p-2 border border-[--bg-tertiary] focus:ring-1 focus:ring-[--accent-primary] focus:outline-none",disabled:S}),c.jsxs("button",{onClick:K,disabled:!v.trim()||S||!s,className:"px-4 py-2 rounded-md bg-[--accent-primary] hover:bg-[--accent-hover] text-white font-semibold disabled:bg-gray-500 disabled:cursor-not-allowed",title:s?"":"Inicie sesin para guardar en la nube",children:[" ",S?"Guardando...":"Guardar en la Nube"," "]})]})]}),c.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:r?c.jsx("div",{className:"flex items-center justify-center h-full",children:c.jsx("div",{className:"w-8 h-8 border-4 border-[--accent-primary] border-t-transparent rounded-full animate-spin"})}):a.length===0?c.jsxs("div",{className:"text-center text-[--text-secondary] py-16",children:[" ",c.jsx("p",{children:"No se encontraron proyectos guardados."})," ",c.jsx("p",{className:"text-sm",children:"Guarda tu lienzo actual para empezar!"})," "]}):c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:a.map(H=>c.jsxs("div",{className:"group relative bg-[--bg-tertiary] rounded-lg overflow-hidden shadow-md",children:[c.jsx("div",{className:"aspect-video bg-white/10 flex items-center justify-center",children:c.jsx("img",{src:H.thumbnailUrl,alt:H.name,className:"w-full h-full object-cover"})}),c.jsx("div",{className:"p-2",children:c.jsx("p",{className:"font-semibold text-sm truncate",children:H.name})}),c.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2",children:[c.jsx("button",{onClick:()=>p(H),className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-500 text-white w-3/4",children:"Cargar"}),c.jsx("button",{onClick:()=>M(H),className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white w-3/4",children:"Eliminar"})]})]},H.id))})})]}):c.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center text-center text-[--text-secondary]",children:[" ",c.jsx(dy,{className:"w-16 h-16 mb-4"})," ",c.jsx("h3",{className:"text-xl font-bold",children:"Por favor, inicie sesin"})," ",c.jsx("p",{children:"Inicie sesin para guardar y cargar sus proyectos en la nube."})," "]})]}),_&&c.jsxs("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center",children:[" ",c.jsxs("div",{className:"bg-[--bg-secondary] rounded-lg p-6 shadow-xl",children:[" ",c.jsx("h3",{className:"text-lg font-bold",children:"Confirmar Eliminacin"})," ",c.jsxs("p",{className:"my-2 text-[--text-secondary]",children:['Ests seguro de que quieres eliminar "',_.name,'"? Esta accin no se puede deshacer.']})," ",c.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[" ",c.jsx("button",{onClick:()=>M(null),className:"px-4 py-2 rounded-md bg-[--bg-tertiary] hover:bg-[--bg-hover]",children:"Cancelar"})," ",c.jsx("button",{onClick:I,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-500 text-white",children:"Eliminar"})," "]})," "]})," "]})]}):null},pT=({isOpen:o,onClose:t,anchorEl:s,scaleFactor:a,scaleUnit:r,onSetScaleFactor:u,onSetScaleUnit:p})=>{const[y,x]=T.useState(""),m=T.useRef(null),v={mm:1,cm:10,m:1e3};T.useEffect(()=>{x(Number((a*v[r]).toFixed(2)).toString())},[a,r,v]),T.useEffect(()=>{const M=G=>{m.current&&!m.current.contains(G.target)&&s&&!s.contains(G.target)&&t()};return o&&document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[o,t,s]);const b=(M,G)=>{const k=parseFloat(M);!isNaN(k)&&k>0&&u(k/v[G])},S=M=>{const G=M.target.value;x(G),b(G,r)},N=M=>{p(M)};if(!o||!s)return null;const _=s.getBoundingClientRect();return c.jsxs("div",{ref:m,className:"absolute z-20 bg-[--bg-primary] border border-[--bg-tertiary] rounded-lg shadow-lg p-3 space-y-3",style:{top:_.bottom+8,left:_.left},children:[c.jsx("p",{className:"text-xs font-bold text-[--text-secondary]",children:"Ajustes de Escala"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm",children:"1"}),c.jsxs("select",{value:r,onChange:M=>N(M.target.value),className:"bg-[--bg-tertiary] text-sm rounded-md p-1 border border-[--bg-hover]",children:[" ",c.jsx("option",{value:"mm",children:"mm"})," ",c.jsx("option",{value:"cm",children:"cm"})," ",c.jsx("option",{value:"m",children:"m"})," "]}),c.jsx("span",{className:"text-sm",children:"="}),c.jsx("input",{type:"number",value:y,onChange:S,className:"w-24 bg-[--bg-secondary] text-sm rounded-md p-1 border border-[--bg-tertiary]"}),c.jsx("span",{className:"text-sm",children:"px"})]})]})};try{const{registerSW:o}=require("virtual:pwa-register");o&&o()}catch{}const yy=document.getElementById("root");if(!yy)throw new Error("Could not find root element to mount to");const mT=q0.createRoot(yy);mT.render(c.jsx(Mg.StrictMode,{children:c.jsx(fT,{})}));
